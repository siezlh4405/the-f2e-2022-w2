var $2=Object.defineProperty,Y2=Object.defineProperties,X2=Object.getOwnPropertyDescriptors,SC=Object.getOwnPropertySymbols,q2=Object.prototype.hasOwnProperty,Q2=Object.prototype.propertyIsEnumerable,qf=(Ie,$,Ae)=>$ in Ie?$2(Ie,$,{enumerable:!0,configurable:!0,writable:!0,value:Ae}):Ie[$]=Ae,Qf=(Ie,$)=>{for(var Ae in $||($={}))q2.call($,Ae)&&qf(Ie,Ae,$[Ae]);if(SC)for(var Ae of SC($))Q2.call($,Ae)&&qf(Ie,Ae,$[Ae]);return Ie},Kf=(Ie,$)=>Y2(Ie,X2($)),Yc=(Ie,$,Ae)=>(qf(Ie,"symbol"!=typeof $?$+"":$,Ae),Ae),Jf=(Ie,$,Ae)=>{if(!$.has(Ie))throw TypeError("Cannot "+Ae)},$e=(Ie,$,Ae)=>(Jf(Ie,$,"read from private field"),Ae?Ae.call(Ie):$.get(Ie)),Ze=(Ie,$,Ae)=>{if($.has(Ie))throw TypeError("Cannot add the same private member more than once");$ instanceof WeakSet?$.add(Ie):$.set(Ie,Ae)},Ut=(Ie,$,Ae,S)=>(Jf(Ie,$,"write to private field"),S?S.call(Ie,Ae):$.set(Ie,Ae),Ae),wC=(Ie,$,Ae,S)=>({set _(ke){Ut(Ie,$,ke,Ae)},get _(){return $e(Ie,$,S)}}),Xe=(Ie,$,Ae)=>(Jf(Ie,$,"access private method"),Ae);(self.webpackChunkthef2e2022week2=self.webpackChunkthef2e2022week2||[]).push([[179],{255:Ie=>{function $(Ae){return Promise.resolve().then(()=>{var S=new Error("Cannot find module '"+Ae+"'");throw S.code="MODULE_NOT_FOUND",S})}$.keys=()=>[],$.resolve=$,$.id=255,Ie.exports=$},371:(Ie,$,Ae)=>{var _,h,p,g,c,l,S=S||{version:"5.2.4"};if($.fabric=S,"undefined"!=typeof document&&"undefined"!=typeof window)S.document=document instanceof("undefined"!=typeof HTMLDocument?HTMLDocument:Document)?document:document.implementation.createHTMLDocument(""),S.window=window;else{var we=new(Ae(960).JSDOM)(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;S.document=we.document,S.jsdomImplForWrapper=Ae(759).implForWrapper,S.nodeCanvas=Ae(272).Canvas,S.window=we,DOMParser=S.window.DOMParser}function be(_,h){var p=_.canvas,g=h.targetCanvas,c=g.getContext("2d");c.translate(0,g.height),c.scale(1,-1),c.drawImage(p,0,p.height-g.height,g.width,g.height,0,0,g.width,g.height)}function le(_,h){var g=h.targetCanvas.getContext("2d"),c=h.destinationWidth,l=h.destinationHeight,o=c*l*4,a=new Uint8Array(this.imageBuffer,0,o),f=new Uint8ClampedArray(this.imageBuffer,0,o);_.readPixels(0,0,c,l,_.RGBA,_.UNSIGNED_BYTE,a);var u=new ImageData(f,c,l);g.putImageData(u,0,0)}S.isTouchSupported="ontouchstart"in S.window||"ontouchstart"in S.document||S.window&&S.window.navigator&&S.window.navigator.maxTouchPoints>0,S.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,S.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],S.DPI=96,S.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",S.commaWsp="(?:\\s+,?\\s*|,\\s*)",S.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,S.reNonWord=/[ \n\.,;!\?\-]/,S.fontPaths={},S.iMatrix=[1,0,0,1,0,0],S.svgNS="http://www.w3.org/2000/svg",S.perfLimitSizeTotal=2097152,S.maxCacheSideLimit=4096,S.minCacheSideLimit=256,S.charWidthsCache={},S.textureSize=2048,S.disableStyleCopyPaste=!1,S.enableGLFiltering=!0,S.devicePixelRatio=S.window.devicePixelRatio||S.window.webkitDevicePixelRatio||S.window.mozDevicePixelRatio||1,S.browserShadowBlurConstant=1,S.arcToSegmentsCache={},S.boundsOfCurveCache={},S.cachesBoundsOfCurve=!0,S.forceGLPutImageData=!1,S.initFilterBackend=function(){return S.enableGLFiltering&&S.isWebglSupported&&S.isWebglSupported(S.textureSize)?(console.log("max texture size: "+S.maxTextureSize),new S.WebglFilterBackend({tileSize:S.textureSize})):S.Canvas2dFilterBackend?new S.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=S),function(){function _(o,a){if(this.__eventListeners[o]){var f=this.__eventListeners[o];a?f[f.indexOf(a)]=!1:S.util.array.fill(f,!1)}}function p(o,a){var f=function(){a.apply(this,arguments),this.off(o,f)}.bind(this);this.on(o,f)}S.Observable={fire:function(o,a){if(!this.__eventListeners)return this;var f=this.__eventListeners[o];if(!f)return this;for(var u=0,m=f.length;u<m;u++)f[u]&&f[u].call(this,a||{});return this.__eventListeners[o]=f.filter(function(b){return!1!==b}),this},on:function(o,a){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var f in o)this.on(f,o[f]);else this.__eventListeners[o]||(this.__eventListeners[o]=[]),this.__eventListeners[o].push(a);return this},once:function(o,a){if(1===arguments.length)for(var f in o)p.call(this,f,o[f]);else p.call(this,o,a);return this},off:function(o,a){if(!this.__eventListeners)return this;if(0===arguments.length)for(o in this.__eventListeners)_.call(this,o);else if(1===arguments.length&&"object"==typeof arguments[0])for(var f in o)_.call(this,f,o[f]);else _.call(this,o,a);return this}}}(),S.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var _=0,h=arguments.length;_<h;_++)this._onObjectAdded(arguments[_]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(_,h,p){var g=this._objects;return p?g[h]=_:g.splice(h,0,_),this._onObjectAdded&&this._onObjectAdded(_),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var h,_=this._objects,p=!1,g=0,c=arguments.length;g<c;g++)-1!==(h=_.indexOf(arguments[g]))&&(p=!0,_.splice(h,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[g]));return this.renderOnAddRemove&&p&&this.requestRenderAll(),this},forEachObject:function(_,h){for(var p=this.getObjects(),g=0,c=p.length;g<c;g++)_.call(h,p[g],g,p);return this},getObjects:function(_){return void 0===_?this._objects.concat():this._objects.filter(function(h){return h.type===_})},item:function(_){return this._objects[_]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(_,h){return this._objects.indexOf(_)>-1||!!h&&this._objects.some(function(p){return"function"==typeof p.contains&&p.contains(_,!0)})},complexity:function(){return this._objects.reduce(function(_,h){return _+(h.complexity?h.complexity():0)},0)}},S.CommonMethods={_setOptions:function(_){for(var h in _)this.set(h,_[h])},_initGradient:function(_,h){_&&_.colorStops&&!(_ instanceof S.Gradient)&&this.set(h,new S.Gradient(_))},_initPattern:function(_,h,p){!_||!_.source||_ instanceof S.Pattern?p&&p():this.set(h,new S.Pattern(_,p))},_setObject:function(_){for(var h in _)this._set(h,_[h])},set:function(_,h){return"object"==typeof _?this._setObject(_):this._set(_,h),this},_set:function(_,h){this[_]=h},toggle:function(_){var h=this.get(_);return"boolean"==typeof h&&this.set(_,!h),this},get:function(_){return this[_]}},_=$,h=Math.sqrt,p=Math.atan2,g=Math.pow,c=Math.PI/180,l=Math.PI/2,S.util={cos:function(o){if(0===o)return 1;switch(o<0&&(o=-o),o/l){case 1:case 3:return 0;case 2:return-1}return Math.cos(o)},sin:function(o){if(0===o)return 0;var f=1;switch(o<0&&(f=-1),o/l){case 1:return f;case 2:return 0;case 3:return-f}return Math.sin(o)},removeFromArray:function(o,a){var f=o.indexOf(a);return-1!==f&&o.splice(f,1),o},getRandomInt:function(o,a){return Math.floor(Math.random()*(a-o+1))+o},degreesToRadians:function(o){return o*c},radiansToDegrees:function(o){return o/c},rotatePoint:function(o,a,f){var u=new S.Point(o.x-a.x,o.y-a.y),m=S.util.rotateVector(u,f);return new S.Point(m.x,m.y).addEquals(a)},rotateVector:function(o,a){var f=S.util.sin(a),u=S.util.cos(a);return{x:o.x*u-o.y*f,y:o.x*f+o.y*u}},createVector:function(o,a){return new S.Point(a.x-o.x,a.y-o.y)},calcAngleBetweenVectors:function(o,a){return Math.acos((o.x*a.x+o.y*a.y)/(Math.hypot(o.x,o.y)*Math.hypot(a.x,a.y)))},getHatVector:function(o){return new S.Point(o.x,o.y).multiply(1/Math.hypot(o.x,o.y))},getBisector:function(o,a,f){var u=S.util.createVector(o,a),m=S.util.createVector(o,f),b=S.util.calcAngleBetweenVectors(u,m),v=S.util.calcAngleBetweenVectors(S.util.rotateVector(u,b),m);return{vector:S.util.getHatVector(S.util.rotateVector(u,b*(0===v?1:-1)/2)),angle:b}},projectStrokeOnPoints:function(o,a,f){var u=[],m=a.strokeWidth/2,b=a.strokeUniform?new S.Point(1/a.scaleX,1/a.scaleY):new S.Point(1,1),v=function(C){var x=m/Math.hypot(C.x,C.y);return new S.Point(C.x*x*b.x,C.y*x*b.y)};return o.length<=1||o.forEach(function(C,x){var I,N,T=new S.Point(C.x,C.y);0===x?(N=o[x+1],I=f?v(S.util.createVector(N,T)).addEquals(T):o[o.length-1]):x===o.length-1?(I=o[x-1],N=f?v(S.util.createVector(I,T)).addEquals(T):o[0]):(I=o[x-1],N=o[x+1]);var ne,ae,H=S.util.getBisector(T,I,N),W=H.vector;if("miter"===a.strokeLineJoin&&(ne=-m/Math.sin(H.angle/2),ae=new S.Point(W.x*ne*b.x,W.y*ne*b.y),Math.hypot(ae.x,ae.y)/m<=a.strokeMiterLimit))return u.push(T.add(ae)),void u.push(T.subtract(ae));ne=-m*Math.SQRT2,ae=new S.Point(W.x*ne*b.x,W.y*ne*b.y),u.push(T.add(ae)),u.push(T.subtract(ae))}),u},transformPoint:function(o,a,f){return f?new S.Point(a[0]*o.x+a[2]*o.y,a[1]*o.x+a[3]*o.y):new S.Point(a[0]*o.x+a[2]*o.y+a[4],a[1]*o.x+a[3]*o.y+a[5])},makeBoundingBoxFromPoints:function(o,a){if(a)for(var f=0;f<o.length;f++)o[f]=S.util.transformPoint(o[f],a);var u=[o[0].x,o[1].x,o[2].x,o[3].x],m=S.util.array.min(u),v=S.util.array.max(u)-m,C=[o[0].y,o[1].y,o[2].y,o[3].y],x=S.util.array.min(C);return{left:m,top:x,width:v,height:S.util.array.max(C)-x}},invertTransform:function(o){var a=1/(o[0]*o[3]-o[1]*o[2]),f=[a*o[3],-a*o[1],-a*o[2],a*o[0]],u=S.util.transformPoint({x:o[4],y:o[5]},f,!0);return f[4]=-u.x,f[5]=-u.y,f},toFixed:function(o,a){return parseFloat(Number(o).toFixed(a))},parseUnit:function(o,a){var f=/\D{0,2}$/.exec(o),u=parseFloat(o);switch(a||(a=S.Text.DEFAULT_SVG_FONT_SIZE),f[0]){case"mm":return u*S.DPI/25.4;case"cm":return u*S.DPI/2.54;case"in":return u*S.DPI;case"pt":return u*S.DPI/72;case"pc":return u*S.DPI/72*12;case"em":return u*a;default:return u}},falseFunction:function(){return!1},getKlass:function(o,a){return o=S.util.string.camelize(o.charAt(0).toUpperCase()+o.slice(1)),S.util.resolveNamespace(a)[o]},getSvgAttributes:function(o){var a=["instantiated_by_use","style","id","class"];switch(o){case"linearGradient":a=a.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":a=a.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":a=a.concat(["offset","stop-color","stop-opacity"])}return a},resolveNamespace:function(o){if(!o)return S;var u,a=o.split("."),f=a.length,m=_||S.window;for(u=0;u<f;++u)m=m[a[u]];return m},loadImage:function(o,a,f,u){if(o){var m=S.util.createImage(),b=function(){a&&a.call(f,m,!1),m=m.onload=m.onerror=null};m.onload=b,m.onerror=function(){S.log("Error loading "+m.src),a&&a.call(f,null,!0),m=m.onload=m.onerror=null},0!==o.indexOf("data")&&null!=u&&(m.crossOrigin=u),"data:image/svg"===o.substring(0,14)&&(m.onload=null,S.util.loadImageInDom(m,b)),m.src=o}else a&&a.call(f,o)},loadImageInDom:function(o,a){var f=S.document.createElement("div");f.style.width=f.style.height="1px",f.style.left=f.style.top="-100%",f.style.position="absolute",f.appendChild(o),S.document.querySelector("body").appendChild(f),o.onload=function(){a(),f.parentNode.removeChild(f),f=null}},enlivenObjects:function(o,a,f,u){var m=[],b=0,v=(o=o||[]).length;function C(){++b===v&&a&&a(m.filter(function(x){return x}))}v?o.forEach(function(x,T){x&&x.type?S.util.getKlass(x.type,f).fromObject(x,function(N,H){H||(m[T]=N),u&&u(x,N,H),C()}):C()}):a&&a(m)},enlivenObjectEnlivables:function(o,a,f){var u=S.Object.ENLIVEN_PROPS.filter(function(m){return!!o[m]});S.util.enlivenObjects(u.map(function(m){return o[m]}),function(m){var b={};u.forEach(function(v,C){b[v]=m[C],a&&(a[v]=m[C])}),f&&f(b)})},enlivenPatterns:function(o,a){function f(){++m===b&&a&&a(u)}var u=[],m=0,b=(o=o||[]).length;b?o.forEach(function(v,C){v&&v.source?new S.Pattern(v,function(x){u[C]=x,f()}):(u[C]=v,f())}):a&&a(u)},groupSVGElements:function(o,a,f){var u;return o&&1===o.length?(void 0!==f&&(o[0].sourcePath=f),o[0]):(a&&(a.width&&a.height?a.centerPoint={x:a.width/2,y:a.height/2}:(delete a.width,delete a.height)),u=new S.Group(o,a),void 0!==f&&(u.sourcePath=f),u)},populateWithProperties:function(o,a,f){if(f&&Array.isArray(f))for(var u=0,m=f.length;u<m;u++)f[u]in o&&(a[f[u]]=o[f[u]])},createCanvasElement:function(){return S.document.createElement("canvas")},copyCanvasElement:function(o){var a=S.util.createCanvasElement();return a.width=o.width,a.height=o.height,a.getContext("2d").drawImage(o,0,0),a},toDataURL:function(o,a,f){return o.toDataURL("image/"+a,f)},createImage:function(){return S.document.createElement("img")},multiplyTransformMatrices:function(o,a,f){return[o[0]*a[0]+o[2]*a[1],o[1]*a[0]+o[3]*a[1],o[0]*a[2]+o[2]*a[3],o[1]*a[2]+o[3]*a[3],f?0:o[0]*a[4]+o[2]*a[5]+o[4],f?0:o[1]*a[4]+o[3]*a[5]+o[5]]},qrDecompose:function(o){var a=p(o[1],o[0]),f=g(o[0],2)+g(o[1],2),u=h(f),m=(o[0]*o[3]-o[2]*o[1])/u,b=p(o[0]*o[2]+o[1]*o[3],f);return{angle:a/c,scaleX:u,scaleY:m,skewX:b/c,skewY:0,translateX:o[4],translateY:o[5]}},calcRotateMatrix:function(o){if(!o.angle)return S.iMatrix.concat();var a=S.util.degreesToRadians(o.angle),f=S.util.cos(a),u=S.util.sin(a);return[f,u,-u,f,0,0]},calcDimensionsMatrix:function(o){var a=void 0===o.scaleX?1:o.scaleX,f=void 0===o.scaleY?1:o.scaleY,u=[o.flipX?-a:a,0,0,o.flipY?-f:f,0,0],m=S.util.multiplyTransformMatrices,b=S.util.degreesToRadians;return o.skewX&&(u=m(u,[1,0,Math.tan(b(o.skewX)),1],!0)),o.skewY&&(u=m(u,[1,Math.tan(b(o.skewY)),0,1],!0)),u},composeMatrix:function(o){var a=[1,0,0,1,o.translateX||0,o.translateY||0],f=S.util.multiplyTransformMatrices;return o.angle&&(a=f(a,S.util.calcRotateMatrix(o))),(1!==o.scaleX||1!==o.scaleY||o.skewX||o.skewY||o.flipX||o.flipY)&&(a=f(a,S.util.calcDimensionsMatrix(o))),a},resetObjectTransform:function(o){o.scaleX=1,o.scaleY=1,o.skewX=0,o.skewY=0,o.flipX=!1,o.flipY=!1,o.rotate(0)},saveObjectTransform:function(o){return{scaleX:o.scaleX,scaleY:o.scaleY,skewX:o.skewX,skewY:o.skewY,angle:o.angle,left:o.left,flipX:o.flipX,flipY:o.flipY,top:o.top}},isTransparent:function(o,a,f,u){u>0&&(a>u?a-=u:a=0,f>u?f-=u:f=0);var b,m=!0,C=o.getImageData(a,f,2*u||1,2*u||1),x=C.data.length;for(b=3;b<x&&0!=(m=C.data[b]<=0);b+=4);return C=null,m},parsePreserveAspectRatioAttribute:function(o){var b,a="meet",m=o.split(" ");return m&&m.length&&("meet"!==(a=m.pop())&&"slice"!==a?(b=a,a="meet"):m.length&&(b=m.pop())),{meetOrSlice:a,alignX:"none"!==b?b.slice(1,4):"none",alignY:"none"!==b?b.slice(5,8):"none"}},clearFabricFontCache:function(o){(o=(o||"").toLowerCase())?S.charWidthsCache[o]&&delete S.charWidthsCache[o]:S.charWidthsCache={}},limitDimsByArea:function(o,a){var f=Math.sqrt(a*o),u=Math.floor(a/f);return{x:Math.floor(f),y:u}},capValue:function(o,a,f){return Math.max(o,Math.min(a,f))},findScaleToFit:function(o,a){return Math.min(a.width/o.width,a.height/o.height)},findScaleToCover:function(o,a){return Math.max(a.width/o.width,a.height/o.height)},matrixToSVG:function(o){return"matrix("+o.map(function(a){return S.util.toFixed(a,S.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(o,a){var f=S.util.invertTransform(a),u=S.util.multiplyTransformMatrices(f,o.calcOwnMatrix());S.util.applyTransformToObject(o,u)},addTransformToObject:function(o,a){S.util.applyTransformToObject(o,S.util.multiplyTransformMatrices(a,o.calcOwnMatrix()))},applyTransformToObject:function(o,a){var f=S.util.qrDecompose(a),u=new S.Point(f.translateX,f.translateY);o.flipX=!1,o.flipY=!1,o.set("scaleX",f.scaleX),o.set("scaleY",f.scaleY),o.skewX=f.skewX,o.skewY=f.skewY,o.angle=f.angle,o.setPositionByOrigin(u,"center","center")},sizeAfterTransform:function(o,a,f){var u=o/2,m=a/2,b=[{x:-u,y:-m},{x:u,y:-m},{x:-u,y:m},{x:u,y:m}],v=S.util.calcDimensionsMatrix(f),C=S.util.makeBoundingBoxFromPoints(b,v);return{x:C.width,y:C.height}},mergeClipPaths:function(o,a){var f=o,u=a;f.inverted&&!u.inverted&&(f=a,u=o),S.util.applyTransformToObject(u,S.util.multiplyTransformMatrices(S.util.invertTransform(f.calcTransformMatrix()),u.calcTransformMatrix()));var m=f.inverted&&u.inverted;return m&&(f.inverted=u.inverted=!1),new S.Group([f],{clipPath:u,inverted:m})},hasStyleChanged:function(o,a,f){return f=f||!1,o.fill!==a.fill||o.stroke!==a.stroke||o.strokeWidth!==a.strokeWidth||o.fontSize!==a.fontSize||o.fontFamily!==a.fontFamily||o.fontWeight!==a.fontWeight||o.fontStyle!==a.fontStyle||o.deltaY!==a.deltaY||f&&(o.overline!==a.overline||o.underline!==a.underline||o.linethrough!==a.linethrough)},stylesToArray:function(o,a){o=S.util.object.clone(o,!0);for(var f=a.split("\n"),u=-1,m={},b=[],v=0;v<f.length;v++)if(o[v])for(var C=0;C<f[v].length;C++){u++;var x=o[v][C];x&&(S.util.hasStyleChanged(m,x,!0)?b.push({start:u,end:u+1,style:x}):b[b.length-1].end++),m=x||{}}else u+=f[v].length;return b},stylesFromArray:function(o,a){if(!Array.isArray(o))return o;for(var f=a.split("\n"),u=-1,m=0,b={},v=0;v<f.length;v++)for(var C=0;C<f[v].length;C++)u++,o[m]&&o[m].start<=u&&u<o[m].end&&(b[v]=b[v]||{},b[v][C]=Object.assign({},o[m].style),u===o[m].end-1&&m++);return b}},function(){var _=Array.prototype.join,h={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},p={m:"l",M:"L"};function g(B,L,D,M,E,P,A,k,R,j,z){var Q=S.util.cos(B),ee=S.util.sin(B),se=S.util.cos(L),J=S.util.sin(L),X=D*E*se-M*P*J+A,he=M*E*se+D*P*J+k;return["C",j+R*(-D*E*ee-M*P*Q),z+R*(-M*E*ee+D*P*Q),X+R*(D*E*J+M*P*se),he+R*(M*E*J-D*P*se),X,he]}function l(B,L,D,M){var E=Math.atan2(L,B),P=Math.atan2(M,D);return P>=E?P-E:2*Math.PI-(E-P)}function a(B,L,D){for(var z=function(B,L,D,M,E,P,A){var k=Math.PI,R=A*k/180,j=S.util.sin(R),z=S.util.cos(R),Q=0,ee=0,se=-z*B*.5-j*L*.5,J=-z*L*.5+j*B*.5,X=(D=Math.abs(D))*D,he=(M=Math.abs(M))*M,_e=J*J,te=se*se,ue=X*he-X*_e-he*te,ge=0;if(ue<0){var U=Math.sqrt(1-ue/(X*he));D*=U,M*=U}else ge=(E===P?-1:1)*Math.sqrt(ue/(X*_e+he*te));var q=ge*D*J/M,Z=-ge*M*se/D,Se=z*q-j*Z+.5*B,xe=j*q+z*Z+.5*L,Te=l(1,0,(se-q)/D,(J-Z)/M),Re=l((se-q)/D,(J-Z)/M,(-se-q)/D,(-J-Z)/M);0===P&&Re>0?Re-=2*k:1===P&&Re<0&&(Re+=2*k);for(var Oe=Math.ceil(Math.abs(Re/k*2)),Ye=[],qe=Re/Oe,yt=8/3*Math.sin(qe/4)*Math.sin(qe/4)/Math.sin(qe/2),Ce=Te+qe,re=0;re<Oe;re++)Ye[re]=g(Te,Ce,z,j,D,M,Se,xe,yt,Q,ee),Q=Ye[re][5],ee=Ye[re][6],Te=Ce,Ce+=qe;return Ye}(D[6]-B,D[7]-L,D[1],D[2],D[4],D[5],D[3]),Q=0,ee=z.length;Q<ee;Q++)z[Q][1]+=B,z[Q][2]+=L,z[Q][3]+=B,z[Q][4]+=L,z[Q][5]+=B,z[Q][6]+=L;return z}function u(B,L,D,M){return Math.sqrt((D-B)*(D-B)+(M-L)*(M-L))}function x(B,L,D,M,E,P,A,k){return function(R){var j=function(B){return B*B*B}(R),z=function(B){return 3*B*B*(1-B)}(R),Q=function(B){return 3*B*(1-B)*(1-B)}(R),ee=function(B){return(1-B)*(1-B)*(1-B)}(R);return{x:A*j+E*z+D*Q+B*ee,y:k*j+P*z+M*Q+L*ee}}}function T(B,L,D,M,E,P,A,k){return function(R){var j=1-R;return Math.atan2(3*j*j*(M-L)+6*j*R*(P-M)+3*R*R*(k-P),3*j*j*(D-B)+6*j*R*(E-D)+3*R*R*(A-E))}}function W(B,L,D,M,E,P){return function(A){var k=function(B){return B*B}(A),R=function(B){return 2*B*(1-B)}(A),j=function(B){return(1-B)*(1-B)}(A);return{x:E*k+D*R+B*j,y:P*k+M*R+L*j}}}function K(B,L,D,M,E,P){return function(A){var k=1-A;return Math.atan2(2*k*(M-L)+2*A*(P-M),2*k*(D-B)+2*A*(E-D))}}function ne(B,L,D){var E,A,M={x:L,y:D},P=0;for(A=1;A<=100;A+=1)E=B(A/100),P+=u(M.x,M.y,E.x,E.y),M=E;return P}function ce(B){for(var M,j,z,Q,L=0,D=B.length,E=0,P=0,A=0,k=0,R=[],ee=0;ee<D;ee++){switch(z={x:E,y:P,command:(M=B[ee])[0]},M[0]){case"M":z.length=0,A=E=M[1],k=P=M[2];break;case"L":z.length=u(E,P,M[1],M[2]),E=M[1],P=M[2];break;case"C":j=x(E,P,M[1],M[2],M[3],M[4],M[5],M[6]),Q=T(E,P,M[1],M[2],M[3],M[4],M[5],M[6]),z.iterator=j,z.angleFinder=Q,z.length=ne(j,E,P),E=M[5],P=M[6];break;case"Q":j=W(E,P,M[1],M[2],M[3],M[4]),Q=K(E,P,M[1],M[2],M[3],M[4]),z.iterator=j,z.angleFinder=Q,z.length=ne(j,E,P),E=M[3],P=M[4];break;case"Z":case"z":z.destX=A,z.destY=k,z.length=u(E,P,A,k),E=A,P=k}L+=z.length,R.push(z)}return R.push({length:L,x:E,y:P}),R}S.util.joinPath=function(B){return B.map(function(L){return L.join(" ")}).join(" ")},S.util.parsePath=function(B){var M,E,Q,ee,se,L=[],D=[],P=S.rePathCommand,A="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",k="("+A+")"+S.commaWsp,R="([01])"+S.commaWsp+"?",z=new RegExp(k+"?"+k+"?"+k+R+R+k+"?("+A+")","g");if(!B||!B.match)return L;for(var X,J=0,he=(se=B.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;J<he;J++){ee=(M=se[J]).slice(1).trim(),D.length=0;var _e=M.charAt(0);if(X=[_e],"a"===_e.toLowerCase())for(var te;te=z.exec(ee);)for(var ue=1;ue<te.length;ue++)D.push(te[ue]);else for(;Q=P.exec(ee);)D.push(Q[0]);ue=0;for(var ge=D.length;ue<ge;ue++)E=parseFloat(D[ue]),isNaN(E)||X.push(E);var U=h[_e.toLowerCase()],q=p[_e]||_e;if(X.length-1>U)for(var Z=1,Se=X.length;Z<Se;Z+=U)L.push([_e].concat(X.slice(Z,Z+U))),_e=q;else L.push(X)}return L},S.util.makePathSimpler=function(B){var A,k,R,z,Q,ee,L=0,D=0,M=B.length,E=0,P=0,j=[];for(k=0;k<M;++k){switch(R=!1,(A=B[k].slice(0))[0]){case"l":A[0]="L",A[1]+=L,A[2]+=D;case"L":L=A[1],D=A[2];break;case"h":A[1]+=L;case"H":A[0]="L",A[2]=D,L=A[1];break;case"v":A[1]+=D;case"V":A[0]="L",D=A[1],A[1]=L,A[2]=D;break;case"m":A[0]="M",A[1]+=L,A[2]+=D;case"M":L=A[1],D=A[2],E=A[1],P=A[2];break;case"c":A[0]="C",A[1]+=L,A[2]+=D,A[3]+=L,A[4]+=D,A[5]+=L,A[6]+=D;case"C":Q=A[3],ee=A[4],L=A[5],D=A[6];break;case"s":A[0]="S",A[1]+=L,A[2]+=D,A[3]+=L,A[4]+=D;case"S":"C"===z?(Q=2*L-Q,ee=2*D-ee):(Q=L,ee=D),L=A[3],D=A[4],A[0]="C",A[5]=A[3],A[6]=A[4],A[3]=A[1],A[4]=A[2],A[1]=Q,A[2]=ee,Q=A[3],ee=A[4];break;case"q":A[0]="Q",A[1]+=L,A[2]+=D,A[3]+=L,A[4]+=D;case"Q":Q=A[1],ee=A[2],L=A[3],D=A[4];break;case"t":A[0]="T",A[1]+=L,A[2]+=D;case"T":"Q"===z?(Q=2*L-Q,ee=2*D-ee):(Q=L,ee=D),A[0]="Q",L=A[1],D=A[2],A[1]=Q,A[2]=ee,A[3]=L,A[4]=D;break;case"a":A[0]="A",A[6]+=L,A[7]+=D;case"A":R=!0,j=j.concat(a(L,D,A)),L=A[6],D=A[7];break;case"z":case"Z":L=E,D=P}R||j.push(A),z=A[0]}return j},S.util.getSmoothPathFromPoints=function(B,L){var M,D=[],E=new S.Point(B[0].x,B[0].y),P=new S.Point(B[1].x,B[1].y),A=B.length,k=1,R=0,j=A>2;for(j&&(k=B[2].x<P.x?-1:B[2].x===P.x?0:1,R=B[2].y<P.y?-1:B[2].y===P.y?0:1),D.push(["M",E.x-k*(L=L||0),E.y-R*L]),M=1;M<A;M++){if(!E.eq(P)){var z=E.midPointFrom(P);D.push(["Q",E.x,E.y,z.x,z.y])}E=B[M],M+1<B.length&&(P=B[M+1])}return j&&(k=E.x>B[M-2].x?1:E.x===B[M-2].x?0:-1,R=E.y>B[M-2].y?1:E.y===B[M-2].y?0:-1),D.push(["L",E.x+k*L,E.y+R*L]),D},S.util.getPathSegmentsInfo=ce,S.util.getBoundsOfCurve=function(B,L,D,M,E,P,A,k){var R;if(S.cachesBoundsOfCurve&&(R=_.call(arguments),S.boundsOfCurveCache[R]))return S.boundsOfCurveCache[R];var X,he,_e,te,ue,ge,U,q,j=Math.sqrt,z=Math.min,Q=Math.max,ee=Math.abs,se=[],J=[[],[]];he=6*B-12*D+6*E,X=-3*B+9*D-9*E+3*A,_e=3*D-3*B;for(var Z=0;Z<2;++Z)if(Z>0&&(he=6*L-12*M+6*P,X=-3*L+9*M-9*P+3*k,_e=3*M-3*L),ee(X)<1e-12){if(ee(he)<1e-12)continue;0<(te=-_e/he)&&te<1&&se.push(te)}else!((U=he*he-4*_e*X)<0)&&(0<(ue=(-he+(q=j(U)))/(2*X))&&ue<1&&se.push(ue),0<(ge=(-he-q)/(2*X))&&ge<1&&se.push(ge));for(var Oe,Te=se.length,Re=Te;Te--;)J[0][Te]=(Oe=1-(te=se[Te]))*Oe*Oe*B+3*Oe*Oe*te*D+3*Oe*te*te*E+te*te*te*A,J[1][Te]=Oe*Oe*Oe*L+3*Oe*Oe*te*M+3*Oe*te*te*P+te*te*te*k;J[0][Re]=B,J[1][Re]=L,J[0][Re+1]=A,J[1][Re+1]=k;var Ye=[{x:z.apply(null,J[0]),y:z.apply(null,J[1])},{x:Q.apply(null,J[0]),y:Q.apply(null,J[1])}];return S.cachesBoundsOfCurve&&(S.boundsOfCurveCache[R]=Ye),Ye},S.util.getPointOnPath=function(B,L,D){D||(D=ce(B));for(var M=0;L-D[M].length>0&&M<D.length-2;)L-=D[M].length,M++;var R,E=D[M],P=L/E.length,k=B[M];switch(E.command){case"M":return{x:E.x,y:E.y,angle:0};case"Z":case"z":return(R=new S.Point(E.x,E.y).lerp(new S.Point(E.destX,E.destY),P)).angle=Math.atan2(E.destY-E.y,E.destX-E.x),R;case"L":return(R=new S.Point(E.x,E.y).lerp(new S.Point(k[1],k[2]),P)).angle=Math.atan2(k[2]-E.y,k[1]-E.x),R;case"C":case"Q":return function(B,L){for(var A,k,z,D=0,M=0,E=B.iterator,P={x:B.x,y:B.y},R=.01,j=B.angleFinder;M<L&&R>1e-4;)A=E(D),z=D,(k=u(P.x,P.y,A.x,A.y))+M>L?(D-=R,R/=2):(P=A,D+=R,M+=k);return A.angle=j(z),A}(E,L)}},S.util.transformPath=function(B,L,D){return D&&(L=S.util.multiplyTransformMatrices(L,[1,0,0,1,-D.x,-D.y])),B.map(function(M){for(var E=M.slice(0),P={},A=1;A<M.length-1;A+=2)P.x=M[A],P.y=M[A+1],P=S.util.transformPoint(P,L),E[A]=P.x,E[A+1]=P.y;return E})}}(),function(){var _=Array.prototype.slice;function l(o,a,f){if(o&&0!==o.length){var u=o.length-1,m=a?o[u][a]:o[u];if(a)for(;u--;)f(o[u][a],m)&&(m=o[u][a]);else for(;u--;)f(o[u],m)&&(m=o[u]);return m}}S.util.array={fill:function(o,a){for(var f=o.length;f--;)o[f]=a;return o},invoke:function(o,a){for(var f=_.call(arguments,2),u=[],m=0,b=o.length;m<b;m++)u[m]=f.length?o[m][a].apply(o[m],f):o[m][a].call(o[m]);return u},min:function(o,a){return l(o,a,function(f,u){return f<u})},max:function(o,a){return l(o,a,function(f,u){return f>=u})}}}(),function(){function _(p,g,c){if(c)if(!S.isLikelyNode&&g instanceof Element)p=g;else if(g instanceof Array){p=[];for(var l=0,o=g.length;l<o;l++)p[l]=_({},g[l],c)}else if(g&&"object"==typeof g)for(var a in g)"canvas"===a||"group"===a?p[a]=null:g.hasOwnProperty(a)&&(p[a]=_({},g[a],c));else p=g;else for(var a in g)p[a]=g[a];return p}S.util.object={extend:_,clone:function(p,g){return _({},p,g)}},S.util.object.extend(S.util,S.Observable)}(),function(){function c(l,o){var a=l.charCodeAt(o);if(isNaN(a))return"";if(a<55296||a>57343)return l.charAt(o);if(55296<=a&&a<=56319){if(l.length<=o+1)throw"High surrogate without following low surrogate";var f=l.charCodeAt(o+1);if(56320>f||f>57343)throw"High surrogate without following low surrogate";return l.charAt(o)+l.charAt(o+1)}if(0===o)throw"Low surrogate without preceding high surrogate";var u=l.charCodeAt(o-1);if(55296>u||u>56319)throw"Low surrogate without preceding high surrogate";return!1}S.util.string={camelize:function(l){return l.replace(/-+(.)?/g,function(o,a){return a?a.toUpperCase():""})},capitalize:function(l,o){return l.charAt(0).toUpperCase()+(o?l.slice(1):l.slice(1).toLowerCase())},escapeXml:function(l){return l.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(l){var a,o=0,f=[];for(o=0;o<l.length;o++)!1!==(a=c(l,o))&&f.push(a);return f}}}(),function(){var _=Array.prototype.slice,h=function(){},p=function(){for(var a in{toString:1})if("toString"===a)return!1;return!0}(),g=function(a,f,u){for(var m in f)a.prototype[m]=m in a.prototype&&"function"==typeof a.prototype[m]&&(f[m]+"").indexOf("callSuper")>-1?function(b){return function(){var v=this.constructor.superclass;this.constructor.superclass=u;var C=f[b].apply(this,arguments);if(this.constructor.superclass=v,"initialize"!==b)return C}}(m):f[m],p&&(f.toString!==Object.prototype.toString&&(a.prototype.toString=f.toString),f.valueOf!==Object.prototype.valueOf&&(a.prototype.valueOf=f.valueOf))};function c(){}function l(a){for(var f=null,u=this;u.constructor.superclass;){var m=u.constructor.superclass.prototype[a];if(u[a]!==m){f=m;break}u=u.constructor.superclass.prototype}return f?arguments.length>1?f.apply(this,_.call(arguments,1)):f.call(this):console.log("tried to callSuper "+a+", method not found in prototype chain",this)}S.util.createClass=function(){var a=null,f=_.call(arguments,0);function u(){this.initialize.apply(this,arguments)}"function"==typeof f[0]&&(a=f.shift()),u.superclass=a,u.subclasses=[],a&&(c.prototype=a.prototype,u.prototype=new c,a.subclasses.push(u));for(var m=0,b=f.length;m<b;m++)g(u,f[m],a);return u.prototype.initialize||(u.prototype.initialize=h),u.prototype.constructor=u,u.prototype.callSuper=l,u}}(),function(){var _=!!S.document.createElement("div").attachEvent,h=["touchstart","touchmove","touchend"];S.util.addListener=function(g,c,l,o){g&&g.addEventListener(c,l,!_&&o)},S.util.removeListener=function(g,c,l,o){g&&g.removeEventListener(c,l,!_&&o)},S.util.getPointer=function(g){var l=S.util.getScrollLeftTop(g.target),o=function(g){var c=g.changedTouches;return c&&c[0]?c[0]:g}(g);return{x:o.clientX+l.left,y:o.clientY+l.top}},S.util.isTouchEvent=function(g){return h.indexOf(g.type)>-1||"touch"===g.pointerType}}(),function(){var h=S.document.createElement("div"),c=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,l=function(o){return o};"string"==typeof h.style.opacity?l=function(o,a){return o.style.opacity=a,o}:"string"==typeof h.style.filter&&(l=function(o,a){var f=o.style;return o.currentStyle&&!o.currentStyle.hasLayout&&(f.zoom=1),c.test(f.filter)?f.filter=f.filter.replace(c,a=a>=.9999?"":"alpha(opacity="+100*a+")"):f.filter+=" alpha(opacity="+100*a+")",o}),S.util.setStyle=function(o,a){var f=o.style;if(!f)return o;if("string"==typeof a)return o.style.cssText+=";"+a,a.indexOf("opacity")>-1?l(o,a.match(/opacity:\s*(\d?\.?\d*)/)[1]):o;for(var u in a)"opacity"===u?l(o,a[u]):f.setProperty("float"===u||"cssFloat"===u?void 0===f.styleFloat?"cssFloat":"styleFloat":u,a[u]);return o}}(),function(){var p,u,C,x,_=Array.prototype.slice,g=function(C){return _.call(C,0)};try{p=g(S.document.childNodes)instanceof Array}catch(C){}function c(C,x){var T=S.document.createElement(C);for(var I in x)"class"===I?T.className=x[I]:"for"===I?T.htmlFor=x[I]:T.setAttribute(I,x[I]);return T}function a(C){for(var x=0,T=0,I=S.document.documentElement,N=S.document.body||{scrollLeft:0,scrollTop:0};C&&(C.parentNode||C.host)&&((C=C.parentNode||C.host)===S.document?(x=N.scrollLeft||I.scrollLeft||0,T=N.scrollTop||I.scrollTop||0):(x+=C.scrollLeft||0,T+=C.scrollTop||0),1!==C.nodeType||"fixed"!==C.style.position););return{left:x,top:T}}p||(g=function(C){for(var x=new Array(C.length),T=C.length;T--;)x[T]=C[T];return x}),u=S.document.defaultView&&S.document.defaultView.getComputedStyle?function(C,x){var T=S.document.defaultView.getComputedStyle(C,null);return T?T[x]:void 0}:function(C,x){var T=C.style[x];return!T&&C.currentStyle&&(T=C.currentStyle[x]),T},x="userSelect"in(C=S.document.documentElement.style)?"userSelect":"MozUserSelect"in C?"MozUserSelect":"WebkitUserSelect"in C?"WebkitUserSelect":"KhtmlUserSelect"in C?"KhtmlUserSelect":"",S.util.makeElementUnselectable=function(N){return void 0!==N.onselectstart&&(N.onselectstart=S.util.falseFunction),x?N.style[x]="none":"string"==typeof N.unselectable&&(N.unselectable="on"),N},S.util.makeElementSelectable=function(N){return void 0!==N.onselectstart&&(N.onselectstart=null),x?N.style[x]="":"string"==typeof N.unselectable&&(N.unselectable=""),N},S.util.setImageSmoothing=function(C,x){C.imageSmoothingEnabled=C.imageSmoothingEnabled||C.webkitImageSmoothingEnabled||C.mozImageSmoothingEnabled||C.msImageSmoothingEnabled||C.oImageSmoothingEnabled,C.imageSmoothingEnabled=x},S.util.getById=function(C){return"string"==typeof C?S.document.getElementById(C):C},S.util.toArray=g,S.util.addClass=function(C,x){C&&-1===(" "+C.className+" ").indexOf(" "+x+" ")&&(C.className+=(C.className?" ":"")+x)},S.util.makeElement=c,S.util.wrapElement=function(C,x,T){return"string"==typeof x&&(x=c(x,T)),C.parentNode&&C.parentNode.replaceChild(x,C),x.appendChild(C),x},S.util.getScrollLeftTop=a,S.util.getElementOffset=function(C){var x,H,T=C&&C.ownerDocument,I={left:0,top:0},N={left:0,top:0},W={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!T)return N;for(var K in W)N[W[K]]+=parseInt(u(C,K),10)||0;return x=T.documentElement,void 0!==C.getBoundingClientRect&&(I=C.getBoundingClientRect()),H=a(C),{left:I.left+H.left-(x.clientLeft||0)+N.left,top:I.top+H.top-(x.clientTop||0)+N.top}},S.util.getNodeCanvas=function(C){var x=S.jsdomImplForWrapper(C);return x._canvas||x._image},S.util.cleanUpJsdomNode=function(C){if(S.isLikelyNode){var x=S.jsdomImplForWrapper(C);x&&(x._image=null,x._canvas=null,x._currentSrc=null,x._attributes=null,x._classList=null)}}}(),function(){function h(){}S.util.request=function(g,c){c||(c={});var l=c.method?c.method.toUpperCase():"GET",o=c.onComplete||function(){},a=new S.window.XMLHttpRequest,f=c.body||c.parameters;return a.onreadystatechange=function(){4===a.readyState&&(o(a),a.onreadystatechange=h)},"GET"===l&&(f=null,"string"==typeof c.parameters&&(g=function(g,c){return g+(/\?/.test(g)?"&":"?")+c}(g,c.parameters))),a.open(l,g,!0),("POST"===l||"PUT"===l)&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(f),a}}(),S.log=console.log,S.warn=console.warn,function(){var _=S.util.object.extend,h=S.util.object.clone,p=[];function g(){return!1}function c(m,b,v,C){return-v*Math.cos(m/C*(Math.PI/2))+v+b}S.util.object.extend(p,{cancelAll:function(){var m=this.splice(0);return m.forEach(function(b){b.cancel()}),m},cancelByCanvas:function(m){if(!m)return[];var b=this.filter(function(v){return"object"==typeof v.target&&v.target.canvas===m});return b.forEach(function(v){v.cancel()}),b},cancelByTarget:function(m){var b=this.findAnimationsByTarget(m);return b.forEach(function(v){v.cancel()}),b},findAnimationIndex:function(m){return this.indexOf(this.findAnimation(m))},findAnimation:function(m){return this.find(function(b){return b.cancel===m})},findAnimationsByTarget:function(m){return m?this.filter(function(b){return b.target===m}):[]}});var o=S.window.requestAnimationFrame||S.window.webkitRequestAnimationFrame||S.window.mozRequestAnimationFrame||S.window.oRequestAnimationFrame||S.window.msRequestAnimationFrame||function(m){return S.window.setTimeout(m,1e3/60)},a=S.window.cancelAnimationFrame||S.window.clearTimeout;function f(){return o.apply(S.window,arguments)}S.util.animate=function(m){m||(m={});var v,b=!1,C=function(){var x=S.runningAnimations.indexOf(v);return x>-1&&S.runningAnimations.splice(x,1)[0]};return v=_(h(m),{cancel:function(){return b=!0,C()},currentValue:"startValue"in m?m.startValue:0,completionRate:0,durationRate:0}),S.runningAnimations.push(v),f(function(x){var H,T=x||+new Date,I=m.duration||500,N=T+I,W=m.onChange||g,K=m.abort||g,ne=m.onComplete||g,ae=m.easing||c,ce="startValue"in m&&m.startValue.length>0,Y="startValue"in m?m.startValue:0,de="endValue"in m?m.endValue:100,fe=m.byValue||(ce?Y.map(function(me,B){return de[B]-Y[B]}):de-Y);m.onStart&&m.onStart(),function me(B){var L=(H=B||+new Date)>N?I:H-T,D=L/I,M=ce?Y.map(function(P,A){return ae(L,Y[A],fe[A],I)}):ae(L,Y,fe,I),E=Math.abs(ce?(M[0]-Y[0])/fe[0]:(M-Y)/fe);if(v.currentValue=ce?M.slice():M,v.completionRate=E,v.durationRate=D,!b){if(K(M,E,D))return void C();if(H>N)return v.currentValue=ce?de.slice():de,v.completionRate=1,v.durationRate=1,W(ce?de.slice():de,1,1),ne(de,1,1),void C();W(M,E,D),f(me)}}(T)}),v.cancel},S.util.requestAnimFrame=f,S.util.cancelAnimFrame=function(){return a.apply(S.window,arguments)},S.runningAnimations=p}(),function(){function _(p,g,c){var l="rgba("+parseInt(p[0]+c*(g[0]-p[0]),10)+","+parseInt(p[1]+c*(g[1]-p[1]),10)+","+parseInt(p[2]+c*(g[2]-p[2]),10);return(l+=","+(p&&g?parseFloat(p[3]+c*(g[3]-p[3])):1))+")"}S.util.animateColor=function(p,g,c,l){var o=new S.Color(p).getSource(),a=new S.Color(g).getSource(),f=l.onComplete,u=l.onChange;return S.util.animate(S.util.object.extend(l=l||{},{duration:c||500,startValue:o,endValue:a,byValue:a,easing:function(m,b,v,C){return _(b,v,l.colorEasing?l.colorEasing(m,C):1-Math.cos(m/C*(Math.PI/2)))},onComplete:function(m,b,v){if(f)return f(_(a,a,0),b,v)},onChange:function(m,b,v){if(u){if(Array.isArray(m))return u(_(m,m,0),b,v);u(m,b,v)}}}))}}(),function(){function _(B,L,D,M){return B<Math.abs(L)?(B=L,M=D/4):M=0===L&&0===B?D/(2*Math.PI)*Math.asin(1):D/(2*Math.PI)*Math.asin(L/B),{a:B,c:L,p:D,s:M}}function h(B,L,D){return B.a*Math.pow(2,10*(L-=1))*Math.sin((L*D-B.s)*(2*Math.PI)/B.p)}function de(B,L,D,M){return D-fe(M-B,0,D,M)+L}function fe(B,L,D,M){return(B/=M)<1/2.75?D*(7.5625*B*B)+L:B<2/2.75?D*(7.5625*(B-=1.5/2.75)*B+.75)+L:B<2.5/2.75?D*(7.5625*(B-=2.25/2.75)*B+.9375)+L:D*(7.5625*(B-=2.625/2.75)*B+.984375)+L}S.util.ease={easeInQuad:function(B,L,D,M){return D*(B/=M)*B+L},easeOutQuad:function(B,L,D,M){return-D*(B/=M)*(B-2)+L},easeInOutQuad:function(B,L,D,M){return(B/=M/2)<1?D/2*B*B+L:-D/2*(--B*(B-2)-1)+L},easeInCubic:function(B,L,D,M){return D*(B/=M)*B*B+L},easeOutCubic:function(B,L,D,M){return D*((B=B/M-1)*B*B+1)+L},easeInOutCubic:function(B,L,D,M){return(B/=M/2)<1?D/2*B*B*B+L:D/2*((B-=2)*B*B+2)+L},easeInQuart:function(B,L,D,M){return D*(B/=M)*B*B*B+L},easeOutQuart:function(B,L,D,M){return-D*((B=B/M-1)*B*B*B-1)+L},easeInOutQuart:function(B,L,D,M){return(B/=M/2)<1?D/2*B*B*B*B+L:-D/2*((B-=2)*B*B*B-2)+L},easeInQuint:function(B,L,D,M){return D*(B/=M)*B*B*B*B+L},easeOutQuint:function(B,L,D,M){return D*((B=B/M-1)*B*B*B*B+1)+L},easeInOutQuint:function(B,L,D,M){return(B/=M/2)<1?D/2*B*B*B*B*B+L:D/2*((B-=2)*B*B*B*B+2)+L},easeInSine:function(B,L,D,M){return-D*Math.cos(B/M*(Math.PI/2))+D+L},easeOutSine:function(B,L,D,M){return D*Math.sin(B/M*(Math.PI/2))+L},easeInOutSine:function(B,L,D,M){return-D/2*(Math.cos(Math.PI*B/M)-1)+L},easeInExpo:function(B,L,D,M){return 0===B?L:D*Math.pow(2,10*(B/M-1))+L},easeOutExpo:function(B,L,D,M){return B===M?L+D:D*(1-Math.pow(2,-10*B/M))+L},easeInOutExpo:function(B,L,D,M){return 0===B?L:B===M?L+D:(B/=M/2)<1?D/2*Math.pow(2,10*(B-1))+L:D/2*(2-Math.pow(2,-10*--B))+L},easeInCirc:function(B,L,D,M){return-D*(Math.sqrt(1-(B/=M)*B)-1)+L},easeOutCirc:function(B,L,D,M){return D*Math.sqrt(1-(B=B/M-1)*B)+L},easeInOutCirc:function(B,L,D,M){return(B/=M/2)<1?-D/2*(Math.sqrt(1-B*B)-1)+L:D/2*(Math.sqrt(1-(B-=2)*B)+1)+L},easeInElastic:function(B,L,D,M){var P=0;return 0===B?L:1==(B/=M)?L+D:(P||(P=.3*M),-h(_(D,D,P,1.70158),B,M)+L)},easeOutElastic:function(B,L,D,M){var P=0;if(0===B)return L;if(1==(B/=M))return L+D;P||(P=.3*M);var k=_(D,D,P,1.70158);return k.a*Math.pow(2,-10*B)*Math.sin((B*M-k.s)*(2*Math.PI)/k.p)+k.c+L},easeInOutElastic:function(B,L,D,M){var P=0;if(0===B)return L;if(2==(B/=M/2))return L+D;P||(P=M*(.3*1.5));var k=_(D,D,P,1.70158);return B<1?-.5*h(k,B,M)+L:k.a*Math.pow(2,-10*(B-=1))*Math.sin((B*M-k.s)*(2*Math.PI)/k.p)*.5+k.c+L},easeInBack:function(B,L,D,M,E){return void 0===E&&(E=1.70158),D*(B/=M)*B*((E+1)*B-E)+L},easeOutBack:function(B,L,D,M,E){return void 0===E&&(E=1.70158),D*((B=B/M-1)*B*((E+1)*B+E)+1)+L},easeInOutBack:function(B,L,D,M,E){return void 0===E&&(E=1.70158),(B/=M/2)<1?D/2*(B*B*((1+(E*=1.525))*B-E))+L:D/2*((B-=2)*B*((1+(E*=1.525))*B+E)+2)+L},easeInBounce:de,easeOutBounce:fe,easeInOutBounce:function(B,L,D,M){return B<M/2?.5*de(2*B,0,D,M)+L:.5*fe(2*B-M,0,D,M)+.5*D+L}}}(),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.object.extend,g=h.util.object.clone,c=h.util.toFixed,l=h.util.parseUnit,o=h.util.multiplyTransformMatrices,b={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},v={stroke:"strokeOpacity",fill:"fillOpacity"},C="font-size",x="clip-path";function T(P){return P in b?b[P]:P}function I(P,A,k,R){var z,j=Array.isArray(A);if("fill"!==P&&"stroke"!==P||"none"!==A){if("strokeUniform"===P)return"non-scaling-stroke"===A;if("strokeDashArray"===P)A="none"===A?null:A.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===P)A=k&&k.transformMatrix?o(k.transformMatrix,h.parseTransformAttribute(A)):h.parseTransformAttribute(A);else if("visible"===P)A="none"!==A&&"hidden"!==A,k&&!1===k.visible&&(A=!1);else if("opacity"===P)A=parseFloat(A),k&&void 0!==k.opacity&&(A*=k.opacity);else if("textAnchor"===P)A="start"===A?"left":"end"===A?"right":"center";else if("charSpacing"===P)z=l(A,R)/R*1e3;else if("paintFirst"===P){var Q=A.indexOf("fill"),ee=A.indexOf("stroke");A="fill",(Q>-1&&ee>-1&&ee<Q||-1===Q&&ee>-1)&&(A="stroke")}else{if("href"===P||"xlink:href"===P||"font"===P)return A;if("imageSmoothing"===P)return"optimizeQuality"===A;z=j?A.map(l):l(A,R)}}else A="";return!j&&isNaN(z)?A:z}function N(P){return new RegExp("^("+P.join("|")+")\\b","i")}function W(P,A){var j,z,Q,R=[];for(z=0,Q=A.length;z<Q;z++)j=P.getElementsByTagName(A[z]),R=R.concat(Array.prototype.slice.call(j));return R}function ce(P,A){var k,R=!0;return(k=de(P,A.pop()))&&A.length&&(R=function(P,A){for(var k,R=!0;P.parentNode&&1===P.parentNode.nodeType&&A.length;)R&&(k=A.pop()),R=de(P=P.parentNode,k);return 0===A.length}(P,A)),k&&R&&0===A.length}function de(P,A){var z,Q,k=P.nodeName,R=P.getAttribute("class"),j=P.getAttribute("id");if(z=new RegExp("^"+k,"i"),A=A.replace(z,""),j&&A.length&&(z=new RegExp("#"+j+"(?![a-zA-Z\\-]+)","i"),A=A.replace(z,"")),R&&A.length)for(Q=(R=R.split(" ")).length;Q--;)z=new RegExp("\\."+R[Q]+"(?![a-zA-Z\\-]+)","i"),A=A.replace(z,"");return 0===A.length}function fe(P,A){var k;if(P.getElementById&&(k=P.getElementById(A)),k)return k;var R,j,z,Q=P.getElementsByTagName("*");for(j=0,z=Q.length;j<z;j++)if(A===(R=Q[j]).getAttribute("id"))return R}h.svgValidTagNamesRegEx=N(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),h.svgViewBoxElementsRegEx=N(["symbol","image","marker","pattern","view","svg"]),h.svgInvalidAncestorsRegEx=N(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),h.svgValidParentsRegEx=N(["symbol","g","a","svg","clipPath","defs"]),h.cssRules={},h.gradientDefs={},h.clipPaths={},h.parseTransformAttribute=function(){function k(Z,Se,xe){Z[xe]=Math.tan(h.util.degreesToRadians(Se[0]))}var j=h.iMatrix,z=h.reNum,Q=h.commaWsp,te="(?:(?:(matrix)\\s*\\(\\s*("+z+")"+Q+"("+z+")"+Q+"("+z+")"+Q+"("+z+")"+Q+"("+z+")"+Q+"("+z+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+z+")(?:"+Q+"("+z+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+z+")(?:"+Q+"("+z+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+z+")(?:"+Q+"("+z+")"+Q+"("+z+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+z+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+z+")\\s*\\)))",U=new RegExp("^\\s*(?:(?:"+te+"(?:"+Q+"*"+te+")*)?)\\s*$"),q=new RegExp(te,"g");return function(Z){var Se=j.concat(),xe=[];if(!Z||Z&&!U.test(Z))return Se;Z.replace(q,function(Re){var Oe=new RegExp(te).exec(Re).filter(function(yt){return!!yt}),Ye=Oe[1],qe=Oe.slice(2).map(parseFloat);switch(Ye){case"translate":!function(Z,Se){Z[4]=Se[0],2===Se.length&&(Z[5]=Se[1])}(Se,qe);break;case"rotate":qe[0]=h.util.degreesToRadians(qe[0]),function(Z,Se){var xe=h.util.cos(Se[0]),Te=h.util.sin(Se[0]),Re=0,Oe=0;3===Se.length&&(Re=Se[1],Oe=Se[2]),Z[0]=xe,Z[1]=Te,Z[2]=-Te,Z[3]=xe,Z[4]=Re-(xe*Re-Te*Oe),Z[5]=Oe-(Te*Re+xe*Oe)}(Se,qe);break;case"scale":!function(Z,Se){var Te=2===Se.length?Se[1]:Se[0];Z[0]=Se[0],Z[3]=Te}(Se,qe);break;case"skewX":k(Se,qe,2);break;case"skewY":k(Se,qe,1);break;case"matrix":Se=qe}xe.push(Se.concat()),Se=j.concat()});for(var Te=xe[0];xe.length>1;)xe.shift(),Te=h.util.multiplyTransformMatrices(Te,xe[0]);return Te}}();var B=new RegExp("^\\s*("+h.reNum+"+)\\s*,?\\s*("+h.reNum+"+)\\s*,?\\s*("+h.reNum+"+)\\s*,?\\s*("+h.reNum+"+)\\s*$");function L(P){if(!h.svgViewBoxElementsRegEx.test(P.nodeName))return{};var j,z,Q,ee,se,J,A=P.getAttribute("viewBox"),k=1,R=1,X=P.getAttribute("width"),he=P.getAttribute("height"),_e=P.getAttribute("x")||0,te=P.getAttribute("y")||0,ue=P.getAttribute("preserveAspectRatio")||"",ge=!A||!(A=A.match(B)),U=!X||!he||"100%"===X||"100%"===he,q=ge&&U,Z={},Se="",xe=0,Te=0;if(Z.width=0,Z.height=0,Z.toBeParsed=q,ge&&(_e||te)&&P.parentNode&&"#document"!==P.parentNode.nodeName&&(Se=" translate("+l(_e)+" "+l(te)+") ",se=(P.getAttribute("transform")||"")+Se,P.setAttribute("transform",se),P.removeAttribute("x"),P.removeAttribute("y")),q)return Z;if(ge)return Z.width=l(X),Z.height=l(he),Z;if(j=-parseFloat(A[1]),z=-parseFloat(A[2]),Q=parseFloat(A[3]),ee=parseFloat(A[4]),Z.minX=j,Z.minY=z,Z.viewBoxWidth=Q,Z.viewBoxHeight=ee,U?(Z.width=Q,Z.height=ee):(Z.width=l(X),Z.height=l(he),k=Z.width/Q,R=Z.height/ee),"none"!==(ue=h.util.parsePreserveAspectRatioAttribute(ue)).alignX&&("meet"===ue.meetOrSlice&&(R=k=k>R?R:k),"slice"===ue.meetOrSlice&&(R=k=k>R?k:R),xe=Z.width-Q*k,Te=Z.height-ee*k,"Mid"===ue.alignX&&(xe/=2),"Mid"===ue.alignY&&(Te/=2),"Min"===ue.alignX&&(xe=0),"Min"===ue.alignY&&(Te=0)),1===k&&1===R&&0===j&&0===z&&0===_e&&0===te)return Z;if((_e||te)&&"#document"!==P.parentNode.nodeName&&(Se=" translate("+l(_e)+" "+l(te)+") "),se=Se+" matrix("+k+" 0 0 "+R+" "+(j*k+xe)+" "+(z*R+Te)+") ","svg"===P.nodeName){for(J=P.ownerDocument.createElementNS(h.svgNS,"g");P.firstChild;)J.appendChild(P.firstChild);P.appendChild(J)}else(J=P).removeAttribute("x"),J.removeAttribute("y"),se=J.getAttribute("transform")+se;return J.setAttribute("transform",se),Z}function M(P,A){var R="xlink:href",z=fe(P,A.getAttribute(R).slice(1));if(z&&z.getAttribute(R)&&M(P,z),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach(function(ee){z&&!A.hasAttribute(ee)&&z.hasAttribute(ee)&&A.setAttribute(ee,z.getAttribute(ee))}),!A.children.length)for(var Q=z.cloneNode(!0);Q.firstChild;)A.appendChild(Q.firstChild);A.removeAttribute(R)}h.parseSVGDocument=function(P,A,k,R){if(P){!function(P){for(var A=W(P,["use","svg:use"]),k=0;A.length&&k<A.length;){var R=A[k],j=R.getAttribute("xlink:href")||R.getAttribute("href");if(null===j)return;var _e,te,ue,ge,z=j.slice(1),Q=R.getAttribute("x")||0,ee=R.getAttribute("y")||0,se=fe(P,z).cloneNode(!0),J=(se.getAttribute("transform")||"")+" translate("+Q+", "+ee+")",he=A.length,U=h.svgNS;if(L(se),/^svg$/i.test(se.nodeName)){var q=se.ownerDocument.createElementNS(U,"g");for(te=0,ge=(ue=se.attributes).length;te<ge;te++)_e=ue.item(te),q.setAttributeNS(U,_e.nodeName,_e.nodeValue);for(;se.firstChild;)q.appendChild(se.firstChild);se=q}for(te=0,ge=(ue=R.attributes).length;te<ge;te++)"x"!==(_e=ue.item(te)).nodeName&&"y"!==_e.nodeName&&"xlink:href"!==_e.nodeName&&"href"!==_e.nodeName&&("transform"===_e.nodeName?J=_e.nodeValue+" "+J:se.setAttribute(_e.nodeName,_e.nodeValue));se.setAttribute("transform",J),se.setAttribute("instantiated_by_use","1"),se.removeAttribute("id"),R.parentNode.replaceChild(se,R),A.length===he&&k++}}(P);var z,Q,j=h.Object.__uid++,ee=L(P),se=h.util.toArray(P.getElementsByTagName("*"));if(ee.crossOrigin=R&&R.crossOrigin,ee.svgUid=j,0===se.length&&h.isLikelyNode){var J=[];for(z=0,Q=(se=P.selectNodes('//*[name(.)!="svg"]')).length;z<Q;z++)J[z]=se[z];se=J}var X=se.filter(function(_e){return L(_e),h.svgValidTagNamesRegEx.test(_e.nodeName.replace("svg:",""))&&!function(P,A){for(;P&&(P=P.parentNode);)if(P.nodeName&&A.test(P.nodeName.replace("svg:",""))&&!P.getAttribute("instantiated_by_use"))return!0;return!1}(_e,h.svgInvalidAncestorsRegEx)});if(!X||X&&!X.length)return void(A&&A([],{}));var he={};se.filter(function(_e){return"clipPath"===_e.nodeName.replace("svg:","")}).forEach(function(_e){var te=_e.getAttribute("id");he[te]=h.util.toArray(_e.getElementsByTagName("*")).filter(function(ue){return h.svgValidTagNamesRegEx.test(ue.nodeName.replace("svg:",""))})}),h.gradientDefs[j]=h.getGradientDefs(P),h.cssRules[j]=h.getCSSRules(P),h.clipPaths[j]=he,h.parseElements(X,function(_e,te){A&&(A(_e,ee,te,se),delete h.gradientDefs[j],delete h.cssRules[j],delete h.clipPaths[j])},g(ee),k,R)}};var E=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+h.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+h.reNum+"))?\\s+(.*)");p(h,{parseFontDeclaration:function(P,A){var k=P.match(E);if(k){var R=k[1],j=k[3],z=k[4],Q=k[5],ee=k[6];R&&(A.fontStyle=R),j&&(A.fontWeight=isNaN(parseFloat(j))?j:parseFloat(j)),z&&(A.fontSize=l(z)),ee&&(A.fontFamily=ee),Q&&(A.lineHeight="normal"===Q?1:Q)}},getGradientDefs:function(P){var R,k=W(P,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),j=0,z={};for(j=k.length;j--;)(R=k[j]).getAttribute("xlink:href")&&M(P,R),z[R.getAttribute("id")]=R;return z},parseAttributes:function(P,A,k){if(P){var R,z,Q,j={};void 0===k&&(k=P.getAttribute("svgUid")),P.parentNode&&h.svgValidParentsRegEx.test(P.parentNode.nodeName)&&(j=h.parseAttributes(P.parentNode,A,k));var ee=A.reduce(function(ue,ge){return(R=P.getAttribute(ge))&&(ue[ge]=R),ue},{}),se=p(function(P,A){var k={};for(var R in h.cssRules[A])if(ce(P,R.split(" ")))for(var j in h.cssRules[A][R])k[j]=h.cssRules[A][R][j];return k}(P,k),h.parseStyleAttribute(P));ee=p(ee,se),se[x]&&P.setAttribute(x,se[x]),z=Q=j.fontSize||h.Text.DEFAULT_SVG_FONT_SIZE,ee[C]&&(ee[C]=z=l(ee[C],Q));var J,X,he={};for(var _e in ee)X=I(J=T(_e),ee[_e],j,z),he[J]=X;he&&he.font&&h.parseFontDeclaration(he.font,he);var te=p(j,he);return h.svgValidParentsRegEx.test(P.nodeName)?te:function(P){for(var A in v)if(void 0!==P[v[A]]&&""!==P[A]){if(void 0===P[A]){if(!h.Object.prototype[A])continue;P[A]=h.Object.prototype[A]}if(0!==P[A].indexOf("url(")){var k=new h.Color(P[A]);P[A]=k.setAlpha(c(k.getAlpha()*P[v[A]],2)).toRgba()}}return P}(te)}},parseElements:function(P,A,k,R,j){new h.ElementsParser(P,A,k,R,j).parse()},parseStyleAttribute:function(P){var A={},k=P.getAttribute("style");return k&&("string"==typeof k?function(P,A){var k,R;P.replace(/;\s*$/,"").split(";").forEach(function(j){var z=j.split(":");k=z[0].trim().toLowerCase(),R=z[1].trim(),A[k]=R})}(k,A):function(P,A){for(var j in P)void 0!==P[j]&&(A[j.toLowerCase()]=P[j])}(k,A)),A},parsePointsAttribute:function(P){if(!P)return null;var k,R,A=[];for(k=0,R=(P=(P=P.replace(/,/g," ").trim()).split(/\s+/)).length;k<R;k+=2)A.push({x:parseFloat(P[k]),y:parseFloat(P[k+1])});return A},getCSSRules:function(P){var k,R,A=P.getElementsByTagName("style"),j={};for(k=0,R=A.length;k<R;k++){var Q=A[k].textContent;""!==(Q=Q.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&Q.split("}").filter(function(ee){return ee.trim()}).forEach(function(ee){var se=ee.split("{"),J={},he=se[1].trim().split(";").filter(function(ge){return ge.trim()});for(k=0,R=he.length;k<R;k++){var _e=he[k].split(":"),te=_e[0].trim(),ue=_e[1].trim();J[te]=ue}(ee=se[0].trim()).split(",").forEach(function(ge){""!==(ge=ge.replace(/^svg/i,"").trim())&&(j[ge]?h.util.object.extend(j[ge],J):j[ge]=h.util.object.clone(J))})})}return j},loadSVGFromURL:function(P,A,k,R){P=P.replace(/^\n\s*/,"").trim(),new h.util.request(P,{method:"get",onComplete:function(z){var Q=z.responseXML;if(!Q||!Q.documentElement)return A&&A(null),!1;h.parseSVGDocument(Q.documentElement,function(ee,se,J,X){A&&A(ee,se,J,X)},k,R)}})},loadSVGFromString:function(P,A,k,R){var z=(new h.window.DOMParser).parseFromString(P.trim(),"text/xml");h.parseSVGDocument(z.documentElement,function(Q,ee,se,J){A(Q,ee,se,J)},k,R)}})}($),S.ElementsParser=function(_,h,p,g,c,l){this.elements=_,this.callback=h,this.options=p,this.reviver=g,this.svgUid=p&&p.svgUid||0,this.parsingOptions=c,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=l},function(_){_.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},_.createObjects=function(){var h=this;this.elements.forEach(function(p,g){p.setAttribute("svgUid",h.svgUid),h.createObject(p,g)})},_.findTag=function(h){return S[S.util.string.capitalize(h.tagName.replace("svg:",""))]},_.createObject=function(h,p){var g=this.findTag(h);if(g&&g.fromElement)try{g.fromElement(h,this.createCallback(p,h),this.options)}catch(c){S.log(c)}else this.checkIfDone()},_.createCallback=function(h,p){var g=this;return function(c){var l;g.resolveGradient(c,p,"fill"),g.resolveGradient(c,p,"stroke"),c instanceof S.Image&&c._originalElement&&(l=c.parsePreserveAspectRatioAttribute(p)),c._removeTransformMatrix(l),g.resolveClipPath(c,p),g.reviver&&g.reviver(p,c),g.instances[h]=c,g.checkIfDone()}},_.extractPropertyDefinition=function(h,p,g){var c=h[p],l=this.regexUrl;if(l.test(c)){l.lastIndex=0;var o=l.exec(c)[1];return l.lastIndex=0,S[g][this.svgUid][o]}},_.resolveGradient=function(h,p,g){var c=this.extractPropertyDefinition(h,g,"gradientDefs");if(c){var l=p.getAttribute(g+"-opacity"),o=S.Gradient.fromElement(c,h,l,this.options);h.set(g,o)}},_.createClipPathCallback=function(h,p){return function(g){g._removeTransformMatrix(),g.fillRule=g.clipRule,p.push(g)}},_.resolveClipPath=function(h,p){var c,o,a,f,g=this.extractPropertyDefinition(h,"clipPath","clipPaths");if(g){a=[],o=S.util.invertTransform(h.calcTransformMatrix());for(var m=g[0].parentNode,b=p;b.parentNode&&b.getAttribute("clip-path")!==h.clipPath;)b=b.parentNode;b.parentNode.appendChild(m);for(var v=0;v<g.length;v++)this.findTag(c=g[v]).fromElement(c,this.createClipPathCallback(h,a),this.options);g=1===a.length?a[0]:new S.Group(a),f=S.util.multiplyTransformMatrices(o,g.calcTransformMatrix()),g.clipPath&&this.resolveClipPath(g,b);var u=S.util.qrDecompose(f);g.flipX=!1,g.flipY=!1,g.set("scaleX",u.scaleX),g.set("scaleY",u.scaleY),g.angle=u.angle,g.skewX=u.skewX,g.skewY=0,g.setPositionByOrigin({x:u.translateX,y:u.translateY},"center","center"),h.clipPath=g}else delete h.clipPath},_.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter(function(h){return null!=h}),this.callback(this.instances,this.elements))}}(S.ElementsParser.prototype),function(_){"use strict";var h=_.fabric||(_.fabric={});function p(g,c){this.x=g,this.y=c}h.Point?h.warn("fabric.Point is already defined"):(h.Point=p,p.prototype={type:"point",constructor:p,add:function(g){return new p(this.x+g.x,this.y+g.y)},addEquals:function(g){return this.x+=g.x,this.y+=g.y,this},scalarAdd:function(g){return new p(this.x+g,this.y+g)},scalarAddEquals:function(g){return this.x+=g,this.y+=g,this},subtract:function(g){return new p(this.x-g.x,this.y-g.y)},subtractEquals:function(g){return this.x-=g.x,this.y-=g.y,this},scalarSubtract:function(g){return new p(this.x-g,this.y-g)},scalarSubtractEquals:function(g){return this.x-=g,this.y-=g,this},multiply:function(g){return new p(this.x*g,this.y*g)},multiplyEquals:function(g){return this.x*=g,this.y*=g,this},divide:function(g){return new p(this.x/g,this.y/g)},divideEquals:function(g){return this.x/=g,this.y/=g,this},eq:function(g){return this.x===g.x&&this.y===g.y},lt:function(g){return this.x<g.x&&this.y<g.y},lte:function(g){return this.x<=g.x&&this.y<=g.y},gt:function(g){return this.x>g.x&&this.y>g.y},gte:function(g){return this.x>=g.x&&this.y>=g.y},lerp:function(g,c){return void 0===c&&(c=.5),c=Math.max(Math.min(1,c),0),new p(this.x+(g.x-this.x)*c,this.y+(g.y-this.y)*c)},distanceFrom:function(g){var c=this.x-g.x,l=this.y-g.y;return Math.sqrt(c*c+l*l)},midPointFrom:function(g){return this.lerp(g)},min:function(g){return new p(Math.min(this.x,g.x),Math.min(this.y,g.y))},max:function(g){return new p(Math.max(this.x,g.x),Math.max(this.y,g.y))},toString:function(){return this.x+","+this.y},setXY:function(g,c){return this.x=g,this.y=c,this},setX:function(g){return this.x=g,this},setY:function(g){return this.y=g,this},setFromPoint:function(g){return this.x=g.x,this.y=g.y,this},swap:function(g){var c=this.x,l=this.y;this.x=g.x,this.y=g.y,g.x=c,g.y=l},clone:function(){return new p(this.x,this.y)}})}($),function(_){"use strict";var h=_.fabric||(_.fabric={});function p(g){this.status=g,this.points=[]}h.Intersection?h.warn("fabric.Intersection is already defined"):(h.Intersection=p,h.Intersection.prototype={constructor:p,appendPoint:function(g){return this.points.push(g),this},appendPoints:function(g){return this.points=this.points.concat(g),this}},h.Intersection.intersectLineLine=function(g,c,l,o){var a,f=(o.x-l.x)*(g.y-l.y)-(o.y-l.y)*(g.x-l.x),u=(c.x-g.x)*(g.y-l.y)-(c.y-g.y)*(g.x-l.x),m=(o.y-l.y)*(c.x-g.x)-(o.x-l.x)*(c.y-g.y);if(0!==m){var b=f/m,v=u/m;0<=b&&b<=1&&0<=v&&v<=1?(a=new p("Intersection")).appendPoint(new h.Point(g.x+b*(c.x-g.x),g.y+b*(c.y-g.y))):a=new p}else a=new p(0===f||0===u?"Coincident":"Parallel");return a},h.Intersection.intersectLinePolygon=function(g,c,l){var m,b,o=new p,a=l.length;for(b=0;b<a;b++)m=p.intersectLineLine(g,c,l[b],l[(b+1)%a]),o.appendPoints(m.points);return o.points.length>0&&(o.status="Intersection"),o},h.Intersection.intersectPolygonPolygon=function(g,c){var a,l=new p,o=g.length;for(a=0;a<o;a++){var m=p.intersectLinePolygon(g[a],g[(a+1)%o],c);l.appendPoints(m.points)}return l.points.length>0&&(l.status="Intersection"),l},h.Intersection.intersectPolygonRectangle=function(g,c,l){var o=c.min(l),a=c.max(l),f=new h.Point(a.x,o.y),u=new h.Point(o.x,a.y),m=p.intersectLinePolygon(o,f,g),b=p.intersectLinePolygon(f,a,g),v=p.intersectLinePolygon(a,u,g),C=p.intersectLinePolygon(u,o,g),x=new p;return x.appendPoints(m.points),x.appendPoints(b.points),x.appendPoints(v.points),x.appendPoints(C.points),x.points.length>0&&(x.status="Intersection"),x})}($),function(_){"use strict";var h=_.fabric||(_.fabric={});function p(c){c?this._tryParsingColor(c):this.setSource([0,0,0,1])}function g(c,l,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?c+6*(l-c)*o:o<.5?l:o<2/3?c+(l-c)*(2/3-o)*6:c}h.Color?h.warn("fabric.Color is already defined."):(h.Color=p,h.Color.prototype={_tryParsingColor:function(c){var l;c in p.colorNameMap&&(c=p.colorNameMap[c]),"transparent"===c&&(l=[255,255,255,0]),l||(l=p.sourceFromHex(c)),l||(l=p.sourceFromRgb(c)),l||(l=p.sourceFromHsl(c)),l||(l=[0,0,0,1]),l&&this.setSource(l)},_rgbToHsl:function(c,l,o){var a,f,u,m=h.util.array.max([c/=255,l/=255,o/=255]),b=h.util.array.min([c,l,o]);if(u=(m+b)/2,m===b)a=f=0;else{var v=m-b;switch(f=u>.5?v/(2-m-b):v/(m+b),m){case c:a=(l-o)/v+(l<o?6:0);break;case l:a=(o-c)/v+2;break;case o:a=(c-l)/v+4}a/=6}return[Math.round(360*a),Math.round(100*f),Math.round(100*u)]},getSource:function(){return this._source},setSource:function(c){this._source=c},toRgb:function(){var c=this.getSource();return"rgb("+c[0]+","+c[1]+","+c[2]+")"},toRgba:function(){var c=this.getSource();return"rgba("+c[0]+","+c[1]+","+c[2]+","+c[3]+")"},toHsl:function(){var c=this.getSource(),l=this._rgbToHsl(c[0],c[1],c[2]);return"hsl("+l[0]+","+l[1]+"%,"+l[2]+"%)"},toHsla:function(){var c=this.getSource(),l=this._rgbToHsl(c[0],c[1],c[2]);return"hsla("+l[0]+","+l[1]+"%,"+l[2]+"%,"+c[3]+")"},toHex:function(){var l,o,a,c=this.getSource();return l=1===(l=c[0].toString(16)).length?"0"+l:l,o=1===(o=c[1].toString(16)).length?"0"+o:o,a=1===(a=c[2].toString(16)).length?"0"+a:a,l.toUpperCase()+o.toUpperCase()+a.toUpperCase()},toHexa:function(){var l,c=this.getSource();return l=1===(l=(l=Math.round(255*c[3])).toString(16)).length?"0"+l:l,this.toHex()+l.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(c){var l=this.getSource();return l[3]=c,this.setSource(l),this},toGrayscale:function(){var c=this.getSource(),l=parseInt((.3*c[0]+.59*c[1]+.11*c[2]).toFixed(0),10);return this.setSource([l,l,l,c[3]]),this},toBlackWhite:function(c){var l=this.getSource(),o=(.3*l[0]+.59*l[1]+.11*l[2]).toFixed(0),a=l[3];return c=c||127,o=Number(o)<Number(c)?0:255,this.setSource([o,o,o,a]),this},overlayWith:function(c){c instanceof p||(c=new p(c));var m,l=[],o=this.getAlpha(),f=this.getSource(),u=c.getSource();for(m=0;m<3;m++)l.push(Math.round(.5*f[m]+.5*u[m]));return l[3]=o,this.setSource(l),this}},h.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,h.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,h.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,h.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},h.Color.fromRgb=function(c){return p.fromSource(p.sourceFromRgb(c))},h.Color.sourceFromRgb=function(c){var l=c.match(p.reRGBa);if(l){var o=parseInt(l[1],10)/(/%$/.test(l[1])?100:1)*(/%$/.test(l[1])?255:1),a=parseInt(l[2],10)/(/%$/.test(l[2])?100:1)*(/%$/.test(l[2])?255:1),f=parseInt(l[3],10)/(/%$/.test(l[3])?100:1)*(/%$/.test(l[3])?255:1);return[parseInt(o,10),parseInt(a,10),parseInt(f,10),l[4]?parseFloat(l[4]):1]}},h.Color.fromRgba=p.fromRgb,h.Color.fromHsl=function(c){return p.fromSource(p.sourceFromHsl(c))},h.Color.sourceFromHsl=function(c){var l=c.match(p.reHSLa);if(l){var u,m,b,o=(parseFloat(l[1])%360+360)%360/360,a=parseFloat(l[2])/(/%$/.test(l[2])?100:1),f=parseFloat(l[3])/(/%$/.test(l[3])?100:1);if(0===a)u=m=b=f;else{var v=f<=.5?f*(a+1):f+a-f*a,C=2*f-v;u=g(C,v,o+1/3),m=g(C,v,o),b=g(C,v,o-1/3)}return[Math.round(255*u),Math.round(255*m),Math.round(255*b),l[4]?parseFloat(l[4]):1]}},h.Color.fromHsla=p.fromHsl,h.Color.fromHex=function(c){return p.fromSource(p.sourceFromHex(c))},h.Color.sourceFromHex=function(c){if(c.match(p.reHex)){var l=c.slice(c.indexOf("#")+1),o=3===l.length||4===l.length,a=8===l.length||4===l.length,f=o?l.charAt(0)+l.charAt(0):l.substring(0,2),u=o?l.charAt(1)+l.charAt(1):l.substring(2,4),m=o?l.charAt(2)+l.charAt(2):l.substring(4,6),b=a?o?l.charAt(3)+l.charAt(3):l.substring(6,8):"FF";return[parseInt(f,16),parseInt(u,16),parseInt(m,16),parseFloat((parseInt(b,16)/255).toFixed(2))]}},h.Color.fromSource=function(c){var l=new p;return l.setSource(c),l})}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=["e","se","s","sw","w","nw","n","ne","e"],g=["ns","nesw","ew","nwse"],c={},l="left",o="top",a="right",f="bottom",u="center",m={top:f,bottom:o,left:a,right:l,center:u},b=h.util.radiansToDegrees,v=Math.sign||function(J){return(J>0)-(J<0)||+J};function C(J,X){var he=J.angle+b(Math.atan2(X.y,X.x))+360;return Math.round(he%360/45)}function x(J,X){var he=X.transform.target,_e=he.canvas,te=h.util.object.clone(X);te.target=he,_e&&_e.fire("object:"+J,te),he.fire(J,X)}function T(J,X){var he=X.canvas,te=J[he.uniScaleKey];return he.uniformScaling&&!te||!he.uniformScaling&&te}function I(J){return J.originX===u&&J.originY===u}function N(J,X,he){var _e=J.lockScalingX,te=J.lockScalingY;return!!(_e&&te||!X&&(_e||te)&&he||_e&&"x"===X||te&&"y"===X)}function ce(J,X,he,_e){return{e:J,transform:X,pointer:{x:he,y:_e}}}function Y(J){return function(X,he,_e,te){var ue=he.target,ge=ue.getCenterPoint(),U=ue.translateToOriginPoint(ge,he.originX,he.originY),q=J(X,he,_e,te);return ue.setPositionByOrigin(U,he.originX,he.originY),q}}function de(J,X){return function(he,_e,te,ue){var ge=X(he,_e,te,ue);return ge&&x(J,ce(he,_e,te,ue)),ge}}function fe(J,X,he,_e,te){var ue=J.target,ge=ue.controls[J.corner],U=ue.canvas.getZoom(),q=ue.padding/U,Z=ue.toLocalPoint(new h.Point(_e,te),X,he);return Z.x>=q&&(Z.x-=q),Z.x<=-q&&(Z.x+=q),Z.y>=q&&(Z.y-=q),Z.y<=q&&(Z.y+=q),Z.x-=ge.offsetX,Z.y-=ge.offsetY,Z}function me(J){return J.flipX!==J.flipY}function B(J,X,he,_e,te){if(0!==J[X]){var ue=J._getTransformedDimensions()[_e];J.set(he,te/ue*J[he])}}function L(J,X,he,_e){var Z,te=X.target,ue=te._getTransformedDimensions(0,te.skewY),ge=fe(X,X.originX,X.originY,he,_e),U=Math.abs(2*ge.x)-ue.x,q=te.skewX;U<2?Z=0:(Z=b(Math.atan2(U/te.scaleX,ue.y/te.scaleY)),X.originX===l&&X.originY===f&&(Z=-Z),X.originX===a&&X.originY===o&&(Z=-Z),me(te)&&(Z=-Z));var Se=q!==Z;if(Se){var xe=te._getTransformedDimensions().y;te.set("skewX",Z),B(te,"skewY","scaleY","y",xe)}return Se}function D(J,X,he,_e){var Z,te=X.target,ue=te._getTransformedDimensions(te.skewX,0),ge=fe(X,X.originX,X.originY,he,_e),U=Math.abs(2*ge.y)-ue.y,q=te.skewY;U<2?Z=0:(Z=b(Math.atan2(U/te.scaleY,ue.x/te.scaleX)),X.originX===l&&X.originY===f&&(Z=-Z),X.originX===a&&X.originY===o&&(Z=-Z),me(te)&&(Z=-Z));var Se=q!==Z;if(Se){var xe=te._getTransformedDimensions().x;te.set("skewY",Z),B(te,"skewX","scaleX","x",xe)}return Se}function A(J,X,he,_e,te){var Z,Se,xe,Te,Ye,qe,ue=X.target,ge=ue.lockScalingX,U=ue.lockScalingY,q=(te=te||{}).by,Re=T(J,ue),Oe=N(ue,q,Re),yt=X.gestureScale;if(Oe)return!1;if(yt)Se=X.scaleX*yt,xe=X.scaleY*yt;else{if(Z=fe(X,X.originX,X.originY,he,_e),Ye="y"!==q?v(Z.x):1,qe="x"!==q?v(Z.y):1,X.signX||(X.signX=Ye),X.signY||(X.signY=qe),ue.lockScalingFlip&&(X.signX!==Ye||X.signY!==qe))return!1;if(Te=ue._getTransformedDimensions(),Re&&!q){var Ce=Math.abs(Z.x)+Math.abs(Z.y),re=X.original,De=Ce/(Math.abs(Te.x*re.scaleX/ue.scaleX)+Math.abs(Te.y*re.scaleY/ue.scaleY));Se=re.scaleX*De,xe=re.scaleY*De}else Se=Math.abs(Z.x*ue.scaleX/Te.x),xe=Math.abs(Z.y*ue.scaleY/Te.y);I(X)&&(Se*=2,xe*=2),X.signX!==Ye&&"y"!==q&&(X.originX=m[X.originX],Se*=-1,X.signX=Ye),X.signY!==qe&&"x"!==q&&(X.originY=m[X.originY],xe*=-1,X.signY=qe)}var Me=ue.scaleX,Be=ue.scaleY;return q?("x"===q&&ue.set("scaleX",Se),"y"===q&&ue.set("scaleY",xe)):(!ge&&ue.set("scaleX",Se),!U&&ue.set("scaleY",xe)),Me!==ue.scaleX||Be!==ue.scaleY}c.scaleCursorStyleHandler=function(J,X,he){var te=T(J,he),ue="";if(0!==X.x&&0===X.y?ue="x":0===X.x&&0!==X.y&&(ue="y"),N(he,ue,te))return"not-allowed";var ge=C(he,X);return p[ge]+"-resize"},c.skewCursorStyleHandler=function(J,X,he){if(0!==X.x&&he.lockSkewingY||0!==X.y&&he.lockSkewingX)return"not-allowed";var te=C(he,X)%4;return g[te]+"-resize"},c.scaleSkewCursorStyleHandler=function(J,X,he){return J[he.canvas.altActionKey]?c.skewCursorStyleHandler(J,X,he):c.scaleCursorStyleHandler(J,X,he)},c.rotationWithSnapping=de("rotating",Y(function(J,X,he,_e){var te=X,ue=te.target,ge=ue.translateToOriginPoint(ue.getCenterPoint(),te.originX,te.originY);if(ue.lockRotation)return!1;var Se,U=Math.atan2(te.ey-ge.y,te.ex-ge.x),q=Math.atan2(_e-ge.y,he-ge.x),Z=b(q-U+te.theta);if(ue.snapAngle>0){var xe=ue.snapAngle,Te=ue.snapThreshold||xe,Re=Math.ceil(Z/xe)*xe,Oe=Math.floor(Z/xe)*xe;Math.abs(Z-Oe)<Te?Z=Oe:Math.abs(Z-Re)<Te&&(Z=Re)}return Z<0&&(Z=360+Z),Se=ue.angle!==(Z%=360),ue.angle=Z,Se})),c.scalingEqually=de("scaling",Y(function(J,X,he,_e){return A(J,X,he,_e)})),c.scalingX=de("scaling",Y(function(J,X,he,_e){return A(J,X,he,_e,{by:"x"})})),c.scalingY=de("scaling",Y(function(J,X,he,_e){return A(J,X,he,_e,{by:"y"})})),c.scalingYOrSkewingX=function(J,X,he,_e){return J[X.target.canvas.altActionKey]?c.skewHandlerX(J,X,he,_e):c.scalingY(J,X,he,_e)},c.scalingXOrSkewingY=function(J,X,he,_e){return J[X.target.canvas.altActionKey]?c.skewHandlerY(J,X,he,_e):c.scalingX(J,X,he,_e)},c.changeWidth=de("resizing",Y(function(J,X,he,_e){var te=X.target,ue=fe(X,X.originX,X.originY,he,_e),ge=te.strokeWidth/(te.strokeUniform?te.scaleX:1),U=I(X)?2:1,q=te.width,Z=Math.abs(ue.x*U/te.scaleX)-ge;return te.set("width",Math.max(Z,0)),q!==Z})),c.skewHandlerX=function(J,X,he,_e){var ge,te=X.target,ue=te.skewX,U=X.originY;return!te.lockSkewingX&&(0===ue?ge=fe(X,u,u,he,_e).x>0?l:a:(ue>0&&(ge=U===o?l:a),ue<0&&(ge=U===o?a:l),me(te)&&(ge=ge===l?a:l)),X.originX=ge,de("skewing",Y(L))(J,X,he,_e))},c.skewHandlerY=function(J,X,he,_e){var ge,te=X.target,ue=te.skewY,U=X.originX;return!te.lockSkewingY&&(0===ue?ge=fe(X,u,u,he,_e).y>0?o:f:(ue>0&&(ge=U===l?o:f),ue<0&&(ge=U===l?f:o),me(te)&&(ge=ge===o?f:o)),X.originY=ge,de("skewing",Y(D))(J,X,he,_e))},c.dragHandler=function(J,X,he,_e){var te=X.target,ue=he-X.offsetX,ge=_e-X.offsetY,U=!te.get("lockMovementX")&&te.left!==ue,q=!te.get("lockMovementY")&&te.top!==ge;return U&&te.set("left",ue),q&&te.set("top",ge),(U||q)&&x("moving",ce(J,X,he,_e)),U||q},c.scaleOrSkewActionName=function(J,X,he){var _e=J[he.canvas.altActionKey];return 0===X.x?_e?"skewX":"scaleY":0===X.y?_e?"skewY":"scaleX":void 0},c.rotationStyleHandler=function(J,X,he){return he.lockRotation?"not-allowed":X.cursorStyle},c.fireEvent=x,c.wrapWithFixedAnchor=Y,c.wrapWithFireEvent=de,c.getLocalPoint=fe,h.controlsUtils=c}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.degreesToRadians,g=h.controlsUtils;g.renderCircleControl=function(o,a,f,u,m){u=u||{};var H,b=this.sizeX||u.cornerSize||m.cornerSize,v=this.sizeY||u.cornerSize||m.cornerSize,C=void 0!==u.transparentCorners?u.transparentCorners:m.transparentCorners,x=C?"stroke":"fill",T=!C&&(u.cornerStrokeColor||m.cornerStrokeColor),I=a,N=f;o.save(),o.fillStyle=u.cornerColor||m.cornerColor,o.strokeStyle=u.cornerStrokeColor||m.cornerStrokeColor,b>v?(H=b,o.scale(1,v/b),N=f*b/v):v>b?(H=v,o.scale(b/v,1),I=a*v/b):H=b,o.lineWidth=1,o.beginPath(),o.arc(I,N,H/2,0,2*Math.PI,!1),o[x](),T&&o.stroke(),o.restore()},g.renderSquareControl=function(o,a,f,u,m){u=u||{};var b=this.sizeX||u.cornerSize||m.cornerSize,v=this.sizeY||u.cornerSize||m.cornerSize,C=void 0!==u.transparentCorners?u.transparentCorners:m.transparentCorners,x=C?"stroke":"fill",T=!C&&(u.cornerStrokeColor||m.cornerStrokeColor),I=b/2,N=v/2;o.save(),o.fillStyle=u.cornerColor||m.cornerColor,o.strokeStyle=u.cornerStrokeColor||m.cornerStrokeColor,o.lineWidth=1,o.translate(a,f),o.rotate(p(m.angle)),o[x+"Rect"](-I,-N,b,v),T&&o.strokeRect(-I,-N,b,v),o.restore()}}($),function(_){"use strict";var h=_.fabric||(_.fabric={});h.Control=function(g){for(var c in g)this[c]=g[c]},h.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(g,c){return c.cursorStyle},getActionName:function(g,c){return c.actionName},getVisibility:function(g,c){var l=g._controlsVisibility;return l&&void 0!==l[c]?l[c]:this.visible},setVisibility:function(g){this.visible=g},positionHandler:function(g,c){return h.util.transformPoint({x:this.x*g.x+this.offsetX,y:this.y*g.y+this.offsetY},c)},calcCornerCoords:function(g,c,l,o,a){var f,u,m,b,v=a?this.touchSizeX:this.sizeX,C=a?this.touchSizeY:this.sizeY;if(v&&C&&v!==C){var x=Math.atan2(C,v),T=Math.sqrt(v*v+C*C)/2,I=x-h.util.degreesToRadians(g),N=Math.PI/2-x-h.util.degreesToRadians(g);f=T*h.util.cos(I),u=T*h.util.sin(I),m=T*h.util.cos(N),b=T*h.util.sin(N)}else T=.7071067812*(v&&C?v:c),I=h.util.degreesToRadians(45-g),f=m=T*h.util.cos(I),u=b=T*h.util.sin(I);return{tl:{x:l-b,y:o-m},tr:{x:l+f,y:o-u},bl:{x:l-f,y:o+u},br:{x:l+b,y:o+m}}},render:function(g,c,l,o,a){"circle"===((o=o||{}).cornerStyle||a.cornerStyle)?h.controlsUtils.renderCircleControl.call(this,g,c,l,o,a):h.controlsUtils.renderSquareControl.call(this,g,c,l,o,a)}}}($),function(){function _(l,o){var u,m,b,v,a=l.getAttribute("style"),f=l.getAttribute("offset")||0;if(f=(f=parseFloat(f)/(/%$/.test(f)?100:1))<0?0:f>1?1:f,a){var C=a.split(/\s*;\s*/);for(""===C[C.length-1]&&C.pop(),v=C.length;v--;){var x=C[v].split(/\s*:\s*/),T=x[0].trim(),I=x[1].trim();"stop-color"===T?u=I:"stop-opacity"===T&&(b=I)}}return u||(u=l.getAttribute("stop-color")||"rgb(0,0,0)"),b||(b=l.getAttribute("stop-opacity")),m=(u=new S.Color(u)).getAlpha(),b=isNaN(parseFloat(b))?1:parseFloat(b),b*=m*o,{offset:f,color:u.toRgb(),opacity:b}}var g=S.util.object.clone;S.Gradient=S.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(l){l||(l={}),l.coords||(l.coords={});var o,a=this;Object.keys(l).forEach(function(f){a[f]=l[f]}),this.id?this.id+="_"+S.Object.__uid++:this.id=S.Object.__uid++,o={x1:l.coords.x1||0,y1:l.coords.y1||0,x2:l.coords.x2||0,y2:l.coords.y2||0},"radial"===this.type&&(o.r1=l.coords.r1||0,o.r2=l.coords.r2||0),this.coords=o,this.colorStops=l.colorStops.slice()},addColorStop:function(l){for(var o in l){var a=new S.Color(l[o]);this.colorStops.push({offset:parseFloat(o),color:a.toRgb(),opacity:a.getAlpha()})}return this},toObject:function(l){var o={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return S.util.populateWithProperties(this,o,l),o},toSVG:function(l,o){var f,u,m,b,a=g(this.coords,!0),v=(o=o||{},g(this.colorStops,!0)),C=a.r1>a.r2,x=this.gradientTransform?this.gradientTransform.concat():S.iMatrix.concat(),T=-this.offsetX,I=-this.offsetY,N=!!o.additionalTransform,H="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(v.sort(function(ce,Y){return ce.offset-Y.offset}),"objectBoundingBox"===H?(T/=l.width,I/=l.height):(T+=l.width/2,I+=l.height/2),"path"===l.type&&"percentage"!==this.gradientUnits&&(T-=l.pathOffset.x,I-=l.pathOffset.y),x[4]-=T,x[5]-=I,b='id="SVGID_'+this.id+'" gradientUnits="'+H+'"',b+=' gradientTransform="'+(N?o.additionalTransform+" ":"")+S.util.matrixToSVG(x)+'" ',"linear"===this.type?m=["<linearGradient ",b,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,'">\n']:"radial"===this.type&&(m=["<radialGradient ",b,' cx="',C?a.x1:a.x2,'" cy="',C?a.y1:a.y2,'" r="',C?a.r1:a.r2,'" fx="',C?a.x2:a.x1,'" fy="',C?a.y2:a.y1,'">\n']),"radial"===this.type){if(C)for((v=v.concat()).reverse(),f=0,u=v.length;f<u;f++)v[f].offset=1-v[f].offset;var W=Math.min(a.r1,a.r2);if(W>0){var ne=W/Math.max(a.r1,a.r2);for(f=0,u=v.length;f<u;f++)v[f].offset+=ne*(1-v[f].offset)}}for(f=0,u=v.length;f<u;f++){var ae=v[f];m.push("<stop ",'offset="',100*ae.offset+"%",'" style="stop-color:',ae.color,void 0!==ae.opacity?";stop-opacity: "+ae.opacity:";",'"/>\n')}return m.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),m.join("")},toLive:function(l){var o,f,u,a=S.util.object.clone(this.coords);if(this.type){for("linear"===this.type?o=l.createLinearGradient(a.x1,a.y1,a.x2,a.y2):"radial"===this.type&&(o=l.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2)),f=0,u=this.colorStops.length;f<u;f++){var m=this.colorStops[f].color,b=this.colorStops[f].opacity,v=this.colorStops[f].offset;void 0!==b&&(m=new S.Color(m).setAlpha(b).toRgba()),o.addColorStop(v,m)}return o}}}),S.util.object.extend(S.Gradient,{fromElement:function(l,o,a,f){var u=parseFloat(a)/(/%$/.test(a)?100:1);u=u<0?0:u>1?1:u,isNaN(u)&&(u=1);var b,T,I,W,m=l.getElementsByTagName("stop"),v="userSpaceOnUse"===l.getAttribute("gradientUnits")?"pixels":"percentage",C=l.getAttribute("gradientTransform")||"",x=[],N=0,H=0;for("linearGradient"===l.nodeName||"LINEARGRADIENT"===l.nodeName?(b="linear",T=function(l){return{x1:l.getAttribute("x1")||0,y1:l.getAttribute("y1")||0,x2:l.getAttribute("x2")||"100%",y2:l.getAttribute("y2")||0}}(l)):(b="radial",T=function(l){return{x1:l.getAttribute("fx")||l.getAttribute("cx")||"50%",y1:l.getAttribute("fy")||l.getAttribute("cy")||"50%",r1:0,x2:l.getAttribute("cx")||"50%",y2:l.getAttribute("cy")||"50%",r2:l.getAttribute("r")||"50%"}}(l)),I=m.length;I--;)x.push(_(m[I],u));return W=S.parseTransformAttribute(C),function(l,o,a,f){var u,m;Object.keys(o).forEach(function(b){"Infinity"===(u=o[b])?m=1:"-Infinity"===u?m=0:(m=parseFloat(o[b],10),"string"==typeof u&&/^(\d+\.\d+)%|(\d+)%$/.test(u)&&(m*=.01,"pixels"===f&&(("x1"===b||"x2"===b||"r2"===b)&&(m*=a.viewBoxWidth||a.width),("y1"===b||"y2"===b)&&(m*=a.viewBoxHeight||a.height)))),o[b]=m})}(0,T,f,v),"pixels"===v&&(N=-o.left,H=-o.top),new S.Gradient({id:l.getAttribute("id"),type:b,coords:T,colorStops:x,gradientUnits:v,gradientTransform:W,offsetX:N,offsetY:H})}})}(),function(){"use strict";var _=S.util.toFixed;S.Pattern=S.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(h,p){if(h||(h={}),this.id=S.Object.__uid++,this.setOptions(h),!h.source||h.source&&"string"!=typeof h.source)p&&p(this);else{var g=this;this.source=S.util.createImage(),S.util.loadImage(h.source,function(c,l){g.source=c,p&&p(g,l)},null,this.crossOrigin)}},toObject:function(h){var g,c,p=S.Object.NUM_FRACTION_DIGITS;return"string"==typeof this.source.src?g=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(g=this.source.toDataURL()),c={type:"pattern",source:g,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:_(this.offsetX,p),offsetY:_(this.offsetY,p),patternTransform:this.patternTransform?this.patternTransform.concat():null},S.util.populateWithProperties(this,c,h),c},toSVG:function(h){var p="function"==typeof this.source?this.source():this.source,g=p.width/h.width,c=p.height/h.height,l=this.offsetX/h.width,o=this.offsetY/h.height,a="";return("repeat-x"===this.repeat||"no-repeat"===this.repeat)&&(c=1,o&&(c+=Math.abs(o))),("repeat-y"===this.repeat||"no-repeat"===this.repeat)&&(g=1,l&&(g+=Math.abs(l))),p.src?a=p.src:p.toDataURL&&(a=p.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+l+'" y="'+o+'" width="'+g+'" height="'+c+'">\n<image x="0" y="0" width="'+p.width+'" height="'+p.height+'" xlink:href="'+a+'"></image>\n</pattern>\n'},setOptions:function(h){for(var p in h)this[p]=h[p]},toLive:function(h){var p=this.source;return p&&(void 0===p.src||p.complete&&0!==p.naturalWidth&&0!==p.naturalHeight)?h.createPattern(p,this.repeat):""}})}(),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.toFixed;h.Shadow?h.warn("fabric.Shadow is already defined."):(h.Shadow=h.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(g){for(var c in"string"==typeof g&&(g=this._parseShadow(g)),g)this[c]=g[c];this.id=h.Object.__uid++},_parseShadow:function(g){var c=g.trim(),l=h.Shadow.reOffsetsAndBlur.exec(c)||[];return{color:(c.replace(h.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(l[1],10)||0,offsetY:parseFloat(l[2],10)||0,blur:parseFloat(l[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(g){var c=40,l=40,o=h.Object.NUM_FRACTION_DIGITS,a=h.util.rotateVector({x:this.offsetX,y:this.offsetY},h.util.degreesToRadians(-g.angle)),u=new h.Color(this.color);return g.width&&g.height&&(c=100*p((Math.abs(a.x)+this.blur)/g.width,o)+20,l=100*p((Math.abs(a.y)+this.blur)/g.height,o)+20),g.flipX&&(a.x*=-1),g.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+l+'%" height="'+(100+2*l)+'%" x="-'+c+'%" width="'+(100+2*c)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+p(this.blur?this.blur/2:0,o)+'"></feGaussianBlur>\n\t<feOffset dx="'+p(a.x,o)+'" dy="'+p(a.y,o)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+u.toRgb()+'" flood-opacity="'+u.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var g={},c=h.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(l){this[l]!==c[l]&&(g[l]=this[l])},this),g}}),h.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}($),function(){"use strict";if(S.StaticCanvas)S.warn("fabric.StaticCanvas is already defined.");else{var _=S.util.object.extend,h=S.util.getElementOffset,p=S.util.removeFromArray,g=S.util.toFixed,c=S.util.transformPoint,l=S.util.invertTransform,o=S.util.getNodeCanvas,a=S.util.createCanvasElement,f=new Error("Could not initialize `canvas` element");S.StaticCanvas=S.util.createClass(S.CommonMethods,{initialize:function(u,m){m||(m={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(u,m)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:S.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(u,m){var b=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(u),this._initOptions(m),this.interactive||this._initRetinaScaling(),m.overlayImage&&this.setOverlayImage(m.overlayImage,b),m.backgroundImage&&this.setBackgroundImage(m.backgroundImage,b),m.backgroundColor&&this.setBackgroundColor(m.backgroundColor,b),m.overlayColor&&this.setOverlayColor(m.overlayColor,b),this.calcOffset()},_isRetinaScaling:function(){return S.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,S.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var u=S.devicePixelRatio;this.__initRetinaScaling(u,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(u,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(u,m,b){m.setAttribute("width",this.width*u),m.setAttribute("height",this.height*u),b.scale(u,u)},calcOffset:function(){return this._offset=h(this.lowerCanvasEl),this},setOverlayImage:function(u,m,b){return this.__setBgOverlayImage("overlayImage",u,m,b)},setBackgroundImage:function(u,m,b){return this.__setBgOverlayImage("backgroundImage",u,m,b)},setOverlayColor:function(u,m){return this.__setBgOverlayColor("overlayColor",u,m)},setBackgroundColor:function(u,m){return this.__setBgOverlayColor("backgroundColor",u,m)},__setBgOverlayImage:function(u,m,b,v){return"string"==typeof m?S.util.loadImage(m,function(C,x){if(C){var T=new S.Image(C,v);this[u]=T,T.canvas=this}b&&b(C,x)},this,v&&v.crossOrigin):(v&&m.setOptions(v),this[u]=m,m&&(m.canvas=this),b&&b(m,!1)),this},__setBgOverlayColor:function(u,m,b){return this[u]=m,this._initGradient(m,u),this._initPattern(m,u,b),this},_createCanvasElement:function(){var u=a();if(!u||(u.style||(u.style={}),void 0===u.getContext))throw f;return u},_initOptions:function(u){var m=this.lowerCanvasEl;this._setOptions(u),this.width=this.width||parseInt(m.width,10)||0,this.height=this.height||parseInt(m.height,10)||0,this.lowerCanvasEl.style&&(m.width=this.width,m.height=this.height,m.style.width=this.width+"px",m.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(u){this.lowerCanvasEl=u&&u.getContext?u:S.util.getById(u)||this._createCanvasElement(),S.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(u,m){return this.setDimensions({width:u},m)},setHeight:function(u,m){return this.setDimensions({height:u},m)},setDimensions:function(u,m){var b;for(var v in m=m||{},u)b=u[v],m.cssOnly||(this._setBackstoreDimension(v,u[v]),b+="px",this.hasLostContext=!0),m.backstoreOnly||this._setCssDimension(v,b);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),m.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(u,m){return this.lowerCanvasEl[u]=m,this.upperCanvasEl&&(this.upperCanvasEl[u]=m),this.cacheCanvasEl&&(this.cacheCanvasEl[u]=m),this[u]=m,this},_setCssDimension:function(u,m){return this.lowerCanvasEl.style[u]=m,this.upperCanvasEl&&(this.upperCanvasEl.style[u]=m),this.wrapperEl&&(this.wrapperEl.style[u]=m),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(u){var C,x,T,m=this._activeObject,b=this.backgroundImage,v=this.overlayImage;for(this.viewportTransform=u,x=0,T=this._objects.length;x<T;x++)(C=this._objects[x]).group||C.setCoords(!0);return m&&m.setCoords(),b&&b.setCoords(!0),v&&v.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(u,m){var b=u,v=this.viewportTransform.slice(0);u=c(u,l(this.viewportTransform)),v[0]=m,v[3]=m;var C=c(u,v);return v[4]+=b.x-C.x,v[5]+=b.y-C.y,this.setViewportTransform(v)},setZoom:function(u){return this.zoomToPoint(new S.Point(0,0),u),this},absolutePan:function(u){var m=this.viewportTransform.slice(0);return m[4]=-u.x,m[5]=-u.y,this.setViewportTransform(m)},relativePan:function(u){return this.absolutePan(new S.Point(-u.x-this.viewportTransform[4],-u.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(u){this.stateful&&u.setupState(),u._set("canvas",this),u.setCoords(),this.fire("object:added",{target:u}),u.fire("added")},_onObjectRemoved:function(u){this.fire("object:removed",{target:u}),u.fire("removed"),delete u.canvas},clearContext:function(u){return u.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){return this.renderCanvas(this.contextContainer,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=S.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var u={},m=this.width,b=this.height,v=l(this.viewportTransform);return u.tl=c({x:0,y:0},v),u.br=c({x:m,y:b},v),u.tr=new S.Point(u.br.x,u.tl.y),u.bl=new S.Point(u.tl.x,u.br.y),this.vptCoords=u,u},cancelRequestedRender:function(){this.isRendering&&(S.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(u,m){var b=this.viewportTransform,v=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(u),S.util.setImageSmoothing(u,this.imageSmoothingEnabled),this.fire("before:render",{ctx:u}),this._renderBackground(u),u.save(),u.transform(b[0],b[1],b[2],b[3],b[4],b[5]),this._renderObjects(u,m),u.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),v&&(v.canvas=this,v.shouldCache(),v._transformDone=!0,v.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(u)),this._renderOverlay(u),this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),this.fire("after:render",{ctx:u})},drawClipPathOnCanvas:function(u){var m=this.viewportTransform,b=this.clipPath;u.save(),u.transform(m[0],m[1],m[2],m[3],m[4],m[5]),u.globalCompositeOperation="destination-in",b.transform(u),u.scale(1/b.zoomX,1/b.zoomY),u.drawImage(b._cacheCanvas,-b.cacheTranslationX,-b.cacheTranslationY),u.restore()},_renderObjects:function(u,m){var b,v;for(b=0,v=m.length;b<v;++b)m[b]&&m[b].render(u)},_renderBackgroundOrOverlay:function(u,m){var b=this[m+"Color"],v=this[m+"Image"],C=this.viewportTransform,x=this[m+"Vpt"];if(b||v){if(b){u.save(),u.beginPath(),u.moveTo(0,0),u.lineTo(this.width,0),u.lineTo(this.width,this.height),u.lineTo(0,this.height),u.closePath(),u.fillStyle=b.toLive?b.toLive(u,this):b,x&&u.transform(C[0],C[1],C[2],C[3],C[4],C[5]),u.transform(1,0,0,1,b.offsetX||0,b.offsetY||0);var T=b.gradientTransform||b.patternTransform;T&&u.transform(T[0],T[1],T[2],T[3],T[4],T[5]),u.fill(),u.restore()}v&&(u.save(),x&&u.transform(C[0],C[1],C[2],C[3],C[4],C[5]),v.render(u),u.restore())}},_renderBackground:function(u){this._renderBackgroundOrOverlay(u,"background")},_renderOverlay:function(u){this._renderBackgroundOrOverlay(u,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new S.Point(this.width/2,this.height/2)},centerObjectH:function(u){return this._centerObject(u,new S.Point(this.getCenterPoint().x,u.getCenterPoint().y))},centerObjectV:function(u){return this._centerObject(u,new S.Point(u.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(u){var m=this.getCenterPoint();return this._centerObject(u,m)},viewportCenterObject:function(u){var m=this.getVpCenter();return this._centerObject(u,m)},viewportCenterObjectH:function(u){var m=this.getVpCenter();return this._centerObject(u,new S.Point(m.x,u.getCenterPoint().y)),this},viewportCenterObjectV:function(u){var m=this.getVpCenter();return this._centerObject(u,new S.Point(u.getCenterPoint().x,m.y))},getVpCenter:function(){var u=this.getCenterPoint(),m=l(this.viewportTransform);return c(u,m)},_centerObject:function(u,m){return u.setPositionByOrigin(m,"center","center"),u.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(u){return this.toDatalessObject(u)},toObject:function(u){return this._toObjectMethod("toObject",u)},toDatalessObject:function(u){return this._toObjectMethod("toDatalessObject",u)},_toObjectMethod:function(u,m){var b=this.clipPath,v={version:S.version,objects:this._toObjects(u,m)};return b&&!b.excludeFromExport&&(v.clipPath=this._toObject(this.clipPath,u,m)),_(v,this.__serializeBgOverlay(u,m)),S.util.populateWithProperties(this,v,m),v},_toObjects:function(u,m){return this._objects.filter(function(b){return!b.excludeFromExport}).map(function(b){return this._toObject(b,u,m)},this)},_toObject:function(u,m,b){var v;this.includeDefaultValues||(v=u.includeDefaultValues,u.includeDefaultValues=!1);var C=u[m](b);return this.includeDefaultValues||(u.includeDefaultValues=v),C},__serializeBgOverlay:function(u,m){var b={},v=this.backgroundImage,C=this.overlayImage,x=this.backgroundColor,T=this.overlayColor;return x&&x.toObject?x.excludeFromExport||(b.background=x.toObject(m)):x&&(b.background=x),T&&T.toObject?T.excludeFromExport||(b.overlay=T.toObject(m)):T&&(b.overlay=T),v&&!v.excludeFromExport&&(b.backgroundImage=this._toObject(v,u,m)),C&&!C.excludeFromExport&&(b.overlayImage=this._toObject(C,u,m)),b},svgViewportTransformation:!0,toSVG:function(u,m){u||(u={}),u.reviver=m;var b=[];return this._setSVGPreamble(b,u),this._setSVGHeader(b,u),this.clipPath&&b.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(b,"background"),this._setSVGBgOverlayImage(b,"backgroundImage",m),this._setSVGObjects(b,m),this.clipPath&&b.push("</g>\n"),this._setSVGBgOverlayColor(b,"overlay"),this._setSVGBgOverlayImage(b,"overlayImage",m),b.push("</svg>"),b.join("")},_setSVGPreamble:function(u,m){m.suppressPreamble||u.push('<?xml version="1.0" encoding="',m.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(u,m){var C,b=m.width||this.width,v=m.height||this.height,x='viewBox="0 0 '+this.width+" "+this.height+'" ',T=S.Object.NUM_FRACTION_DIGITS;m.viewBox?x='viewBox="'+m.viewBox.x+" "+m.viewBox.y+" "+m.viewBox.width+" "+m.viewBox.height+'" ':this.svgViewportTransformation&&(x='viewBox="'+g(-(C=this.viewportTransform)[4]/C[0],T)+" "+g(-C[5]/C[3],T)+" "+g(this.width/C[0],T)+" "+g(this.height/C[3],T)+'" '),u.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',b,'" ','height="',v,'" ',x,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",S.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(m),"</defs>\n")},createSVGClipPathMarkup:function(u){var m=this.clipPath;return m?(m.clipPathId="CLIPPATH_"+S.Object.__uid++,'<clipPath id="'+m.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(u.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var u=this;return["background","overlay"].map(function(b){var v=u[b+"Color"];if(v&&v.toLive){var C=u[b+"Vpt"],x=u.viewportTransform;return v.toSVG({width:u.width/(C?x[0]:1),height:u.height/(C?x[3]:1)},{additionalTransform:C?S.util.matrixToSVG(x):""})}}).join("")},createSVGFontFacesMarkup:function(){var b,v,C,x,T,N,H,W,u="",m={},K=S.fontPaths,ne=[];for(this._objects.forEach(function ce(Y){ne.push(Y),Y._objects&&Y._objects.forEach(ce)}),H=0,W=ne.length;H<W;H++)if(v=(b=ne[H]).fontFamily,-1!==b.type.indexOf("text")&&!m[v]&&K[v]&&(m[v]=!0,b.styles))for(T in C=b.styles)for(N in x=C[T])!m[v=x[N].fontFamily]&&K[v]&&(m[v]=!0);for(var ae in m)u+=["\t\t@font-face {\n","\t\t\tfont-family: '",ae,"';\n","\t\t\tsrc: url('",K[ae],"');\n","\t\t}\n"].join("");return u&&(u=['\t<style type="text/css">',"<![CDATA[\n",u,"]]>","</style>\n"].join("")),u},_setSVGObjects:function(u,m){var b,v,C,x=this._objects;for(v=0,C=x.length;v<C;v++)!(b=x[v]).excludeFromExport&&this._setSVGObject(u,b,m)},_setSVGObject:function(u,m,b){u.push(m.toSVG(b))},_setSVGBgOverlayImage:function(u,m,b){this[m]&&!this[m].excludeFromExport&&this[m].toSVG&&u.push(this[m].toSVG(b))},_setSVGBgOverlayColor:function(u,m){var b=this[m+"Color"],C=this.width,x=this.height;if(b)if(b.toLive){var T=b.repeat,I=S.util.invertTransform(this.viewportTransform),H=this[m+"Vpt"]?S.util.matrixToSVG(I):"";u.push('<rect transform="'+H+" translate(",C/2,",",x/2,')"',' x="',b.offsetX-C/2,'" y="',b.offsetY-x/2,'" ','width="',"repeat-y"===T||"no-repeat"===T?b.source.width:C,'" height="',"repeat-x"===T||"no-repeat"===T?b.source.height:x,'" fill="url(#SVGID_'+b.id+')"',"></rect>\n")}else u.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',b,'"',"></rect>\n")},sendToBack:function(u){if(!u)return this;var b,v,C,m=this._activeObject;if(u===m&&"activeSelection"===u.type)for(b=(C=m._objects).length;b--;)p(this._objects,v=C[b]),this._objects.unshift(v);else p(this._objects,u),this._objects.unshift(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(u){if(!u)return this;var b,v,C,m=this._activeObject;if(u===m&&"activeSelection"===u.type)for(C=m._objects,b=0;b<C.length;b++)p(this._objects,v=C[b]),this._objects.push(v);else p(this._objects,u),this._objects.push(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(u,m){if(!u)return this;var v,C,x,T,I,b=this._activeObject,N=0;if(u===b&&"activeSelection"===u.type)for(I=b._objects,v=0;v<I.length;v++)(x=this._objects.indexOf(C=I[v]))>0+N&&(T=x-1,p(this._objects,C),this._objects.splice(T,0,C)),N++;else 0!==(x=this._objects.indexOf(u))&&(T=this._findNewLowerIndex(u,x,m),p(this._objects,u),this._objects.splice(T,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(u,m,b){var v,C;if(b){for(v=m,C=m-1;C>=0;--C)if(u.intersectsWithObject(this._objects[C])||u.isContainedWithinObject(this._objects[C])||this._objects[C].isContainedWithinObject(u)){v=C;break}}else v=m-1;return v},bringForward:function(u,m){if(!u)return this;var v,C,x,T,I,b=this._activeObject,N=0;if(u===b&&"activeSelection"===u.type)for(v=(I=b._objects).length;v--;)(x=this._objects.indexOf(C=I[v]))<this._objects.length-1-N&&(T=x+1,p(this._objects,C),this._objects.splice(T,0,C)),N++;else(x=this._objects.indexOf(u))!==this._objects.length-1&&(T=this._findNewUpperIndex(u,x,m),p(this._objects,u),this._objects.splice(T,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(u,m,b){var v,C,x;if(b){for(v=m,C=m+1,x=this._objects.length;C<x;++C)if(u.intersectsWithObject(this._objects[C])||u.isContainedWithinObject(this._objects[C])||this._objects[C].isContainedWithinObject(u)){v=C;break}}else v=m+1;return v},moveTo:function(u,m){return p(this._objects,u),this._objects.splice(m,0,u),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(S.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(u){u.dispose&&u.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),S.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),S.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),_(S.StaticCanvas.prototype,S.Observable),_(S.StaticCanvas.prototype,S.Collection),_(S.StaticCanvas.prototype,S.DataURLExporter),_(S.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(u){var m=a();if(!m||!m.getContext)return null;var b=m.getContext("2d");return b&&"setLineDash"===u?void 0!==b.setLineDash:null}}),S.StaticCanvas.prototype.toJSON=S.StaticCanvas.prototype.toObject,S.isLikelyNode&&(S.StaticCanvas.prototype.createPNGStream=function(){var u=o(this.lowerCanvasEl);return u&&u.createPNGStream()},S.StaticCanvas.prototype.createJPEGStream=function(u){var m=o(this.lowerCanvasEl);return m&&m.createJPEGStream(u)})}}(),S.BaseBrush=S.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(_){_.strokeStyle=this.color,_.lineWidth=this.width,_.lineCap=this.strokeLineCap,_.miterLimit=this.strokeMiterLimit,_.lineJoin=this.strokeLineJoin,_.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(_){var h=this.canvas.viewportTransform;_.save(),_.transform(h[0],h[1],h[2],h[3],h[4],h[5])},_setShadow:function(){if(this.shadow){var _=this.canvas,h=this.shadow,p=_.contextTop,g=_.getZoom();_&&_._isRetinaScaling()&&(g*=S.devicePixelRatio),p.shadowColor=h.color,p.shadowBlur=h.blur*g,p.shadowOffsetX=h.offsetX*g,p.shadowOffsetY=h.offsetY*g}},needsFullRender:function(){return new S.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var _=this.canvas.contextTop;_.shadowColor="",_.shadowBlur=_.shadowOffsetX=_.shadowOffsetY=0},_isOutSideCanvas:function(_){return _.x<0||_.x>this.canvas.getWidth()||_.y<0||_.y>this.canvas.getHeight()}}),S.PencilBrush=S.util.createClass(S.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(_){this.canvas=_,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(_,h,p){var g=h.midPointFrom(p);return _.quadraticCurveTo(h.x,h.y,g.x,g.y),g},onMouseDown:function(_,h){!this.canvas._isMainEvent(h.e)||(this.drawStraightLine=h.e[this.straightLineKey],this._prepareForDrawing(_),this._captureDrawingPath(_),this._render())},onMouseMove:function(_,h){if(this.canvas._isMainEvent(h.e)&&(this.drawStraightLine=h.e[this.straightLineKey],(!0!==this.limitedToCanvasSize||!this._isOutSideCanvas(_))&&this._captureDrawingPath(_)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var p=this._points,g=p.length,c=this.canvas.contextTop;this._saveAndTransform(c),this.oldEnd&&(c.beginPath(),c.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(c,p[g-2],p[g-1],!0),c.stroke(),c.restore()}},onMouseUp:function(_){return!this.canvas._isMainEvent(_.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(_){var h=new S.Point(_.x,_.y);this._reset(),this._addPoint(h),this.canvas.contextTop.moveTo(h.x,h.y)},_addPoint:function(_){return!(this._points.length>1&&_.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(_),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(_){var h=new S.Point(_.x,_.y);return this._addPoint(h)},_render:function(_){var h,p,g=this._points[0],c=this._points[1];if(this._saveAndTransform(_=_||this.canvas.contextTop),_.beginPath(),2===this._points.length&&g.x===c.x&&g.y===c.y){var l=this.width/1e3;g=new S.Point(g.x,g.y),c=new S.Point(c.x,c.y),g.x-=l,c.x+=l}for(_.moveTo(g.x,g.y),h=1,p=this._points.length;h<p;h++)this._drawSegment(_,g,c),g=this._points[h],c=this._points[h+1];_.lineTo(g.x,g.y),_.stroke(),_.restore()},convertPointsToSVGPath:function(_){return S.util.getSmoothPathFromPoints(_,this.width/1e3)},_isEmptySVGPath:function(_){return"M 0 0 Q 0 0 0 0 L 0 0"===S.util.joinPath(_)},createPath:function(_){var h=new S.Path(_,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,h.shadow=new S.Shadow(this.shadow)),h},decimatePoints:function(_,h){if(_.length<=2)return _;var c,p=this.canvas.getZoom(),g=Math.pow(h/p,2),l=_.length-1,o=_[0],a=[o];for(c=1;c<l-1;c++)Math.pow(o.x-_[c].x,2)+Math.pow(o.y-_[c].y,2)>=g&&a.push(o=_[c]);return a.push(_[l]),a},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var h=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(h))this.canvas.requestRenderAll();else{var p=this.createPath(h);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:p}),this.canvas.add(p),this.canvas.requestRenderAll(),p.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:p})}}}),S.CircleBrush=S.util.createClass(S.BaseBrush,{width:10,initialize:function(_){this.canvas=_,this.points=[]},drawDot:function(_){var h=this.addPoint(_),p=this.canvas.contextTop;this._saveAndTransform(p),this.dot(p,h),p.restore()},dot:function(_,h){_.fillStyle=h.fill,_.beginPath(),_.arc(h.x,h.y,h.radius,0,2*Math.PI,!1),_.closePath(),_.fill()},onMouseDown:function(_){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(_)},_render:function(){var h,p,_=this.canvas.contextTop,g=this.points;for(this._saveAndTransform(_),h=0,p=g.length;h<p;h++)this.dot(_,g[h]);_.restore()},onMouseMove:function(_){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(_)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(_),this._render()):this.drawDot(_))},onMouseUp:function(){var h,p,_=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var g=[];for(h=0,p=this.points.length;h<p;h++){var c=this.points[h],l=new S.Circle({radius:c.radius,left:c.x,top:c.y,originX:"center",originY:"center",fill:c.fill});this.shadow&&(l.shadow=new S.Shadow(this.shadow)),g.push(l)}var o=new S.Group(g);o.canvas=this.canvas,this.canvas.fire("before:path:created",{path:o}),this.canvas.add(o),this.canvas.fire("path:created",{path:o}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=_,this.canvas.requestRenderAll()},addPoint:function(_){var h=new S.Point(_.x,_.y),p=S.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,g=new S.Color(this.color).setAlpha(S.util.getRandomInt(0,100)/100).toRgba();return h.radius=p,h.fill=g,this.points.push(h),h}}),S.SprayBrush=S.util.createClass(S.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(_){this.canvas=_,this.sprayChunks=[]},onMouseDown:function(_){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(_),this.render(this.sprayChunkPoints)},onMouseMove:function(_){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(_)||(this.addSprayChunk(_),this.render(this.sprayChunkPoints))},onMouseUp:function(){var _=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var h=[],p=0,g=this.sprayChunks.length;p<g;p++)for(var c=this.sprayChunks[p],l=0,o=c.length;l<o;l++){var a=new S.Rect({width:c[l].width,height:c[l].width,left:c[l].x+1,top:c[l].y+1,originX:"center",originY:"center",fill:this.color});h.push(a)}this.optimizeOverlapping&&(h=this._getOptimizedRects(h));var f=new S.Group(h);this.shadow&&f.set("shadow",new S.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:f}),this.canvas.add(f),this.canvas.fire("path:created",{path:f}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=_,this.canvas.requestRenderAll()},_getOptimizedRects:function(_){var p,g,c,h={};for(g=0,c=_.length;g<c;g++)h[p=_[g].left+""+_[g].top]||(h[p]=_[g]);var l=[];for(p in h)l.push(h[p]);return l},render:function(_){var p,g,h=this.canvas.contextTop;for(h.fillStyle=this.color,this._saveAndTransform(h),p=0,g=_.length;p<g;p++){var c=_[p];void 0!==c.opacity&&(h.globalAlpha=c.opacity),h.fillRect(c.x,c.y,c.width,c.width)}h.restore()},_render:function(){var h,p,_=this.canvas.contextTop;for(_.fillStyle=this.color,this._saveAndTransform(_),h=0,p=this.sprayChunks.length;h<p;h++)this.render(this.sprayChunks[h]);_.restore()},addSprayChunk:function(_){this.sprayChunkPoints=[];var h,p,g,l,c=this.width/2;for(l=0;l<this.density;l++){h=S.util.getRandomInt(_.x-c,_.x+c),p=S.util.getRandomInt(_.y-c,_.y+c),g=this.dotWidthVariance?S.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var o=new S.Point(h,p);o.width=g,this.randomOpacity&&(o.opacity=S.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(o)}this.sprayChunks.push(this.sprayChunkPoints)}}),S.PatternBrush=S.util.createClass(S.PencilBrush,{getPatternSrc:function(){var p=S.util.createCanvasElement(),g=p.getContext("2d");return p.width=p.height=25,g.fillStyle=this.color,g.beginPath(),g.arc(10,10,10,0,2*Math.PI,!1),g.closePath(),g.fill(),p},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(_){return _.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(_){this.callSuper("_setBrushStyles",_),_.strokeStyle=this.getPattern(_)},createPath:function(_){var h=this.callSuper("createPath",_),p=h._getLeftTopCoords().scalarAdd(h.strokeWidth/2);return h.stroke=new S.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-p.x,offsetY:-p.y}),h}}),function(){var _=S.util.getPointer,h=S.util.degreesToRadians,p=S.util.isTouchEvent;for(var g in S.Canvas=S.util.createClass(S.StaticCanvas,{initialize:function(c,l){l||(l={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(c,l),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=S.PencilBrush&&new S.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var l,o,a,c=this.getActiveObjects();if(c.length>0&&!this.preserveObjectStacking){o=[],a=[];for(var f=0,u=this._objects.length;f<u;f++)-1===c.indexOf(l=this._objects[f])?o.push(l):a.push(l);c.length>1&&(this._activeObject._objects=a),o.push.apply(o,a)}else o=this._objects;return o},renderAll:function(){return this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),this.renderCanvas(this.contextContainer,this._chooseObjectsToRender()),this},renderTopLayer:function(c){c.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(c),this.contextTopDirty=!0),c.restore()},renderTop:function(){var c=this.contextTop;return this.clearContext(c),this.renderTopLayer(c),this.fire("after:render"),this},_normalizePointer:function(c,l){var o=c.calcTransformMatrix(),a=S.util.invertTransform(o),f=this.restorePointerVpt(l);return S.util.transformPoint(f,a)},isTargetTransparent:function(c,l,o){if(c.shouldCache()&&c._cacheCanvas&&c!==this._activeObject){var a=this._normalizePointer(c,{x:l,y:o}),f=Math.max(c.cacheTranslationX+a.x*c.zoomX,0),u=Math.max(c.cacheTranslationY+a.y*c.zoomY,0);return S.util.isTransparent(c._cacheContext,Math.round(f),Math.round(u),this.targetFindTolerance)}var m=this.contextCache,b=c.selectionBackgroundColor,v=this.viewportTransform;return c.selectionBackgroundColor="",this.clearContext(m),m.save(),m.transform(v[0],v[1],v[2],v[3],v[4],v[5]),c.render(m),m.restore(),c.selectionBackgroundColor=b,S.util.isTransparent(m,l,o,this.targetFindTolerance)},_isSelectionKeyPressed:function(c){return Array.isArray(this.selectionKey)?!!this.selectionKey.find(function(o){return!0===c[o]}):c[this.selectionKey]},_shouldClearSelection:function(c,l){var o=this.getActiveObjects(),a=this._activeObject;return!l||l&&a&&o.length>1&&-1===o.indexOf(l)&&a!==l&&!this._isSelectionKeyPressed(c)||l&&!l.evented||l&&!l.selectable&&a&&a!==l},_shouldCenterTransform:function(c,l,o){var a;if(c)return"scale"===l||"scaleX"===l||"scaleY"===l||"resizing"===l?a=this.centeredScaling||c.centeredScaling:"rotate"===l&&(a=this.centeredRotation||c.centeredRotation),a?!o:o},_getOriginFromCorner:function(c,l){var o={x:c.originX,y:c.originY};return"ml"===l||"tl"===l||"bl"===l?o.x="right":("mr"===l||"tr"===l||"br"===l)&&(o.x="left"),"tl"===l||"mt"===l||"tr"===l?o.y="bottom":("bl"===l||"mb"===l||"br"===l)&&(o.y="top"),o},_getActionFromCorner:function(c,l,o,a){if(!l||!c)return"drag";var f=a.controls[l];return f.getActionName(o,f,a)},_setupCurrentTransform:function(c,l,o){if(l){var a=this.getPointer(c),f=l.__corner,u=l.controls[f],m=o&&f?u.getActionHandler(c,l,u):S.controlsUtils.dragHandler,b=this._getActionFromCorner(o,f,c,l),v=this._getOriginFromCorner(l,f),C=c[this.centeredKey],x={target:l,action:b,actionHandler:m,corner:f,scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY,offsetX:a.x-l.left,offsetY:a.y-l.top,originX:v.x,originY:v.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:h(l.angle),width:l.width*l.scaleX,shiftKey:c.shiftKey,altKey:C,original:S.util.saveObjectTransform(l)};this._shouldCenterTransform(l,b,C)&&(x.originX="center",x.originY="center"),x.original.originX=v.x,x.original.originY=v.y,this._currentTransform=x,this._beforeTransform(c)}},setCursor:function(c){this.upperCanvasEl.style.cursor=c},_drawSelection:function(c){var l=this._groupSelector,o=new S.Point(l.ex,l.ey),a=S.util.transformPoint(o,this.viewportTransform),f=new S.Point(l.ex+l.left,l.ey+l.top),u=S.util.transformPoint(f,this.viewportTransform),m=Math.min(a.x,u.x),b=Math.min(a.y,u.y),v=Math.max(a.x,u.x),C=Math.max(a.y,u.y),x=this.selectionLineWidth/2;this.selectionColor&&(c.fillStyle=this.selectionColor,c.fillRect(m,b,v-m,C-b)),this.selectionLineWidth&&this.selectionBorderColor&&(c.lineWidth=this.selectionLineWidth,c.strokeStyle=this.selectionBorderColor,m+=x,b+=x,v-=x,C-=x,S.Object.prototype._setLineDash.call(this,c,this.selectionDashArray),c.strokeRect(m,b,v-m,C-b))},findTarget:function(c,l){if(!this.skipTargetFind){var m,b,a=this.getPointer(c,!0),f=this._activeObject,u=this.getActiveObjects(),v=p(c),C=u.length>1&&!l||1===u.length;if(this.targets=[],C&&f._findTargetCorner(a,v)||u.length>1&&!l&&f===this._searchPossibleTargets([f],a))return f;if(1===u.length&&f===this._searchPossibleTargets([f],a)){if(!this.preserveObjectStacking)return f;m=f,b=this.targets,this.targets=[]}var x=this._searchPossibleTargets(this._objects,a);return c[this.altSelectionKey]&&x&&m&&x!==m&&(x=m,this.targets=b),x}},_checkTarget:function(c,l,o){if(l&&l.visible&&l.evented&&l.containsPoint(c)){if(!this.perPixelTargetFind&&!l.perPixelTargetFind||l.isEditing)return!0;if(!this.isTargetTransparent(l,o.x,o.y))return!0}},_searchPossibleTargets:function(c,l){for(var o,f,a=c.length;a--;){var u=c[a],m=u.group?this._normalizePointer(u.group,l):l;if(this._checkTarget(m,u,l)){(o=c[a]).subTargetCheck&&o instanceof S.Group&&(f=this._searchPossibleTargets(o._objects,l))&&this.targets.push(f);break}}return o},restorePointerVpt:function(c){return S.util.transformPoint(c,S.util.invertTransform(this.viewportTransform))},getPointer:function(c,l){if(this._absolutePointer&&!l)return this._absolutePointer;if(this._pointer&&l)return this._pointer;var b,o=_(c),a=this.upperCanvasEl,f=a.getBoundingClientRect(),u=f.width||0,m=f.height||0;(!u||!m)&&("top"in f&&"bottom"in f&&(m=Math.abs(f.top-f.bottom)),"right"in f&&"left"in f&&(u=Math.abs(f.right-f.left))),this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,l||(o=this.restorePointerVpt(o));var v=this.getRetinaScaling();return 1!==v&&(o.x/=v,o.y/=v),{x:o.x*(b=0===u||0===m?{width:1,height:1}:{width:a.width/u,height:a.height/m}).width,y:o.y*b.height}},_createUpperCanvas:function(){var c=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),l=this.lowerCanvasEl,o=this.upperCanvasEl;o?o.className="":(o=this._createCanvasElement(),this.upperCanvasEl=o),S.util.addClass(o,"upper-canvas "+c),this.wrapperEl.appendChild(o),this._copyCanvasStyle(l,o),this._applyCanvasStyle(o),this.contextTop=o.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=S.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),S.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),S.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(c){var l=this.width||c.width,o=this.height||c.height;S.util.setStyle(c,{position:"absolute",width:l+"px",height:o+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),c.width=l,c.height=o,S.util.makeElementUnselectable(c)},_copyCanvasStyle:function(c,l){l.style.cssText=c.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var c=this._activeObject;return c?"activeSelection"===c.type&&c._objects?c._objects.slice(0):[c]:[]},_onObjectRemoved:function(c){c===this._activeObject&&(this.fire("before:selection:cleared",{target:c}),this._discardActiveObject(),this.fire("selection:cleared",{target:c}),c.fire("deselected")),c===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",c)},_fireSelectionEvents:function(c,l){var o=!1,a=this.getActiveObjects(),f=[],u=[];c.forEach(function(m){-1===a.indexOf(m)&&(o=!0,m.fire("deselected",{e:l,target:m}),u.push(m))}),a.forEach(function(m){-1===c.indexOf(m)&&(o=!0,m.fire("selected",{e:l,target:m}),f.push(m))}),c.length>0&&a.length>0?o&&this.fire("selection:updated",{e:l,selected:f,deselected:u}):a.length>0?this.fire("selection:created",{e:l,selected:f}):c.length>0&&this.fire("selection:cleared",{e:l,deselected:u})},setActiveObject:function(c,l){var o=this.getActiveObjects();return this._setActiveObject(c,l),this._fireSelectionEvents(o,l),this},_setActiveObject:function(c,l){return!(this._activeObject===c||!this._discardActiveObject(l,c)||c.onSelect({e:l})||(this._activeObject=c,0))},_discardActiveObject:function(c,l){var o=this._activeObject;if(o){if(o.onDeselect({e:c,object:l}))return!1;this._activeObject=null}return!0},discardActiveObject:function(c){var l=this.getActiveObjects(),o=this.getActiveObject();return l.length&&this.fire("before:selection:cleared",{target:o,e:c}),this._discardActiveObject(c),this._fireSelectionEvents(l,c),this},dispose:function(){var c=this.wrapperEl;return this.removeListeners(),c.removeChild(this.upperCanvasEl),c.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(l){S.util.cleanUpJsdomNode(this[l]),this[l]=void 0}.bind(this)),c.parentNode&&c.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,S.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(c){var l=this._activeObject;l&&l._renderControls(c)},_toObject:function(c,l,o){var a=this._realizeGroupTransformOnObject(c),f=this.callSuper("_toObject",c,l,o);return this._unwindGroupTransformOnObject(c,a),f},_realizeGroupTransformOnObject:function(c){if(c.group&&"activeSelection"===c.group.type&&this._activeObject===c.group){var o={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(a){o[a]=c[a]}),S.util.addTransformToObject(c,this._activeObject.calcOwnMatrix()),o}return null},_unwindGroupTransformOnObject:function(c,l){l&&c.set(l)},_setSVGObject:function(c,l,o){var a=this._realizeGroupTransformOnObject(l);this.callSuper("_setSVGObject",c,l,o),this._unwindGroupTransformOnObject(l,a)},setViewportTransform:function(c){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),S.StaticCanvas.prototype.setViewportTransform.call(this,c)}}),S.StaticCanvas)"prototype"!==g&&(S.Canvas[g]=S.StaticCanvas[g])}(),function(){var _=S.util.addListener,h=S.util.removeListener,l={passive:!1};function o(a,f){return a.button&&a.button===f-1}S.util.object.extend(S.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(_,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(a,f){var u=this.upperCanvasEl,m=this._getEventPrefix();a(S.window,"resize",this._onResize),a(u,m+"down",this._onMouseDown),a(u,m+"move",this._onMouseMove,l),a(u,m+"out",this._onMouseOut),a(u,m+"enter",this._onMouseEnter),a(u,"wheel",this._onMouseWheel),a(u,"contextmenu",this._onContextMenu),a(u,"dblclick",this._onDoubleClick),a(u,"dragover",this._onDragOver),a(u,"dragenter",this._onDragEnter),a(u,"dragleave",this._onDragLeave),a(u,"drop",this._onDrop),this.enablePointerEvents||a(u,"touchstart",this._onTouchStart,l),"undefined"!=typeof eventjs&&f in eventjs&&(eventjs[f](u,"gesture",this._onGesture),eventjs[f](u,"drag",this._onDrag),eventjs[f](u,"orientation",this._onOrientationChange),eventjs[f](u,"shake",this._onShake),eventjs[f](u,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(h,"remove");var a=this._getEventPrefix();h(S.document,a+"up",this._onMouseUp),h(S.document,"touchend",this._onTouchEnd,l),h(S.document,a+"move",this._onMouseMove,l),h(S.document,"touchmove",this._onMouseMove,l)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(a,f){this.__onTransformGesture&&this.__onTransformGesture(a,f)},_onDrag:function(a,f){this.__onDrag&&this.__onDrag(a,f)},_onMouseWheel:function(a){this.__onMouseWheel(a)},_onMouseOut:function(a){var f=this._hoveredTarget;this.fire("mouse:out",{target:f,e:a}),this._hoveredTarget=null,f&&f.fire("mouseout",{e:a});var u=this;this._hoveredTargets.forEach(function(m){u.fire("mouse:out",{target:f,e:a}),m&&f.fire("mouseout",{e:a})}),this._hoveredTargets=[]},_onMouseEnter:function(a){!this._currentTransform&&!this.findTarget(a)&&(this.fire("mouse:over",{target:null,e:a}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(a,f){this.__onOrientationChange&&this.__onOrientationChange(a,f)},_onShake:function(a,f){this.__onShake&&this.__onShake(a,f)},_onLongPress:function(a,f){this.__onLongPress&&this.__onLongPress(a,f)},_onDragOver:function(a){a.preventDefault();var f=this._simpleEventHandler("dragover",a);this._fireEnterLeaveEvents(f,a)},_onDrop:function(a){return this._simpleEventHandler("drop:before",a),this._simpleEventHandler("drop",a)},_onContextMenu:function(a){return this.stopContextMenu&&(a.stopPropagation(),a.preventDefault()),!1},_onDoubleClick:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"dblclick"),this._resetTransformEventData(a)},getPointerId:function(a){var f=a.changedTouches;return f?f[0]&&f[0].identifier:this.enablePointerEvents?a.pointerId:-1},_isMainEvent:function(a){return!0===a.isPrimary||!1!==a.isPrimary&&("touchend"===a.type&&0===a.touches.length||!a.changedTouches||a.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(a){a.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(a)),this.__onMouseDown(a),this._resetTransformEventData();var f=this.upperCanvasEl,u=this._getEventPrefix();_(S.document,"touchend",this._onTouchEnd,l),_(S.document,"touchmove",this._onMouseMove,l),h(f,u+"down",this._onMouseDown)},_onMouseDown:function(a){this.__onMouseDown(a),this._resetTransformEventData();var f=this.upperCanvasEl,u=this._getEventPrefix();h(f,u+"move",this._onMouseMove,l),_(S.document,u+"up",this._onMouseUp),_(S.document,u+"move",this._onMouseMove,l)},_onTouchEnd:function(a){if(!(a.touches.length>0)){this.__onMouseUp(a),this._resetTransformEventData(),this.mainTouchId=null;var f=this._getEventPrefix();h(S.document,"touchend",this._onTouchEnd,l),h(S.document,"touchmove",this._onMouseMove,l);var u=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){_(u.upperCanvasEl,f+"down",u._onMouseDown),u._willAddMouseDown=0},400)}},_onMouseUp:function(a){this.__onMouseUp(a),this._resetTransformEventData();var f=this.upperCanvasEl,u=this._getEventPrefix();this._isMainEvent(a)&&(h(S.document,u+"up",this._onMouseUp),h(S.document,u+"move",this._onMouseMove,l),_(f,u+"move",this._onMouseMove,l))},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault(),this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},_shouldRender:function(a){var f=this._activeObject;return!!(!!f!=!!a||f&&a&&f!==a)},__onMouseUp:function(a){var f,u=this._currentTransform,m=this._groupSelector,b=!1,v=!m||0===m.left&&0===m.top;if(this._cacheTransformEventData(a),f=this._target,this._handleEvent(a,"up:before"),o(a,3))this.fireRightClick&&this._handleEvent(a,"up",3,v);else{if(o(a,2))return this.fireMiddleClick&&this._handleEvent(a,"up",2,v),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(a);else if(this._isMainEvent(a)){if(u&&(this._finalizeCurrentTransform(a),b=u.actionPerformed),!v){var C=f===this._activeObject;this._maybeGroupObjects(a),b||(b=this._shouldRender(f)||!C&&f===this._activeObject)}var x,T;if(f){if(x=f._findTargetCorner(this.getPointer(a,!0),S.util.isTouchEvent(a)),f.selectable&&f!==this._activeObject&&"up"===f.activeOn)this.setActiveObject(f,a),b=!0;else{var I=f.controls[x],N=I&&I.getMouseUpHandler(a,f,I);N&&N(a,u,(T=this.getPointer(a)).x,T.y)}f.isMoving=!1}if(u&&(u.target!==f||u.corner!==x)){var H=u.target&&u.target.controls[u.corner],W=H&&H.getMouseUpHandler(a,f,I);T=T||this.getPointer(a),W&&W(a,u,T.x,T.y)}this._setCursorFromEvent(a,f),this._handleEvent(a,"up",1,v),this._groupSelector=null,this._currentTransform=null,f&&(f.__corner=0),b?this.requestRenderAll():v||this.renderTop()}}},_simpleEventHandler:function(a,f){var u=this.findTarget(f),m=this.targets,b={e:f,target:u,subTargets:m};if(this.fire(a,b),u&&u.fire(a,b),!m)return u;for(var v=0;v<m.length;v++)m[v].fire(a,b);return u},_handleEvent:function(a,f,u,m){var b=this._target,v=this.targets||[],C={e:a,target:b,subTargets:v,button:u||1,isClick:m||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===f&&(C.currentTarget=this.findTarget(a),C.currentSubTargets=this.targets),this.fire("mouse:"+f,C),b&&b.fire("mouse"+f,C);for(var x=0;x<v.length;x++)v[x].fire("mouse"+f,C)},_finalizeCurrentTransform:function(a){var f=this._currentTransform,u=f.target,m={e:a,target:u,transform:f,action:f.action};u._scaling&&(u._scaling=!1),u.setCoords(),(f.actionPerformed||this.stateful&&u.hasStateChanged())&&this._fire("modified",m)},_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(a).requestRenderAll();var f=this.getPointer(a);this.freeDrawingBrush.onMouseDown(f,{e:a,pointer:f}),this._handleEvent(a,"down")},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var f=this.getPointer(a);this.freeDrawingBrush.onMouseMove(f,{e:a,pointer:f})}this.setCursor(this.freeDrawingCursor),this._handleEvent(a,"move")},_onMouseUpInDrawingMode:function(a){var f=this.getPointer(a);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:a,pointer:f}),this._handleEvent(a,"up")},__onMouseDown:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"down:before");var f=this._target;if(o(a,3))this.fireRightClick&&this._handleEvent(a,"down",3);else if(o(a,2))this.fireMiddleClick&&this._handleEvent(a,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(a);else if(this._isMainEvent(a)&&!this._currentTransform){this._previousPointer=u=this._pointer;var m=this._shouldRender(f),b=this._shouldGroup(a,f);if(this._shouldClearSelection(a,f)?this.discardActiveObject(a):b&&(this._handleGrouping(a,f),f=this._activeObject),this.selection&&(!f||!f.selectable&&!f.isEditing&&f!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),f){var v=f===this._activeObject;f.selectable&&"down"===f.activeOn&&this.setActiveObject(f,a);var C=f._findTargetCorner(this.getPointer(a,!0),S.util.isTouchEvent(a));if(f.__corner=C,f===this._activeObject&&(C||!b)){this._setupCurrentTransform(a,f,v);var x=f.controls[C],u=this.getPointer(a),T=x&&x.getMouseDownHandler(a,f,x);T&&T(a,this._currentTransform,u.x,u.y)}}this._handleEvent(a,"down"),(m||b)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(a){this._resetTransformEventData(),this._pointer=this.getPointer(a,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(a)||null},_beforeTransform:function(a){var f=this._currentTransform;this.stateful&&f.target.saveState(),this.fire("before:transform",{e:a,transform:f})},__onMouseMove:function(a){var f,u;if(this._handleEvent(a,"move:before"),this._cacheTransformEventData(a),this.isDrawingMode)this._onMouseMoveInDrawingMode(a);else if(this._isMainEvent(a)){var m=this._groupSelector;m?(m.left=(u=this._absolutePointer).x-m.ex,m.top=u.y-m.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(f=this.findTarget(a)||null,this._setCursorFromEvent(a,f),this._fireOverOutEvents(f,a)),this._handleEvent(a,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(a,f){var u=this._hoveredTarget,m=this._hoveredTargets,b=this.targets,v=Math.max(m.length,b.length);this.fireSyntheticInOutEvents(a,f,{oldTarget:u,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var C=0;C<v;C++)this.fireSyntheticInOutEvents(b[C],f,{oldTarget:m[C],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=a,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(a,f){var u=this._draggedoverTarget,m=this._hoveredTargets,b=this.targets,v=Math.max(m.length,b.length);this.fireSyntheticInOutEvents(a,f,{oldTarget:u,evtOut:"dragleave",evtIn:"dragenter"});for(var C=0;C<v;C++)this.fireSyntheticInOutEvents(b[C],f,{oldTarget:m[C],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=a},fireSyntheticInOutEvents:function(a,f,u){var m,b,x,v=u.oldTarget,T=v!==a,I=u.canvasEvtIn,N=u.canvasEvtOut;T&&(m={e:f,target:a,previousTarget:v},b={e:f,target:v,nextTarget:a}),x=a&&T,v&&T&&(N&&this.fire(N,b),v.fire(u.evtOut,b)),x&&(I&&this.fire(I,m),a.fire(u.evtIn,m))},__onMouseWheel:function(a){this._cacheTransformEventData(a),this._handleEvent(a,"wheel"),this._resetTransformEventData()},_transformObject:function(a){var f=this.getPointer(a),u=this._currentTransform;u.reset=!1,u.shiftKey=a.shiftKey,u.altKey=a[this.centeredKey],this._performTransformAction(a,u,f),u.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(a,f,u){var v=f.action,C=!1,x=f.actionHandler;x&&(C=x(a,f,u.x,u.y)),"drag"===v&&C&&(f.target.isMoving=!0,this.setCursor(f.target.moveCursor||this.moveCursor)),f.actionPerformed=f.actionPerformed||C},_fire:S.controlsUtils.fireEvent,_setCursorFromEvent:function(a,f){if(!f)return this.setCursor(this.defaultCursor),!1;var u=f.hoverCursor||this.hoverCursor,m=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,b=(!m||!m.contains(f))&&f._findTargetCorner(this.getPointer(a,!0));b?this.setCursor(this.getCornerCursor(b,f,a)):(f.subTargetCheck&&this.targets.concat().reverse().map(function(v){u=v.hoverCursor||u}),this.setCursor(u))},getCornerCursor:function(a,f,u){var m=f.controls[a];return m.cursorStyleHandler(u,m,f)}})}(),function(){var _=Math.min,h=Math.max;S.util.object.extend(S.Canvas.prototype,{_shouldGroup:function(p,g){var c=this._activeObject;return c&&this._isSelectionKeyPressed(p)&&g&&g.selectable&&this.selection&&(c!==g||"activeSelection"===c.type)&&!g.onSelect({e:p})},_handleGrouping:function(p,g){var c=this._activeObject;c.__corner||g===c&&(!(g=this.findTarget(p,!0))||!g.selectable)||(c&&"activeSelection"===c.type?this._updateActiveSelection(g,p):this._createActiveSelection(g,p))},_updateActiveSelection:function(p,g){var c=this._activeObject,l=c._objects.slice(0);c.contains(p)?(c.removeWithUpdate(p),this._hoveredTarget=p,this._hoveredTargets=this.targets.concat(),1===c.size()&&this._setActiveObject(c.item(0),g)):(c.addWithUpdate(p),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(l,g)},_createActiveSelection:function(p,g){var c=this.getActiveObjects(),l=this._createGroup(p);this._hoveredTarget=l,this._setActiveObject(l,g),this._fireSelectionEvents(c,g)},_createGroup:function(p){var g=this._objects,l=g.indexOf(this._activeObject)<g.indexOf(p)?[this._activeObject,p]:[p,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new S.ActiveSelection(l,{canvas:this})},_groupSelectedObjects:function(p){var c,g=this._collectObjects(p);1===g.length?this.setActiveObject(g[0],p):g.length>1&&(c=new S.ActiveSelection(g.reverse(),{canvas:this}),this.setActiveObject(c,p))},_collectObjects:function(p){for(var c,g=[],l=this._groupSelector.ex,o=this._groupSelector.ey,a=l+this._groupSelector.left,f=o+this._groupSelector.top,u=new S.Point(_(l,a),_(o,f)),m=new S.Point(h(l,a),h(o,f)),b=!this.selectionFullyContained,v=l===a&&o===f,C=this._objects.length;C--&&!((c=this._objects[C])&&c.selectable&&c.visible&&(b&&c.intersectsWithRect(u,m,!0)||c.isContainedWithinRect(u,m,!0)||b&&c.containsPoint(u,null,!0)||b&&c.containsPoint(m,null,!0))&&(g.push(c),v)););return g.length>1&&(g=g.filter(function(x){return!x.onSelect({e:p})})),g},_maybeGroupObjects:function(p){this.selection&&this._groupSelector&&this._groupSelectedObjects(p),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),S.util.object.extend(S.StaticCanvas.prototype,{toDataURL:function(_){_||(_={});var h=_.format||"png",p=_.quality||1,g=(_.multiplier||1)*(_.enableRetinaScaling?this.getRetinaScaling():1),c=this.toCanvasElement(g,_);return S.util.toDataURL(c,h,p)},toCanvasElement:function(_,h){var p=((h=h||{}).width||this.width)*(_=_||1),g=(h.height||this.height)*_,c=this.getZoom(),l=this.width,o=this.height,a=c*_,f=this.viewportTransform,b=this.interactive,v=[a,0,0,a,(f[4]-(h.left||0))*_,(f[5]-(h.top||0))*_],C=this.enableRetinaScaling,x=S.util.createCanvasElement(),T=this.contextTop;return x.width=p,x.height=g,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=v,this.width=p,this.height=g,this.calcViewportBoundaries(),this.renderCanvas(x.getContext("2d"),this._objects),this.viewportTransform=f,this.width=l,this.height=o,this.calcViewportBoundaries(),this.interactive=b,this.enableRetinaScaling=C,this.contextTop=T,x}}),S.util.object.extend(S.StaticCanvas.prototype,{loadFromJSON:function(_,h,p){if(_){var g="string"==typeof _?JSON.parse(_):S.util.object.clone(_),c=this,l=g.clipPath,o=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete g.clipPath,this._enlivenObjects(g.objects,function(a){c.clear(),c._setBgOverlay(g,function(){l?c._enlivenObjects([l],function(f){c.clipPath=f[0],c.__setupCanvas.call(c,g,a,o,h)}):c.__setupCanvas.call(c,g,a,o,h)})},p),this}},__setupCanvas:function(_,h,p,g){var c=this;h.forEach(function(l,o){c.insertAt(l,o)}),this.renderOnAddRemove=p,delete _.objects,delete _.backgroundImage,delete _.overlayImage,delete _.background,delete _.overlay,this._setOptions(_),this.renderAll(),g&&g()},_setBgOverlay:function(_,h){var p={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(_.backgroundImage||_.overlayImage||_.background||_.overlay){var g=function(){p.backgroundImage&&p.overlayImage&&p.backgroundColor&&p.overlayColor&&h&&h()};this.__setBgOverlay("backgroundImage",_.backgroundImage,p,g),this.__setBgOverlay("overlayImage",_.overlayImage,p,g),this.__setBgOverlay("backgroundColor",_.background,p,g),this.__setBgOverlay("overlayColor",_.overlay,p,g)}else h&&h()},__setBgOverlay:function(_,h,p,g){var c=this;if(!h)return p[_]=!0,void(g&&g());"backgroundImage"===_||"overlayImage"===_?S.util.enlivenObjects([h],function(l){c[_]=l[0],p[_]=!0,g&&g()}):this["set"+S.util.string.capitalize(_,!0)](h,function(){p[_]=!0,g&&g()})},_enlivenObjects:function(_,h,p){_&&0!==_.length?S.util.enlivenObjects(_,function(g){h&&h(g)},null,p):h&&h([])},_toDataURL:function(_,h){this.clone(function(p){h(p.toDataURL(_))})},_toDataURLWithMultiplier:function(_,h,p){this.clone(function(g){p(g.toDataURLWithMultiplier(_,h))})},clone:function(_,h){var p=JSON.stringify(this.toJSON(h));this.cloneWithoutData(function(g){g.loadFromJSON(p,function(){_&&_(g)})})},cloneWithoutData:function(_){var h=S.util.createCanvasElement();h.width=this.width,h.height=this.height;var p=new S.Canvas(h);this.backgroundImage?(p.setBackgroundImage(this.backgroundImage.src,function(){p.renderAll(),_&&_(p)}),p.backgroundImageOpacity=this.backgroundImageOpacity,p.backgroundImageStretch=this.backgroundImageStretch):_&&_(p)}}),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.object.extend,g=h.util.object.clone,c=h.util.toFixed,l=h.util.string.capitalize,o=h.util.degreesToRadians;h.Object||(h.Object=h.util.createClass(h.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:!h.isLikelyNode,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(u){u&&this.setOptions(u)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=h.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(u){var m=h.perfLimitSizeTotal,b=u.width,v=u.height,C=h.maxCacheSideLimit,x=h.minCacheSideLimit;if(b<=C&&v<=C&&b*v<=m)return b<x&&(u.width=x),v<x&&(u.height=x),u;var I=h.util.limitDimsByArea(b/v,m),N=h.util.capValue,H=N(x,I.x,C),W=N(x,I.y,C);return b>H&&(u.zoomX/=b/H,u.width=H,u.capped=!0),v>W&&(u.zoomY/=v/W,u.height=W,u.capped=!0),u},_getCacheCanvasDimensions:function(){var u=this.getTotalObjectScaling(),m=this._getTransformedDimensions(0,0),b=m.x*u.scaleX/this.scaleX,v=m.y*u.scaleY/this.scaleY;return{width:b+2,height:v+2,zoomX:u.scaleX,zoomY:u.scaleY,x:b,y:v}},_updateCacheCanvas:function(){var u=this.canvas;if(this.noScaleCache&&u&&u._currentTransform){var b=u._currentTransform.action;if(this===u._currentTransform.target&&b.slice&&"scale"===b.slice(0,5))return!1}var N,H,v=this._cacheCanvas,C=this._limitCacheSize(this._getCacheCanvasDimensions()),x=h.minCacheSideLimit,T=C.width,I=C.height,W=C.zoomX,K=C.zoomY,ne=T!==this.cacheWidth||I!==this.cacheHeight,ce=ne||this.zoomX!==W||this.zoomY!==K,Y=0,de=0,fe=!1;if(ne){var me=this._cacheCanvas.width,B=this._cacheCanvas.height,L=T>me||I>B;fe=L||(T<.9*me||I<.9*B)&&me>x&&B>x,L&&!C.capped&&(T>x||I>x)&&(Y=.1*T,de=.1*I)}return this instanceof h.Text&&this.path&&(ce=!0,fe=!0,Y+=this.getHeightOfLine(0)*this.zoomX,de+=this.getHeightOfLine(0)*this.zoomY),!!ce&&(fe?(v.width=Math.ceil(T+Y),v.height=Math.ceil(I+de)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,v.width,v.height)),N=C.x/2,H=C.y/2,this.cacheTranslationX=Math.round(v.width/2-N)+N,this.cacheTranslationY=Math.round(v.height/2-H)+H,this.cacheWidth=T,this.cacheHeight=I,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(W,K),this.zoomX=W,this.zoomY=K,!0)},setOptions:function(u){this._setOptions(u),this._initGradient(u.fill,"fill"),this._initGradient(u.stroke,"stroke"),this._initPattern(u.fill,"fill"),this._initPattern(u.stroke,"stroke")},transform:function(u){var b=this.calcTransformMatrix(!(this.group&&!this.group._transformDone||this.group&&this.canvas&&u===this.canvas.contextTop));u.transform(b[0],b[1],b[2],b[3],b[4],b[5])},toObject:function(u){var m=h.Object.NUM_FRACTION_DIGITS,b={type:this.type,version:h.version,originX:this.originX,originY:this.originY,left:c(this.left,m),top:c(this.top,m),width:c(this.width,m),height:c(this.height,m),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:c(this.strokeWidth,m),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:c(this.strokeMiterLimit,m),scaleX:c(this.scaleX,m),scaleY:c(this.scaleY,m),angle:c(this.angle,m),flipX:this.flipX,flipY:this.flipY,opacity:c(this.opacity,m),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:c(this.skewX,m),skewY:c(this.skewY,m)};return this.clipPath&&!this.clipPath.excludeFromExport&&(b.clipPath=this.clipPath.toObject(u),b.clipPath.inverted=this.clipPath.inverted,b.clipPath.absolutePositioned=this.clipPath.absolutePositioned),h.util.populateWithProperties(this,b,u),this.includeDefaultValues||(b=this._removeDefaultValues(b)),b},toDatalessObject:function(u){return this.toObject(u)},_removeDefaultValues:function(u){var m=h.util.getKlass(u.type).prototype;return m.stateProperties.forEach(function(v){"left"===v||"top"===v||(u[v]===m[v]&&delete u[v],Array.isArray(u[v])&&Array.isArray(m[v])&&0===u[v].length&&0===m[v].length&&delete u[v])}),u},toString:function(){return"#<fabric."+l(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var u=h.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(u.scaleX),scaleY:Math.abs(u.scaleY)}},getTotalObjectScaling:function(){var u=this.getObjectScaling(),m=u.scaleX,b=u.scaleY;if(this.canvas){var v=this.canvas.getZoom(),C=this.canvas.getRetinaScaling();m*=v*C,b*=v*C}return{scaleX:m,scaleY:b}},getObjectOpacity:function(){var u=this.opacity;return this.group&&(u*=this.group.getObjectOpacity()),u},_set:function(u,m){var v=this[u]!==m,C=!1;return("scaleX"===u||"scaleY"===u)&&(m=this._constrainScale(m)),"scaleX"===u&&m<0?(this.flipX=!this.flipX,m*=-1):"scaleY"===u&&m<0?(this.flipY=!this.flipY,m*=-1):"shadow"!==u||!m||m instanceof h.Shadow?"dirty"===u&&this.group&&this.group.set("dirty",m):m=new h.Shadow(m),this[u]=m,v&&(C=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(u)>-1?(this.dirty=!0,C&&this.group.set("dirty",!0)):C&&this.stateProperties.indexOf(u)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:h.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(u){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(u.save(),this._setupCompositeOperation(u),this.drawSelectionBackground(u),this.transform(u),this._setOpacity(u),this._setShadow(u,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(u)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(u),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),u.restore())},renderCache:function(u){u=u||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,u.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!!("stroke"===this.paintFirst&&this.hasFill()&&this.hasStroke()&&"object"==typeof this.shadow||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(u,m){if(u.save(),u.globalCompositeOperation=m.inverted?"destination-out":"destination-in",m.absolutePositioned){var b=h.util.invertTransform(this.calcTransformMatrix());u.transform(b[0],b[1],b[2],b[3],b[4],b[5])}m.transform(u),u.scale(1/m.zoomX,1/m.zoomY),u.drawImage(m._cacheCanvas,-m.cacheTranslationX,-m.cacheTranslationY),u.restore()},drawObject:function(u,m){var b=this.fill,v=this.stroke;m?(this.fill="black",this.stroke="",this._setClippingProperties(u)):this._renderBackground(u),this._render(u),this._drawClipPath(u,this.clipPath),this.fill=b,this.stroke=v},_drawClipPath:function(u,m){!m||(m.canvas=this.canvas,m.shouldCache(),m._transformDone=!0,m.renderCache({forClipping:!0}),this.drawClipPathOnCache(u,m))},drawCacheOnCanvas:function(u){u.scale(1/this.zoomX,1/this.zoomY),u.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(u){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!u&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!u){var m=this.cacheWidth/this.zoomX,b=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-m/2,-b/2,m,b)}return!0}return!1},_renderBackground:function(u){if(this.backgroundColor){var m=this._getNonTransformedDimensions();u.fillStyle=this.backgroundColor,u.fillRect(-m.x/2,-m.y/2,m.x,m.y),this._removeShadow(u)}},_setOpacity:function(u){this.group&&!this.group._transformDone?u.globalAlpha=this.getObjectOpacity():u.globalAlpha*=this.opacity},_setStrokeStyles:function(u,m){var b=m.stroke;b&&(u.lineWidth=m.strokeWidth,u.lineCap=m.strokeLineCap,u.lineDashOffset=m.strokeDashOffset,u.lineJoin=m.strokeLineJoin,u.miterLimit=m.strokeMiterLimit,b.toLive?"percentage"===b.gradientUnits||b.gradientTransform||b.patternTransform?this._applyPatternForTransformedGradient(u,b):(u.strokeStyle=b.toLive(u,this),this._applyPatternGradientTransform(u,b)):u.strokeStyle=m.stroke)},_setFillStyles:function(u,m){var b=m.fill;b&&(b.toLive?(u.fillStyle=b.toLive(u,this),this._applyPatternGradientTransform(u,m.fill)):u.fillStyle=b)},_setClippingProperties:function(u){u.globalAlpha=1,u.strokeStyle="transparent",u.fillStyle="#000000"},_setLineDash:function(u,m){!m||0===m.length||(1&m.length&&m.push.apply(m,m),u.setLineDash(m))},_renderControls:function(u,m){var C,x,T,b=this.getViewportTransform(),v=this.calcTransformMatrix();x=void 0!==(m=m||{}).hasBorders?m.hasBorders:this.hasBorders,T=void 0!==m.hasControls?m.hasControls:this.hasControls,v=h.util.multiplyTransformMatrices(b,v),C=h.util.qrDecompose(v),u.save(),u.translate(C.translateX,C.translateY),u.lineWidth=1*this.borderScaleFactor,this.group||(u.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(C.angle-=180),u.rotate(o(this.group?C.angle:this.angle)),m.forActiveSelection||this.group?x&&this.drawBordersInGroup(u,C,m):x&&this.drawBorders(u,m),T&&this.drawControls(u,m),u.restore()},_setShadow:function(u){if(this.shadow){var v,m=this.shadow,b=this.canvas,C=b&&b.viewportTransform[0]||1,x=b&&b.viewportTransform[3]||1;v=m.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),b&&b._isRetinaScaling()&&(C*=h.devicePixelRatio,x*=h.devicePixelRatio),u.shadowColor=m.color,u.shadowBlur=m.blur*h.browserShadowBlurConstant*(C+x)*(v.scaleX+v.scaleY)/4,u.shadowOffsetX=m.offsetX*C*v.scaleX,u.shadowOffsetY=m.offsetY*x*v.scaleY}},_removeShadow:function(u){!this.shadow||(u.shadowColor="",u.shadowBlur=u.shadowOffsetX=u.shadowOffsetY=0)},_applyPatternGradientTransform:function(u,m){if(!m||!m.toLive)return{offsetX:0,offsetY:0};var b=m.gradientTransform||m.patternTransform,v=-this.width/2+m.offsetX||0,C=-this.height/2+m.offsetY||0;return"percentage"===m.gradientUnits?u.transform(this.width,0,0,this.height,v,C):u.transform(1,0,0,1,v,C),b&&u.transform(b[0],b[1],b[2],b[3],b[4],b[5]),{offsetX:v,offsetY:C}},_renderPaintInOrder:function(u){"stroke"===this.paintFirst?(this._renderStroke(u),this._renderFill(u)):(this._renderFill(u),this._renderStroke(u))},_render:function(){},_renderFill:function(u){!this.fill||(u.save(),this._setFillStyles(u,this),"evenodd"===this.fillRule?u.fill("evenodd"):u.fill(),u.restore())},_renderStroke:function(u){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(u),u.save(),this.strokeUniform&&this.group){var m=this.getObjectScaling();u.scale(1/m.scaleX,1/m.scaleY)}else this.strokeUniform&&u.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(u,this.strokeDashArray),this._setStrokeStyles(u,this),u.stroke(),u.restore()}},_applyPatternForTransformedGradient:function(u,m){var C,b=this._limitCacheSize(this._getCacheCanvasDimensions()),v=h.util.createCanvasElement(),x=this.canvas.getRetinaScaling(),T=b.x/this.scaleX/x,I=b.y/this.scaleY/x;v.width=T,v.height=I,(C=v.getContext("2d")).beginPath(),C.moveTo(0,0),C.lineTo(T,0),C.lineTo(T,I),C.lineTo(0,I),C.closePath(),C.translate(T/2,I/2),C.scale(b.zoomX/this.scaleX/x,b.zoomY/this.scaleY/x),this._applyPatternGradientTransform(C,m),C.fillStyle=m.toLive(u),C.fill(),u.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),u.scale(x*this.scaleX/b.zoomX,x*this.scaleY/b.zoomY),u.strokeStyle=C.createPattern(v,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var u=h.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",u.scaleX),this.set("scaleY",u.scaleY),this.angle=u.angle,this.skewX=u.skewX,this.skewY=0}},_removeTransformMatrix:function(u){var m=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),m=h.util.transformPoint(m,this.transformMatrix)),this.transformMatrix=null,u&&(this.scaleX*=u.scaleX,this.scaleY*=u.scaleY,this.cropX=u.cropX,this.cropY=u.cropY,m.x+=u.offsetLeft,m.y+=u.offsetTop,this.width=u.width,this.height=u.height),this.setPositionByOrigin(m,"center","center")},clone:function(u,m){var b=this.toObject(m);this.constructor.fromObject?this.constructor.fromObject(b,u):h.Object._fromObject("Object",b,u)},cloneAsImage:function(u,m){var b=this.toCanvasElement(m);return u&&u(new h.Image(b)),this},toCanvasElement:function(u){u||(u={});var m=h.util,b=m.saveObjectTransform(this),v=this.group,C=this.shadow,x=Math.abs,T=(u.multiplier||1)*(u.enableRetinaScaling?h.devicePixelRatio:1);delete this.group,u.withoutTransform&&m.resetObjectTransform(this),u.withoutShadow&&(this.shadow=null);var W,ne,ce,I=h.util.createCanvasElement(),N=this.getBoundingRect(!0,!0),H=this.shadow,K={x:0,y:0};H&&(ne=H.blur,W=H.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),K.x=2*Math.round(x(H.offsetX)+ne)*x(W.scaleX),K.y=2*Math.round(x(H.offsetY)+ne)*x(W.scaleY)),ce=N.height+K.y,I.width=Math.ceil(N.width+K.x),I.height=Math.ceil(ce);var Y=new h.StaticCanvas(I,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===u.format&&(Y.backgroundColor="#fff"),this.setPositionByOrigin(new h.Point(Y.width/2,Y.height/2),"center","center");var de=this.canvas;Y.add(this);var fe=Y.toCanvasElement(T||1,u);return this.shadow=C,this.set("canvas",de),v&&(this.group=v),this.set(b).setCoords(),Y._objects=[],Y.dispose(),Y=null,fe},toDataURL:function(u){return u||(u={}),h.util.toDataURL(this.toCanvasElement(u),u.format||"png",u.quality||1)},isType:function(u){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===u},complexity:function(){return 1},toJSON:function(u){return this.toObject(u)},rotate:function(u){var m=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return m&&this._setOriginToCenter(),this.set("angle",u),m&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(u,m){m=m||this.canvas.getPointer(u);var b=new h.Point(m.x,m.y),v=this._getLeftTopCoords();return this.angle&&(b=h.util.rotatePoint(b,v,o(-this.angle))),{x:b.x-v.x,y:b.y-v.y}},_setupCompositeOperation:function(u){this.globalCompositeOperation&&(u.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){h.runningAnimations&&h.runningAnimations.cancelByTarget(this)}}),h.util.createAccessors&&h.util.createAccessors(h.Object),p(h.Object.prototype,h.Observable),h.Object.NUM_FRACTION_DIGITS=2,h.Object.ENLIVEN_PROPS=["clipPath"],h.Object._fromObject=function(u,m,b,v){var C=h[u];m=g(m,!0),h.util.enlivenPatterns([m.fill,m.stroke],function(x){void 0!==x[0]&&(m.fill=x[0]),void 0!==x[1]&&(m.stroke=x[1]),h.util.enlivenObjectEnlivables(m,m,function(){var T=v?new C(m[v],m):new C(m);b&&b(T)})})},h.Object.__uid=0)}($),function(){var _=S.util.degreesToRadians,h={left:-.5,center:0,right:.5},p={top:-.5,center:0,bottom:.5};S.util.object.extend(S.Object.prototype,{translateToGivenOrigin:function(g,c,l,o,a){var m,b,v,f=g.x,u=g.y;return"string"==typeof c?c=h[c]:c-=.5,"string"==typeof o?o=h[o]:o-=.5,"string"==typeof l?l=p[l]:l-=.5,"string"==typeof a?a=p[a]:a-=.5,b=a-l,((m=o-c)||b)&&(v=this._getTransformedDimensions(),f=g.x+m*v.x,u=g.y+b*v.y),new S.Point(f,u)},translateToCenterPoint:function(g,c,l){var o=this.translateToGivenOrigin(g,c,l,"center","center");return this.angle?S.util.rotatePoint(o,g,_(this.angle)):o},translateToOriginPoint:function(g,c,l){var o=this.translateToGivenOrigin(g,"center","center",c,l);return this.angle?S.util.rotatePoint(o,g,_(this.angle)):o},getCenterPoint:function(){var g=new S.Point(this.left,this.top);return this.translateToCenterPoint(g,this.originX,this.originY)},getPointByOrigin:function(g,c){var l=this.getCenterPoint();return this.translateToOriginPoint(l,g,c)},toLocalPoint:function(g,c,l){var a,f,o=this.getCenterPoint();return a=void 0!==c&&void 0!==l?this.translateToGivenOrigin(o,"center","center",c,l):new S.Point(this.left,this.top),f=new S.Point(g.x,g.y),this.angle&&(f=S.util.rotatePoint(f,o,-_(this.angle))),f.subtractEquals(a)},setPositionByOrigin:function(g,c,l){var o=this.translateToCenterPoint(g,c,l),a=this.translateToOriginPoint(o,this.originX,this.originY);this.set("left",a.x),this.set("top",a.y)},adjustPosition:function(g){var f,u,c=_(this.angle),l=this.getScaledWidth(),o=S.util.cos(c)*l,a=S.util.sin(c)*l;this.left+=o*((u="string"==typeof g?h[g]:g-.5)-(f="string"==typeof this.originX?h[this.originX]:this.originX-.5)),this.top+=a*(u-f),this.setCoords(),this.originX=g},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var g=this.getCenterPoint();this.originX="center",this.originY="center",this.left=g.x,this.top=g.y},_resetOrigin:function(){var g=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=g.x,this.top=g.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){var h=S.util,p=h.degreesToRadians,g=h.multiplyTransformMatrices,c=h.transformPoint;h.object.extend(S.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(l,o){return o?l?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),l?this.aCoords:this.lineCoords)},getCoords:function(l,o){return function(l){return[new S.Point(l.tl.x,l.tl.y),new S.Point(l.tr.x,l.tr.y),new S.Point(l.br.x,l.br.y),new S.Point(l.bl.x,l.bl.y)]}(this._getCoords(l,o))},intersectsWithRect:function(l,o,a,f){var u=this.getCoords(a,f);return"Intersection"===S.Intersection.intersectPolygonRectangle(u,l,o).status},intersectsWithObject:function(l,o,a){return"Intersection"===S.Intersection.intersectPolygonPolygon(this.getCoords(o,a),l.getCoords(o,a)).status||l.isContainedWithinObject(this,o,a)||this.isContainedWithinObject(l,o,a)},isContainedWithinObject:function(l,o,a){for(var f=this.getCoords(o,a),m=0,b=l._getImageLines(o?l.aCoords:l.lineCoords);m<4;m++)if(!l.containsPoint(f[m],b))return!1;return!0},isContainedWithinRect:function(l,o,a,f){var u=this.getBoundingRect(a,f);return u.left>=l.x&&u.left+u.width<=o.x&&u.top>=l.y&&u.top+u.height<=o.y},containsPoint:function(l,o,a,f){var u=this._getCoords(a,f),m=(o=o||this._getImageLines(u),this._findCrossPoints(l,o));return 0!==m&&m%2==1},isOnScreen:function(l){if(!this.canvas)return!1;var o=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br;return!(!this.getCoords(!0,l).some(function(u){return u.x<=a.x&&u.x>=o.x&&u.y<=a.y&&u.y>=o.y})&&!this.intersectsWithRect(o,a,!0,l))||this._containsCenterOfCanvas(o,a,l)},_containsCenterOfCanvas:function(l,o,a){return!!this.containsPoint({x:(l.x+o.x)/2,y:(l.y+o.y)/2},null,!0,a)},isPartiallyOnScreen:function(l){if(!this.canvas)return!1;var o=this.canvas.vptCoords.tl,a=this.canvas.vptCoords.br;return!!this.intersectsWithRect(o,a,!0,l)||this.getCoords(!0,l).every(function(u){return(u.x>=a.x||u.x<=o.x)&&(u.y>=a.y||u.y<=o.y)})&&this._containsCenterOfCanvas(o,a,l)},_getImageLines:function(l){return{topline:{o:l.tl,d:l.tr},rightline:{o:l.tr,d:l.br},bottomline:{o:l.br,d:l.bl},leftline:{o:l.bl,d:l.tl}}},_findCrossPoints:function(l,o){var f,u,m,b,C,v=0;for(var x in o)if(!((C=o[x]).o.y<l.y&&C.d.y<l.y||C.o.y>=l.y&&C.d.y>=l.y||(C.o.x===C.d.x&&C.o.x>=l.x?b=C.o.x:(f=(C.d.y-C.o.y)/(C.d.x-C.o.x),u=l.y-0*l.x,m=C.o.y-f*C.o.x,b=-(u-m)/(0-f)),b>=l.x&&(v+=1),2!==v)))break;return v},getBoundingRect:function(l,o){var a=this.getCoords(l,o);return h.makeBoundingBoxFromPoints(a)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(l){return Math.abs(l)<this.minScaleLimit?l<0?-this.minScaleLimit:this.minScaleLimit:0===l?1e-4:l},scale:function(l){return this._set("scaleX",l),this._set("scaleY",l),this.setCoords()},scaleToWidth:function(l,o){var a=this.getBoundingRect(o).width/this.getScaledWidth();return this.scale(l/this.width/a)},scaleToHeight:function(l,o){var a=this.getBoundingRect(o).height/this.getScaledHeight();return this.scale(l/this.height/a)},calcLineCoords:function(){var l=this.getViewportTransform(),o=this.padding,a=p(this.angle),m=h.cos(a)*o,b=h.sin(a)*o,v=m+b,C=m-b,x=this.calcACoords(),T={tl:c(x.tl,l),tr:c(x.tr,l),bl:c(x.bl,l),br:c(x.br,l)};return o&&(T.tl.x-=C,T.tl.y-=v,T.tr.x+=v,T.tr.y-=C,T.bl.x-=v,T.bl.y+=C,T.br.x+=C,T.br.y+=v),T},calcOCoords:function(){var l=this._calcRotateMatrix(),o=this._calcTranslateMatrix(),a=this.getViewportTransform(),f=g(a,o),u=g(f,l),m=(u=g(u,[1/a[0],0,0,1/a[3],0,0]),this._calculateCurrentDimensions()),b={};return this.forEachControl(function(v,C,x){b[C]=v.positionHandler(m,u,x)}),b},calcACoords:function(){var l=this._calcRotateMatrix(),o=this._calcTranslateMatrix(),a=g(o,l),f=this._getTransformedDimensions(),u=f.x/2,m=f.y/2;return{tl:c({x:-u,y:-m},a),tr:c({x:u,y:-m},a),bl:c({x:-u,y:m},a),br:c({x:u,y:m},a)}},setCoords:function(l){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),l||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return h.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var l=this.getCenterPoint();return[1,0,0,1,l.x,l.y]},transformMatrixKey:function(l){var o="_",a="";return!l&&this.group&&(a=this.group.transformMatrixKey(l)+o),a+this.top+o+this.left+o+this.scaleX+o+this.scaleY+o+this.skewX+o+this.skewY+o+this.angle+o+this.originX+o+this.originY+o+this.width+o+this.height+o+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(l){var o=this.calcOwnMatrix();if(l||!this.group)return o;var a=this.transformMatrixKey(l),f=this.matrixCache||(this.matrixCache={});return f.key===a?f.value:(this.group&&(o=g(this.group.calcTransformMatrix(!1),o)),f.key=a,f.value=o,o)},calcOwnMatrix:function(){var l=this.transformMatrixKey(!0),o=this.ownMatrixCache||(this.ownMatrixCache={});if(o.key===l)return o.value;var a=this._calcTranslateMatrix(),f={angle:this.angle,translateX:a[4],translateY:a[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return o.key=l,o.value=h.composeMatrix(f),o.value},_getNonTransformedDimensions:function(){var l=this.strokeWidth;return{x:this.width+l,y:this.height+l}},_getTransformedDimensions:function(l,o){void 0===l&&(l=this.skewX),void 0===o&&(o=this.skewY);var a,f,u,m=0===l&&0===o;if(this.strokeUniform?(f=this.width,u=this.height):(f=(a=this._getNonTransformedDimensions()).x,u=a.y),m)return this._finalizeDimensions(f*this.scaleX,u*this.scaleY);var b=h.sizeAfterTransform(f,u,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:l,skewY:o});return this._finalizeDimensions(b.x,b.y)},_finalizeDimensions:function(l,o){return this.strokeUniform?{x:l+this.strokeWidth,y:o+this.strokeWidth}:{x:l,y:o}},_calculateCurrentDimensions:function(){var l=this.getViewportTransform(),o=this._getTransformedDimensions();return c(o,l,!0).scalarAdd(2*this.padding)}})}(),S.util.object.extend(S.Object.prototype,{sendToBack:function(){return this.group?S.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?S.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(_){return this.group?S.StaticCanvas.prototype.sendBackwards.call(this.group,this,_):this.canvas&&this.canvas.sendBackwards(this,_),this},bringForward:function(_){return this.group?S.StaticCanvas.prototype.bringForward.call(this.group,this,_):this.canvas&&this.canvas.bringForward(this,_),this},moveTo:function(_){return this.group&&"activeSelection"!==this.group.type?S.StaticCanvas.prototype.moveTo.call(this.group,this,_):this.canvas&&this.canvas.moveTo(this,_),this}}),function(){function _(p,g){if(g){if(g.toLive)return p+": url(#SVGID_"+g.id+"); ";var c=new S.Color(g),l=p+": "+c.toRgb()+"; ",o=c.getAlpha();return 1!==o&&(l+=p+"-opacity: "+o.toString()+"; "),l}return p+": none; "}var h=S.util.toFixed;S.util.object.extend(S.Object.prototype,{getSvgStyles:function(p){var g=this.fillRule?this.fillRule:"nonzero",c=this.strokeWidth?this.strokeWidth:"0",l=this.strokeDashArray?this.strokeDashArray.join(" "):"none",o=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",f=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",m=void 0!==this.opacity?this.opacity:"1",b=this.visible?"":" visibility: hidden;",v=p?"":this.getSvgFilter(),C=_("fill",this.fill);return[_("stroke",this.stroke),"stroke-width: ",c,"; ","stroke-dasharray: ",l,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",f,"; ","stroke-miterlimit: ",u,"; ",C,"fill-rule: ",g,"; ","opacity: ",m,";",v,b].join("")},getSvgSpanStyles:function(p,g){var c="; ",l=p.fontFamily?"font-family: "+(-1===p.fontFamily.indexOf("'")&&-1===p.fontFamily.indexOf('"')?"'"+p.fontFamily+"'":p.fontFamily)+c:"",o=p.strokeWidth?"stroke-width: "+p.strokeWidth+c:"",a=p.fontSize?"font-size: "+p.fontSize+"px"+c:"",f=p.fontStyle?"font-style: "+p.fontStyle+c:"",u=p.fontWeight?"font-weight: "+p.fontWeight+c:"",m=p.fill?_("fill",p.fill):"",b=p.stroke?_("stroke",p.stroke):"",v=this.getSvgTextDecoration(p);return v&&(v="text-decoration: "+v+c),[b,o,l,a,f,u,v,m,p.deltaY?"baseline-shift: "+-p.deltaY+"; ":"",g?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(p){return["overline","underline","line-through"].filter(function(g){return p[g.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(p,g){var c=p?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+S.util.matrixToSVG(c)+(g||"")+'" '},_setSVGBg:function(p){if(this.backgroundColor){var g=S.Object.NUM_FRACTION_DIGITS;p.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',h(-this.width/2,g),'" y="',h(-this.height/2,g),'" width="',h(this.width,g),'" height="',h(this.height,g),'"></rect>\n')}},toSVG:function(p){return this._createBaseSVGMarkup(this._toSVG(p),{reviver:p})},toClipPathSVG:function(p){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(p),{reviver:p})},_createBaseClipPathSVGMarkup:function(p,g){var c=(g=g||{}).reviver,o=[this.getSvgTransform(!0,g.additionalTransform||""),this.getSvgCommons()].join(""),a=p.indexOf("COMMON_PARTS");return p[a]=o,c?c(p.join("")):p.join("")},_createBaseSVGMarkup:function(p,g){var x,I,c=(g=g||{}).noStyle,l=g.reviver,o=c?"":'style="'+this.getSvgStyles()+'" ',a=g.withShadow?'style="'+this.getSvgFilter()+'" ':"",f=this.clipPath,u=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",m=f&&f.absolutePositioned,b=this.stroke,v=this.fill,C=this.shadow,T=[],N=p.indexOf("COMMON_PARTS"),H=g.additionalTransform;return f&&(f.clipPathId="CLIPPATH_"+S.Object.__uid++,I='<clipPath id="'+f.clipPathId+'" >\n'+f.toClipPathSVG(l)+"</clipPath>\n"),m&&T.push("<g ",a,this.getSvgCommons()," >\n"),T.push("<g ",this.getSvgTransform(!1),m?"":a+this.getSvgCommons()," >\n"),x=[o,u,c?"":this.addPaintOrder()," ",H?'transform="'+H+'" ':""].join(""),p[N]=x,v&&v.toLive&&T.push(v.toSVG(this)),b&&b.toLive&&T.push(b.toSVG(this)),C&&T.push(C.toSVG(this)),f&&T.push(I),T.push(p.join("")),T.push("</g>\n"),m&&T.push("</g>\n"),l?l(T.join("")):T.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var _=S.util.object.extend,h="stateProperties";function p(c,l,o){var a={};o.forEach(function(u){a[u]=c[u]}),_(c[l],a,!0)}function g(c,l,o){if(c===l)return!0;if(Array.isArray(c)){if(!Array.isArray(l)||c.length!==l.length)return!1;for(var a=0,f=c.length;a<f;a++)if(!g(c[a],l[a]))return!1;return!0}if(c&&"object"==typeof c){var m,u=Object.keys(c);if(!l||"object"!=typeof l||!o&&u.length!==Object.keys(l).length)return!1;for(a=0,f=u.length;a<f;a++)if("canvas"!==(m=u[a])&&"group"!==m&&!g(c[m],l[m]))return!1;return!0}}S.util.object.extend(S.Object.prototype,{hasStateChanged:function(c){var l="_"+(c=c||h);return Object.keys(this[l]).length<this[c].length||!g(this[l],this,!0)},saveState:function(c){var l=c&&c.propertySet||h,o="_"+l;return this[o]?(p(this,o,this[l]),c&&c.stateProperties&&p(this,o,c.stateProperties),this):this.setupState(c)},setupState:function(c){var l=(c=c||{}).propertySet||h;return c.propertySet=l,this["_"+l]={},this.saveState(c),this}})}(),function(){var _=S.util.degreesToRadians;S.util.object.extend(S.Object.prototype,{_findTargetCorner:function(h,p){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var l,o,u,g=h.x,c=h.y,a=Object.keys(this.oCoords),f=a.length-1;for(this.__corner=0;f>=0;f--)if(this.isControlVisible(u=a[f])&&(o=this._getImageLines(p?this.oCoords[u].touchCorner:this.oCoords[u].corner),0!==(l=this._findCrossPoints({x:g,y:c},o))&&l%2==1))return this.__corner=u,u;return!1},forEachControl:function(h){for(var p in this.controls)h(this.controls[p],p,this)},_setCornerCoords:function(){var h=this.oCoords;for(var p in h){var g=this.controls[p];h[p].corner=g.calcCornerCoords(this.angle,this.cornerSize,h[p].x,h[p].y,!1),h[p].touchCorner=g.calcCornerCoords(this.angle,this.touchCornerSize,h[p].x,h[p].y,!0)}},drawSelectionBackground:function(h){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;h.save();var p=this.getCenterPoint(),g=this._calculateCurrentDimensions(),c=this.canvas.viewportTransform;return h.translate(p.x,p.y),h.scale(1/c[0],1/c[3]),h.rotate(_(this.angle)),h.fillStyle=this.selectionBackgroundColor,h.fillRect(-g.x/2,-g.y/2,g.x,g.y),h.restore(),this},drawBorders:function(h,p){p=p||{};var g=this._calculateCurrentDimensions(),c=this.borderScaleFactor,l=g.x+c,o=g.y+c,a=void 0!==p.hasControls?p.hasControls:this.hasControls,f=!1;return h.save(),h.strokeStyle=p.borderColor||this.borderColor,this._setLineDash(h,p.borderDashArray||this.borderDashArray),h.strokeRect(-l/2,-o/2,l,o),a&&(h.beginPath(),this.forEachControl(function(u,m,b){u.withConnection&&u.getVisibility(b,m)&&(f=!0,h.moveTo(u.x*l,u.y*o),h.lineTo(u.x*l+u.offsetX,u.y*o+u.offsetY))}),f&&h.stroke()),h.restore(),this},drawBordersInGroup:function(h,p,g){g=g||{};var c=S.util.sizeAfterTransform(this.width,this.height,p),l=this.strokeWidth,o=this.strokeUniform,a=this.borderScaleFactor,f=c.x+l*(o?this.canvas.getZoom():p.scaleX)+a,u=c.y+l*(o?this.canvas.getZoom():p.scaleY)+a;return h.save(),this._setLineDash(h,g.borderDashArray||this.borderDashArray),h.strokeStyle=g.borderColor||this.borderColor,h.strokeRect(-f/2,-u/2,f,u),h.restore(),this},drawControls:function(h,p){p=p||{},h.save();var c,l,g=this.canvas.getRetinaScaling();return h.setTransform(g,0,0,g,0,0),h.strokeStyle=h.fillStyle=p.cornerColor||this.cornerColor,this.transparentCorners||(h.strokeStyle=p.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(h,p.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(c=this.group.calcTransformMatrix()),this.forEachControl(function(o,a,f){l=f.oCoords[a],o.getVisibility(f,a)&&(c&&(l=S.util.transformPoint(l,c)),o.render(h,l.x,l.y,p,f))}),h.restore(),this},isControlVisible:function(h){return this.controls[h]&&this.controls[h].getVisibility(this,h)},setControlVisible:function(h,p){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[h]=p,this},setControlsVisibility:function(h){for(var p in h||(h={}),h)this.setControlVisible(p,h[p]);return this},onDeselect:function(){},onSelect:function(){}})}(),S.util.object.extend(S.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(_,h){var p=function(){},g=(h=h||{}).onComplete||p,c=h.onChange||p,l=this;return S.util.animate({target:this,startValue:_.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(o){_.set("left",o),l.requestRenderAll(),c()},onComplete:function(){_.setCoords(),g()}})},fxCenterObjectV:function(_,h){var p=function(){},g=(h=h||{}).onComplete||p,c=h.onChange||p,l=this;return S.util.animate({target:this,startValue:_.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(o){_.set("top",o),l.requestRenderAll(),c()},onComplete:function(){_.setCoords(),g()}})},fxRemove:function(_,h){var p=function(){},g=(h=h||{}).onComplete||p,c=h.onChange||p,l=this;return S.util.animate({target:this,startValue:_.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(o){_.set("opacity",o),l.requestRenderAll(),c()},onComplete:function(){l.remove(_),g()}})}}),S.util.object.extend(S.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var h,_=[],g=[];for(h in arguments[0])_.push(h);for(var c=0,l=_.length;c<l;c++)g.push(this._animate(h=_[c],arguments[0][h],arguments[1],c!==l-1));return g}return this._animate.apply(this,arguments)},_animate:function(_,h,p,g){var l,c=this;h=h.toString(),p=p?S.util.object.clone(p):{},~_.indexOf(".")&&(l=_.split("."));var o=c.colorProperties.indexOf(_)>-1||l&&c.colorProperties.indexOf(l[1])>-1,a=l?this.get(l[0])[l[1]]:this.get(_);"from"in p||(p.from=a),o||(h=~h.indexOf("=")?a+parseFloat(h.replace("=","")):parseFloat(h));var f={target:this,startValue:p.from,endValue:h,byValue:p.by,easing:p.easing,duration:p.duration,abort:p.abort&&function(u,m,b){return p.abort.call(c,u,m,b)},onChange:function(u,m,b){l?c[l[0]][l[1]]=u:c.set(_,u),!g&&p.onChange&&p.onChange(u,m,b)},onComplete:function(u,m,b){g||(c.setCoords(),p.onComplete&&p.onComplete(u,m,b))}};return o?S.util.animateColor(f.startValue,f.endValue,f.duration,f):S.util.animate(f)}}),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.object.extend,g=h.util.object.clone,c={x1:1,x2:1,y1:1,y2:1};function l(o,a){var f=o.origin,u=o.axis1,m=o.axis2,b=o.dimension,v=a.nearest,C=a.center,x=a.farthest;return function(){switch(this.get(f)){case v:return Math.min(this.get(u),this.get(m));case C:return Math.min(this.get(u),this.get(m))+.5*this.get(b);case x:return Math.max(this.get(u),this.get(m))}}}h.Line?h.warn("fabric.Line is already defined"):(h.Line=h.util.createClass(h.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:h.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(o,a){o||(o=[0,0,0,0]),this.callSuper("initialize",a),this.set("x1",o[0]),this.set("y1",o[1]),this.set("x2",o[2]),this.set("y2",o[3]),this._setWidthHeight(a)},_setWidthHeight:function(o){o||(o={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in o?o.left:this._getLeftToOriginX(),this.top="top"in o?o.top:this._getTopToOriginY()},_set:function(o,a){return this.callSuper("_set",o,a),void 0!==c[o]&&this._setWidthHeight(),this},_getLeftToOriginX:l({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:l({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(o){o.beginPath();var a=this.calcLinePoints();o.moveTo(a.x1,a.y1),o.lineTo(a.x2,a.y2),o.lineWidth=this.strokeWidth;var f=o.strokeStyle;o.strokeStyle=this.stroke||o.fillStyle,this.stroke&&this._renderStroke(o),o.strokeStyle=f},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(o){return p(this.callSuper("toObject",o),this.calcLinePoints())},_getNonTransformedDimensions:function(){var o=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(o.y-=this.strokeWidth),0===this.height&&(o.x-=this.strokeWidth)),o},calcLinePoints:function(){var o=this.x1<=this.x2?-1:1,a=this.y1<=this.y2?-1:1;return{x1:o*this.width*.5,x2:o*this.width*-.5,y1:a*this.height*.5,y2:a*this.height*-.5}},_toSVG:function(){var o=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',o.x1,'" y1="',o.y1,'" x2="',o.x2,'" y2="',o.y2,'" />\n']}}),h.Line.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),h.Line.fromElement=function(o,a,f){f=f||{};var u=h.parseAttributes(o,h.Line.ATTRIBUTE_NAMES);a(new h.Line([u.x1||0,u.y1||0,u.x2||0,u.y2||0],p(u,f)))},h.Line.fromObject=function(o,a){var u=g(o,!0);u.points=[o.x1,o.y1,o.x2,o.y2],h.Object._fromObject("Line",u,function(m){delete m.points,a&&a(m)},"points")})}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.degreesToRadians;h.Circle?h.warn("fabric.Circle is already defined."):(h.Circle=h.util.createClass(h.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:h.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(c,l){return this.callSuper("_set",c,l),"radius"===c&&this.setRadius(l),this},toObject:function(c){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(c))},_toSVG:function(){var c,a=(this.endAngle-this.startAngle)%360;if(0===a)c=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n'];else{var f=p(this.startAngle),u=p(this.endAngle),m=this.radius;c=['<path d="M '+h.util.cos(f)*m+" "+h.util.sin(f)*m," A "+m+" "+m," 0 ",+(a>180?"1":"0")+" 1"," "+h.util.cos(u)*m+" "+h.util.sin(u)*m,'" ',"COMMON_PARTS"," />\n"]}return c},_render:function(c){c.beginPath(),c.arc(0,0,this.radius,p(this.startAngle),p(this.endAngle),!1),this._renderPaintInOrder(c)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(c){return this.radius=c,this.set("width",2*c).set("height",2*c)}}),h.Circle.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),h.Circle.fromElement=function(c,l){var o=h.parseAttributes(c,h.Circle.ATTRIBUTE_NAMES);if(!function(c){return"radius"in c&&c.radius>=0}(o))throw new Error("value of `r` attribute is required and can not be negative");o.left=(o.left||0)-o.radius,o.top=(o.top||0)-o.radius,l(new h.Circle(o))},h.Circle.fromObject=function(c,l){h.Object._fromObject("Circle",c,l)})}($),function(_){"use strict";var h=_.fabric||(_.fabric={});h.Triangle?h.warn("fabric.Triangle is already defined"):(h.Triangle=h.util.createClass(h.Object,{type:"triangle",width:100,height:100,_render:function(p){var g=this.width/2,c=this.height/2;p.beginPath(),p.moveTo(-g,c),p.lineTo(0,-c),p.lineTo(g,c),p.closePath(),this._renderPaintInOrder(p)},_toSVG:function(){var p=this.width/2,g=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-p+" "+g,"0 "+-g,p+" "+g].join(","),'" />']}}),h.Triangle.fromObject=function(p,g){return h.Object._fromObject("Triangle",p,g)})}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=2*Math.PI;h.Ellipse?h.warn("fabric.Ellipse is already defined."):(h.Ellipse=h.util.createClass(h.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:h.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(g){this.callSuper("initialize",g),this.set("rx",g&&g.rx||0),this.set("ry",g&&g.ry||0)},_set:function(g,c){switch(this.callSuper("_set",g,c),g){case"rx":this.rx=c,this.set("width",2*c);break;case"ry":this.ry=c,this.set("height",2*c)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(g){return this.callSuper("toObject",["rx","ry"].concat(g))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(g){g.beginPath(),g.save(),g.transform(1,0,0,this.ry/this.rx,0,0),g.arc(0,0,this.rx,0,p,!1),g.restore(),this._renderPaintInOrder(g)}}),h.Ellipse.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),h.Ellipse.fromElement=function(g,c){var l=h.parseAttributes(g,h.Ellipse.ATTRIBUTE_NAMES);l.left=(l.left||0)-l.rx,l.top=(l.top||0)-l.ry,c(new h.Ellipse(l))},h.Ellipse.fromObject=function(g,c){h.Object._fromObject("Ellipse",g,c)})}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.object.extend;h.Rect?h.warn("fabric.Rect is already defined"):(h.Rect=h.util.createClass(h.Object,{stateProperties:h.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:h.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(g){this.callSuper("initialize",g),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(g){var c=this.rx?Math.min(this.rx,this.width/2):0,l=this.ry?Math.min(this.ry,this.height/2):0,o=this.width,a=this.height,f=-this.width/2,u=-this.height/2,m=0!==c||0!==l,b=.4477152502;g.beginPath(),g.moveTo(f+c,u),g.lineTo(f+o-c,u),m&&g.bezierCurveTo(f+o-b*c,u,f+o,u+b*l,f+o,u+l),g.lineTo(f+o,u+a-l),m&&g.bezierCurveTo(f+o,u+a-b*l,f+o-b*c,u+a,f+o-c,u+a),g.lineTo(f+c,u+a),m&&g.bezierCurveTo(f+b*c,u+a,f,u+a-b*l,f,u+a-l),g.lineTo(f,u+l),m&&g.bezierCurveTo(f,u+b*l,f+b*c,u,f+c,u),g.closePath(),this._renderPaintInOrder(g)},toObject:function(g){return this.callSuper("toObject",["rx","ry"].concat(g))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),h.Rect.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),h.Rect.fromElement=function(g,c,l){if(!g)return c(null);l=l||{};var o=h.parseAttributes(g,h.Rect.ATTRIBUTE_NAMES);o.left=o.left||0,o.top=o.top||0,o.height=o.height||0,o.width=o.width||0;var a=new h.Rect(p(l?h.util.object.clone(l):{},o));a.visible=a.visible&&a.width>0&&a.height>0,c(a)},h.Rect.fromObject=function(g,c){return h.Object._fromObject("Rect",g,c)})}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.object.extend,g=h.util.array.min,c=h.util.array.max,l=h.util.toFixed,o=h.util.projectStrokeOnPoints;h.Polyline?h.warn("fabric.Polyline is already defined"):(h.Polyline=h.util.createClass(h.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:h.Object.prototype.cacheProperties.concat("points"),initialize:function(a,f){f=f||{},this.points=a||[],this.callSuper("initialize",f),this._setPositionDimensions(f)},_projectStrokeOnPoints:function(){return o(this.points,this,!0)},_setPositionDimensions:function(a){var u,f=this._calcDimensions(a),m=this.exactBoundingBox?this.strokeWidth:0;this.width=f.width-m,this.height=f.height-m,a.fromSVG||(u=this.translateToGivenOrigin({x:f.left-this.strokeWidth/2+m/2,y:f.top-this.strokeWidth/2+m/2},"left","top",this.originX,this.originY)),void 0===a.left&&(this.left=a.fromSVG?f.left:u.x),void 0===a.top&&(this.top=a.fromSVG?f.top:u.y),this.pathOffset={x:f.left+this.width/2+m/2,y:f.top+this.height/2+m/2}},_calcDimensions:function(){var a=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,f=g(a,"x")||0,u=g(a,"y")||0;return{left:f,top:u,width:(c(a,"x")||0)-f,height:(c(a,"y")||0)-u}},toObject:function(a){return p(this.callSuper("toObject",a),{points:this.points.concat()})},_toSVG:function(){for(var a=[],f=this.pathOffset.x,u=this.pathOffset.y,m=h.Object.NUM_FRACTION_DIGITS,b=0,v=this.points.length;b<v;b++)a.push(l(this.points[b].x-f,m),",",l(this.points[b].y-u,m)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',a.join(""),'" />\n']},commonRender:function(a){var f,u=this.points.length,m=this.pathOffset.x,b=this.pathOffset.y;if(!u||isNaN(this.points[u-1].y))return!1;a.beginPath(),a.moveTo(this.points[0].x-m,this.points[0].y-b);for(var v=0;v<u;v++)a.lineTo((f=this.points[v]).x-m,f.y-b);return!0},_render:function(a){!this.commonRender(a)||this._renderPaintInOrder(a)},complexity:function(){return this.get("points").length}}),h.Polyline.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(),h.Polyline.fromElementGenerator=function(a){return function(f,u,m){if(!f)return u(null);m||(m={});var b=h.parsePointsAttribute(f.getAttribute("points")),v=h.parseAttributes(f,h[a].ATTRIBUTE_NAMES);v.fromSVG=!0,u(new h[a](b,p(v,m)))}},h.Polyline.fromElement=h.Polyline.fromElementGenerator("Polyline"),h.Polyline.fromObject=function(a,f){return h.Object._fromObject("Polyline",a,f,"points")})}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.projectStrokeOnPoints;h.Polygon?h.warn("fabric.Polygon is already defined"):(h.Polygon=h.util.createClass(h.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return p(this.points,this)},_render:function(g){!this.commonRender(g)||(g.closePath(),this._renderPaintInOrder(g))}}),h.Polygon.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(),h.Polygon.fromElement=h.Polyline.fromElementGenerator("Polygon"),h.Polygon.fromObject=function(g,c){h.Object._fromObject("Polygon",g,c,"points")})}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.array.min,g=h.util.array.max,c=h.util.object.extend,l=h.util.object.clone,o=h.util.toFixed;h.Path?h.warn("fabric.Path is already defined"):(h.Path=h.util.createClass(h.Object,{type:"path",path:null,cacheProperties:h.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:h.Object.prototype.stateProperties.concat("path"),initialize:function(a,f){delete(f=l(f||{})).path,this.callSuper("initialize",f),this._setPath(a||[],f)},_setPath:function(a,f){this.path=h.util.makePathSimpler(Array.isArray(a)?a:h.util.parsePath(a)),h.Polyline.prototype._setPositionDimensions.call(this,f||{})},_renderPathCommands:function(a){var f,u=0,m=0,b=0,v=0,T=-this.pathOffset.x,I=-this.pathOffset.y;a.beginPath();for(var N=0,H=this.path.length;N<H;++N)switch(f=this.path[N],f[0]){case"L":a.lineTo((b=f[1])+T,(v=f[2])+I);break;case"M":u=b=f[1],m=v=f[2],a.moveTo(b+T,v+I);break;case"C":a.bezierCurveTo(f[1]+T,f[2]+I,f[3]+T,f[4]+I,(b=f[5])+T,(v=f[6])+I);break;case"Q":a.quadraticCurveTo(f[1]+T,f[2]+I,f[3]+T,f[4]+I),b=f[3],v=f[4];break;case"z":case"Z":b=u,v=m,a.closePath()}},_render:function(a){this._renderPathCommands(a),this._renderPaintInOrder(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){return c(this.callSuper("toObject",a),{path:this.path.map(function(f){return f.slice()})})},toDatalessObject:function(a){var f=this.toObject(["sourcePath"].concat(a));return f.sourcePath&&delete f.path,f},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',h.util.joinPath(this.path),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var a=h.Object.NUM_FRACTION_DIGITS;return" translate("+o(-this.pathOffset.x,a)+", "+o(-this.pathOffset.y,a)+")"},toClipPathSVG:function(a){var f=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:f})},toSVG:function(a){var f=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:a,additionalTransform:f})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var u,x,a=[],f=[],m=0,b=0,v=0,C=0,T=0,I=this.path.length;T<I;++T){switch((u=this.path[T])[0]){case"L":v=u[1],C=u[2],x=[];break;case"M":m=v=u[1],b=C=u[2],x=[];break;case"C":x=h.util.getBoundsOfCurve(v,C,u[1],u[2],u[3],u[4],u[5],u[6]),v=u[5],C=u[6];break;case"Q":x=h.util.getBoundsOfCurve(v,C,u[1],u[2],u[1],u[2],u[3],u[4]),v=u[3],C=u[4];break;case"z":case"Z":v=m,C=b}x.forEach(function(ce){a.push(ce.x),f.push(ce.y)}),a.push(v),f.push(C)}var N=p(a)||0,H=p(f)||0;return{left:N,top:H,width:(g(a)||0)-N,height:(g(f)||0)-H}}}),h.Path.fromObject=function(a,f){"string"==typeof a.sourcePath?h.loadSVGFromURL(a.sourcePath,function(m){var b=m[0];b.setOptions(a),a.clipPath?h.util.enlivenObjects([a.clipPath],function(v){b.clipPath=v[0],f&&f(b)}):f&&f(b)}):h.Object._fromObject("Path",a,f,"path")},h.Path.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat(["d"]),h.Path.fromElement=function(a,f,u){var m=h.parseAttributes(a,h.Path.ATTRIBUTE_NAMES);m.fromSVG=!0,f(new h.Path(m.d,c(m,u)))})}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.array.min,g=h.util.array.max;h.Group||(h.Group=h.util.createClass(h.Object,h.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(c,l,o){l=l||{},this._objects=[],o&&this.callSuper("initialize",l),this._objects=c||[];for(var a=this._objects.length;a--;)this._objects[a].group=this;if(o)this._updateObjectsACoords();else{var f=l&&l.centerPoint;void 0!==l.originX&&(this.originX=l.originX),void 0!==l.originY&&(this.originY=l.originY),f||this._calcBounds(),this._updateObjectsCoords(f),delete l.centerPoint,this.callSuper("initialize",l)}this.setCoords()},_updateObjectsACoords:function(){for(var l=this._objects.length;l--;)this._objects[l].setCoords(!0)},_updateObjectsCoords:function(c){c=c||this.getCenterPoint();for(var l=this._objects.length;l--;)this._updateObjectCoords(this._objects[l],c)},_updateObjectCoords:function(c,l){c.set({left:c.left-l.x,top:c.top-l.y}),c.group=this,c.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(c){var l=!!this.group;return this._restoreObjectsState(),h.util.resetObjectTransform(this),c&&(l&&h.util.removeTransformFromObject(c,this.group.calcTransformMatrix()),this._objects.push(c),c.group=this,c._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,l?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(c){return this._restoreObjectsState(),h.util.resetObjectTransform(this),this.remove(c),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(c){this.dirty=!0,c.group=this,c._set("canvas",this.canvas)},_onObjectRemoved:function(c){this.dirty=!0,delete c.group},_set:function(c,l){var o=this._objects.length;if(this.useSetOnGroup)for(;o--;)this._objects[o].setOnGroup(c,l);if("canvas"===c)for(;o--;)this._objects[o]._set(c,l);h.Object.prototype._set.call(this,c,l)},toObject:function(c){var l=this.includeDefaultValues,o=this._objects.filter(function(f){return!f.excludeFromExport}).map(function(f){var u=f.includeDefaultValues;f.includeDefaultValues=l;var m=f.toObject(c);return f.includeDefaultValues=u,m}),a=h.Object.prototype.toObject.call(this,c);return a.objects=o,a},toDatalessObject:function(c){var l,o=this.sourcePath;if(o)l=o;else{var a=this.includeDefaultValues;l=this._objects.map(function(u){var m=u.includeDefaultValues;u.includeDefaultValues=a;var b=u.toDatalessObject(c);return u.includeDefaultValues=m,b})}var f=h.Object.prototype.toDatalessObject.call(this,c);return f.objects=l,f},render:function(c){this._transformDone=!0,this.callSuper("render",c),this._transformDone=!1},shouldCache:function(){var c=h.Object.prototype.shouldCache.call(this);if(c)for(var l=0,o=this._objects.length;l<o;l++)if(this._objects[l].willDrawShadow())return this.ownCaching=!1,!1;return c},willDrawShadow:function(){if(h.Object.prototype.willDrawShadow.call(this))return!0;for(var c=0,l=this._objects.length;c<l;c++)if(this._objects[c].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(c){for(var l=0,o=this._objects.length;l<o;l++)this._objects[l].render(c);this._drawClipPath(c,this.clipPath)},isCacheDirty:function(c){if(this.callSuper("isCacheDirty",c))return!0;if(!this.statefullCache)return!1;for(var l=0,o=this._objects.length;l<o;l++)if(this._objects[l].isCacheDirty(!0)){if(this._cacheCanvas){var a=this.cacheWidth/this.zoomX,f=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-a/2,-f/2,a,f)}return!0}return!1},_restoreObjectsState:function(){var c=this.calcOwnMatrix();return this._objects.forEach(function(l){h.util.addTransformToObject(l,c),delete l.group,l.setCoords()}),this},destroy:function(){return this._objects.forEach(function(c){c.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(c){c.dispose&&c.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var c=this._objects,l=this.canvas;this._objects=[];var o=this.toObject();delete o.objects;var a=new h.ActiveSelection([]);return a.set(o),a.type="activeSelection",l.remove(this),c.forEach(function(f){f.group=a,f.dirty=!0,l.add(f)}),a.canvas=l,a._objects=c,l._activeObject=a,a.setCoords(),a}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(l){l.setCoords(!0)}),this},_calcBounds:function(c){for(var a,f,u,C,l=[],o=[],m=["tr","br","bl","tl"],b=0,v=this._objects.length,x=m.length;b<v;++b){for(u=(a=this._objects[b]).calcACoords(),C=0;C<x;C++)l.push(u[f=m[C]].x),o.push(u[f].y);a.aCoords=u}this._getBounds(l,o,c)},_getBounds:function(c,l,o){var a=new h.Point(p(c),p(l)),f=new h.Point(g(c),g(l)),u=a.y||0,m=a.x||0,v=f.y-a.y||0;this.width=f.x-a.x||0,this.height=v,o||this.setPositionByOrigin({x:m,y:u},"left","top")},_toSVG:function(c){for(var l=["<g ","COMMON_PARTS"," >\n"],o=0,a=this._objects.length;o<a;o++)l.push("\t\t",this._objects[o].toSVG(c));return l.push("</g>\n"),l},getSvgStyles:function(){var l=this.visible?"":" visibility: hidden;";return[void 0!==this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",this.getSvgFilter(),l].join("")},toClipPathSVG:function(c){for(var l=[],o=0,a=this._objects.length;o<a;o++)l.push("\t",this._objects[o].toClipPathSVG(c));return this._createBaseClipPathSVGMarkup(l,{reviver:c})}}),h.Group.fromObject=function(c,l){var o=c.objects,a=h.util.object.clone(c,!0);delete a.objects,"string"!=typeof o?h.util.enlivenObjects(o,function(f){h.util.enlivenObjectEnlivables(c,a,function(){l&&l(new h.Group(f,a,!0))})}):h.loadSVGFromURL(o,function(f){var u=h.util.groupSVGElements(f,c,o),m=a.clipPath;delete a.clipPath,u.set(a),m?h.util.enlivenObjects([m],function(b){u.clipPath=b[0],l&&l(u)}):l&&l(u)})})}($),function(_){"use strict";var h=_.fabric||(_.fabric={});h.ActiveSelection||(h.ActiveSelection=h.util.createClass(h.Group,{type:"activeSelection",initialize:function(p,g){g=g||{},this._objects=p||[];for(var c=this._objects.length;c--;)this._objects[c].group=this;g.originX&&(this.originX=g.originX),g.originY&&(this.originY=g.originY),this._calcBounds(),this._updateObjectsCoords(),h.Object.prototype.initialize.call(this,g),this.setCoords()},toGroup:function(){var p=this._objects.concat();this._objects=[];var g=h.Object.prototype.toObject.call(this),c=new h.Group([]);if(delete g.type,c.set(g),p.forEach(function(o){o.canvas.remove(o),o.group=c}),c._objects=p,!this.canvas)return c;var l=this.canvas;return l.add(c),l._activeObject=c,c.setCoords(),c},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(p,g,c){p.save(),p.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",p,g),void 0===(c=c||{}).hasControls&&(c.hasControls=!1),c.forActiveSelection=!0;for(var l=0,o=this._objects.length;l<o;l++)this._objects[l]._renderControls(p,c);p.restore()}}),h.ActiveSelection.fromObject=function(p,g){h.util.enlivenObjects(p.objects,function(c){delete p.objects,g&&g(new h.ActiveSelection(c,p,!0))})})}($),function(_){"use strict";var h=S.util.object.extend;_.fabric||(_.fabric={}),_.fabric.Image?S.warn("fabric.Image is already defined."):(S.Image=S.util.createClass(S.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:S.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:S.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(p,g){g||(g={}),this.filters=[],this.cacheKey="texture"+S.Object.__uid++,this.callSuper("initialize",g),this._initElement(p,g)},getElement:function(){return this._element||{}},setElement:function(p,g){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=p,this._originalElement=p,this._initConfig(g),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(p){var g=S.filterBackend;g&&g.evictCachesForKey&&g.evictCachesForKey(p)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(p){S.util.cleanUpJsdomNode(this[p]),this[p]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var p=this.getElement();return{width:p.naturalWidth||p.width,height:p.naturalHeight||p.height}},_stroke:function(p){if(this.stroke&&0!==this.strokeWidth){var g=this.width/2,c=this.height/2;p.beginPath(),p.moveTo(-g,-c),p.lineTo(g,-c),p.lineTo(g,c),p.lineTo(-g,c),p.lineTo(-g,-c),p.closePath()}},toObject:function(p){var g=[];this.filters.forEach(function(l){l&&g.push(l.toObject())});var c=h(this.callSuper("toObject",["cropX","cropY"].concat(p)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:g});return this.resizeFilter&&(c.resizeFilter=this.resizeFilter.toObject()),c},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c,p=[],g=[],l=this._element,o=-this.width/2,a=-this.height/2,f="",u="";if(!l)return[];if(this.hasCrop()){var m=S.Object.__uid++;p.push('<clipPath id="imageCrop_'+m+'">\n','\t<rect x="'+o+'" y="'+a+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),f=' clip-path="url(#imageCrop_'+m+')" '}if(this.imageSmoothing||(u='" image-rendering="optimizeSpeed'),g.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',o-this.cropX,'" y="',a-this.cropY,'" width="',l.width||l.naturalWidth,'" height="',l.height||l.height,u,'"',f,"></image>\n"),this.stroke||this.strokeDashArray){var b=this.fill;this.fill=null,c=["\t<rect ",'x="',o,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=b}return"fill"!==this.paintFirst?p.concat(c,g):p.concat(g,c)},getSrc:function(p){var g=p?this._element:this._originalElement;return g?g.toDataURL?g.toDataURL():this.srcFromAttribute?g.getAttribute("src"):g.src:this.src||""},setSrc:function(p,g,c){return S.util.loadImage(p,function(l,o){this.setElement(l,c),this._setWidthHeight(),g&&g(this,o)},this,c&&c.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var p=this.resizeFilter,g=this.minimumScaleTrigger,c=this.getTotalObjectScaling(),l=c.scaleX,o=c.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!p||l>g&&o>g)return this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=l,void(this._lastScaleY=o);S.filterBackend||(S.filterBackend=S.initFilterBackend());var f=S.util.createCanvasElement(),u=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,m=a.width,b=a.height;f.width=m,f.height=b,this._element=f,this._lastScaleX=p.scaleX=l,this._lastScaleY=p.scaleY=o,S.filterBackend.applyFilters([p],a,m,b,this._element,u),this._filterScalingX=f.width/this._originalElement.width,this._filterScalingY=f.height/this._originalElement.height},applyFilters:function(p){if(p=(p=p||this.filters||[]).filter(function(a){return a&&!a.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===p.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var g=this._originalElement,c=g.naturalWidth||g.width,l=g.naturalHeight||g.height;if(this._element===this._originalElement){var o=S.util.createCanvasElement();o.width=c,o.height=l,this._element=o,this._filteredEl=o}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,c,l),this._lastScaleX=1,this._lastScaleY=1;return S.filterBackend||(S.filterBackend=S.initFilterBackend()),S.filterBackend.applyFilters(p,this._originalElement,c,l,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(p){S.util.setImageSmoothing(p,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(p),this._renderPaintInOrder(p)},drawCacheOnCanvas:function(p){S.util.setImageSmoothing(p,this.imageSmoothing),S.Object.prototype.drawCacheOnCanvas.call(this,p)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(p){var g=this._element;if(g){var c=this._filterScalingX,l=this._filterScalingY,o=this.width,a=this.height,f=Math.min,u=Math.max,m=u(this.cropX,0),b=u(this.cropY,0),v=g.naturalWidth||g.width,C=g.naturalHeight||g.height,x=m*c,T=b*l,I=f(o*c,v-x),N=f(a*l,C-T),H=-o/2,W=-a/2,K=f(o,v/c-m),ne=f(a,C/l-b);g&&p.drawImage(g,x,T,I,N,H,W,K,ne)}},_needsResize:function(){var p=this.getTotalObjectScaling();return p.scaleX!==this._lastScaleX||p.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(p,g){this.setElement(S.util.getById(p),g),S.util.addClass(this.getElement(),S.Image.CSS_CANVAS)},_initConfig:function(p){p||(p={}),this.setOptions(p),this._setWidthHeight(p)},_initFilters:function(p,g){p&&p.length?S.util.enlivenObjects(p,function(c){g&&g(c)},"fabric.Image.filters"):g&&g()},_setWidthHeight:function(p){p||(p={});var g=this.getElement();this.width=p.width||g.naturalWidth||g.width||0,this.height=p.height||g.naturalHeight||g.height||0},parsePreserveAspectRatioAttribute:function(){var b,p=S.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),g=this._element.width,c=this._element.height,l=1,o=1,a=0,f=0,u=0,m=0,v=this.width,C=this.height,x={width:v,height:C};return!p||"none"===p.alignX&&"none"===p.alignY?(l=v/g,o=C/c):("meet"===p.meetOrSlice&&(b=(v-g*(l=o=S.util.findScaleToFit(this._element,x)))/2,"Min"===p.alignX&&(a=-b),"Max"===p.alignX&&(a=b),b=(C-c*o)/2,"Min"===p.alignY&&(f=-b),"Max"===p.alignY&&(f=b)),"slice"===p.meetOrSlice&&(b=g-v/(l=o=S.util.findScaleToCover(this._element,x)),"Mid"===p.alignX&&(u=b/2),"Max"===p.alignX&&(u=b),b=c-C/o,"Mid"===p.alignY&&(m=b/2),"Max"===p.alignY&&(m=b),g=v/l,c=C/o)),{width:g,height:c,scaleX:l,scaleY:o,offsetLeft:a,offsetTop:f,cropX:u,cropY:m}}}),S.Image.CSS_CANVAS="canvas-img",S.Image.prototype.getSvgSrc=S.Image.prototype.getSrc,S.Image.fromObject=function(p,g){var c=S.util.object.clone(p);S.util.loadImage(c.src,function(l,o){o?g&&g(null,!0):S.Image.prototype._initFilters.call(c,c.filters,function(a){c.filters=a||[],S.Image.prototype._initFilters.call(c,[c.resizeFilter],function(f){c.resizeFilter=f[0],S.util.enlivenObjectEnlivables(c,c,function(){var u=new S.Image(l,c);g(u,!1)})})})},null,c.crossOrigin)},S.Image.fromURL=function(p,g,c){S.util.loadImage(p,function(l,o){g&&g(new S.Image(l,c),o)},null,c&&c.crossOrigin)},S.Image.ATTRIBUTE_NAMES=S.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),S.Image.fromElement=function(p,g,c){var l=S.parseAttributes(p,S.Image.ATTRIBUTE_NAMES);S.Image.fromURL(l["xlink:href"],g,h(c?S.util.object.clone(c):{},l))})}($),S.util.object.extend(S.Object.prototype,{_getAngleValueForStraighten:function(){var _=this.angle%360;return _>0?90*Math.round((_-1)/90):90*Math.round(_/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(_){var h=function(){},p=(_=_||{}).onComplete||h,g=_.onChange||h,c=this;return S.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(l){c.rotate(l),g()},onComplete:function(){c.setCoords(),p()}})}}),S.util.object.extend(S.StaticCanvas.prototype,{straightenObject:function(_){return _.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(_){return _.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){"use strict";function _(p,g){var c="precision "+g+" float;\nvoid main(){}",l=p.createShader(p.FRAGMENT_SHADER);return p.shaderSource(l,c),p.compileShader(l),!!p.getShaderParameter(l,p.COMPILE_STATUS)}function h(p){p&&p.tileSize&&(this.tileSize=p.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}S.isWebglSupported=function(p){if(S.isLikelyNode)return!1;p=p||S.WebglFilterBackend.prototype.tileSize;var g=document.createElement("canvas"),c=g.getContext("webgl")||g.getContext("experimental-webgl"),l=!1;if(c){S.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE),l=S.maxTextureSize>=p;for(var o=["highp","mediump","lowp"],a=0;a<3;a++)if(_(c,o[a])){S.webGlPrecision=o[a];break}}return this.isSupported=l,l},S.WebglFilterBackend=h,h.prototype={tileSize:2048,resources:{},setupGLContext:function(p,g){this.dispose(),this.createWebGLCanvas(p,g),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(p,g)},chooseFastestCopyGLTo2DMethod:function(p,g){var l,c=void 0!==window.performance;try{new ImageData(1,1),l=!0}catch(x){l=!1}var o="undefined"!=typeof ArrayBuffer,a="undefined"!=typeof Uint8ClampedArray;if(c&&l&&o&&a){var f=S.util.createCanvasElement(),u=new ArrayBuffer(p*g*4);if(S.forceGLPutImageData)return this.imageBuffer=u,void(this.copyGLTo2D=le);var b,v,m={imageBuffer:u,destinationWidth:p,destinationHeight:g,targetCanvas:f};f.width=p,f.height=g,b=window.performance.now(),be.call(m,this.gl,m),v=window.performance.now()-b,b=window.performance.now(),le.call(m,this.gl,m),v>window.performance.now()-b?(this.imageBuffer=u,this.copyGLTo2D=le):this.copyGLTo2D=be}},createWebGLCanvas:function(p,g){var c=S.util.createCanvasElement();c.width=p,c.height=g;var l={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},o=c.getContext("webgl",l);o||(o=c.getContext("experimental-webgl",l)),o&&(o.clearColor(0,0,0,0),this.canvas=c,this.gl=o)},applyFilters:function(p,g,c,l,o,a){var u,f=this.gl;a&&(u=this.getCachedTexture(a,g));var m={originalWidth:g.width||g.originalWidth,originalHeight:g.height||g.originalHeight,sourceWidth:c,sourceHeight:l,destinationWidth:c,destinationHeight:l,context:f,sourceTexture:this.createTexture(f,c,l,!u&&g),targetTexture:this.createTexture(f,c,l),originalTexture:u||this.createTexture(f,c,l,!u&&g),passes:p.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:o},b=f.createFramebuffer();return f.bindFramebuffer(f.FRAMEBUFFER,b),p.forEach(function(v){v&&v.applyTo(m)}),function(_){var h=_.targetCanvas,c=_.destinationWidth,l=_.destinationHeight;(h.width!==c||h.height!==l)&&(h.width=c,h.height=l)}(m),this.copyGLTo2D(f,m),f.bindTexture(f.TEXTURE_2D,null),f.deleteTexture(m.sourceTexture),f.deleteTexture(m.targetTexture),f.deleteFramebuffer(b),o.getContext("2d").setTransform(1,0,0,1,0,0),m},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(p,g,c,l){var o=p.createTexture();return p.bindTexture(p.TEXTURE_2D,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),l?p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,l):p.texImage2D(p.TEXTURE_2D,0,p.RGBA,g,c,0,p.RGBA,p.UNSIGNED_BYTE,null),o},getCachedTexture:function(p,g){if(this.textureCache[p])return this.textureCache[p];var c=this.createTexture(this.gl,g.width,g.height,g);return this.textureCache[p]=c,c},evictCachesForKey:function(p){this.textureCache[p]&&(this.gl.deleteTexture(this.textureCache[p]),delete this.textureCache[p])},copyGLTo2D:be,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var p=this.gl,g={renderer:"",vendor:""};if(!p)return g;var c=p.getExtension("WEBGL_debug_renderer_info");if(c){var l=p.getParameter(c.UNMASKED_RENDERER_WEBGL),o=p.getParameter(c.UNMASKED_VENDOR_WEBGL);l&&(g.renderer=l.toLowerCase()),o&&(g.vendor=o.toLowerCase())}return this.gpuInfo=g,g}}}(),function(){"use strict";var _=function(){};function h(){}S.Canvas2dFilterBackend=h,h.prototype={evictCachesForKey:_,dispose:_,clearWebGLCaches:_,resources:{},applyFilters:function(p,g,c,l,o){var a=o.getContext("2d");a.drawImage(g,0,0,c,l);var m={sourceWidth:c,sourceHeight:l,imageData:a.getImageData(0,0,c,l),originalEl:g,originalImageData:a.getImageData(0,0,c,l),canvasEl:o,ctx:a,filterBackend:this};return p.forEach(function(b){b.applyTo(m)}),(m.imageData.width!==c||m.imageData.height!==l)&&(o.width=m.imageData.width,o.height=m.imageData.height),a.putImageData(m.imageData,0,0),m}}}(),S.Image=S.Image||{},S.Image.filters=S.Image.filters||{},S.Image.filters.BaseFilter=S.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(_){_&&this.setOptions(_)},setOptions:function(_){for(var h in _)this[h]=_[h]},createProgram:function(_,h,p){h=h||this.fragmentSource,p=p||this.vertexSource,"highp"!==S.webGlPrecision&&(h=h.replace(/precision highp float/g,"precision "+S.webGlPrecision+" float"));var g=_.createShader(_.VERTEX_SHADER);if(_.shaderSource(g,p),_.compileShader(g),!_.getShaderParameter(g,_.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+_.getShaderInfoLog(g));var c=_.createShader(_.FRAGMENT_SHADER);if(_.shaderSource(c,h),_.compileShader(c),!_.getShaderParameter(c,_.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+_.getShaderInfoLog(c));var l=_.createProgram();if(_.attachShader(l,g),_.attachShader(l,c),_.linkProgram(l),!_.getProgramParameter(l,_.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+_.getProgramInfoLog(l));var o=this.getAttributeLocations(_,l),a=this.getUniformLocations(_,l)||{};return a.uStepW=_.getUniformLocation(l,"uStepW"),a.uStepH=_.getUniformLocation(l,"uStepH"),{program:l,attributeLocations:o,uniformLocations:a}},getAttributeLocations:function(_,h){return{aPosition:_.getAttribLocation(h,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(_,h,p){var g=h.aPosition,c=_.createBuffer();_.bindBuffer(_.ARRAY_BUFFER,c),_.enableVertexAttribArray(g),_.vertexAttribPointer(g,2,_.FLOAT,!1,0,0),_.bufferData(_.ARRAY_BUFFER,p,_.STATIC_DRAW)},_setupFrameBuffer:function(_){var p,g,h=_.context;_.passes>1?(g=_.destinationHeight,(_.sourceWidth!==(p=_.destinationWidth)||_.sourceHeight!==g)&&(h.deleteTexture(_.targetTexture),_.targetTexture=_.filterBackend.createTexture(h,p,g)),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,_.targetTexture,0)):(h.bindFramebuffer(h.FRAMEBUFFER,null),h.finish())},_swapTextures:function(_){_.passes--,_.pass++;var h=_.targetTexture;_.targetTexture=_.sourceTexture,_.sourceTexture=h},isNeutralState:function(){var _=this.mainParameter,h=S.Image.filters[this.type].prototype;if(_){if(Array.isArray(h[_])){for(var p=h[_].length;p--;)if(this[_][p]!==h[_][p])return!1;return!0}return h[_]===this[_]}return!1},applyTo:function(_){_.webgl?(this._setupFrameBuffer(_),this.applyToWebGL(_),this._swapTextures(_)):this.applyTo2d(_)},retrieveShader:function(_){return _.programCache.hasOwnProperty(this.type)||(_.programCache[this.type]=this.createProgram(_.context)),_.programCache[this.type]},applyToWebGL:function(_){var h=_.context,p=this.retrieveShader(_);h.bindTexture(h.TEXTURE_2D,0===_.pass&&_.originalTexture?_.originalTexture:_.sourceTexture),h.useProgram(p.program),this.sendAttributeData(h,p.attributeLocations,_.aPosition),h.uniform1f(p.uniformLocations.uStepW,1/_.sourceWidth),h.uniform1f(p.uniformLocations.uStepH,1/_.sourceHeight),this.sendUniformData(h,p.uniformLocations),h.viewport(0,0,_.destinationWidth,_.destinationHeight),h.drawArrays(h.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(_,h,p){_.activeTexture(p),_.bindTexture(_.TEXTURE_2D,h),_.activeTexture(_.TEXTURE0)},unbindAdditionalTexture:function(_,h){_.activeTexture(h),_.bindTexture(_.TEXTURE_2D,null),_.activeTexture(_.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(_){this[this.mainParameter]=_},sendUniformData:function(){},createHelpLayer:function(_){if(!_.helpLayer){var h=document.createElement("canvas");h.width=_.sourceWidth,h.height=_.sourceHeight,_.helpLayer=h}},toObject:function(){var _={type:this.type},h=this.mainParameter;return h&&(_[h]=this[h]),_},toJSON:function(){return this.toObject()}}),S.Image.filters.BaseFilter.fromObject=function(_,h){var p=new S.Image.filters[_.type](_);return h&&h(p),p},function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.ColorMatrix=(0,h.util.createClass)(p.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(c){this.callSuper("initialize",c),this.matrix=this.matrix.slice(0)},applyTo2d:function(c){var u,m,b,v,C,o=c.imageData.data,a=o.length,f=this.matrix,x=this.colorsOnly;for(C=0;C<a;C+=4)u=o[C],m=o[C+1],b=o[C+2],x?(o[C]=u*f[0]+m*f[1]+b*f[2]+255*f[4],o[C+1]=u*f[5]+m*f[6]+b*f[7]+255*f[9],o[C+2]=u*f[10]+m*f[11]+b*f[12]+255*f[14]):(o[C]=u*f[0]+m*f[1]+b*f[2]+(v=o[C+3])*f[3]+255*f[4],o[C+1]=u*f[5]+m*f[6]+b*f[7]+v*f[8]+255*f[9],o[C+2]=u*f[10]+m*f[11]+b*f[12]+v*f[13]+255*f[14],o[C+3]=u*f[15]+m*f[16]+b*f[17]+v*f[18]+255*f[19])},getUniformLocations:function(c,l){return{uColorMatrix:c.getUniformLocation(l,"uColorMatrix"),uConstants:c.getUniformLocation(l,"uConstants")}},sendUniformData:function(c,l){var o=this.matrix,f=[o[4],o[9],o[14],o[19]];c.uniformMatrix4fv(l.uColorMatrix,!1,[o[0],o[1],o[2],o[3],o[5],o[6],o[7],o[8],o[10],o[11],o[12],o[13],o[15],o[16],o[17],o[18]]),c.uniform4fv(l.uConstants,f)}}),h.Image.filters.ColorMatrix.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.Brightness=(0,h.util.createClass)(p.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(c){if(0!==this.brightness){var a,o=c.imageData.data,f=o.length,u=Math.round(255*this.brightness);for(a=0;a<f;a+=4)o[a]=o[a]+u,o[a+1]=o[a+1]+u,o[a+2]=o[a+2]+u}},getUniformLocations:function(c,l){return{uBrightness:c.getUniformLocation(l,"uBrightness")}},sendUniformData:function(c,l){c.uniform1f(l.uBrightness,this.brightness)}}),h.Image.filters.Brightness.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.object.extend,g=h.Image.filters;g.Convolute=(0,h.util.createClass)(g.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(l){var o=Math.sqrt(this.matrix.length),a=this.type+"_"+o+"_"+(this.opaque?1:0),f=this.fragmentSource[a];return l.programCache.hasOwnProperty(a)||(l.programCache[a]=this.createProgram(l.context,f)),l.programCache[a]},applyTo2d:function(l){var I,N,H,W,K,ne,ae,ce,Y,de,fe,me,B,o=l.imageData,a=o.data,f=this.matrix,u=Math.round(Math.sqrt(f.length)),m=Math.floor(u/2),b=o.width,v=o.height,C=l.ctx.createImageData(b,v),x=C.data,T=this.opaque?1:0;for(fe=0;fe<v;fe++)for(de=0;de<b;de++){for(K=4*(fe*b+de),I=0,N=0,H=0,W=0,B=0;B<u;B++)for(me=0;me<u;me++)ne=de+me-m,!((ae=fe+B-m)<0||ae>=v||ne<0||ne>=b)&&(I+=a[ce=4*(ae*b+ne)]*(Y=f[B*u+me]),N+=a[ce+1]*Y,H+=a[ce+2]*Y,T||(W+=a[ce+3]*Y));x[K]=I,x[K+1]=N,x[K+2]=H,x[K+3]=T?a[K+3]:W}l.imageData=C},getUniformLocations:function(l,o){return{uMatrix:l.getUniformLocation(o,"uMatrix"),uOpaque:l.getUniformLocation(o,"uOpaque"),uHalfSize:l.getUniformLocation(o,"uHalfSize"),uSize:l.getUniformLocation(o,"uSize")}},sendUniformData:function(l,o){l.uniform1fv(o.uMatrix,this.matrix)},toObject:function(){return p(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),h.Image.filters.Convolute.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.Grayscale=(0,h.util.createClass)(p.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(c){var a,u,o=c.imageData.data,f=o.length,m=this.mode;for(a=0;a<f;a+=4)"average"===m?u=(o[a]+o[a+1]+o[a+2])/3:"lightness"===m?u=(Math.min(o[a],o[a+1],o[a+2])+Math.max(o[a],o[a+1],o[a+2]))/2:"luminosity"===m&&(u=.21*o[a]+.72*o[a+1]+.07*o[a+2]),o[a]=u,o[a+1]=u,o[a+2]=u},retrieveShader:function(c){var l=this.type+"_"+this.mode;return c.programCache.hasOwnProperty(l)||(c.programCache[l]=this.createProgram(c.context,this.fragmentSource[this.mode])),c.programCache[l]},getUniformLocations:function(c,l){return{uMode:c.getUniformLocation(l,"uMode")}},sendUniformData:function(c,l){c.uniform1i(l.uMode,1)},isNeutralState:function(){return!1}}),h.Image.filters.Grayscale.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.Invert=(0,h.util.createClass)(p.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(c){var a,o=c.imageData.data,f=o.length;for(a=0;a<f;a+=4)o[a]=255-o[a],o[a+1]=255-o[a+1],o[a+2]=255-o[a+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(c,l){return{uInvert:c.getUniformLocation(l,"uInvert")}},sendUniformData:function(c,l){c.uniform1i(l.uInvert,this.invert)}}),h.Image.filters.Invert.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.object.extend,g=h.Image.filters;g.Noise=(0,h.util.createClass)(g.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(l){if(0!==this.noise){var f,u,b,a=l.imageData.data,m=this.noise;for(f=0,u=a.length;f<u;f+=4)b=(.5-Math.random())*m,a[f]+=b,a[f+1]+=b,a[f+2]+=b}},getUniformLocations:function(l,o){return{uNoise:l.getUniformLocation(o,"uNoise"),uSeed:l.getUniformLocation(o,"uSeed")}},sendUniformData:function(l,o){l.uniform1f(o.uNoise,this.noise/255),l.uniform1f(o.uSeed,Math.random())},toObject:function(){return p(this.callSuper("toObject"),{noise:this.noise})}}),h.Image.filters.Noise.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.Pixelate=(0,h.util.createClass)(p.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(c){var u,m,b,v,C,x,T,I,N,H,W,l=c.imageData,o=l.data,a=l.height,f=l.width;for(m=0;m<a;m+=this.blocksize)for(b=0;b<f;b+=this.blocksize)for(v=o[u=4*m*f+4*b],C=o[u+1],x=o[u+2],T=o[u+3],H=Math.min(m+this.blocksize,a),W=Math.min(b+this.blocksize,f),I=m;I<H;I++)for(N=b;N<W;N++)o[u=4*I*f+4*N]=v,o[u+1]=C,o[u+2]=x,o[u+3]=T},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(c,l){return{uBlocksize:c.getUniformLocation(l,"uBlocksize"),uStepW:c.getUniformLocation(l,"uStepW"),uStepH:c.getUniformLocation(l,"uStepH")}},sendUniformData:function(c,l){c.uniform1f(l.uBlocksize,this.blocksize)}}),h.Image.filters.Pixelate.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.object.extend,g=h.Image.filters;g.RemoveColor=(0,h.util.createClass)(g.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(l){var f,m,b,v,a=l.imageData.data,u=255*this.distance,C=new h.Color(this.color).getSource(),x=[C[0]-u,C[1]-u,C[2]-u],T=[C[0]+u,C[1]+u,C[2]+u];for(f=0;f<a.length;f+=4)b=a[f+1],v=a[f+2],(m=a[f])>x[0]&&b>x[1]&&v>x[2]&&m<T[0]&&b<T[1]&&v<T[2]&&(a[f+3]=0)},getUniformLocations:function(l,o){return{uLow:l.getUniformLocation(o,"uLow"),uHigh:l.getUniformLocation(o,"uHigh")}},sendUniformData:function(l,o){var a=new h.Color(this.color).getSource(),f=parseFloat(this.distance),m=[a[0]/255+f,a[1]/255+f,a[2]/255+f,1];l.uniform4fv(o.uLow,[0+a[0]/255-f,0+a[1]/255-f,0+a[2]/255-f,1]),l.uniform4fv(o.uHigh,m)},toObject:function(){return p(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),h.Image.filters.RemoveColor.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters,g=h.util.createClass,c={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var l in c)p[l]=g(p.ColorMatrix,{type:l,matrix:c[l],mainParameter:!1,colorsOnly:!0}),h.Image.filters[l].fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric,p=h.Image.filters;p.BlendColor=(0,h.util.createClass)(p.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(c){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[c]+"}\n}"},retrieveShader:function(c){var o,l=this.type+"_"+this.mode;return c.programCache.hasOwnProperty(l)||(o=this.buildSource(this.mode),c.programCache[l]=this.createProgram(c.context,o)),c.programCache[l]},applyTo2d:function(c){var f,u,m,b,v,C,x,o=c.imageData.data,a=o.length,T=1-this.alpha;f=(x=new h.Color(this.color).getSource())[0]*this.alpha,u=x[1]*this.alpha,m=x[2]*this.alpha;for(var I=0;I<a;I+=4)switch(b=o[I],v=o[I+1],C=o[I+2],this.mode){case"multiply":o[I]=b*f/255,o[I+1]=v*u/255,o[I+2]=C*m/255;break;case"screen":o[I]=255-(255-b)*(255-f)/255,o[I+1]=255-(255-v)*(255-u)/255,o[I+2]=255-(255-C)*(255-m)/255;break;case"add":o[I]=b+f,o[I+1]=v+u,o[I+2]=C+m;break;case"diff":case"difference":o[I]=Math.abs(b-f),o[I+1]=Math.abs(v-u),o[I+2]=Math.abs(C-m);break;case"subtract":o[I]=b-f,o[I+1]=v-u,o[I+2]=C-m;break;case"darken":o[I]=Math.min(b,f),o[I+1]=Math.min(v,u),o[I+2]=Math.min(C,m);break;case"lighten":o[I]=Math.max(b,f),o[I+1]=Math.max(v,u),o[I+2]=Math.max(C,m);break;case"overlay":o[I]=f<128?2*b*f/255:255-2*(255-b)*(255-f)/255,o[I+1]=u<128?2*v*u/255:255-2*(255-v)*(255-u)/255,o[I+2]=m<128?2*C*m/255:255-2*(255-C)*(255-m)/255;break;case"exclusion":o[I]=f+b-2*f*b/255,o[I+1]=u+v-2*u*v/255,o[I+2]=m+C-2*m*C/255;break;case"tint":o[I]=f+b*T,o[I+1]=u+v*T,o[I+2]=m+C*T}},getUniformLocations:function(c,l){return{uColor:c.getUniformLocation(l,"uColor")}},sendUniformData:function(c,l){var o=new h.Color(this.color).getSource();o[0]=this.alpha*o[0]/255,o[1]=this.alpha*o[1]/255,o[2]=this.alpha*o[2]/255,o[3]=this.alpha,c.uniform4fv(l.uColor,o)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),h.Image.filters.BlendColor.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric,p=h.Image.filters;p.BlendImage=(0,h.util.createClass)(p.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(c){var l=this.type+"_"+this.mode,o=this.fragmentSource[this.mode];return c.programCache.hasOwnProperty(l)||(c.programCache[l]=this.createProgram(c.context,o)),c.programCache[l]},applyToWebGL:function(c){var l=c.context,o=this.createTexture(c.filterBackend,this.image);this.bindAdditionalTexture(l,o,l.TEXTURE1),this.callSuper("applyToWebGL",c),this.unbindAdditionalTexture(l,l.TEXTURE1)},createTexture:function(c,l){return c.getCachedTexture(l.cacheKey,l._element)},calculateMatrix:function(){var c=this.image;return[1/c.scaleX,0,0,0,1/c.scaleY,0,-c.left/c._element.width,-c.top/c._element.height,1]},applyTo2d:function(c){var b,v,C,x,T,I,N,H,W,K,ae,l=c.imageData,o=c.filterBackend.resources,a=l.data,f=a.length,u=l.width,m=l.height,ne=this.image;o.blendImage||(o.blendImage=h.util.createCanvasElement()),K=(W=o.blendImage).getContext("2d"),W.width!==u||W.height!==m?(W.width=u,W.height=m):K.clearRect(0,0,u,m),K.setTransform(ne.scaleX,0,0,ne.scaleY,ne.left,ne.top),K.drawImage(ne._element,0,0,u,m),ae=K.getImageData(0,0,u,m).data;for(var ce=0;ce<f;ce+=4)switch(T=a[ce],I=a[ce+1],N=a[ce+2],H=a[ce+3],b=ae[ce],v=ae[ce+1],C=ae[ce+2],x=ae[ce+3],this.mode){case"multiply":a[ce]=T*b/255,a[ce+1]=I*v/255,a[ce+2]=N*C/255,a[ce+3]=H*x/255;break;case"mask":a[ce+3]=x}},getUniformLocations:function(c,l){return{uTransformMatrix:c.getUniformLocation(l,"uTransformMatrix"),uImage:c.getUniformLocation(l,"uImage")}},sendUniformData:function(c,l){var o=this.calculateMatrix();c.uniform1i(l.uImage,1),c.uniformMatrix3fv(l.uTransformMatrix,!1,o)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),h.Image.filters.BlendImage.fromObject=function(c,l){h.Image.fromObject(c.image,function(o){var a=h.util.object.clone(c);a.image=o,l(new h.Image.filters.BlendImage(a))})}}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=Math.pow,g=Math.floor,c=Math.sqrt,l=Math.abs,o=Math.round,a=Math.sin,f=Math.ceil,u=h.Image.filters;u.Resize=(0,h.util.createClass)(u.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(b,v){return{uDelta:b.getUniformLocation(v,"uDelta"),uTaps:b.getUniformLocation(v,"uTaps")}},sendUniformData:function(b,v){b.uniform2fv(v.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),b.uniform1fv(v.uTaps,this.taps)},retrieveShader:function(b){var v=this.getFilterWindow(),C=this.type+"_"+v;if(!b.programCache.hasOwnProperty(C)){var x=this.generateShader(v);b.programCache[C]=this.createProgram(b.context,x)}return b.programCache[C]},getFilterWindow:function(){return Math.ceil(this.lanczosLobes/this.tempScale)},getTaps:function(){for(var b=this.lanczosCreate(this.lanczosLobes),v=this.tempScale,C=this.getFilterWindow(),x=new Array(C),T=1;T<=C;T++)x[T-1]=b(T*v);return x},generateShader:function(b){for(var v=new Array(b),C=this.fragmentSourceTOP,x=1;x<=b;x++)v[x-1]=x+".0 * uDelta";return C+="uniform float uTaps["+b+"];\n",C+="void main() {\n",C+="  vec4 color = texture2D(uTexture, vTexCoord);\n",C+="  float sum = 1.0;\n",v.forEach(function(T,I){C+="  color += texture2D(uTexture, vTexCoord + "+T+") * uTaps["+I+"];\n",C+="  color += texture2D(uTexture, vTexCoord - "+T+") * uTaps["+I+"];\n",C+="  sum += 2.0 * uTaps["+I+"];\n"}),C+="  gl_FragColor = color / sum;\n",C+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(b){b.webgl?(b.passes++,this.width=b.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=b.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),b.destinationWidth=this.dW,this._setupFrameBuffer(b),this.applyToWebGL(b),this._swapTextures(b),b.sourceWidth=b.destinationWidth,this.height=b.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),b.destinationHeight=this.dH,this._setupFrameBuffer(b),this.applyToWebGL(b),this._swapTextures(b),b.sourceHeight=b.destinationHeight):this.applyTo2d(b)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(b){return function(v){if(v>=b||v<=-b)return 0;if(v<1.1920929e-7&&v>-1.1920929e-7)return 1;var C=(v*=Math.PI)/b;return a(v)/v*a(C)/C}},applyTo2d:function(b){var v=b.imageData,C=this.scaleX,x=this.scaleY;this.rcpScaleX=1/C,this.rcpScaleY=1/x;var W,T=v.width,I=v.height,N=o(T*C),H=o(I*x);"sliceHack"===this.resizeType?W=this.sliceByTwo(b,T,I,N,H):"hermite"===this.resizeType?W=this.hermiteFastResize(b,T,I,N,H):"bilinear"===this.resizeType?W=this.bilinearFiltering(b,T,I,N,H):"lanczos"===this.resizeType&&(W=this.lanczosResize(b,T,I,N,H)),b.imageData=W},sliceByTwo:function(b,v,C,x,T){var ce,Y,I=b.imageData,N=.5,H=!1,W=!1,K=v*N,ne=C*N,ae=h.filterBackend.resources,de=0,fe=0,me=v,B=0;for(ae.sliceByTwo||(ae.sliceByTwo=document.createElement("canvas")),((ce=ae.sliceByTwo).width<1.5*v||ce.height<C)&&(ce.width=1.5*v,ce.height=C),(Y=ce.getContext("2d")).clearRect(0,0,1.5*v,C),Y.putImageData(I,0,0),x=g(x),T=g(T);!H||!W;)v=K,C=ne,x<g(K*N)?K=g(K*N):(K=x,H=!0),T<g(ne*N)?ne=g(ne*N):(ne=T,W=!0),Y.drawImage(ce,de,fe,v,C,me,B,K,ne),de=me,fe=B,B+=ne;return Y.getImageData(de,fe,x,T)},lanczosResize:function(b,v,C,x,T){var N=b.imageData.data,H=b.ctx.createImageData(x,T),W=H.data,K=this.lanczosCreate(this.lanczosLobes),ne=this.rcpScaleX,ae=this.rcpScaleY,ce=2/this.rcpScaleX,Y=2/this.rcpScaleY,de=f(ne*this.lanczosLobes/2),fe=f(ae*this.lanczosLobes/2),me={},B={},L={};return function I(D){var M,E,P,A,k,R,j,z,Q,ee,se;for(B.x=(D+.5)*ne,L.x=g(B.x),M=0;M<T;M++){for(B.y=(M+.5)*ae,L.y=g(B.y),k=0,R=0,j=0,z=0,Q=0,E=L.x-de;E<=L.x+de;E++)if(!(E<0||E>=v)){ee=g(1e3*l(E-B.x)),me[ee]||(me[ee]={});for(var J=L.y-fe;J<=L.y+fe;J++)J<0||J>=C||(se=g(1e3*l(J-B.y)),me[ee][se]||(me[ee][se]=K(c(p(ee*ce,2)+p(se*Y,2))/1e3)),(P=me[ee][se])>0&&(k+=P,R+=P*N[A=4*(J*v+E)],j+=P*N[A+1],z+=P*N[A+2],Q+=P*N[A+3]))}W[A=4*(M*x+D)]=R/k,W[A+1]=j/k,W[A+2]=z/k,W[A+3]=Q/k}return++D<x?I(D):H}(0)},bilinearFiltering:function(b,v,C,x,T){var K,ne,ae,ce,Y,de,fe,L,B=0,D=this.rcpScaleX,M=this.rcpScaleY,E=4*(v-1),A=b.imageData.data,k=b.ctx.createImageData(x,T),R=k.data;for(ae=0;ae<T;ae++)for(ce=0;ce<x;ce++)for(Y=D*ce-(K=g(D*ce)),de=M*ae-(ne=g(M*ae)),L=4*(ne*v+K),fe=0;fe<4;fe++)R[B++]=A[L+fe]*(1-Y)*(1-de)+A[L+4+fe]*Y*(1-de)+A[L+E+fe]*de*(1-Y)+A[L+E+4+fe]*Y*de;return k},hermiteFastResize:function(b,v,C,x,T){for(var I=this.rcpScaleX,N=this.rcpScaleY,H=f(I/2),W=f(N/2),ne=b.imageData.data,ae=b.ctx.createImageData(x,T),ce=ae.data,Y=0;Y<T;Y++)for(var de=0;de<x;de++){for(var fe=4*(de+Y*x),me=0,B=0,L=0,D=0,M=0,E=0,P=0,A=(Y+.5)*N,k=g(Y*N);k<(Y+1)*N;k++)for(var R=l(A-(k+.5))/W,j=(de+.5)*I,z=R*R,Q=g(de*I);Q<(de+1)*I;Q++){var ee=l(j-(Q+.5))/H,se=c(z+ee*ee);se>1&&se<-1||(me=2*se*se*se-3*se*se+1)>0&&(P+=me*ne[3+(ee=4*(Q+k*v))],L+=me,ne[ee+3]<255&&(me=me*ne[ee+3]/250),D+=me*ne[ee],M+=me*ne[ee+1],E+=me*ne[ee+2],B+=me)}ce[fe]=D/B,ce[fe+1]=M/B,ce[fe+2]=E/B,ce[fe+3]=P/L}return ae},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),h.Image.filters.Resize.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.Contrast=(0,h.util.createClass)(p.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(c){if(0!==this.contrast){var o,f=c.imageData.data,a=f.length,u=Math.floor(255*this.contrast),m=259*(u+255)/(255*(259-u));for(o=0;o<a;o+=4)f[o]=m*(f[o]-128)+128,f[o+1]=m*(f[o+1]-128)+128,f[o+2]=m*(f[o+2]-128)+128}},getUniformLocations:function(c,l){return{uContrast:c.getUniformLocation(l,"uContrast")}},sendUniformData:function(c,l){c.uniform1f(l.uContrast,this.contrast)}}),h.Image.filters.Contrast.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.Saturation=(0,h.util.createClass)(p.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(c){if(0!==this.saturation){var u,m,o=c.imageData.data,a=o.length,f=-this.saturation;for(u=0;u<a;u+=4)m=Math.max(o[u],o[u+1],o[u+2]),o[u]+=m!==o[u]?(m-o[u])*f:0,o[u+1]+=m!==o[u+1]?(m-o[u+1])*f:0,o[u+2]+=m!==o[u+2]?(m-o[u+2])*f:0}},getUniformLocations:function(c,l){return{uSaturation:c.getUniformLocation(l,"uSaturation")}},sendUniformData:function(c,l){c.uniform1f(l.uSaturation,-this.saturation)}}),h.Image.filters.Saturation.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.Vibrance=(0,h.util.createClass)(p.BaseFilter,{type:"Vibrance",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uVibrance;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat max = max(color.r, max(color.g, color.b));\nfloat avg = (color.r + color.g + color.b) / 3.0;\nfloat amt = (abs(max - avg) * 2.0) * uVibrance;\ncolor.r += max != color.r ? (max - color.r) * amt : 0.00;\ncolor.g += max != color.g ? (max - color.g) * amt : 0.00;\ncolor.b += max != color.b ? (max - color.b) * amt : 0.00;\ngl_FragColor = color;\n}",vibrance:0,mainParameter:"vibrance",applyTo2d:function(c){if(0!==this.vibrance){var u,m,v,o=c.imageData.data,a=o.length,f=-this.vibrance;for(u=0;u<a;u+=4)m=Math.max(o[u],o[u+1],o[u+2]),v=2*Math.abs(m-(o[u]+o[u+1]+o[u+2])/3)/255*f,o[u]+=m!==o[u]?(m-o[u])*v:0,o[u+1]+=m!==o[u+1]?(m-o[u+1])*v:0,o[u+2]+=m!==o[u+2]?(m-o[u+2])*v:0}},getUniformLocations:function(c,l){return{uVibrance:c.getUniformLocation(l,"uVibrance")}},sendUniformData:function(c,l){c.uniform1f(l.uVibrance,-this.vibrance)}}),h.Image.filters.Vibrance.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.Blur=(0,h.util.createClass)(p.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(c){c.webgl?(this.aspectRatio=c.sourceWidth/c.sourceHeight,c.passes++,this._setupFrameBuffer(c),this.horizontal=!0,this.applyToWebGL(c),this._swapTextures(c),this._setupFrameBuffer(c),this.horizontal=!1,this.applyToWebGL(c),this._swapTextures(c)):this.applyTo2d(c)},applyTo2d:function(c){c.imageData=this.simpleBlur(c)},simpleBlur:function(c){var o,a,l=c.filterBackend.resources,f=c.imageData.width,u=c.imageData.height;l.blurLayer1||(l.blurLayer1=h.util.createCanvasElement(),l.blurLayer2=h.util.createCanvasElement()),a=l.blurLayer2,((o=l.blurLayer1).width!==f||o.height!==u)&&(a.width=o.width=f,a.height=o.height=u);var C,x,T,I,m=o.getContext("2d"),b=a.getContext("2d"),v=15,N=.06*this.blur*.5;for(m.putImageData(c.imageData,0,0),b.clearRect(0,0,f,u),I=-v;I<=v;I++)T=N*(x=I/v)*f+(C=(Math.random()-.5)/4),b.globalAlpha=1-Math.abs(x),b.drawImage(o,T,C),m.drawImage(a,0,0),b.globalAlpha=1,b.clearRect(0,0,a.width,a.height);for(I=-v;I<=v;I++)T=N*(x=I/v)*u+(C=(Math.random()-.5)/4),b.globalAlpha=1-Math.abs(x),b.drawImage(o,C,T),m.drawImage(a,0,0),b.globalAlpha=1,b.clearRect(0,0,a.width,a.height);c.ctx.drawImage(o,0,0);var H=c.ctx.getImageData(0,0,o.width,o.height);return m.globalAlpha=1,m.clearRect(0,0,o.width,o.height),H},getUniformLocations:function(c,l){return{delta:c.getUniformLocation(l,"uDelta")}},sendUniformData:function(c,l){var o=this.chooseRightDelta();c.uniform2fv(l.delta,o)},chooseRightDelta:function(){var o,c=1,l=[0,0];return this.horizontal?this.aspectRatio>1&&(c=1/this.aspectRatio):this.aspectRatio<1&&(c=this.aspectRatio),o=c*this.blur*.12,this.horizontal?l[0]=o:l[1]=o,l}}),p.Blur.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.Gamma=(0,h.util.createClass)(p.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(c){this.gamma=[1,1,1],p.BaseFilter.prototype.initialize.call(this,c)},applyTo2d:function(c){var v,o=c.imageData.data,a=this.gamma,f=o.length,u=1/a[0],m=1/a[1],b=1/a[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),v=0,f=256;v<f;v++)this.rVals[v]=255*Math.pow(v/255,u),this.gVals[v]=255*Math.pow(v/255,m),this.bVals[v]=255*Math.pow(v/255,b);for(v=0,f=o.length;v<f;v+=4)o[v]=this.rVals[o[v]],o[v+1]=this.gVals[o[v+1]],o[v+2]=this.bVals[o[v+2]]},getUniformLocations:function(c,l){return{uGamma:c.getUniformLocation(l,"uGamma")}},sendUniformData:function(c,l){c.uniform3fv(l.uGamma,this.gamma)}}),h.Image.filters.Gamma.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.Composed=(0,h.util.createClass)(p.BaseFilter,{type:"Composed",subFilters:[],initialize:function(c){this.callSuper("initialize",c),this.subFilters=this.subFilters.slice(0)},applyTo:function(c){c.passes+=this.subFilters.length-1,this.subFilters.forEach(function(l){l.applyTo(c)})},toObject:function(){return h.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(c){return c.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(c){return!c.isNeutralState()})}}),h.Image.filters.Composed.fromObject=function(c,l){var a=(c.subFilters||[]).map(function(u){return new h.Image.filters[u.type](u)}),f=new h.Image.filters.Composed({subFilters:a});return l&&l(f),f}}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.Image.filters;p.HueRotation=(0,h.util.createClass)(p.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var c=this.rotation*Math.PI,l=h.util.cos(c),o=h.util.sin(c),a=1/3,f=Math.sqrt(a)*o,u=1-l;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=l+u/3,this.matrix[1]=a*u-f,this.matrix[2]=a*u+f,this.matrix[5]=a*u+f,this.matrix[6]=l+a*u,this.matrix[7]=a*u-f,this.matrix[10]=a*u-f,this.matrix[11]=a*u+f,this.matrix[12]=l+a*u},isNeutralState:function(c){return this.calculateMatrix(),p.BaseFilter.prototype.isNeutralState.call(this,c)},applyTo:function(c){this.calculateMatrix(),p.BaseFilter.prototype.applyTo.call(this,c)}}),h.Image.filters.HueRotation.fromObject=h.Image.filters.BaseFilter.fromObject}($),function(_){"use strict";var h=_.fabric||(_.fabric={}),p=h.util.object.clone;if(h.Text)h.warn("fabric.Text is already defined");else{var g="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");h.Text=h.util.createClass(h.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:h.Object.prototype.stateProperties.concat(g),cacheProperties:h.Object.prototype.cacheProperties.concat(g),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(c,l){this.styles=l&&l.styles||{},this.text=c,this.__skipDimension=!0,this.callSuper("initialize",l),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var c=this.path;c&&(c.segmentsInfo=h.util.getPathSegmentsInfo(c.path))},getMeasuringContext:function(){return h._measuringContext||(h._measuringContext=this.canvas&&this.canvas.contextCache||h.util.createCanvasElement().getContext("2d")),h._measuringContext},_splitText:function(){var c=this._splitTextIntoLines(this.text);return this.textLines=c.lines,this._textLines=c.graphemeLines,this._unwrappedTextLines=c._unwrappedLines,this._text=c.graphemeText,c},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var c,l,a,f,u,m,b=0,v=this._textLines.length;b<v;b++)if(("justify"===this.textAlign||b!==v-1&&!this.isEndOfWrapping(b))&&(a=0,f=this._textLines[b],(l=this.getLineWidth(b))<this.width&&(m=this.textLines[b].match(this._reSpacesAndTabs)))){c=(this.width-l)/m.length;for(var C=0,x=f.length;C<=x;C++)u=this.__charBounds[b][C],this._reSpaceAndTab.test(f[C])?(u.width+=c,u.kernedWidth+=c,u.left+=a,a+=c):u.left+=a}},isEndOfWrapping:function(c){return c===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var c=this.callSuper("_getCacheCanvasDimensions"),l=this.fontSize;return c.width+=l*c.zoomX,c.height+=l*c.zoomY,c},_render:function(c){var l=this.path;l&&!l.isNotVisible()&&l._render(c),this._setTextStyles(c),this._renderTextLinesBackground(c),this._renderTextDecoration(c,"underline"),this._renderText(c),this._renderTextDecoration(c,"overline"),this._renderTextDecoration(c,"linethrough")},_renderText:function(c){"stroke"===this.paintFirst?(this._renderTextStroke(c),this._renderTextFill(c)):(this._renderTextFill(c),this._renderTextStroke(c))},_setTextStyles:function(c,l,o){if(c.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":c.textBaseline="middle";break;case"ascender":c.textBaseline="top";break;case"descender":c.textBaseline="bottom"}c.font=this._getFontDeclaration(l,o)},calcTextWidth:function(){for(var c=this.getLineWidth(0),l=1,o=this._textLines.length;l<o;l++){var a=this.getLineWidth(l);a>c&&(c=a)}return c},_renderTextLine:function(c,l,o,a,f,u){this._renderChars(c,l,o,a,f,u)},_renderTextLinesBackground:function(c){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var l,o,f,u,x,T,N,a=c.fillStyle,m=this._getLeftOffset(),b=this._getTopOffset(),v=0,C=0,I=this.path,H=0,W=this._textLines.length;H<W;H++)if(l=this.getHeightOfLine(H),this.textBackgroundColor||this.styleHas("textBackgroundColor",H)){f=this._textLines[H],o=this._getLineLeftOffset(H),C=0,v=0,u=this.getValueOfPropertyAt(H,0,"textBackgroundColor");for(var K=0,ne=f.length;K<ne;K++)x=this.__charBounds[H][K],T=this.getValueOfPropertyAt(H,K,"textBackgroundColor"),I?(c.save(),c.translate(x.renderLeft,x.renderTop),c.rotate(x.angle),c.fillStyle=T,T&&c.fillRect(-x.width/2,-l/this.lineHeight*(1-this._fontSizeFraction),x.width,l/this.lineHeight),c.restore()):T!==u?(N=m+o+v,"rtl"===this.direction&&(N=this.width-N-C),c.fillStyle=u,u&&c.fillRect(N,b,C,l/this.lineHeight),v=x.left,C=x.width,u=T):C+=x.kernedWidth;T&&!I&&(N=m+o+v,"rtl"===this.direction&&(N=this.width-N-C),c.fillStyle=T,c.fillRect(N,b,C,l/this.lineHeight)),b+=l}else b+=l;c.fillStyle=a,this._removeShadow(c)}},getFontCache:function(c){var l=c.fontFamily.toLowerCase();h.charWidthsCache[l]||(h.charWidthsCache[l]={});var o=h.charWidthsCache[l],a=c.fontStyle.toLowerCase()+"_"+(c.fontWeight+"").toLowerCase();return o[a]||(o[a]={}),o[a]},_measureChar:function(c,l,o,a){var C,x,T,N,f=this.getFontCache(l),b=o+c,v=this._getFontDeclaration(l)===this._getFontDeclaration(a),I=l.fontSize/this.CACHE_FONT_SIZE;if(o&&void 0!==f[o]&&(T=f[o]),void 0!==f[c]&&(N=C=f[c]),v&&void 0!==f[b]&&(N=(x=f[b])-T),void 0===C||void 0===T||void 0===x){var H=this.getMeasuringContext();this._setTextStyles(H,l,!0)}return void 0===C&&(N=C=H.measureText(c).width,f[c]=C),void 0===T&&v&&o&&(T=H.measureText(o).width,f[o]=T),v&&void 0===x&&(x=H.measureText(b).width,f[b]=x,N=x-T),{width:C*I,kernedWidth:N*I}},getHeightOfChar:function(c,l){return this.getValueOfPropertyAt(c,l,"fontSize")},measureLine:function(c){var l=this._measureLine(c);return 0!==this.charSpacing&&(l.width-=this._getWidthOfCharSpacing()),l.width<0&&(l.width=0),l},_measureLine:function(c){var o,a,u,m,x,T,l=0,f=this._textLines[c],v=new Array(f.length),C=0,I=this.path,N="right"===this.pathSide;for(this.__charBounds[c]=v,o=0;o<f.length;o++)m=this._getGraphemeBox(a=f[o],c,o,u),v[o]=m,l+=m.kernedWidth,u=a;if(v[o]={left:m?m.left+m.width:0,width:0,kernedWidth:0,height:this.fontSize},I){switch(T=I.segmentsInfo[I.segmentsInfo.length-1].length,(x=h.util.getPointOnPath(I.path,0,I.segmentsInfo)).x+=I.pathOffset.x,x.y+=I.pathOffset.y,this.textAlign){case"left":C=N?T-l:0;break;case"center":C=(T-l)/2;break;case"right":C=N?0:T-l}for(C+=this.pathStartOffset*(N?-1:1),o=N?f.length-1:0;N?o>=0:o<f.length;N?o--:o++)C>T?C%=T:C<0&&(C+=T),this._setGraphemeOnPath(C,m=v[o],x),C+=m.kernedWidth}return{width:l,numOfSpaces:0}},_setGraphemeOnPath:function(c,l,o){var f=this.path,u=h.util.getPointOnPath(f.path,c+l.kernedWidth/2,f.segmentsInfo);l.renderLeft=u.x-o.x,l.renderTop=u.y-o.y,l.angle=u.angle+("right"===this.pathSide?Math.PI:0)},_getGraphemeBox:function(c,l,o,a,f){var x,u=this.getCompleteStyleDeclaration(l,o),m=a?this.getCompleteStyleDeclaration(l,o-1):{},b=this._measureChar(c,u,a,m),v=b.kernedWidth,C=b.width;0!==this.charSpacing&&(C+=x=this._getWidthOfCharSpacing(),v+=x);var T={width:C,left:0,height:u.fontSize,kernedWidth:v,deltaY:u.deltaY};if(o>0&&!f){var I=this.__charBounds[l][o-1];T.left=I.left+I.width+b.kernedWidth-b.width}return T},getHeightOfLine:function(c){if(this.__lineHeights[c])return this.__lineHeights[c];for(var l=this._textLines[c],o=this.getHeightOfChar(c,0),a=1,f=l.length;a<f;a++)o=Math.max(this.getHeightOfChar(c,a),o);return this.__lineHeights[c]=o*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var c,l=0,o=0,a=this._textLines.length;o<a;o++)c=this.getHeightOfLine(o),l+=o===a-1?c/this.lineHeight:c;return l},_getLeftOffset:function(){return"ltr"===this.direction?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(c,l){c.save();for(var o=0,a=this._getLeftOffset(),f=this._getTopOffset(),u=0,m=this._textLines.length;u<m;u++){var b=this.getHeightOfLine(u),v=b/this.lineHeight,C=this._getLineLeftOffset(u);this._renderTextLine(l,c,this._textLines[u],a+C,f+o+v,u),o+=b}c.restore()},_renderTextFill:function(c){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(c,"fillText")},_renderTextStroke:function(c){(!this.stroke||0===this.strokeWidth)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(c),c.save(),this._setLineDash(c,this.strokeDashArray),c.beginPath(),this._renderTextCommon(c,"strokeText"),c.closePath(),c.restore())},_renderChars:function(c,l,o,a,f,u){var v,C,T,N,m=this.getHeightOfLine(u),b=-1!==this.textAlign.indexOf("justify"),x="",I=0,H=this.path,W=!b&&0===this.charSpacing&&this.isEmptyStyles(u)&&!H,K="ltr"===this.direction,ne="ltr"===this.direction?1:-1,ce=l.canvas.getAttribute("dir");if(l.save(),ce!==this.direction&&(l.canvas.setAttribute("dir",K?"ltr":"rtl"),l.direction=K?"ltr":"rtl",l.textAlign=K?"left":"right"),f-=m*this._fontSizeFraction/this.lineHeight,W)return this._renderChar(c,l,u,0,o.join(""),a,f,m),void l.restore();for(var Y=0,de=o.length-1;Y<=de;Y++)N=Y===de||this.charSpacing||H,x+=o[Y],T=this.__charBounds[u][Y],0===I?(a+=ne*(T.kernedWidth-T.width),I+=T.width):I+=T.kernedWidth,b&&!N&&this._reSpaceAndTab.test(o[Y])&&(N=!0),N||(v=v||this.getCompleteStyleDeclaration(u,Y),C=this.getCompleteStyleDeclaration(u,Y+1),N=h.util.hasStyleChanged(v,C,!1)),N&&(H?(l.save(),l.translate(T.renderLeft,T.renderTop),l.rotate(T.angle),this._renderChar(c,l,u,Y,x,-I/2,0,m),l.restore()):this._renderChar(c,l,u,Y,x,a,f,m),x="",v=C,a+=ne*I,I=0);l.restore()},_applyPatternGradientTransformText:function(c){var o,l=h.util.createCanvasElement(),a=this.width+this.strokeWidth,f=this.height+this.strokeWidth;return l.width=a,l.height=f,(o=l.getContext("2d")).beginPath(),o.moveTo(0,0),o.lineTo(a,0),o.lineTo(a,f),o.lineTo(0,f),o.closePath(),o.translate(a/2,f/2),o.fillStyle=c.toLive(o),this._applyPatternGradientTransform(o,c),o.fill(),o.createPattern(l,"no-repeat")},handleFiller:function(c,l,o){var a,f;return o.toLive?"percentage"===o.gradientUnits||o.gradientTransform||o.patternTransform?(c.translate(a=-this.width/2,f=-this.height/2),c[l]=this._applyPatternGradientTransformText(o),{offsetX:a,offsetY:f}):(c[l]=o.toLive(c,this),this._applyPatternGradientTransform(c,o)):(c[l]=o,{offsetX:0,offsetY:0})},_setStrokeStyles:function(c,l){return c.lineWidth=l.strokeWidth,c.lineCap=this.strokeLineCap,c.lineDashOffset=this.strokeDashOffset,c.lineJoin=this.strokeLineJoin,c.miterLimit=this.strokeMiterLimit,this.handleFiller(c,"strokeStyle",l.stroke)},_setFillStyles:function(c,l){return this.handleFiller(c,"fillStyle",l.fill)},_renderChar:function(c,l,o,a,f,u,m){var T,I,b=this._getStyleDeclaration(o,a),v=this.getCompleteStyleDeclaration(o,a),C="fillText"===c&&v.fill,x="strokeText"===c&&v.stroke&&v.strokeWidth;!x&&!C||(l.save(),C&&(T=this._setFillStyles(l,v)),x&&(I=this._setStrokeStyles(l,v)),l.font=this._getFontDeclaration(v),b&&b.textBackgroundColor&&this._removeShadow(l),b&&b.deltaY&&(m+=b.deltaY),C&&l.fillText(f,u-T.offsetX,m-T.offsetY),x&&l.strokeText(f,u-I.offsetX,m-I.offsetY),l.restore())},setSuperscript:function(c,l){return this._setScript(c,l,this.superscript)},setSubscript:function(c,l){return this._setScript(c,l,this.subscript)},_setScript:function(c,l,o){var a=this.get2DCursorLocation(c,!0),f=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"fontSize"),u=this.getValueOfPropertyAt(a.lineIndex,a.charIndex,"deltaY");return this.setSelectionStyles({fontSize:f*o.size,deltaY:u+f*o.baseline},c,l),this},_getLineLeftOffset:function(c){var l=this.getLineWidth(c),o=this.width-l,a=this.textAlign,f=this.direction,m=0,u=this.isEndOfWrapping(c);return"justify"===a||"justify-center"===a&&!u||"justify-right"===a&&!u||"justify-left"===a&&!u?0:("center"===a&&(m=o/2),"right"===a&&(m=o),"justify-center"===a&&(m=o/2),"justify-right"===a&&(m=o),"rtl"===f&&(m-=o),m)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var c=this._forceClearCache;return c||(c=this.hasStateChanged("_dimensionAffectingProps")),c&&(this.dirty=!0,this._forceClearCache=!1),c},getLineWidth:function(c){if(void 0!==this.__lineWidths[c])return this.__lineWidths[c];var o=this.measureLine(c).width;return this.__lineWidths[c]=o,o},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(c,l,o){var a=this._getStyleDeclaration(c,l);return a&&void 0!==a[o]?a[o]:this[o]},_renderTextDecoration:function(c,l){if(this[l]||this.styleHas(l)){for(var o,a,f,u,m,b,v,C,I,N,H,W,K,ne,ae,ce,x=this._getLeftOffset(),T=this._getTopOffset(),Y=this.path,de=this._getWidthOfCharSpacing(),fe=this.offsets[l],me=0,B=this._textLines.length;me<B;me++)if(o=this.getHeightOfLine(me),this[l]||this.styleHas(l,me)){v=this._textLines[me],ne=o/this.lineHeight,u=this._getLineLeftOffset(me),N=0,H=0,C=this.getValueOfPropertyAt(me,0,l),ce=this.getValueOfPropertyAt(me,0,"fill"),I=T+ne*(1-this._fontSizeFraction),a=this.getHeightOfChar(me,0),m=this.getValueOfPropertyAt(me,0,"deltaY");for(var L=0,D=v.length;L<D;L++)if(W=this.__charBounds[me][L],K=this.getValueOfPropertyAt(me,L,l),ae=this.getValueOfPropertyAt(me,L,"fill"),f=this.getHeightOfChar(me,L),b=this.getValueOfPropertyAt(me,L,"deltaY"),Y&&K&&ae)c.save(),c.fillStyle=ce,c.translate(W.renderLeft,W.renderTop),c.rotate(W.angle),c.fillRect(-W.kernedWidth/2,fe*f+b,W.kernedWidth,this.fontSize/15),c.restore();else if((K!==C||ae!==ce||f!==a||b!==m)&&H>0){var M=x+u+N;"rtl"===this.direction&&(M=this.width-M-H),C&&ce&&(c.fillStyle=ce,c.fillRect(M,I+fe*a+m,H,this.fontSize/15)),N=W.left,H=W.width,C=K,ce=ae,a=f,m=b}else H+=W.kernedWidth;M=x+u+N,"rtl"===this.direction&&(M=this.width-M-H),c.fillStyle=ae,K&&ae&&c.fillRect(M,I+fe*a+m,H-de,this.fontSize/15),T+=o}else T+=o;this._removeShadow(c)}},_getFontDeclaration:function(c,l){var o=c||this,a=this.fontFamily,f=h.Text.genericFonts.indexOf(a.toLowerCase())>-1,u=void 0===a||a.indexOf("'")>-1||a.indexOf(",")>-1||a.indexOf('"')>-1||f?o.fontFamily:'"'+o.fontFamily+'"';return[h.isLikelyNode?o.fontWeight:o.fontStyle,h.isLikelyNode?o.fontStyle:o.fontWeight,l?this.CACHE_FONT_SIZE+"px":o.fontSize+"px",u].join(" ")},render:function(c){!this.visible||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",c))},_splitTextIntoLines:function(c){for(var l=c.split(this._reNewline),o=new Array(l.length),a=["\n"],f=[],u=0;u<l.length;u++)o[u]=h.util.string.graphemeSplit(l[u]),f=f.concat(o[u],a);return f.pop(),{_unwrappedLines:o,lines:l,graphemeText:f,graphemeLines:o}},toObject:function(c){var l=g.concat(c),o=this.callSuper("toObject",l);return o.styles=h.util.stylesToArray(this.styles,this.text),o.path&&(o.path=this.path.toObject()),o},set:function(c,l){this.callSuper("set",c,l);var o=!1,a=!1;if("object"==typeof c)for(var f in c)"path"===f&&this.setPathInfo(),o=o||-1!==this._dimensionAffectingProps.indexOf(f),a=a||"path"===f;else o=-1!==this._dimensionAffectingProps.indexOf(c),a="path"===c;return a&&this.setPathInfo(),o&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),h.Text.ATTRIBUTE_NAMES=h.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),h.Text.DEFAULT_SVG_FONT_SIZE=16,h.Text.fromElement=function(c,l,o){if(!c)return l(null);var a=h.parseAttributes(c,h.Text.ATTRIBUTE_NAMES),f=a.textAnchor||"left";if((o=h.util.object.extend(o?p(o):{},a)).top=o.top||0,o.left=o.left||0,a.textDecoration){var u=a.textDecoration;-1!==u.indexOf("underline")&&(o.underline=!0),-1!==u.indexOf("overline")&&(o.overline=!0),-1!==u.indexOf("line-through")&&(o.linethrough=!0),delete o.textDecoration}"dx"in a&&(o.left+=a.dx),"dy"in a&&(o.top+=a.dy),"fontSize"in o||(o.fontSize=h.Text.DEFAULT_SVG_FONT_SIZE);var m="";"textContent"in c?m=c.textContent:"firstChild"in c&&null!==c.firstChild&&"data"in c.firstChild&&null!==c.firstChild.data&&(m=c.firstChild.data),m=m.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var b=o.strokeWidth;o.strokeWidth=0;var v=new h.Text(m,o),C=v.getScaledHeight()/v.height,T=((v.height+v.strokeWidth)*v.lineHeight-v.height)*C,I=v.getScaledHeight()+T,N=0;"center"===f&&(N=v.getScaledWidth()/2),"right"===f&&(N=v.getScaledWidth()),v.set({left:v.left-N,top:v.top-(I-v.fontSize*(.07+v._fontSizeFraction))/v.lineHeight,strokeWidth:void 0!==b?b:1}),l(v)},h.Text.fromObject=function(c,l){var o=p(c),a=c.path;return delete o.path,h.Object._fromObject("Text",o,function(f){f.styles=h.util.stylesFromArray(c.styles,c.text),a?h.Object._fromObject("Path",a,function(u){f.set("path",u),l(f)},"path"):l(f)},"text")},h.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],h.util.createAccessors&&h.util.createAccessors(h.Text)}}($),S.util.object.extend(S.Text.prototype,{isEmptyStyles:function(_){if(!this.styles||void 0!==_&&!this.styles[_])return!0;var h=void 0===_?this.styles:{line:this.styles[_]};for(var p in h)for(var g in h[p])for(var c in h[p][g])return!1;return!0},styleHas:function(_,h){if(!this.styles||!_||""===_||void 0!==h&&!this.styles[h])return!1;var p=void 0===h?this.styles:{0:this.styles[h]};for(var g in p)for(var c in p[g])if(void 0!==p[g][c][_])return!0;return!1},cleanStyle:function(_){if(!this.styles||!_||""===_)return!1;var g,c,h=this.styles,p=0,l=!0,o=0;for(var f in h){for(var u in g=0,h[f]){var a;p++,(a=h[f][u]).hasOwnProperty(_)?(c?a[_]!==c&&(l=!1):c=a[_],a[_]===this[_]&&delete a[_]):l=!1,0!==Object.keys(a).length?g++:delete h[f][u]}0===g&&delete h[f]}for(var b=0;b<this._textLines.length;b++)o+=this._textLines[b].length;l&&p===o&&(this[_]=c,this.removeStyle(_))},removeStyle:function(_){if(this.styles&&_&&""!==_){var p,g,c,h=this.styles;for(g in h){for(c in p=h[g])delete p[c][_],0===Object.keys(p[c]).length&&delete p[c];0===Object.keys(p).length&&delete h[g]}}},_extendStyles:function(_,h){var p=this.get2DCursorLocation(_);this._getLineStyle(p.lineIndex)||this._setLineStyle(p.lineIndex),this._getStyleDeclaration(p.lineIndex,p.charIndex)||this._setStyleDeclaration(p.lineIndex,p.charIndex,{}),S.util.object.extend(this._getStyleDeclaration(p.lineIndex,p.charIndex),h)},get2DCursorLocation:function(_,h){void 0===_&&(_=this.selectionStart);for(var p=h?this._unwrappedTextLines:this._textLines,g=p.length,c=0;c<g;c++){if(_<=p[c].length)return{lineIndex:c,charIndex:_};_-=p[c].length+this.missingNewlineOffset(c)}return{lineIndex:c-1,charIndex:p[c-1].length<_?p[c-1].length:_}},getSelectionStyles:function(_,h,p){void 0===_&&(_=this.selectionStart||0),void 0===h&&(h=this.selectionEnd||_);for(var g=[],c=_;c<h;c++)g.push(this.getStyleAtPosition(c,p));return g},getStyleAtPosition:function(_,h){var p=this.get2DCursorLocation(_);return(h?this.getCompleteStyleDeclaration(p.lineIndex,p.charIndex):this._getStyleDeclaration(p.lineIndex,p.charIndex))||{}},setSelectionStyles:function(_,h,p){void 0===h&&(h=this.selectionStart||0),void 0===p&&(p=this.selectionEnd||h);for(var g=h;g<p;g++)this._extendStyles(g,_);return this._forceClearCache=!0,this},_getStyleDeclaration:function(_,h){var p=this.styles&&this.styles[_];return p?p[h]:null},getCompleteStyleDeclaration:function(_,h){for(var c,p=this._getStyleDeclaration(_,h)||{},g={},l=0;l<this._styleProperties.length;l++)g[c=this._styleProperties[l]]=void 0===p[c]?this[c]:p[c];return g},_setStyleDeclaration:function(_,h,p){this.styles[_][h]=p},_deleteStyleDeclaration:function(_,h){delete this.styles[_][h]},_getLineStyle:function(_){return!!this.styles[_]},_setLineStyle:function(_){this.styles[_]={}},_deleteLineStyle:function(_){delete this.styles[_]}}),function(){function _(h){h.textDecoration&&(h.textDecoration.indexOf("underline")>-1&&(h.underline=!0),h.textDecoration.indexOf("line-through")>-1&&(h.linethrough=!0),h.textDecoration.indexOf("overline")>-1&&(h.overline=!0),delete h.textDecoration)}S.IText=S.util.createClass(S.Text,S.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(h,p){this.callSuper("initialize",h,p),this.initBehavior()},setSelectionStart:function(h){h=Math.max(h,0),this._updateAndFire("selectionStart",h)},setSelectionEnd:function(h){h=Math.min(h,this.text.length),this._updateAndFire("selectionEnd",h)},_updateAndFire:function(h,p){this[h]!==p&&(this._fireSelectionChanged(),this[h]=p),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(h){this.clearContextTop(),this.callSuper("render",h),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(h){this.callSuper("_render",h)},clearContextTop:function(h){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var p=this.canvas.contextTop,g=this.canvas.viewportTransform;p.save(),p.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this.transform(p),this._clearTextArea(p),h||p.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var h=this._getCursorBoundaries(),p=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(h,p):this.renderSelection(h,p),p.restore()}},_clearTextArea:function(h){var p=this.width+4,g=this.height+4;h.clearRect(-p/2,-g/2,p,g)},_getCursorBoundaries:function(h){void 0===h&&(h=this.selectionStart);var p=this._getLeftOffset(),g=this._getTopOffset(),c=this._getCursorBoundariesOffsets(h);return{left:p,top:g,leftOffset:c.left,topOffset:c.top}},_getCursorBoundariesOffsets:function(h){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var p,g,c,a,l=0,o=0,f=this.get2DCursorLocation(h);c=f.charIndex,g=f.lineIndex;for(var u=0;u<g;u++)l+=this.getHeightOfLine(u);p=this._getLineLeftOffset(g);var m=this.__charBounds[g][c];return m&&(o=m.left),0!==this.charSpacing&&c===this._textLines[g].length&&(o-=this._getWidthOfCharSpacing()),a={top:l,left:p+(o>0?o:0)},"rtl"===this.direction&&(a.left*=-1),this.cursorOffsetCache=a,this.cursorOffsetCache},renderCursor:function(h,p){var g=this.get2DCursorLocation(),c=g.lineIndex,l=g.charIndex>0?g.charIndex-1:0,o=this.getValueOfPropertyAt(c,l,"fontSize"),a=this.scaleX*this.canvas.getZoom(),f=this.cursorWidth/a,u=h.topOffset,m=this.getValueOfPropertyAt(c,l,"deltaY");u+=(1-this._fontSizeFraction)*this.getHeightOfLine(c)/this.lineHeight-o*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(h,p),p.fillStyle=this.cursorColor||this.getValueOfPropertyAt(c,l,"fill"),p.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,p.fillRect(h.left+h.leftOffset-f/2,u+h.top+m,f,o)},renderSelection:function(h,p){for(var g=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,c=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,l=-1!==this.textAlign.indexOf("justify"),o=this.get2DCursorLocation(g),a=this.get2DCursorLocation(c),f=o.lineIndex,u=a.lineIndex,m=o.charIndex<0?0:o.charIndex,b=a.charIndex<0?0:a.charIndex,v=f;v<=u;v++){var T,C=this._getLineLeftOffset(v)||0,x=this.getHeightOfLine(v),I=0,N=0;if(v===f&&(I=this.__charBounds[f][m].left),v>=f&&v<u)N=l&&!this.isEndOfWrapping(v)?this.width:this.getLineWidth(v)||5;else if(v===u)if(0===b)N=this.__charBounds[u][b].left;else{var H=this._getWidthOfCharSpacing();N=this.__charBounds[u][b-1].left+this.__charBounds[u][b-1].width-H}T=x,(this.lineHeight<1||v===u&&this.lineHeight>1)&&(x/=this.lineHeight);var W=h.left+C+I,K=N-I,ne=x,ae=0;this.inCompositionMode?(p.fillStyle=this.compositionColor||"black",ne=1,ae=x):p.fillStyle=this.selectionColor,"rtl"===this.direction&&(W=this.width-W-K),p.fillRect(W,h.top+h.topOffset+ae,K,ne),h.topOffset+=T}},getCurrentCharFontSize:function(){var h=this._getCurrentCharIndex();return this.getValueOfPropertyAt(h.l,h.c,"fontSize")},getCurrentCharColor:function(){var h=this._getCurrentCharIndex();return this.getValueOfPropertyAt(h.l,h.c,"fill")},_getCurrentCharIndex:function(){var h=this.get2DCursorLocation(this.selectionStart,!0);return{l:h.lineIndex,c:h.charIndex>0?h.charIndex-1:0}}}),S.IText.fromObject=function(h,p){var g=S.util.stylesFromArray(h.styles,h.text),c=Object.assign({},h,{styles:g});if(_(c),c.styles)for(var l in c.styles)for(var o in c.styles[l])_(c.styles[l][o]);S.Object._fromObject("IText",c,p,"text")}}(),function(){var _=S.util.object.clone;S.util.object.extend(S.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var h=this;this.on("added",function(){var p=h.canvas;p&&(p._hasITextHandlers||(p._hasITextHandlers=!0,h._initCanvasHandlers(p)),p._iTextInstances=p._iTextInstances||[],p._iTextInstances.push(h))})},initRemovedHandler:function(){var h=this;this.on("removed",function(){var p=h.canvas;p&&(p._iTextInstances=p._iTextInstances||[],S.util.removeFromArray(p._iTextInstances,h),0===p._iTextInstances.length&&(p._hasITextHandlers=!1,h._removeCanvasHandlers(p)))})},_initCanvasHandlers:function(h){h._mouseUpITextHandler=function(){h._iTextInstances&&h._iTextInstances.forEach(function(p){p.__isMousedown=!1})},h.on("mouse:up",h._mouseUpITextHandler)},_removeCanvasHandlers:function(h){h.off("mouse:up",h._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(h,p,g,c){var l;return l={isAborted:!1,abort:function(){this.isAborted=!0}},h.animate("_currentCursorOpacity",p,{duration:g,onComplete:function(){l.isAborted||h[c]()},onChange:function(){h.canvas&&h.selectionStart===h.selectionEnd&&h.renderCursorOrSelection()},abort:function(){return l.isAborted}}),l},_onTickComplete:function(){var h=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){h._currentTickCompleteState=h._animateCursor(h,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(h){var p=this,g=h?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){p._tick()},g)},abortCursorAnimation:function(){var h=this._currentTickState||this._currentTickCompleteState,p=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,h&&p&&p.clearContext(p.contextTop||p.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(h){var p=0,g=h-1;if(this._reSpace.test(this._text[g]))for(;this._reSpace.test(this._text[g]);)p++,g--;for(;/\S/.test(this._text[g])&&g>-1;)p++,g--;return h-p},findWordBoundaryRight:function(h){var p=0,g=h;if(this._reSpace.test(this._text[g]))for(;this._reSpace.test(this._text[g]);)p++,g++;for(;/\S/.test(this._text[g])&&g<this._text.length;)p++,g++;return h+p},findLineBoundaryLeft:function(h){for(var p=0,g=h-1;!/\n/.test(this._text[g])&&g>-1;)p++,g--;return h-p},findLineBoundaryRight:function(h){for(var p=0,g=h;!/\n/.test(this._text[g])&&g<this._text.length;)p++,g++;return h+p},searchWordBoundary:function(h,p){for(var g=this._text,c=this._reSpace.test(g[h])?h-1:h,l=g[c],o=S.reNonWord;!o.test(l)&&c>0&&c<g.length;)l=g[c+=p];return o.test(l)&&(c+=1===p?0:1),c},selectWord:function(h){var p=this.searchWordBoundary(h=h||this.selectionStart,-1),g=this.searchWordBoundary(h,1);this.selectionStart=p,this.selectionEnd=g,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(h){var p=this.findLineBoundaryLeft(h=h||this.selectionStart),g=this.findLineBoundaryRight(h);return this.selectionStart=p,this.selectionEnd=g,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(h){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(h),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(h){h._iTextInstances&&h._iTextInstances.forEach(function(p){p.selected=!1,p.isEditing&&p.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(h){if(this.__isMousedown&&this.isEditing){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var p=this.getSelectionStartFromPointer(h.e),g=this.selectionStart,c=this.selectionEnd;(p!==this.__selectionStartOnMouseDown||g===c)&&(g===p||c===p)||(p>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=p):(this.selectionStart=p,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==g||this.selectionEnd!==c)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(h,p,g){var c=g.slice(0,h),l=S.util.string.graphemeSplit(c).length;if(h===p)return{selectionStart:l,selectionEnd:l};var o=g.slice(h,p);return{selectionStart:l,selectionEnd:l+S.util.string.graphemeSplit(o).length}},fromGraphemeToStringSelection:function(h,p,g){var l=g.slice(0,h).join("").length;return h===p?{selectionStart:l,selectionEnd:l}:{selectionStart:l,selectionEnd:l+g.slice(h,p).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var h=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=h.selectionStart,this.hiddenTextarea.selectionEnd=h.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var h=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=h.selectionEnd,this.inCompositionMode||(this.selectionStart=h.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var h=this._calcTextareaPosition();this.hiddenTextarea.style.left=h.left,this.hiddenTextarea.style.top=h.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var h=this.inCompositionMode?this.compositionStart:this.selectionStart,p=this._getCursorBoundaries(h),g=this.get2DCursorLocation(h),o=this.getValueOfPropertyAt(g.lineIndex,g.charIndex,"fontSize")*this.lineHeight,a=p.leftOffset,f=this.calcTransformMatrix(),u={x:p.left+a,y:p.top+p.topOffset+o},m=this.canvas.getRetinaScaling(),b=this.canvas.upperCanvasEl,v=b.width/m,C=b.height/m,x=v-o,T=C-o,I=b.clientWidth/v,N=b.clientHeight/C;return u=S.util.transformPoint(u,f),(u=S.util.transformPoint(u,this.canvas.viewportTransform)).x*=I,u.y*=N,u.x<0&&(u.x=0),u.x>x&&(u.x=x),u.y<0&&(u.y=0),u.y>T&&(u.y=T),u.x+=this.canvas._offset.left,u.y+=this.canvas._offset.top,{left:u.x+"px",top:u.y+"px",fontSize:o+"px",charHeight:o}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){!this._savedProps||(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var h=this._textBeforeEdit!==this.text,p=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,p&&(p.blur&&p.blur(),p.parentNode&&p.parentNode.removeChild(p)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),h&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),h&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var h in this.styles)this._textLines[h]||delete this.styles[h]},removeStyleFromTo:function(h,p){var u,m,g=this.get2DCursorLocation(h,!0),c=this.get2DCursorLocation(p,!0),l=g.lineIndex,o=g.charIndex,a=c.lineIndex,f=c.charIndex;if(l!==a){if(this.styles[l])for(u=o;u<this._unwrappedTextLines[l].length;u++)delete this.styles[l][u];if(this.styles[a])for(u=f;u<this._unwrappedTextLines[a].length;u++)(m=this.styles[a][u])&&(this.styles[l]||(this.styles[l]={}),this.styles[l][o+u-f]=m);for(u=l+1;u<=a;u++)delete this.styles[u];this.shiftLineStyles(a,l-a)}else if(this.styles[l]){m=this.styles[l];var v,C,b=f-o;for(u=o;u<f;u++)delete m[u];for(C in this.styles[l])(v=parseInt(C,10))>=f&&(m[v-b]=m[C],delete m[C])}},shiftLineStyles:function(h,p){var g=_(this.styles);for(var c in this.styles){var l=parseInt(c,10);l>h&&(this.styles[l+p]=g[l],g[l-p]||delete this.styles[l])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(h,p,g,c){var l,o={},a=!1,f=this._unwrappedTextLines[h].length===p;for(var u in g||(g=1),this.shiftLineStyles(h,g),this.styles[h]&&(l=this.styles[h][0===p?p:p-1]),this.styles[h]){var m=parseInt(u,10);m>=p&&(a=!0,o[m-p]=this.styles[h][u],f&&0===p||delete this.styles[h][u])}var b=!1;for(a&&!f&&(this.styles[h+g]=o,b=!0),b&&g--;g>0;)c&&c[g-1]?this.styles[h+g]={0:_(c[g-1])}:l?this.styles[h+g]={0:_(l)}:delete this.styles[h+g],g--;this._forceClearCache=!0},insertCharStyleObject:function(h,p,g,c){this.styles||(this.styles={});var l=this.styles[h],o=l?_(l):{};for(var a in g||(g=1),o){var f=parseInt(a,10);f>=p&&(l[f+g]=o[f],o[f-g]||delete l[f])}if(this._forceClearCache=!0,c)for(;g--;)!Object.keys(c[g]).length||(this.styles[h]||(this.styles[h]={}),this.styles[h][p+g]=_(c[g]));else if(l)for(var u=l[p?p-1:1];u&&g--;)this.styles[h][p+g]=_(u)},insertNewStyleBlock:function(h,p,g){for(var c=this.get2DCursorLocation(p,!0),l=[0],o=0,a=0;a<h.length;a++)"\n"===h[a]?l[++o]=0:l[o]++;for(l[0]>0&&(this.insertCharStyleObject(c.lineIndex,c.charIndex,l[0],g),g=g&&g.slice(l[0]+1)),o&&this.insertNewlineStyleObject(c.lineIndex,c.charIndex+l[0],o),a=1;a<o;a++)l[a]>0?this.insertCharStyleObject(c.lineIndex+a,0,l[a],g):g&&this.styles[c.lineIndex+a]&&g[0]&&(this.styles[c.lineIndex+a][0]=g[0]),g=g&&g.slice(l[a]+1);l[a]>0&&this.insertCharStyleObject(c.lineIndex+a,0,l[a],g)},setSelectionStartEndWithShift:function(h,p,g){g<=h?(p===h?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=h),this.selectionStart=g):g>h&&g<p?"right"===this._selectionDirection?this.selectionEnd=g:this.selectionStart=g:(p===h?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=p),this.selectionEnd=g)},setSelectionInBoundaries:function(){var h=this.text.length;this.selectionStart>h?this.selectionStart=h:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>h?this.selectionEnd=h:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),S.util.object.extend(S.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(_){if(this.canvas){this.__newClickTime=+new Date;var h=_.pointer;this.isTripleClick(h)&&(this.fire("tripleclick",_),this._stopEvent(_.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=h,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(_){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===_.x&&this.__lastPointer.y===_.y},_stopEvent:function(_){_.preventDefault&&_.preventDefault(),_.stopPropagation&&_.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(_){!this.isEditing||this.selectWord(this.getSelectionStartFromPointer(_.e))},tripleClickHandler:function(_){!this.isEditing||this.selectLine(this.getSelectionStartFromPointer(_.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(_){!this.canvas||!this.editable||_.e.button&&1!==_.e.button||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(_.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(_){!this.canvas||!this.editable||_.e.button&&1!==_.e.button||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(_){if(this.__isMousedown=!1,!(!this.editable||this.group||_.transform&&_.transform.actionPerformed||_.e.button&&1!==_.e.button)){if(this.canvas){var h=this.canvas._activeObject;if(h&&h!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(_.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(_){var h=this.getSelectionStartFromPointer(_);_.shiftKey?this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,h):(this.selectionStart=h,this.selectionEnd=h),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(_){for(var f,h=this.getLocalPointer(_),p=0,g=0,c=0,l=0,o=0,u=0,m=this._textLines.length;u<m&&c<=h.y;u++)c+=this.getHeightOfLine(u)*this.scaleY,o=u,u>0&&(l+=this._textLines[u-1].length+this.missingNewlineOffset(u-1));g=this._getLineLeftOffset(o)*this.scaleX,f=this._textLines[o],"rtl"===this.direction&&(h.x=this.width*this.scaleX-h.x+g);for(var b=0,v=f.length;b<v&&(p=g,(g+=this.__charBounds[o][b].kernedWidth*this.scaleX)<=h.x);b++)l++;return this._getNewSelectionStartFromOffset(h,p,g,l,v)},_getNewSelectionStartFromOffset:function(_,h,p,g,c){var o=p-_.x,f=g+(o>_.x-h||o<0?0:1);return this.flipX&&(f=c-f),f>this._text.length&&(f=this._text.length),f}}),S.util.object.extend(S.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=S.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var _=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+_.top+"; left: "+_.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uff70top: "+_.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):S.document.body.appendChild(this.hiddenTextarea),S.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),S.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),S.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),S.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),S.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),S.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(S.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(_){if(this.isEditing){var h="rtl"===this.direction?this.keysMapRtl:this.keysMap;if(_.keyCode in h)this[h[_.keyCode]](_);else{if(!(_.keyCode in this.ctrlKeysMapDown)||!_.ctrlKey&&!_.metaKey)return;this[this.ctrlKeysMapDown[_.keyCode]](_)}_.stopImmediatePropagation(),_.preventDefault(),_.keyCode>=33&&_.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(_){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:_.keyCode in this.ctrlKeysMapUp&&(_.ctrlKey||_.metaKey)&&(this[this.ctrlKeysMapUp[_.keyCode]](_),_.stopImmediatePropagation(),_.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(_){var h=this.fromPaste;if(this.fromPaste=!1,_&&_.stopPropagation(),this.isEditing){var l,o,b,v,C,p=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,g=this._text.length,c=p.length,a=c-g,f=this.selectionStart,u=this.selectionEnd,m=f!==u;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var x=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),T=f>x.selectionStart;m?(l=this._text.slice(f,u),a+=u-f):c<g&&(l=T?this._text.slice(u+a,u):this._text.slice(f,f-a)),o=p.slice(x.selectionEnd-a,x.selectionEnd),l&&l.length&&(o.length&&(b=this.getSelectionStyles(f,f+1,!1),b=o.map(function(){return b[0]})),m?(v=f,C=u):T?(v=u-l.length,C=u):(v=u,C=u+l.length),this.removeStyleFromTo(v,C)),o.length&&(h&&o.join("")===S.copiedText&&!S.disableStyleCopyPaste&&(b=S.copiedTextStyle),this.insertNewStyleBlock(o,f,b)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(_){this.compositionStart=_.target.selectionStart,this.compositionEnd=_.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(S.copiedText=this.getSelectedText(),S.copiedTextStyle=S.disableStyleCopyPaste?null:this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(_){return _&&_.clipboardData||S.window.clipboardData},_getWidthBeforeCursor:function(_,h){var g,p=this._getLineLeftOffset(_);return h>0&&(p+=(g=this.__charBounds[_][h-1]).left+g.width),p},getDownCursorOffset:function(_,h){var p=this._getSelectionForOffset(_,h),g=this.get2DCursorLocation(p),c=g.lineIndex;if(c===this._textLines.length-1||_.metaKey||34===_.keyCode)return this._text.length-p;var l=g.charIndex,o=this._getWidthBeforeCursor(c,l),a=this._getIndexOnLine(c+1,o);return this._textLines[c].slice(l).length+a+1+this.missingNewlineOffset(c)},_getSelectionForOffset:function(_,h){return _.shiftKey&&this.selectionStart!==this.selectionEnd&&h?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(_,h){var p=this._getSelectionForOffset(_,h),g=this.get2DCursorLocation(p),c=g.lineIndex;if(0===c||_.metaKey||33===_.keyCode)return-p;var l=g.charIndex,o=this._getWidthBeforeCursor(c,l),a=this._getIndexOnLine(c-1,o),f=this._textLines[c].slice(0,l),u=this.missingNewlineOffset(c-1);return-this._textLines[c-1].length+a-f.length+(1-u)},_getIndexOnLine:function(_,h){for(var o,a,p=this._textLines[_],c=this._getLineLeftOffset(_),l=0,f=0,u=p.length;f<u;f++)if((c+=o=this.__charBounds[_][f].width)>h){a=!0;var b=c,v=Math.abs(c-o-h);l=Math.abs(b-h)<v?f:f-1;break}return a||(l=p.length-1),l},moveCursorDown:function(_){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",_)},moveCursorUp:function(_){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",_)},_moveCursorUpOrDown:function(_,h){var g=this["get"+_+"CursorOffset"](h,"right"===this._selectionDirection);h.shiftKey?this.moveCursorWithShift(g):this.moveCursorWithoutShift(g),0!==g&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(_){return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,"left"===this._selectionDirection?this.selectionStart+_:this.selectionEnd+_),0!==_},moveCursorWithoutShift:function(_){return _<0?(this.selectionStart+=_,this.selectionEnd=this.selectionStart):(this.selectionEnd+=_,this.selectionStart=this.selectionEnd),0!==_},moveCursorLeft:function(_){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",_)},_move:function(_,h,p){var g;if(_.altKey)g=this["findWordBoundary"+p](this[h]);else{if(!_.metaKey&&35!==_.keyCode&&36!==_.keyCode)return this[h]+="Left"===p?-1:1,!0;g=this["findLineBoundary"+p](this[h])}if(void 0!==g&&this[h]!==g)return this[h]=g,!0},_moveLeft:function(_,h){return this._move(_,h,"Left")},_moveRight:function(_,h){return this._move(_,h,"Right")},moveCursorLeftWithoutShift:function(_){var h=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(h=this._moveLeft(_,"selectionStart")),this.selectionEnd=this.selectionStart,h},moveCursorLeftWithShift:function(_){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(_,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(_,"selectionStart")):void 0},moveCursorRight:function(_){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",_)},_moveCursorLeftOrRight:function(_,h){var p="moveCursor"+_+"With";this._currentCursorOpacity=1,this[p+=h.shiftKey?"Shift":"outShift"](h)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(_){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(_,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(_,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(_){var h=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(h=this._moveRight(_,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,h},removeChars:function(_,h){void 0===h&&(h=_+1),this.removeStyleFromTo(_,h),this._text.splice(_,h-_),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(_,h,p,g){void 0===g&&(g=p),g>p&&this.removeStyleFromTo(p,g);var c=S.util.string.graphemeSplit(_);this.insertNewStyleBlock(c,p,h),this._text=[].concat(this._text.slice(0,p),c,this._text.slice(g)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var _=S.util.toFixed,h=/  +/g;S.util.object.extend(S.Text.prototype,{_toSVG:function(){var p=this._getSVGLeftTopOffsets(),g=this._getSVGTextAndBg(p.textTop,p.textLeft);return this._wrapSVGTextAndBg(g)},toSVG:function(p){return this._createBaseSVGMarkup(this._toSVG(),{reviver:p,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(p){var c=this.getSvgTextDecoration(this);return[p.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",c?'text-decoration="'+c+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",p.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(p,g){var a,c=[],l=[],o=p;this._setSVGBg(l);for(var f=0,u=this._textLines.length;f<u;f++)a=this._getLineLeftOffset(f),(this.textBackgroundColor||this.styleHas("textBackgroundColor",f))&&this._setSVGTextLineBg(l,f,g+a,o),this._setSVGTextLineText(c,f,g+a,o),o+=this.getHeightOfLine(f);return{textSpans:c,textBgRects:l}},_createTextCharSpan:function(p,g,c,l){var o=p!==p.trim()||p.match(h),a=this.getSvgSpanStyles(g,o),f=a?'style="'+a+'"':"",u=g.deltaY,m="",b=S.Object.NUM_FRACTION_DIGITS;return u&&(m=' dy="'+_(u,b)+'" '),['<tspan x="',_(c,b),'" y="',_(l,b),'" ',m,f,">",S.util.string.escapeXml(p),"</tspan>"].join("")},_setSVGTextLineText:function(p,g,c,l){var f,u,b,v,T,o=this.getHeightOfLine(g),a=-1!==this.textAlign.indexOf("justify"),m="",C=0,x=this._textLines[g];l+=o*(1-this._fontSizeFraction)/this.lineHeight;for(var I=0,N=x.length-1;I<=N;I++)T=I===N||this.charSpacing,m+=x[I],b=this.__charBounds[g][I],0===C?(c+=b.kernedWidth-b.width,C+=b.width):C+=b.kernedWidth,a&&!T&&this._reSpaceAndTab.test(x[I])&&(T=!0),T||(f=f||this.getCompleteStyleDeclaration(g,I),u=this.getCompleteStyleDeclaration(g,I+1),T=S.util.hasStyleChanged(f,u,!0)),T&&(v=this._getStyleDeclaration(g,I)||{},p.push(this._createTextCharSpan(m,v,c,l)),m="",f=u,c+=C,C=0)},_pushTextBgRect:function(p,g,c,l,o,a){var f=S.Object.NUM_FRACTION_DIGITS;p.push("\t\t<rect ",this._getFillAttributes(g),' x="',_(c,f),'" y="',_(l,f),'" width="',_(o,f),'" height="',_(a,f),'"></rect>\n')},_setSVGTextLineBg:function(p,g,c,l){for(var m,b,o=this._textLines[g],a=this.getHeightOfLine(g)/this.lineHeight,f=0,u=0,v=this.getValueOfPropertyAt(g,0,"textBackgroundColor"),C=0,x=o.length;C<x;C++)m=this.__charBounds[g][C],(b=this.getValueOfPropertyAt(g,C,"textBackgroundColor"))!==v?(v&&this._pushTextBgRect(p,v,c+u,l,f,a),u=m.left,f=m.width,v=b):f+=m.kernedWidth;b&&this._pushTextBgRect(p,b,c+u,l,f,a)},_getFillAttributes:function(p){var g=p&&"string"==typeof p?new S.Color(p):"";return g&&g.getSource()&&1!==g.getAlpha()?'opacity="'+g.getAlpha()+'" fill="'+g.setAlpha(1).toRgb()+'"':'fill="'+p+'"'},_getSVGLineTopOffset:function(p){for(var c,g=0,l=0;l<p;l++)g+=this.getHeightOfLine(l);return c=this.getHeightOfLine(l),{lineTop:g,offset:(this._fontSizeMult-this._fontSizeFraction)*c/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(p){return S.Object.prototype.getSvgStyles.call(this,p)+" white-space: pre;"}})}(),function(_){"use strict";var h=_.fabric||(_.fabric={});h.Textbox=h.util.createClass(h.IText,h.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:h.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(p){for(var g=0,c=0,l=0,o={},a=0;a<p.graphemeLines.length;a++)"\n"===p.graphemeText[l]&&a>0?(c=0,l++,g++):!this.splitByGrapheme&&this._reSpaceAndTab.test(p.graphemeText[l])&&a>0&&(c++,l++),o[a]={line:g,offset:c},l+=p.graphemeLines[a].length,c+=p.graphemeLines[a].length;return o},styleHas:function(p,g){if(this._styleMap&&!this.isWrapping){var c=this._styleMap[g];c&&(g=c.line)}return h.Text.prototype.styleHas.call(this,p,g)},isEmptyStyles:function(p){if(!this.styles)return!0;var l,o,g=0,a=!1,f=this._styleMap[p],u=this._styleMap[p+1];for(var m in f&&(p=f.line,g=f.offset),u&&(a=u.line===p,l=u.offset),o=void 0===p?this.styles:{line:this.styles[p]})for(var b in o[m])if(b>=g&&(!a||b<l))for(var v in o[m][b])return!1;return!0},_getStyleDeclaration:function(p,g){if(this._styleMap&&!this.isWrapping){var c=this._styleMap[p];if(!c)return null;p=c.line,g=c.offset+g}return this.callSuper("_getStyleDeclaration",p,g)},_setStyleDeclaration:function(p,g,c){var l=this._styleMap[p];this.styles[p=l.line][g=l.offset+g]=c},_deleteStyleDeclaration:function(p,g){var c=this._styleMap[p];delete this.styles[p=c.line][g=c.offset+g]},_getLineStyle:function(p){return!!this.styles[this._styleMap[p].line]},_setLineStyle:function(p){this.styles[this._styleMap[p].line]={}},_wrapText:function(p,g){var l,c=[];for(this.isWrapping=!0,l=0;l<p.length;l++)c=c.concat(this._wrapLine(p[l],l,g));return this.isWrapping=!1,c},_measureWord:function(p,g,c){var o,l=0;c=c||0;for(var f=0,u=p.length;f<u;f++)l+=this._getGraphemeBox(p[f],g,f+c,o,!0).kernedWidth,o=p[f];return l},_wrapLine:function(p,g,c,l){var o=0,a=this.splitByGrapheme,f=[],u=[],m=a?h.util.string.graphemeSplit(p):p.split(this._wordJoiners),b="",v=0,C=a?"":" ",x=0,T=0,I=0,N=!0,H=this._getWidthOfCharSpacing();l=l||0,0===m.length&&m.push([]),c-=l;for(var W=0;W<m.length;W++)b=a?m[W]:h.util.string.graphemeSplit(m[W]),x=this._measureWord(b,g,v),v+=b.length,(o+=T+x-H)>c&&!N?(f.push(u),u=[],o=x,N=!0):o+=H,!N&&!a&&u.push(C),u=u.concat(b),T=a?0:this._measureWord([C],g,v),v++,N=!1,x>I&&(I=x);return W&&f.push(u),I+l>this.dynamicMinWidth&&(this.dynamicMinWidth=I-H+l),f},isEndOfWrapping:function(p){return!this._styleMap[p+1]||this._styleMap[p+1].line!==this._styleMap[p].line},missingNewlineOffset:function(p){return this.splitByGrapheme?this.isEndOfWrapping(p)?1:0:1},_splitTextIntoLines:function(p){for(var g=h.Text.prototype._splitTextIntoLines.call(this,p),c=this._wrapText(g.lines,this.width),l=new Array(c.length),o=0;o<c.length;o++)l[o]=c[o].join("");return g.lines=l,g.graphemeLines=c,g},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var p={};for(var g in this._styleMap)this._textLines[g]&&(p[this._styleMap[g].line]=1);for(var g in this.styles)p[g]||delete this.styles[g]},toObject:function(p){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(p))}}),h.Textbox.fromObject=function(p,g){var c=h.util.stylesFromArray(p.styles,p.text),l=Object.assign({},p,{styles:c});return h.Object._fromObject("Textbox",l,g,"text")}}($),function(){var _=S.controlsUtils,h=_.scaleSkewCursorStyleHandler,p=_.scaleCursorStyleHandler,g=_.scalingEqually,c=_.scalingYOrSkewingX,l=_.scalingXOrSkewingY,o=_.scaleOrSkewActionName,a=S.Object.prototype.controls;if(a.ml=new S.Control({x:-.5,y:0,cursorStyleHandler:h,actionHandler:l,getActionName:o}),a.mr=new S.Control({x:.5,y:0,cursorStyleHandler:h,actionHandler:l,getActionName:o}),a.mb=new S.Control({x:0,y:.5,cursorStyleHandler:h,actionHandler:c,getActionName:o}),a.mt=new S.Control({x:0,y:-.5,cursorStyleHandler:h,actionHandler:c,getActionName:o}),a.tl=new S.Control({x:-.5,y:-.5,cursorStyleHandler:p,actionHandler:g}),a.tr=new S.Control({x:.5,y:-.5,cursorStyleHandler:p,actionHandler:g}),a.bl=new S.Control({x:-.5,y:.5,cursorStyleHandler:p,actionHandler:g}),a.br=new S.Control({x:.5,y:.5,cursorStyleHandler:p,actionHandler:g}),a.mtr=new S.Control({x:0,y:-.5,actionHandler:_.rotationWithSnapping,cursorStyleHandler:_.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),S.Textbox){var f=S.Textbox.prototype.controls={};f.mtr=a.mtr,f.tr=a.tr,f.br=a.br,f.tl=a.tl,f.bl=a.bl,f.mt=a.mt,f.mb=a.mb,f.mr=new S.Control({x:.5,y:0,actionHandler:_.changeWidth,cursorStyleHandler:h,actionName:"resizing"}),f.ml=new S.Control({x:-.5,y:0,actionHandler:_.changeWidth,cursorStyleHandler:h,actionName:"resizing"})}}()},552:function(module,__unused_webpack_exports,__webpack_require__){var _asyncToGenerator=__webpack_require__(52).default,Ae;Ae=()=>(()=>{"use strict";var __webpack_modules__=[,(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.VerbosityLevel=$.Util=$.UnknownErrorException=$.UnexpectedResponseException=$.UNSUPPORTED_FEATURES=$.TextRenderingMode=$.StreamType=$.RenderingIntentFlag=$.PermissionFlag=$.PasswordResponses=$.PasswordException=$.PageActionEventType=$.OPS=$.MissingPDFException=$.InvalidPDFException=$.ImageKind=$.IDENTITY_MATRIX=$.FormatError=$.FontType=$.FeatureTest=$.FONT_IDENTITY_MATRIX=$.DocumentActionEventType=$.CMapCompressionType=$.BaseException=$.AnnotationType=$.AnnotationStateModelType=$.AnnotationReviewState=$.AnnotationReplyType=$.AnnotationMode=$.AnnotationMarkedState=$.AnnotationFlag=$.AnnotationFieldFlag=$.AnnotationBorderStyleType=$.AnnotationActionEventType=$.AbortException=void 0,$.arrayByteLength=Q,$.arraysToBytes=function(Ce){const re=Ce.length;if(1===re&&Ce[0]instanceof Uint8Array)return Ce[0];let oe=0;for(let Be=0;Be<re;Be++)oe+=Q(Ce[Be]);let De=0;const Me=new Uint8Array(oe);for(let Be=0;Be<re;Be++){let Ve=Ce[Be];Ve instanceof Uint8Array||(Ve="string"==typeof Ve?z(Ve):new Uint8Array(Ve));const ut=Ve.byteLength;Me.set(Ve,De),De+=ut}return Me},$.assert=function(Ce,re){Ce||Y(re)},$.bytesToString=function(Ce){("object"!=typeof Ce||null===Ce||void 0===Ce.length)&&Y("Invalid argument for bytesToString");const re=Ce.length;if(re<8192)return String.fromCharCode.apply(null,Ce);const De=[];for(let Me=0;Me<re;Me+=8192){const Be=Math.min(Me+8192,re),Ve=Ce.subarray(Me,Be);De.push(String.fromCharCode.apply(null,Ve))}return De.join("")},$.createPromiseCapability=function(){const Ce=Object.create(null);let re=!1;return Object.defineProperty(Ce,"settled",{get:()=>re}),Ce.promise=new Promise(function(oe,De){Ce.resolve=function(Me){re=!0,oe(Me)},Ce.reject=function(Me){re=!0,De(Me)}}),Ce},$.createValidAbsoluteUrl=function(Ce,re=null,oe=null){if(!Ce)return null;try{if(oe&&"string"==typeof Ce){if(oe.addDefaultProtocol&&Ce.startsWith("www.")){const Me=Ce.match(/\./g);Me&&Me.length>=2&&(Ce=`http://${Ce}`)}if(oe.tryConvertEncoding)try{Ce=Te(Ce)}catch(Me){}}const De=re?new URL(Ce,re):new URL(Ce);if(function(Ce){if(!Ce)return!1;switch(Ce.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(De))return De}catch(De){}return null},$.escapeString=function(Ce){return Ce.replace(/([()\\\n\r])/g,re=>"\n"===re?"\\n":"\r"===re?"\\r":`\\${re}`)},$.getModificationDate=function(Ce=new Date){return[Ce.getUTCFullYear().toString(),(Ce.getUTCMonth()+1).toString().padStart(2,"0"),Ce.getUTCDate().toString().padStart(2,"0"),Ce.getUTCHours().toString().padStart(2,"0"),Ce.getUTCMinutes().toString().padStart(2,"0"),Ce.getUTCSeconds().toString().padStart(2,"0")].join("")},$.getVerbosityLevel=function(){return W},$.info=function(Ce){W>=x.INFOS&&console.log(`Info: ${Ce}`)},$.isArrayBuffer=function(Ce){return"object"==typeof Ce&&null!==Ce&&void 0!==Ce.byteLength},$.isArrayEqual=function(Ce,re){if(Ce.length!==re.length)return!1;for(let oe=0,De=Ce.length;oe<De;oe++)if(Ce[oe]!==re[oe])return!1;return!0},$.isAscii=function(Ce){return/^[\x00-\x7F]*$/.test(Ce)},$.objectFromMap=function(Ce){const re=Object.create(null);for(const[oe,De]of Ce)re[oe]=De;return re},$.objectSize=function(Ce){return Object.keys(Ce).length},$.setVerbosityLevel=function(Ce){Number.isInteger(Ce)&&(W=Ce)},$.shadow=B,$.string32=function(Ce){return String.fromCharCode(Ce>>24&255,Ce>>16&255,Ce>>8&255,255&Ce)},$.stringToBytes=z,$.stringToPDFString=function(Ce){if(Ce[0]>="\xef"){let oe;if("\xfe"===Ce[0]&&"\xff"===Ce[1]?oe="utf-16be":"\xff"===Ce[0]&&"\xfe"===Ce[1]?oe="utf-16le":"\xef"===Ce[0]&&"\xbb"===Ce[1]&&"\xbf"===Ce[2]&&(oe="utf-8"),oe)try{const De=new TextDecoder(oe,{fatal:!0}),Me=z(Ce);return De.decode(Me)}catch(De){ce(`stringToPDFString: "${De}".`)}}const re=[];for(let oe=0,De=Ce.length;oe<De;oe++){const Me=U[Ce.charCodeAt(oe)];re.push(Me?String.fromCharCode(Me):Ce.charAt(oe))}return re.join("")},$.stringToUTF16BEString=function(Ce){const re=["\xfe\xff"];for(let oe=0,De=Ce.length;oe<De;oe++){const Me=Ce.charCodeAt(oe);re.push(String.fromCharCode(Me>>8&255),String.fromCharCode(255&Me))}return re.join("")},$.stringToUTF8String=Te,$.unreachable=Y,$.utf8StringToString=function(Ce){return unescape(encodeURIComponent(Ce))},$.warn=ce,Ae(2),$.IDENTITY_MATRIX=[1,0,0,1,0,0],$.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],$.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},$.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},$.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},$.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},$.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},$.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},$.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},$.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},$.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},$.AnnotationReplyType={GROUP:"Group",REPLY:"R"},$.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},$.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},$.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},$.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},$.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},$.PageActionEventType={O:"PageOpen",C:"PageClose"},$.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},$.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const x={ERRORS:0,WARNINGS:1,INFOS:5};$.VerbosityLevel=x,$.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},$.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},$.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"},$.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let W=x.WARNINGS;function ce(Ce){W>=x.WARNINGS&&console.log(`Warning: ${Ce}`)}function Y(Ce){throw new Error(Ce)}function B(Ce,re,oe){return Object.defineProperty(Ce,re,{value:oe,enumerable:!0,configurable:!0,writable:!1}),oe}const L=function(){function re(oe,De){this.constructor===re&&Y("Cannot initialize BaseException."),this.message=oe,this.name=De}return re.prototype=new Error,re.constructor=re,re}();function z(Ce){"string"!=typeof Ce&&Y("Invalid argument for stringToBytes");const re=Ce.length,oe=new Uint8Array(re);for(let De=0;De<re;++De)oe[De]=255&Ce.charCodeAt(De);return oe}function Q(Ce){return void 0!==Ce.length?Ce.length:void 0!==Ce.byteLength?Ce.byteLength:void Y("Invalid argument for arrayByteLength")}$.BaseException=L,$.PasswordException=class extends L{constructor(re,oe){super(re,"PasswordException"),this.code=oe}},$.UnknownErrorException=class extends L{constructor(re,oe){super(re,"UnknownErrorException"),this.details=oe}},$.InvalidPDFException=class extends L{constructor(re){super(re,"InvalidPDFException")}},$.MissingPDFException=class extends L{constructor(re){super(re,"MissingPDFException")}},$.UnexpectedResponseException=class extends L{constructor(re,oe){super(re,"UnexpectedResponseException"),this.status=oe}},$.FormatError=class extends L{constructor(re){super(re,"FormatError")}},$.AbortException=class extends L{constructor(re){super(re,"AbortException")}},$.FeatureTest=class{static get isLittleEndian(){return B(this,"isLittleEndian",function(){const Ce=new Uint8Array(4);return Ce[0]=1,1===new Uint32Array(Ce.buffer,0,1)[0]}())}static get isEvalSupported(){return B(this,"isEvalSupported",function(){try{return new Function(""),!0}catch(Ce){return!1}}())}static get isOffscreenCanvasSupported(){return B(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}};const ue=[...Array(256).keys()].map(Ce=>Ce.toString(16).padStart(2,"0"));class ge{static makeHexColor(re,oe,De){return`#${ue[re]}${ue[oe]}${ue[De]}`}static scaleMinMax(re,oe){let De;re[0]?(re[0]<0&&(De=oe[0],oe[0]=oe[1],oe[1]=De),oe[0]*=re[0],oe[1]*=re[0],re[3]<0&&(De=oe[2],oe[2]=oe[3],oe[3]=De),oe[2]*=re[3],oe[3]*=re[3]):(De=oe[0],oe[0]=oe[2],oe[2]=De,De=oe[1],oe[1]=oe[3],oe[3]=De,re[1]<0&&(De=oe[2],oe[2]=oe[3],oe[3]=De),oe[2]*=re[1],oe[3]*=re[1],re[2]<0&&(De=oe[0],oe[0]=oe[1],oe[1]=De),oe[0]*=re[2],oe[1]*=re[2]),oe[0]+=re[4],oe[1]+=re[4],oe[2]+=re[5],oe[3]+=re[5]}static transform(re,oe){return[re[0]*oe[0]+re[2]*oe[1],re[1]*oe[0]+re[3]*oe[1],re[0]*oe[2]+re[2]*oe[3],re[1]*oe[2]+re[3]*oe[3],re[0]*oe[4]+re[2]*oe[5]+re[4],re[1]*oe[4]+re[3]*oe[5]+re[5]]}static applyTransform(re,oe){return[re[0]*oe[0]+re[1]*oe[2]+oe[4],re[0]*oe[1]+re[1]*oe[3]+oe[5]]}static applyInverseTransform(re,oe){const De=oe[0]*oe[3]-oe[1]*oe[2];return[(re[0]*oe[3]-re[1]*oe[2]+oe[2]*oe[5]-oe[4]*oe[3])/De,(-re[0]*oe[1]+re[1]*oe[0]+oe[4]*oe[1]-oe[5]*oe[0])/De]}static getAxialAlignedBoundingBox(re,oe){const De=ge.applyTransform(re,oe),Me=ge.applyTransform(re.slice(2,4),oe),Be=ge.applyTransform([re[0],re[3]],oe),Ve=ge.applyTransform([re[2],re[1]],oe);return[Math.min(De[0],Me[0],Be[0],Ve[0]),Math.min(De[1],Me[1],Be[1],Ve[1]),Math.max(De[0],Me[0],Be[0],Ve[0]),Math.max(De[1],Me[1],Be[1],Ve[1])]}static inverseTransform(re){const oe=re[0]*re[3]-re[1]*re[2];return[re[3]/oe,-re[1]/oe,-re[2]/oe,re[0]/oe,(re[2]*re[5]-re[4]*re[3])/oe,(re[4]*re[1]-re[5]*re[0])/oe]}static apply3dTransform(re,oe){return[re[0]*oe[0]+re[1]*oe[1]+re[2]*oe[2],re[3]*oe[0]+re[4]*oe[1]+re[5]*oe[2],re[6]*oe[0]+re[7]*oe[1]+re[8]*oe[2]]}static singularValueDecompose2dScale(re){const oe=[re[0],re[2],re[1],re[3]],De=re[0]*oe[0]+re[1]*oe[2],Ve=re[2]*oe[1]+re[3]*oe[3],ut=(De+Ve)/2,mt=Math.sqrt((De+Ve)**2-4*(De*Ve-(re[2]*oe[0]+re[3]*oe[2])*(re[0]*oe[1]+re[1]*oe[3])))/2,bt=ut-mt||1;return[Math.sqrt(ut+mt||1),Math.sqrt(bt)]}static normalizeRect(re){const oe=re.slice(0);return re[0]>re[2]&&(oe[0]=re[2],oe[2]=re[0]),re[1]>re[3]&&(oe[1]=re[3],oe[3]=re[1]),oe}static intersect(re,oe){const De=Math.max(Math.min(re[0],re[2]),Math.min(oe[0],oe[2])),Me=Math.min(Math.max(re[0],re[2]),Math.max(oe[0],oe[2]));if(De>Me)return null;const Be=Math.max(Math.min(re[1],re[3]),Math.min(oe[1],oe[3])),Ve=Math.min(Math.max(re[1],re[3]),Math.max(oe[1],oe[3]));return Be>Ve?null:[De,Be,Me,Ve]}static bezierBoundingBox(re,oe,De,Me,Be,Ve,ut,mt){const et=[],bt=[[],[]];let Ke,Ft,jn,kt,We,Vn,Jn,dn;for(let nn=0;nn<2;++nn)if(0===nn?(Ft=6*re-12*De+6*Be,Ke=-3*re+9*De-9*Be+3*ut,jn=3*De-3*re):(Ft=6*oe-12*Me+6*Ve,Ke=-3*oe+9*Me-9*Ve+3*mt,jn=3*Me-3*oe),Math.abs(Ke)<1e-12){if(Math.abs(Ft)<1e-12)continue;kt=-jn/Ft,0<kt&&kt<1&&et.push(kt)}else Jn=Ft*Ft-4*jn*Ke,dn=Math.sqrt(Jn),!(Jn<0)&&(We=(-Ft+dn)/(2*Ke),0<We&&We<1&&et.push(We),Vn=(-Ft-dn)/(2*Ke),0<Vn&&Vn<1&&et.push(Vn));let $t,vn=et.length;const it=vn;for(;vn--;)kt=et[vn],$t=1-kt,bt[0][vn]=$t*$t*$t*re+3*$t*$t*kt*De+3*$t*kt*kt*Be+kt*kt*kt*ut,bt[1][vn]=$t*$t*$t*oe+3*$t*$t*kt*Me+3*$t*kt*kt*Ve+kt*kt*kt*mt;return bt[0][it]=re,bt[1][it]=oe,bt[0][it+1]=ut,bt[1][it+1]=mt,bt[0].length=bt[1].length=it+2,[Math.min(...bt[0]),Math.min(...bt[1]),Math.max(...bt[0]),Math.max(...bt[1])]}}$.Util=ge;const U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Te(Ce){return decodeURIComponent(escape(Ce))}},(Ie,$,Ae)=>{Ae(3)},(Ie,$)=>{Object.defineProperty($,"__esModule",{value:!0}),$.isNodeJS=void 0;const Ae=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);$.isNodeJS=Ae},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var Ie,Ae,S,ke,we,ye,be,le,_,xC,p;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_display_utils=__w_pdfjs_require__(5),_font_loader=__w_pdfjs_require__(7),_annotation_storage=__w_pdfjs_require__(8),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(13),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(14),_metadata=__w_pdfjs_require__(15),_optional_content_config=__w_pdfjs_require__(16),_transport_stream=__w_pdfjs_require__(17),_xfa_text=__w_pdfjs_require__(18);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory,createPDFNetworkStream;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:c,NodeCMapReaderFactory:l,NodeStandardFontDataFactory:o}=__w_pdfjs_require__(19);exports.DefaultCanvasFactory=DefaultCanvasFactory=c,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=l,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=o}function setPDFNetworkStreamFactory(c){createPDFNetworkStream=c}function getDocument(c){const l=new PDFDocumentLoadingTask;let o;if("string"==typeof c||c instanceof URL)o={url:c};else if((0,_util.isArrayBuffer)(c))o={data:c};else if(c instanceof PDFDataRangeTransport)o={range:c};else{if("object"!=typeof c)throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!c.url&&!c.data&&!c.range)throw new Error("Invalid parameter object: need either .data, .range or .url");o=c}const a=Object.create(null);let f=null,u=null;for(const b in o){const v=o[b];switch(b){case"url":if("undefined"!=typeof window)try{a[b]=new URL(v,window.location).href;continue}catch(C){(0,_util.warn)(`Cannot create valid URL: "${C}".`)}else if("string"==typeof v||v instanceof URL){a[b]=v.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":f=v;continue;case"worker":u=v;continue;case"data":if(_is_node.isNodeJS&&"undefined"!=typeof Buffer&&v instanceof Buffer)a[b]=new Uint8Array(v);else{if(v instanceof Uint8Array)break;if("string"==typeof v)a[b]=(0,_util.stringToBytes)(v);else if("object"!=typeof v||null===v||isNaN(v.length)){if(!(0,_util.isArrayBuffer)(v))throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.");a[b]=new Uint8Array(v)}else a[b]=new Uint8Array(v)}continue}a[b]=v}if(a.CMapReaderFactory=a.CMapReaderFactory||DefaultCMapReaderFactory,a.StandardFontDataFactory=a.StandardFontDataFactory||DefaultStandardFontDataFactory,a.ignoreErrors=!0!==a.stopAtErrors,a.fontExtraProperties=!0===a.fontExtraProperties,a.pdfBug=!0===a.pdfBug,a.enableXfa=!0===a.enableXfa,(!Number.isInteger(a.rangeChunkSize)||a.rangeChunkSize<1)&&(a.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),("string"!=typeof a.docBaseUrl||(0,_display_utils.isDataScheme)(a.docBaseUrl))&&(a.docBaseUrl=null),(!Number.isInteger(a.maxImageSize)||a.maxImageSize<-1)&&(a.maxImageSize=-1),"string"!=typeof a.cMapUrl&&(a.cMapUrl=null),"string"!=typeof a.standardFontDataUrl&&(a.standardFontDataUrl=null),"boolean"!=typeof a.useWorkerFetch&&(a.useWorkerFetch=a.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&a.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),"boolean"!=typeof a.isEvalSupported&&(a.isEvalSupported=!0),"boolean"!=typeof a.disableFontFace&&(a.disableFontFace=_is_node.isNodeJS),"boolean"!=typeof a.useSystemFonts&&(a.useSystemFonts=!_is_node.isNodeJS&&!a.disableFontFace),("object"!=typeof a.ownerDocument||null===a.ownerDocument)&&(a.ownerDocument=globalThis.document),"boolean"!=typeof a.disableRange&&(a.disableRange=!1),"boolean"!=typeof a.disableStream&&(a.disableStream=!1),"boolean"!=typeof a.disableAutoFetch&&(a.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(a.verbosity),!u){const b={verbosity:a.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};u=b.port?PDFWorker.fromPort(b):new PDFWorker(b),l._worker=u}const m=l.docId;return u.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const b=_fetchDocument(u,a,f,m),v=new Promise(function(C){let x;f?x=new _transport_stream.PDFDataTransportStream({length:a.length,initialData:a.initialData,progressiveDone:a.progressiveDone,contentDispositionFilename:a.contentDispositionFilename,disableRange:a.disableRange,disableStream:a.disableStream},f):a.data||(x=createPDFNetworkStream({url:a.url,length:a.length,httpHeaders:a.httpHeaders,withCredentials:a.withCredentials,rangeChunkSize:a.rangeChunkSize,disableRange:a.disableRange,disableStream:a.disableStream})),C(x)});return Promise.all([b,v]).then(function([C,x]){if(l.destroyed)throw new Error("Loading aborted");const T=new _message_handler.MessageHandler(m,C,u.port),I=new WorkerTransport(T,l,x,a);l._transport=I,T.send("Ready",null)})}).catch(l._capability.reject),l}function _fetchDocument(c,l,o,a){return _fetchDocument2.apply(this,arguments)}function _fetchDocument2(){return(_fetchDocument2=_asyncToGenerator(function*(c,l,o,a){if(c.destroyed)throw new Error("Worker was destroyed");o&&(l.length=o.length,l.initialData=o.initialData,l.progressiveDone=o.progressiveDone,l.contentDispositionFilename=o.contentDispositionFilename);const f=yield c.messageHandler.sendWithPromise("GetDocRequest",{docId:a,apiVersion:"2.14.305",source:{data:l.data,url:l.url,password:l.password,disableAutoFetch:l.disableAutoFetch,rangeChunkSize:l.rangeChunkSize,length:l.length},maxImageSize:l.maxImageSize,disableFontFace:l.disableFontFace,docBaseUrl:l.docBaseUrl,ignoreErrors:l.ignoreErrors,isEvalSupported:l.isEvalSupported,fontExtraProperties:l.fontExtraProperties,enableXfa:l.enableXfa,useSystemFonts:l.useSystemFonts,cMapUrl:l.useWorkerFetch?l.cMapUrl:null,standardFontDataUrl:l.useWorkerFetch?l.standardFontDataUrl:null});if(c.destroyed)throw new Error("Worker was destroyed");return f})).apply(this,arguments)}const $=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+wC($,Ie)._++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}destroy(){var l=this;return _asyncToGenerator(function*(){var o;l.destroyed=!0,yield null==(o=l._transport)?void 0:o.destroy(),l._transport=null,l._worker&&(l._worker.destroy(),l._worker=null)})()}};let PDFDocumentLoadingTask=$;Ie=new WeakMap,Ze(PDFDocumentLoadingTask,Ie,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,o,a=!1,f=null){this.length=l,this.initialData=o,this.progressiveDone=a,this.contentDispositionFilename=f,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,o){for(const a of this._rangeListeners)a(l,o)}onDataProgress(l,o){this._readyCapability.promise.then(()=>{for(const a of this._progressListeners)a(l,o)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const o of this._progressiveReadListeners)o(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,o){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,o){var f,a=this;this._pdfInfo=l,this._transport=o,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:(f=_asyncToGenerator(function*(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),a.stats||{streamTypes:{},fontTypes:{}}}),function(){return f.apply(this,arguments)})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,o,a,f,u=!1){this._pageIndex=l,this._pageInfo=o,this._ownerDocument=f,this._transport=a,this._stats=u?new _display_utils.StatTimer:null,this._pdfBug=u,this.commonObjs=a.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:o=this.rotate,offsetX:a=0,offsetY:f=0,dontFlip:u=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:o,offsetX:a,offsetY:f,dontFlip:u})}getAnnotations({intent:l="display"}={}){const o=this._transport.getRenderingIntent(l);let a=this._annotationPromises.get(o.cacheKey);return a||(a=this._transport.getAnnotations(this._pageIndex,o.renderingIntent),this._annotationPromises.set(o.cacheKey,a),a=a.then(f=>{for(const u of f)void 0!==u.titleObj&&Object.defineProperty(u,"title",{get:()=>((0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),u.titleObj.str)}),void 0!==u.contentsObj&&Object.defineProperty(u,"contents",{get:()=>((0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),u.contentsObj.str)});return f})),a}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}getXfa(){var l=this;return _asyncToGenerator(function*(){var o;return(null==(o=l._transport._htmlForXfa)?void 0:o.children[l._pageIndex])||null})()}render({canvasContext:l,viewport:o,intent:a="display",annotationMode:f=_util.AnnotationMode.ENABLE,transform:u=null,imageLayer:m=null,canvasFactory:b=null,background:v=null,optionalContentConfigPromise:C=null,annotationCanvasMap:x=null,pageColors:T=null}){var ce,Y;void 0!==(null==(ce=arguments[0])?void 0:ce.renderInteractiveForms)&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),!0===arguments[0].renderInteractiveForms&&f===_util.AnnotationMode.ENABLE&&(f=_util.AnnotationMode.ENABLE_FORMS)),void 0!==(null==(Y=arguments[0])?void 0:Y.includeAnnotationStorage)&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),!0===arguments[0].includeAnnotationStorage&&f===_util.AnnotationMode.ENABLE&&(f=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const I=this._transport.getRenderingIntent(a,f);this.pendingCleanup=!1,C||(C=this._transport.getOptionalContentConfig());let N=this._intentStates.get(I.cacheKey);N||(N=Object.create(null),this._intentStates.set(I.cacheKey,N)),N.streamReaderCancelTimeout&&(clearTimeout(N.streamReaderCancelTimeout),N.streamReaderCancelTimeout=null);const H=b||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),W=!!(I.renderingIntent&_util.RenderingIntentFlag.PRINT);N.displayReadyCapability||(N.displayReadyCapability=(0,_util.createPromiseCapability)(),N.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(I));const K=de=>{N.renderTasks.delete(ne),(this.cleanupAfterRender||W)&&(this.pendingCleanup=!0),this._tryCleanup(),de?(ne.capability.reject(de),this._abortOperatorList({intentState:N,reason:de instanceof Error?de:new Error(de)})):ne.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},ne=new InternalRenderTask({callback:K,params:{canvasContext:l,viewport:o,transform:u,imageLayer:m,background:v},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:x,operatorList:N.operatorList,pageIndex:this._pageIndex,canvasFactory:H,useRequestAnimationFrame:!W,pdfBug:this._pdfBug,pageColors:T});(N.renderTasks||(N.renderTasks=new Set)).add(ne);const ae=ne.task;return Promise.all([N.displayReadyCapability.promise,C]).then(([de,fe])=>{this.pendingCleanup?K():(this._stats&&this._stats.time("Rendering"),ne.initializeGraphics({transparency:de,optionalContentConfig:fe}),ne.operatorListChanged())}).catch(K),ae}getOperatorList({intent:l="display",annotationMode:o=_util.AnnotationMode.ENABLE}={}){const f=this._transport.getRenderingIntent(l,o,!0);let m,u=this._intentStates.get(f.cacheKey);return u||(u=Object.create(null),this._intentStates.set(f.cacheKey,u)),u.opListReadCapability||(m=Object.create(null),m.operatorListChanged=function(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(m))},u.opListReadCapability=(0,_util.createPromiseCapability)(),(u.renderTasks||(u.renderTasks=new Set)).add(m),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(f)),u.opListReadCapability.promise}streamTextContent({disableCombineTextItems:l=!1,includeMarkedContent:o=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:!0!==l,includeMarkedContent:!0===o},{highWaterMark:100,size:f=>f.items.length})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(a=>_xfa_text.XfaText.textContent(a));const o=this.streamTextContent(l);return new Promise(function(a,f){const m=o.getReader(),b={items:[],styles:Object.create(null)};!function u(){m.read().then(function({value:v,done:C}){C?a(b):(Object.assign(b.styles,v.styles),b.items.push(...v.items),u())},f)}()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const l=[];for(const o of this._intentStates.values())if(this._abortOperatorList({intentState:o,reason:new Error("Page was destroyed."),force:!0}),!o.opListReadCapability)for(const a of o.renderTasks)l.push(a.completed),a.cancel();this.objs.clear();for(const o of this._bitmaps)o.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(l)}cleanup(l=!1){return this.pendingCleanup=!0,this._tryCleanup(l)}_tryCleanup(l=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:o,operatorList:a}of this._intentStates.values())if(o.size>0||!a.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,l&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const o of this._bitmaps)o.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(l,o){const a=this._intentStates.get(o);!a||(this._stats&&this._stats.timeEnd("Page Request"),a.displayReadyCapability&&a.displayReadyCapability.resolve(l))}_renderPageChunk(l,o){for(let a=0,f=l.length;a<f;a++)o.operatorList.fnArray.push(l.fnArray[a]),o.operatorList.argsArray.push(l.argsArray[a]);o.operatorList.lastChunk=l.lastChunk;for(const a of o.renderTasks)a.operatorListChanged();l.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:l,cacheKey:o}){const f=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:o,annotationStorage:l&_util.RenderingIntentFlag.ANNOTATIONS_STORAGE?this._transport.annotationStorage.serializable:null}).getReader(),u=this._intentStates.get(o);u.streamReader=f;const m=()=>{f.read().then(({value:b,done:v})=>{v?u.streamReader=null:this._transport.destroyed||(this._renderPageChunk(b,u),m())},b=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const v of u.renderTasks)v.operatorListChanged();this._tryCleanup()}if(u.displayReadyCapability)u.displayReadyCapability.reject(b);else{if(!u.opListReadCapability)throw b;u.opListReadCapability.reject(b)}}})};m()}_abortOperatorList({intentState:l,reason:o,force:a=!1}){if(l.streamReader){if(!a){if(l.renderTasks.size>0)return;if(o instanceof _display_utils.RenderingCancelledException)return void(l.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:l,reason:o,force:!0}),l.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT))}if(l.streamReader.cancel(new _util.AbortException(o.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[f,u]of this._intentStates)if(u===l){this._intentStates.delete(f);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(l,o){const a={data:structuredClone(l,o)};this._deferred.then(()=>{for(const f of this._listeners)f.call(this,a)})}addEventListener(l,o){this._listeners.push(o)}removeEventListener(l,o){const a=this._listeners.indexOf(o);this._listeners.splice(a,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document){const c=null==(Ae=null==document?void 0:document.currentScript)?void 0:Ae.src;c&&(PDFWorkerUtil.fallbackWorkerSrc=c.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(c,l){let o;try{if(o=new URL(c),!o.origin||"null"===o.origin)return!1}catch(f){return!1}const a=new URL(l,o);return o.origin===a.origin},PDFWorkerUtil.createCDNWrapper=function(c){return URL.createObjectURL(new Blob([`importScripts("${c}");`]))};const _PDFWorker=class{constructor({name:c=null,port:l=null,verbosity:o=(0,_util.getVerbosityLevel)()}={}){if(l&&$e(_PDFWorker,S).has(l))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=c,this.destroyed=!1,this.verbosity=o,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,l)return $e(_PDFWorker,S).set(l,this),void this._initializeFromPort(l);this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(c){this._port=c,this._messageHandler=new _message_handler.MessageHandler("main","worker",c),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if("undefined"!=typeof Worker&&!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let c=_PDFWorker.workerSrc;try{PDFWorkerUtil.isSameOrigin(window.location.href,c)||(c=PDFWorkerUtil.createCDNWrapper(new URL(c,window.location).href));const l=new Worker(c),o=new _message_handler.MessageHandler("main","worker",l),a=()=>{l.removeEventListener("error",f),o.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},f=()=>{this._webWorker||a()};l.addEventListener("error",f),o.on("test",m=>{l.removeEventListener("error",f),this.destroyed?a():m?(this._messageHandler=o,this._port=l,this._webWorker=l,this._readyCapability.resolve(),o.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),o.destroy(),l.terminate())}),o.on("ready",m=>{if(l.removeEventListener("error",f),this.destroyed)a();else try{u()}catch(b){this._setupFakeWorker()}});const u=()=>{const m=new Uint8Array;o.send("test",m,[m.buffer])};return void u()}catch(l){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(c=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const l=new LoopbackPort;this._port=l;const o="fake"+PDFWorkerUtil.fakeWorkerId++,a=new _message_handler.MessageHandler(o+"_worker",o,l);c.setup(a,l);const f=new _message_handler.MessageHandler(o,o+"_worker",l);this._messageHandler=f,this._readyCapability.resolve(),f.send("configure",{verbosity:this.verbosity})}).catch(c=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${c.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),$e(_PDFWorker,S).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(c){if(!(null==c?void 0:c.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return $e(this,S).has(c.port)?$e(this,S).get(c.port):new _PDFWorker(c)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var c;try{return(null==(c=globalThis.pdfjsWorker)?void 0:c.WorkerMessageHandler)||null}catch(l){return null}}static get _setupFakeWorkerGlobal(){var _this4=this;const loader=function(){var _ref2=_asyncToGenerator(function*(){const mainWorkerMessageHandler=_this4._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS){const worker=eval("require")(_this4.workerSrc);return worker.WorkerMessageHandler}return yield(0,_display_utils.loadScript)(_this4.workerSrc),window.pdfjsWorker.WorkerMessageHandler});return function(){return _ref2.apply(this,arguments)}}();return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;S=new WeakMap,Ze(PDFWorker,S,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(l,o,a,f){Ze(this,ke,null),Ze(this,we,new Map),Ze(this,ye,new Map),Ze(this,be,null),this.messageHandler=l,this.loadingTask=o,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:o.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:f.ownerDocument,styleElement:f.styleElement}),this._params=f,f.useWorkerFetch||(this.CMapReaderFactory=new f.CMapReaderFactory({baseUrl:f.cMapUrl,isCompressed:f.cMapPacked}),this.StandardFontDataFactory=new f.StandardFontDataFactory({baseUrl:f.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=a,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return $e(this,ke)}getRenderingIntent(l,o=_util.AnnotationMode.ENABLE,a=!1){let f=_util.RenderingIntentFlag.DISPLAY,u="";switch(l){case"any":f=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":f=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(o){case _util.AnnotationMode.DISABLE:f+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:f+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:f+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,u=this.annotationStorage.hash;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${o}`)}return a&&(f+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:f,cacheKey:`${f}_${u}`}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const a of $e(this,we).values())l.push(a._destroy());$e(this,we).clear(),$e(this,ye).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const o=this.messageHandler.sendWithPromise("Terminate",null);return l.push(o),Promise.all(l).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),Ut(this,be,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:o}=this;l.on("GetReader",(a,f)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=u=>{this._lastProgress={loaded:u.loaded,total:u.total}},f.onPull=()=>{this._fullReader.read().then(function({value:u,done:m}){m?f.close():((0,_util.assert)((0,_util.isArrayBuffer)(u),"GetReader - expected an ArrayBuffer."),f.enqueue(new Uint8Array(u),1,[u]))}).catch(u=>{f.error(u)})},f.onCancel=u=>{this._fullReader.cancel(u),f.ready.catch(m=>{if(!this.destroyed)throw m})}}),l.on("ReaderHeadersReady",a=>{const f=(0,_util.createPromiseCapability)(),u=this._fullReader;return u.headersReady.then(()=>{var m;(!u.isStreamingSupported||!u.isRangeSupported)&&(this._lastProgress&&(null==(m=o.onProgress)||m.call(o,this._lastProgress)),u.onProgress=b=>{var v;null==(v=o.onProgress)||v.call(o,{loaded:b.loaded,total:b.total})}),f.resolve({isStreamingSupported:u.isStreamingSupported,isRangeSupported:u.isRangeSupported,contentLength:u.contentLength})},f.reject),f.promise}),l.on("GetRangeReader",(a,f)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const u=this._networkStream.getRangeReader(a.begin,a.end);u?(f.onPull=()=>{u.read().then(function({value:m,done:b}){b?f.close():((0,_util.assert)((0,_util.isArrayBuffer)(m),"GetRangeReader - expected an ArrayBuffer."),f.enqueue(new Uint8Array(m),1,[m]))}).catch(m=>{f.error(m)})},f.onCancel=m=>{u.cancel(m),f.ready.catch(b=>{if(!this.destroyed)throw b})}):f.close()}),l.on("GetDoc",({pdfInfo:a})=>{this._numPages=a.numPages,this._htmlForXfa=a.htmlForXfa,delete a.htmlForXfa,o._capability.resolve(new PDFDocumentProxy(a,this))}),l.on("DocException",function(a){let f;switch(a.name){case"PasswordException":f=new _util.PasswordException(a.message,a.code);break;case"InvalidPDFException":f=new _util.InvalidPDFException(a.message);break;case"MissingPDFException":f=new _util.MissingPDFException(a.message);break;case"UnexpectedResponseException":f=new _util.UnexpectedResponseException(a.message,a.status);break;case"UnknownErrorException":f=new _util.UnknownErrorException(a.message,a.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}o._capability.reject(f)}),l.on("PasswordRequest",a=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),o.onPassword){const f=u=>{u instanceof Error?this._passwordCapability.reject(u):this._passwordCapability.resolve({password:u})};try{o.onPassword(f,a.code)}catch(u){this._passwordCapability.reject(u)}}else this._passwordCapability.reject(new _util.PasswordException(a.message,a.code));return this._passwordCapability.promise}),l.on("DataLoaded",a=>{var f;null==(f=o.onProgress)||f.call(o,{loaded:a.length,total:a.length}),this.downloadInfoCapability.resolve(a)}),l.on("StartRenderPage",a=>{this.destroyed||$e(this,we).get(a.pageIndex)._startRenderPage(a.transparency,a.cacheKey)}),l.on("commonobj",([a,f,u])=>{var m;if(!this.destroyed&&!this.commonObjs.has(a))switch(f){case"Font":const b=this._params;if("error"in u){const x=u.error;(0,_util.warn)(`Error during font loading: ${x}`),this.commonObjs.resolve(a,x);break}let v=null;b.pdfBug&&(null==(m=globalThis.FontInspector)?void 0:m.enabled)&&(v={registerFont(x,T){globalThis.FontInspector.fontAdded(x,T)}});const C=new _font_loader.FontFaceObject(u,{isEvalSupported:b.isEvalSupported,disableFontFace:b.disableFontFace,ignoreErrors:b.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:v});this.fontLoader.bind(C).catch(x=>l.sendWithPromise("FontFallback",{id:a})).finally(()=>{!b.fontExtraProperties&&C.data&&(C.data=null),this.commonObjs.resolve(a,C)});break;case"FontPath":case"Image":this.commonObjs.resolve(a,u);break;default:throw new Error(`Got unknown common object type ${f}`)}}),l.on("obj",([a,f,u,m])=>{var v;if(this.destroyed)return;const b=$e(this,we).get(f);if(!b.objs.has(a))switch(u){case"Image":b.objs.resolve(a,m);const C=8e6;if(m){let x;if(m.bitmap){const{bitmap:T,width:I,height:N}=m;x=I*N*4,b._bitmaps.add(T)}else x=(null==(v=m.data)?void 0:v.length)||0;x>C&&(b.cleanupAfterRender=!0)}break;case"Pattern":b.objs.resolve(a,m);break;default:throw new Error(`Got unknown object type ${u}`)}}),l.on("DocProgress",a=>{var f;this.destroyed||null==(f=o.onProgress)||f.call(o,{loaded:a.loaded,total:a.total})}),l.on("DocStats",a=>{this.destroyed||Ut(this,ke,Object.freeze({streamTypes:Object.freeze(a.streamTypes),fontTypes:Object.freeze(a.fontTypes)}))}),l.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),l.on("FetchBuiltInCMap",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(a):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(a):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:l}){var o,a;this.destroyed||null==(a=(o=this.loadingTask).onUnsupportedFeature)||a.call(o,l)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const o=l-1,a=$e(this,ye).get(o);if(a)return a;const f=this.messageHandler.sendWithPromise("GetPage",{pageIndex:o}).then(u=>{if(this.destroyed)throw new Error("Transport destroyed");const m=new PDFPageProxy(o,u,this,this._params.ownerDocument,this._params.pdfBug);return $e(this,we).set(o,m),m});return $e(this,ye).set(o,f),f}getPageIndex(l){return"object"!=typeof l||null===l||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,o){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:o})}saveDocument(){var l,o;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:null!=(o=null==(l=this._fullReader)?void 0:l.filename)?o:null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return"string"!=typeof l?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return $e(this,be)||Ut(this,be,this.messageHandler.sendWithPromise("GetMetadata",null).then(l=>{var o,a,f,u;return{info:l[0],metadata:l[1]?new _metadata.Metadata(l[1]):null,contentDispositionFilename:null!=(a=null==(o=this._fullReader)?void 0:o.filename)?a:null,contentLength:null!=(u=null==(f=this._fullReader)?void 0:f.contentLength)?u:null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(l=!1){var o=this;return _asyncToGenerator(function*(){if(yield o.messageHandler.sendWithPromise("Cleanup",null),!o.destroyed){for(const a of $e(o,we).values())if(!a.cleanup())throw new Error(`startCleanup: Page ${a.pageNumber} is currently rendering.`);o.commonObjs.clear(),l||o.fontLoader.clear(),Ut(o,be,null),o._getFieldObjectsPromise=null,o._hasJSActionsPromise=null}})()}get loadingParams(){const l=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l.disableAutoFetch,enableXfa:l.enableXfa})}}ke=new WeakMap,we=new WeakMap,ye=new WeakMap,be=new WeakMap;class PDFObjects{constructor(){Ze(this,_),Ze(this,le,Object.create(null))}get(l,o=null){if(o){const f=Xe(this,_,xC).call(this,l);return f.capability.promise.then(()=>o(f.data)),null}const a=$e(this,le)[l];if(!(null==a?void 0:a.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${l}.`);return a.data}has(l){const o=$e(this,le)[l];return(null==o?void 0:o.capability.settled)||!1}resolve(l,o=null){const a=Xe(this,_,xC).call(this,l);a.data=o,a.capability.resolve()}clear(){Ut(this,le,Object.create(null))}}le=new WeakMap,_=new WeakSet,xC=function(l){return $e(this,le)[l]||($e(this,le)[l]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(l){this._internalRenderTask=l,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}exports.RenderTask=RenderTask;const g=class{constructor({callback:l,params:o,objs:a,commonObjs:f,annotationCanvasMap:u,operatorList:m,pageIndex:b,canvasFactory:v,useRequestAnimationFrame:C=!1,pdfBug:x=!1,pageColors:T=null}){this.callback=l,this.params=o,this.objs=a,this.commonObjs=f,this.annotationCanvasMap=u,this.operatorListIdx=null,this.operatorList=m,this._pageIndex=b,this.canvasFactory=v,this._pdfBug=x,this.pageColors=T,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===C&&"undefined"!=typeof window,this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=o.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:o}){var v;if(this.cancelled)return;if(this._canvas){if($e(g,p).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");$e(g,p).add(this._canvas)}this._pdfBug&&(null==(v=globalThis.StepperManager)?void 0:v.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:a,viewport:f,transform:u,imageLayer:m,background:b}=this.params;this.gfx=new _canvas.CanvasGraphics(a,this.commonObjs,this.objs,this.canvasFactory,m,o,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:u,viewport:f,transparency:l,background:b}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(l=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&$e(g,p).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){var l=this;return _asyncToGenerator(function*(){l.cancelled||(l.operatorListIdx=l.gfx.executeOperatorList(l.operatorList,l.operatorListIdx,l._continueBound,l.stepper),l.operatorListIdx===l.operatorList.argsArray.length&&(l.running=!1,l.operatorList.lastChunk&&(l.gfx.endDrawing(),l._canvas&&$e(g,p).delete(l._canvas),l.callback())))})()}};let InternalRenderTask=g;p=new WeakMap,Ze(InternalRenderTask,p,new WeakSet);const version="2.14.305";exports.version=version;const build="eaaa8b4ad";exports.build=build},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.StatTimer=$.RenderingCancelledException=$.PixelsPerInch=$.PageViewport=$.PDFDateString=$.DOMStandardFontDataFactory=$.DOMSVGFactory=$.DOMCanvasFactory=$.DOMCMapReaderFactory=void 0,$.deprecated=function(H){console.log("Deprecated API usage: "+H)},$.getFilenameFromUrl=function(H){const W=H.indexOf("#"),K=H.indexOf("?"),ne=Math.min(W>0?W:H.length,K>0?K:H.length);return H.substring(H.lastIndexOf("/",ne)+1,ne)},$.getPdfFilenameFromUrl=function(H,W="document.pdf"){if("string"!=typeof H)return W;if(o(H))return(0,ke.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),W;const ne=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ae=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(H);let ce=ne.exec(ae[1])||ne.exec(ae[2])||ne.exec(ae[3]);if(ce&&(ce=ce[0],ce.includes("%")))try{ce=ne.exec(decodeURIComponent(ce))[0]}catch(Y){}return ce||W},$.getXfaPageViewport=function(H,{scale:W=1,rotation:K=0}){const{width:ne,height:ae}=H.attributes.style,ce=[0,0,parseInt(ne),parseInt(ae)];return new c({viewBox:ce,scale:W,rotation:K})},$.isDataScheme=o,$.isPdfFile=function(H){return"string"==typeof H&&/\.pdf$/i.test(H)},$.isValidFetchUrl=b,$.loadScript=function(H,W=!1){return new Promise((K,ne)=>{const ae=document.createElement("script");ae.src=H,ae.onload=function(ce){W&&ae.remove(),K(ce)},ae.onerror=function(){ne(new Error(`Cannot load script at: ${ae.src}`))},(document.head||document.documentElement).appendChild(ae)})};var S=Ae(6),ke=Ae(1);const N=class{};let x,ye=N;function le(H){return _.apply(this,arguments)}function _(){return(_=_asyncToGenerator(function*(H,W=!1){if(b(H,document.baseURI)){const K=yield fetch(H);if(!K.ok)throw new Error(K.statusText);return W?new Uint8Array(yield K.arrayBuffer()):(0,ke.stringToBytes)(yield K.text())}return new Promise((K,ne)=>{const ae=new XMLHttpRequest;ae.open("GET",H,!0),W&&(ae.responseType="arraybuffer"),ae.onreadystatechange=()=>{if(ae.readyState===XMLHttpRequest.DONE){if(200===ae.status||0===ae.status){let ce;if(W&&ae.response?ce=new Uint8Array(ae.response):!W&&ae.responseText&&(ce=(0,ke.stringToBytes)(ae.responseText)),ce)return void K(ce)}ne(new Error(ae.statusText))}},ae.send(null)})})).apply(this,arguments)}Yc(ye,"CSS",96),Yc(ye,"PDF",72),Yc(ye,"PDF_TO_CSS_UNITS",N.CSS/N.PDF),$.PixelsPerInch=ye,$.DOMCanvasFactory=class extends S.BaseCanvasFactory{constructor({ownerDocument:W=globalThis.document}={}){super(),this._document=W}_createCanvas(W,K){const ne=this._document.createElement("canvas");return ne.width=W,ne.height=K,ne}},$.DOMCMapReaderFactory=class extends S.BaseCMapReaderFactory{_fetchData(W,K){return le(W,this.isCompressed).then(ne=>({cMapData:ne,compressionType:K}))}},$.DOMStandardFontDataFactory=class extends S.BaseStandardFontDataFactory{_fetchData(W){return le(W,!0)}},$.DOMSVGFactory=class extends S.BaseSVGFactory{_createSVG(W){return document.createElementNS("http://www.w3.org/2000/svg",W)}};class c{constructor({viewBox:W,scale:K,rotation:ne,offsetX:ae=0,offsetY:ce=0,dontFlip:Y=!1}){this.viewBox=W,this.scale=K,this.rotation=ne,this.offsetX=ae,this.offsetY=ce;const de=(W[2]+W[0])/2,fe=(W[3]+W[1])/2;let me,B,L,D,M,E,P,A;switch((ne%=360)<0&&(ne+=360),ne){case 180:me=-1,B=0,L=0,D=1;break;case 90:me=0,B=1,L=1,D=0;break;case 270:me=0,B=-1,L=-1,D=0;break;case 0:me=1,B=0,L=0,D=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Y&&(L=-L,D=-D),0===me?(M=Math.abs(fe-W[1])*K+ae,E=Math.abs(de-W[0])*K+ce,P=Math.abs(W[3]-W[1])*K,A=Math.abs(W[2]-W[0])*K):(M=Math.abs(de-W[0])*K+ae,E=Math.abs(fe-W[1])*K+ce,P=Math.abs(W[2]-W[0])*K,A=Math.abs(W[3]-W[1])*K),this.transform=[me*K,B*K,L*K,D*K,M-me*K*de-L*K*fe,E-B*K*de-D*K*fe],this.width=P,this.height=A}clone({scale:W=this.scale,rotation:K=this.rotation,offsetX:ne=this.offsetX,offsetY:ae=this.offsetY,dontFlip:ce=!1}={}){return new c({viewBox:this.viewBox.slice(),scale:W,rotation:K,offsetX:ne,offsetY:ae,dontFlip:ce})}convertToViewportPoint(W,K){return ke.Util.applyTransform([W,K],this.transform)}convertToViewportRectangle(W){const K=ke.Util.applyTransform([W[0],W[1]],this.transform),ne=ke.Util.applyTransform([W[2],W[3]],this.transform);return[K[0],K[1],ne[0],ne[1]]}convertToPdfPoint(W,K){return ke.Util.applyInverseTransform([W,K],this.transform)}}function o(H){const W=H.length;let K=0;for(;K<W&&""===H[K].trim();)K++;return"data:"===H.substring(K,K+5).toLowerCase()}function b(H,W){try{const{protocol:K}=W?new URL(H,W):new URL(H);return"http:"===K||"https:"===K}catch(K){return!1}}$.PageViewport=c,$.RenderingCancelledException=class extends ke.BaseException{constructor(W,K){super(W,"RenderingCancelledException"),this.type=K}},$.StatTimer=class{constructor(){this.started=Object.create(null),this.times=[]}time(W){W in this.started&&(0,ke.warn)(`Timer is already running for ${W}`),this.started[W]=Date.now()}timeEnd(W){W in this.started||(0,ke.warn)(`Timer has not been started for ${W}`),this.times.push({name:W,start:this.started[W],end:Date.now()}),delete this.started[W]}toString(){const W=[];let K=0;for(const ne of this.times){const ae=ne.name;ae.length>K&&(K=ae.length)}for(const ne of this.times){const ae=ne.end-ne.start;W.push(`${ne.name.padEnd(K)} ${ae}ms\n`)}return W.join("")}},$.PDFDateString=class{static toDateObject(W){if(!W||"string"!=typeof W)return null;x||(x=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const K=x.exec(W);if(!K)return null;const ne=parseInt(K[1],10);let ae=parseInt(K[2],10);ae=ae>=1&&ae<=12?ae-1:0;let ce=parseInt(K[3],10);ce=ce>=1&&ce<=31?ce:1;let Y=parseInt(K[4],10);Y=Y>=0&&Y<=23?Y:0;let de=parseInt(K[5],10);de=de>=0&&de<=59?de:0;let fe=parseInt(K[6],10);fe=fe>=0&&fe<=59?fe:0;const me=K[7]||"Z";let B=parseInt(K[8],10);B=B>=0&&B<=23?B:0;let L=parseInt(K[9],10)||0;return L=L>=0&&L<=59?L:0,"-"===me?(Y+=B,de+=L):"+"===me&&(Y-=B,de-=L),new Date(Date.UTC(ne,ae,ce,Y,de,fe))}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.BaseStandardFontDataFactory=$.BaseSVGFactory=$.BaseCanvasFactory=$.BaseCMapReaderFactory=void 0;var S=Ae(1);class ke{constructor(){this.constructor===ke&&(0,S.unreachable)("Cannot initialize BaseCanvasFactory.")}create(_,h){if(_<=0||h<=0)throw new Error("Invalid canvas size");const p=this._createCanvas(_,h);return{canvas:p,context:p.getContext("2d")}}reset(_,h,p){if(!_.canvas)throw new Error("Canvas is not specified");if(h<=0||p<=0)throw new Error("Invalid canvas size");_.canvas.width=h,_.canvas.height=p}destroy(_){if(!_.canvas)throw new Error("Canvas is not specified");_.canvas.width=0,_.canvas.height=0,_.canvas=null,_.context=null}_createCanvas(_,h){(0,S.unreachable)("Abstract method `_createCanvas` called.")}}$.BaseCanvasFactory=ke;class we{constructor({baseUrl:_=null,isCompressed:h=!1}){this.constructor===we&&(0,S.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=_,this.isCompressed=h}fetch({name:_}){var h=this;return _asyncToGenerator(function*(){if(!h.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!_)throw new Error("CMap name must be specified.");const p=h.baseUrl+_+(h.isCompressed?".bcmap":"");return h._fetchData(p,h.isCompressed?S.CMapCompressionType.BINARY:S.CMapCompressionType.NONE).catch(c=>{throw new Error(`Unable to load ${h.isCompressed?"binary ":""}CMap at: ${p}`)})})()}_fetchData(_,h){(0,S.unreachable)("Abstract method `_fetchData` called.")}}$.BaseCMapReaderFactory=we;class ye{constructor({baseUrl:_=null}){this.constructor===ye&&(0,S.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=_}fetch({filename:_}){var h=this;return _asyncToGenerator(function*(){if(!h.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!_)throw new Error("Font filename must be specified.");const p=`${h.baseUrl}${_}`;return h._fetchData(p).catch(g=>{throw new Error(`Unable to load font data at: ${p}`)})})()}_fetchData(_){(0,S.unreachable)("Abstract method `_fetchData` called.")}}$.BaseStandardFontDataFactory=ye;class be{constructor(){this.constructor===be&&(0,S.unreachable)("Cannot initialize BaseSVGFactory.")}create(_,h){if(_<=0||h<=0)throw new Error("Invalid SVG dimensions");const p=this._createSVG("svg:svg");return p.setAttribute("version","1.1"),p.setAttribute("width",`${_}px`),p.setAttribute("height",`${h}px`),p.setAttribute("preserveAspectRatio","none"),p.setAttribute("viewBox",`0 0 ${_} ${h}`),p}createElement(_){if("string"!=typeof _)throw new Error("Invalid SVG element type");return this._createSVG(_)}_createSVG(_){(0,S.unreachable)("Abstract method `_createSVG` called.")}}$.BaseSVGFactory=be},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.FontLoader=$.FontFaceObject=void 0;var S=Ae(1);class ke{constructor({docId:le,onUnsupportedFeature:_,ownerDocument:h=globalThis.document,styleElement:p=null}){this.constructor===ke&&(0,S.unreachable)("Cannot initialize BaseFontLoader."),this.docId=le,this._onUnsupportedFeature=_,this._document=h,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(le){this.nativeFontFaces.push(le),this._document.fonts.add(le)}insertRule(le){let _=this.styleElement;_||(_=this.styleElement=this._document.createElement("style"),_.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(_));const h=_.sheet;h.insertRule(le,h.cssRules.length)}clear(){for(const le of this.nativeFontFaces)this._document.fonts.delete(le);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}bind(le){var _=this;return _asyncToGenerator(function*(){if(le.attached||le.missingFile)return;if(le.attached=!0,_.isFontLoadingAPISupported){const p=le.createNativeFontFace();if(p){_.addNativeFontFace(p);try{yield p.loaded}catch(g){throw _._onUnsupportedFeature({featureId:S.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,S.warn)(`Failed to load font '${p.family}': '${g}'.`),le.disableFontFace=!0,g}}return}const h=le.createFontFaceRule();if(h){if(_.insertRule(h),_.isSyncFontLoadingSupported)return;yield new Promise(p=>{const g=_._queueLoadingCallback(p);_._prepareFontLoadEvent([h],[le],g)})}})()}_queueLoadingCallback(le){(0,S.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var _;const le=!!(null==(_=this._document)?void 0:_.fonts);return(0,S.shadow)(this,"isFontLoadingAPISupported",le)}get isSyncFontLoadingSupported(){(0,S.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,S.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(le,_,h){(0,S.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let we;$.FontLoader=we,$.FontLoader=we=class extends ke{constructor(le){super(le),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let le=!1;if("undefined"==typeof navigator)le=!0;else{const _=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(null==_?void 0:_[1])>=14&&(le=!0)}return(0,S.shadow)(this,"isSyncFontLoadingSupported",le)}_queueLoadingCallback(le){const h=this.loadingContext,p={id:"pdfjs-font-loading-"+h.nextRequestId++,done:!1,complete:function(){for((0,S.assert)(!p.done,"completeRequest() cannot be called twice."),p.done=!0;h.requests.length>0&&h.requests[0].done;){const g=h.requests.shift();setTimeout(g.callback,0)}},callback:le};return h.requests.push(p),p}get _loadTestFont(){return(0,S.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(le,_,h){function p(K,ne){return K.charCodeAt(ne)<<24|K.charCodeAt(ne+1)<<16|K.charCodeAt(ne+2)<<8|255&K.charCodeAt(ne+3)}function g(K,ne,ae,ce){return K.substring(0,ne)+ce+K.substring(ne+ae)}let c,l;const o=this._document.createElement("canvas");o.width=1,o.height=1;const a=o.getContext("2d");let f=0;const m=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=g(b,976,m.length,m);const x=1482184792;let T=p(b,16);for(c=0,l=m.length-3;c<l;c+=4)T=T-x+p(m,c)|0;c<m.length&&(T=T-x+p(m+"XXX",c)|0),b=g(b,16,4,(0,S.string32)(T));const I=`url(data:font/opentype;base64,${btoa(b)});`;this.insertRule(`@font-face {font-family:"${m}";src:${I}}`);const H=[];for(const K of _)H.push(K.loadedName);H.push(m);const W=this._document.createElement("div");W.style.visibility="hidden",W.style.width=W.style.height="10px",W.style.position="absolute",W.style.top=W.style.left="0px";for(const K of H){const ne=this._document.createElement("span");ne.textContent="Hi",ne.style.fontFamily=K,W.appendChild(ne)}this._document.body.appendChild(W),function u(K,ne){if(f++,f>30)return(0,S.warn)("Load test font never loaded."),void ne();a.font="30px "+K,a.fillText(".",0,20),a.getImageData(0,0,1,1).data[3]>0?ne():setTimeout(u.bind(null,K,ne))}(m,()=>{W.remove(),h.complete()})}},$.FontFaceObject=class{constructor(le,{isEvalSupported:_=!0,disableFontFace:h=!1,ignoreErrors:p=!1,onUnsupportedFeature:g,fontRegistry:c=null}){this.compiledGlyphs=Object.create(null);for(const l in le)this[l]=le[l];this.isEvalSupported=!1!==_,this.disableFontFace=!0===h,this.ignoreErrors=!0===p,this._onUnsupportedFeature=g,this.fontRegistry=c}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let le;if(this.cssFontInfo){const _={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(_.style=`oblique ${this.cssFontInfo.italicAngle}deg`),le=new FontFace(this.cssFontInfo.fontFamily,this.data,_)}else le=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),le}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const le=(0,S.bytesToString)(this.data),_=`url(data:${this.mimetype};base64,${btoa(le)});`;let h;if(this.cssFontInfo){let p=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(p+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),h=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${p}src:${_}}`}else h=`@font-face {font-family:"${this.loadedName}";src:${_}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,_),h}getPathGenerator(le,_){if(void 0!==this.compiledGlyphs[_])return this.compiledGlyphs[_];let h;try{h=le.get(this.loadedName+"_path_"+_)}catch(p){if(!this.ignoreErrors)throw p;return this._onUnsupportedFeature({featureId:S.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,S.warn)(`getPathGenerator - ignoring character: "${p}".`),this.compiledGlyphs[_]=function(g,c){}}if(this.isEvalSupported&&S.FeatureTest.isEvalSupported){const p=[];for(const g of h){const c=void 0!==g.args?g.args.join(","):"";p.push("c.",g.cmd,"(",c,");\n")}return this.compiledGlyphs[_]=new Function("c","size",p.join(""))}return this.compiledGlyphs[_]=function(p,g){for(const c of h)"scale"===c.cmd&&(c.args=[g,-g]),p[c.cmd].apply(p,c.args)}}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.AnnotationStorage=void 0;var S=Ae(9),ke=Ae(1);$.AnnotationStorage=class{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(be,le){const _=this._storage.get(be);return void 0===_?le:Object.assign(le,_)}getRawValue(be){return this._storage.get(be)}setValue(be,le){const _=this._storage.get(be);let h=!1;if(void 0!==_)for(const[p,g]of Object.entries(le))_[p]!==g&&(h=!0,_[p]=g);else h=!0,this._storage.set(be,le);h&&this._setModified()}getAll(){return this._storage.size>0?(0,ke.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}get hash(){const be=new S.MurmurHash3_64;for(const[le,_]of this._storage)be.update(`${le}:${JSON.stringify(_)}`);return be.hexdigest()}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.MurmurHash3_64=void 0;var S=Ae(1);const ke=3285377520,we=4294901760,ye=65535;$.MurmurHash3_64=class{constructor(_){this.h1=_?4294967295&_:ke,this.h2=_?4294967295&_:ke}update(_){let h,p;if("string"==typeof _){h=new Uint8Array(2*_.length),p=0;for(let x=0,T=_.length;x<T;x++){const I=_.charCodeAt(x);I<=255?h[p++]=I:(h[p++]=I>>>8,h[p++]=255&I)}}else{if(!(0,S.isArrayBuffer)(_))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");h=_.slice(),p=h.byteLength}const g=p>>2,c=p-4*g,l=new Uint32Array(h.buffer,0,g);let o=0,a=0,f=this.h1,u=this.h2;const m=3432918353,b=461845907,v=m&ye,C=b&ye;for(let x=0;x<g;x++)1&x?(o=l[x],o=o*m&we|o*v&ye,o=o<<15|o>>>17,o=o*b&we|o*C&ye,f^=o,f=f<<13|f>>>19,f=5*f+3864292196):(a=l[x],a=a*m&we|a*v&ye,a=a<<15|a>>>17,a=a*b&we|a*C&ye,u^=a,u=u<<13|u>>>19,u=5*u+3864292196);switch(o=0,c){case 3:o^=h[4*g+2]<<16;case 2:o^=h[4*g+1]<<8;case 1:o^=h[4*g],o=o*m&we|o*v&ye,o=o<<15|o>>>17,o=o*b&we|o*C&ye,1&g?f^=o:u^=o}this.h1=f,this.h2=u}hexdigest(){let _=this.h1,h=this.h2;_^=h>>>1,_=3981806797*_&we|36045*_&ye,h=4283543511*h&we|(2950163797*(h<<16|_>>>16)&we)>>>16,_^=h>>>1,_=444984403*_&we|60499*_&ye,h=3301882366*h&we|(3120437893*(h<<16|_>>>16)&we)>>>16,_^=h>>>1;const p=(_>>>0).toString(16),g=(h>>>0).toString(16);return p.padStart(8,"0")+g.padStart(8,"0")}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.CanvasGraphics=void 0;var S=Ae(1),ke=Ae(11),we=Ae(12),ye=Ae(3),be=Ae(5);const h=4096,o=16;function u(L){if(L._transformStack&&(L._transformStack=[]),!L.mozCurrentTransform){L._originalSave=L.save,L._originalRestore=L.restore,L._originalRotate=L.rotate,L._originalScale=L.scale,L._originalTranslate=L.translate,L._originalTransform=L.transform,L._originalSetTransform=L.setTransform,L._originalResetTransform=L.resetTransform,L._transformMatrix=L._transformMatrix||[1,0,0,1,0,0],L._transformStack=[];try{const D=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(L),"lineWidth");L._setLineWidth=D.set,L._getLineWidth=D.get,Object.defineProperty(L,"lineWidth",{set:function(E){this._setLineWidth(1.000001*E)},get:function(){return this._getLineWidth()}})}catch(D){}Object.defineProperty(L,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(L,"mozCurrentTransformInverse",{get:function(){const[M,E,P,A,k,R]=this._transformMatrix,j=M*A-E*P,z=E*P-M*A;return[A/j,E/z,P/z,M/j,(A*k-P*R)/z,(E*k-M*R)/j]}}),L.save=function(){const M=this._transformMatrix;this._transformStack.push(M),this._transformMatrix=M.slice(0,6),this._originalSave()},L.restore=function(){0===this._transformStack.length&&(0,S.warn)("Tried to restore a ctx when the stack was already empty.");const M=this._transformStack.pop();M&&(this._transformMatrix=M,this._originalRestore())},L.translate=function(M,E){const P=this._transformMatrix;P[4]=P[0]*M+P[2]*E+P[4],P[5]=P[1]*M+P[3]*E+P[5],this._originalTranslate(M,E)},L.scale=function(M,E){const P=this._transformMatrix;P[0]*=M,P[1]*=M,P[2]*=E,P[3]*=E,this._originalScale(M,E)},L.transform=function(M,E,P,A,k,R){const j=this._transformMatrix;this._transformMatrix=[j[0]*M+j[2]*E,j[1]*M+j[3]*E,j[0]*P+j[2]*A,j[1]*P+j[3]*A,j[0]*k+j[2]*R+j[4],j[1]*k+j[3]*R+j[5]],L._originalTransform(M,E,P,A,k,R)},L.setTransform=function(M,E,P,A,k,R){this._transformMatrix=[M,E,P,A,k,R],L._originalSetTransform(M,E,P,A,k,R)},L.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],L._originalResetTransform()},L.rotate=function(M){const E=Math.cos(M),P=Math.sin(M),A=this._transformMatrix;this._transformMatrix=[A[0]*E+A[2]*P,A[1]*E+A[3]*P,A[0]*-P+A[2]*E,A[1]*-P+A[3]*E,A[4],A[5]],this._originalRotate(M)}}}class m{constructor(D){this.canvasFactory=D,this.cache=Object.create(null)}getCanvas(D,M,E,P){let A;return void 0!==this.cache[D]?(A=this.cache[D],this.canvasFactory.reset(A,M,E),A.context.setTransform(1,0,0,1,0,0)):(A=this.canvasFactory.create(M,E),this.cache[D]=A),P&&u(A.context),A}delete(D){delete this.cache[D]}clear(){for(const D in this.cache)this.canvasFactory.destroy(this.cache[D]),delete this.cache[D]}}function b(L,D,M,E,P,A,k,R,j,z){const[Q,ee,se,J,X,he]=L.mozCurrentTransform;if(0===ee&&0===se){const ge=Math.round(k*Q+X),q=Math.round(R*J+he),Se=Math.abs(Math.round((k+j)*Q+X)-ge)||1,Te=Math.abs(Math.round((R+z)*J+he)-q)||1;return L.setTransform(Math.sign(Q),0,0,Math.sign(J),ge,q),L.drawImage(D,M,E,P,A,0,0,Se,Te),L.setTransform(Q,ee,se,J,X,he),[Se,Te]}if(0===Q&&0===J){const ge=Math.round(R*se+X),q=Math.round(k*ee+he),Se=Math.abs(Math.round((R+z)*se+X)-ge)||1,Te=Math.abs(Math.round((k+j)*ee+he)-q)||1;return L.setTransform(0,Math.sign(ee),Math.sign(se),0,ge,q),L.drawImage(D,M,E,P,A,0,0,Te,Se),L.setTransform(Q,ee,se,J,X,he),[Te,Se]}return L.drawImage(D,M,E,P,A,k,R,j,z),[Math.hypot(Q,ee)*j,Math.hypot(se,J)*z]}class C{constructor(D,M){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=S.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=S.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=S.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,D,M])}clone(){const D=Object.create(this);return D.clipBox=this.clipBox.slice(),D}setCurrentPoint(D,M){this.x=D,this.y=M}updatePathMinMax(D,M,E){[M,E]=S.Util.applyTransform([M,E],D),this.minX=Math.min(this.minX,M),this.minY=Math.min(this.minY,E),this.maxX=Math.max(this.maxX,M),this.maxY=Math.max(this.maxY,E)}updateRectMinMax(D,M){const E=S.Util.applyTransform(M,D),P=S.Util.applyTransform(M.slice(2),D);this.minX=Math.min(this.minX,E[0],P[0]),this.minY=Math.min(this.minY,E[1],P[1]),this.maxX=Math.max(this.maxX,E[0],P[0]),this.maxY=Math.max(this.maxY,E[1],P[1])}updateScalingPathMinMax(D,M){S.Util.scaleMinMax(D,M),this.minX=Math.min(this.minX,M[0]),this.maxX=Math.max(this.maxX,M[1]),this.minY=Math.min(this.minY,M[2]),this.maxY=Math.max(this.maxY,M[3])}updateCurvePathMinMax(D,M,E,P,A,k,R,j,z,Q){const ee=S.Util.bezierBoundingBox(M,E,P,A,k,R,j,z);if(Q)return Q[0]=Math.min(Q[0],ee[0],ee[2]),Q[1]=Math.max(Q[1],ee[0],ee[2]),Q[2]=Math.min(Q[2],ee[1],ee[3]),void(Q[3]=Math.max(Q[3],ee[1],ee[3]));this.updateRectMinMax(D,ee)}getPathBoundingBox(D=ke.PathType.FILL,M=null){const E=[this.minX,this.minY,this.maxX,this.maxY];if(D===ke.PathType.STROKE){M||(0,S.unreachable)("Stroke bounding box must include transform.");const P=S.Util.singularValueDecompose2dScale(M),A=P[0]*this.lineWidth/2,k=P[1]*this.lineWidth/2;E[0]-=A,E[1]-=k,E[2]+=A,E[3]+=k}return E}updateClipFromPath(){const D=S.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(D||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(D){this.clipBox=D,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(D=ke.PathType.FILL,M=null){return S.Util.intersect(this.clipBox,this.getPathBoundingBox(D,M))}}function x(L,D,M=null){if("undefined"!=typeof ImageData&&D instanceof ImageData)return void L.putImageData(D,0,0);const E=D.height,P=D.width,A=E%o,k=(E-A)/o,R=0===A?k:k+1,j=L.createImageData(P,o);let Q,z=0;const ee=D.data,se=j.data;let J,X,he,_e,te,ue,ge,U;if(M)switch(M.length){case 1:te=M[0],ue=M[0],ge=M[0],U=M[0];break;case 4:te=M[0],ue=M[1],ge=M[2],U=M[3]}if(D.kind===S.ImageKind.GRAYSCALE_1BPP){const q=ee.byteLength,Z=new Uint32Array(se.buffer,0,se.byteLength>>2),Se=Z.length,xe=P+7>>3;let Te=4294967295,Re=S.FeatureTest.isLittleEndian?4278190080:255;for(U&&255===U[0]&&0===U[255]&&([Te,Re]=[Re,Te]),J=0;J<R;J++){for(he=J<k?o:A,Q=0,X=0;X<he;X++){const Oe=q-z;let Ye=0;const qe=Oe>xe?P:8*Oe-7,yt=-8&qe;let Ce=0,re=0;for(;Ye<yt;Ye+=8)re=ee[z++],Z[Q++]=128&re?Te:Re,Z[Q++]=64&re?Te:Re,Z[Q++]=32&re?Te:Re,Z[Q++]=16&re?Te:Re,Z[Q++]=8&re?Te:Re,Z[Q++]=4&re?Te:Re,Z[Q++]=2&re?Te:Re,Z[Q++]=1&re?Te:Re;for(;Ye<qe;Ye++)0===Ce&&(re=ee[z++],Ce=128),Z[Q++]=re&Ce?Te:Re,Ce>>=1}for(;Q<Se;)Z[Q++]=0;L.putImageData(j,0,J*o)}}else if(D.kind===S.ImageKind.RGBA_32BPP){const q=!!(te||ue||ge);for(X=0,_e=P*o*4,J=0;J<k;J++){if(se.set(ee.subarray(z,z+_e)),z+=_e,q)for(let Z=0;Z<_e;Z+=4)te&&(se[Z+0]=te[se[Z+0]]),ue&&(se[Z+1]=ue[se[Z+1]]),ge&&(se[Z+2]=ge[se[Z+2]]);L.putImageData(j,0,X),X+=o}if(J<R){if(_e=P*A*4,se.set(ee.subarray(z,z+_e)),q)for(let Z=0;Z<_e;Z+=4)te&&(se[Z+0]=te[se[Z+0]]),ue&&(se[Z+1]=ue[se[Z+1]]),ge&&(se[Z+2]=ge[se[Z+2]]);L.putImageData(j,0,X)}}else{if(D.kind!==S.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${D.kind}`);{const q=!!(te||ue||ge);for(he=o,_e=P*he,J=0;J<R;J++){for(J>=k&&(he=A,_e=P*he),Q=0,X=_e;X--;)se[Q++]=ee[z++],se[Q++]=ee[z++],se[Q++]=ee[z++],se[Q++]=255;if(q)for(let Z=0;Z<Q;Z+=4)te&&(se[Z+0]=te[se[Z+0]]),ue&&(se[Z+1]=ue[se[Z+1]]),ge&&(se[Z+2]=ge[se[Z+2]]);L.putImageData(j,0,J*o)}}}}function T(L,D){if(D.bitmap)return void L.drawImage(D.bitmap,0,0);const M=D.height,E=D.width,P=M%o,A=(M-P)/o,k=0===P?A:A+1,R=L.createImageData(E,o);let j=0;const z=D.data,Q=R.data;for(let ee=0;ee<k;ee++){const se=ee<A?o:P;({srcPos:j}=(0,we.applyMaskImageData)({src:z,srcPos:j,dest:Q,width:E,height:se})),L.putImageData(R,0,ee*o)}}function I(L,D){const M=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let E=0,P=M.length;E<P;E++){const A=M[E];void 0!==L[A]&&(D[A]=L[A])}void 0!==L.setLineDash&&(D.setLineDash(L.getLineDash()),D.lineDashOffset=L.lineDashOffset)}function N(L,D){L.strokeStyle=L.fillStyle=D||"#000000",L.fillRule="nonzero",L.globalAlpha=1,L.lineWidth=1,L.lineCap="butt",L.lineJoin="miter",L.miterLimit=10,L.globalCompositeOperation="source-over",L.font="10px sans-serif",void 0!==L.setLineDash&&(L.setLineDash([]),L.lineDashOffset=0)}function H(L,D,M,E){const P=L.length;for(let A=3;A<P;A+=4){const k=L[A];if(0===k)L[A-3]=D,L[A-2]=M,L[A-1]=E;else if(k<255){const R=255-k;L[A-3]=L[A-3]*k+D*R>>8,L[A-2]=L[A-2]*k+M*R>>8,L[A-1]=L[A-1]*k+E*R>>8}}}function W(L,D,M){const E=L.length;for(let A=3;A<E;A+=4)D[A]=D[A]*(M?M[L[A]]:L[A])*.00392156862745098|0}function K(L,D,M){const E=L.length;for(let P=3;P<E;P+=4){const A=77*L[P-3]+152*L[P-2]+28*L[P-1];D[P]=M?D[P]*M[A>>8]>>8:D[P]*A>>16}}function ce(L,D){const M=S.Util.singularValueDecompose2dScale(L);M[0]=Math.fround(M[0]),M[1]=Math.fround(M[1]);const E=Math.fround((globalThis.devicePixelRatio||1)*be.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==D?D:M[0]<=E||M[1]<=E}const Y=["butt","round","square"],de=["miter","round","bevel"],fe={},me={};class B{constructor(D,M,E,P,A,k,R,j){this.ctx=D,this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=M,this.objs=E,this.canvasFactory=P,this.imageLayer=A,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=k,this.cachedCanvases=new m(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=R,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(null==j?void 0:j.background)||null,this.foregroundColor=(null==j?void 0:j.foreground)||null,D&&u(D),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(D,M=null){return"string"==typeof D?D.startsWith("g_")?this.commonObjs.get(D):this.objs.get(D):M}beginDrawing({transform:D,viewport:M,transparency:E=!1,background:P=null}){const A=this.ctx.canvas.width,k=this.ctx.canvas.height,R=P||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const j=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const z=this.backgroundColor=this.ctx.fillStyle;let Q=!0,ee=R;if(this.ctx.fillStyle=R,ee=this.ctx.fillStyle,Q="string"==typeof ee&&/^#[0-9A-Fa-f]{6}$/.test(ee),"#000000"===j&&"#ffffff"===z||j===z||!Q)this.foregroundColor=this.backgroundColor=null;else{const se=parseInt(ee.slice(1),16),X=(se&&65280)>>8,he=se&&255,_e=ue=>(ue/=255)<=.03928?ue/12.92:((ue+.055)/1.055)**2.4,te=Math.round(.2126*_e((se&&16711680)>>16)+.7152*_e(X)+.0722*_e(he));this.selectColor=(ue,ge,U)=>{const q=.2126*_e(ue)+.7152*_e(ge)+.0722*_e(U);return Math.round(q)===te?z:j}}}if(this.ctx.fillStyle=this.backgroundColor||R,this.ctx.fillRect(0,0,A,k),this.ctx.restore(),E){const j=this.cachedCanvases.getCanvas("transparent",A,k,!0);this.compositeCtx=this.ctx,this.transparentCanvas=j.canvas,this.ctx=j.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),N(this.ctx,this.foregroundColor),D&&(this.ctx.transform.apply(this.ctx,D),this.outputScaleX=D[0],this.outputScaleY=D[0]),this.ctx.transform.apply(this.ctx,M.transform),this.viewportScale=M.scale,this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()}executeOperatorList(D,M,E,P){const A=D.argsArray,k=D.fnArray;let R=M||0;const j=A.length;if(j===R)return R;const z=j-R>10&&"function"==typeof E,Q=z?Date.now()+15:0;let ee=0;const se=this.commonObjs,J=this.objs;let X;for(;;){if(void 0!==P&&R===P.nextBreakPoint)return P.breakIt(R,E),R;if(X=k[R],X!==S.OPS.dependency)this[X].apply(this,A[R]);else for(const he of A[R]){const _e=he.startsWith("g_")?se:J;if(!_e.has(he))return _e.get(he,E),R}if(R++,R===j)return R;if(z&&++ee>10){if(Date.now()>Q)return E(),R;ee=0}}}endDrawing(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const D of this._cachedBitmapsMap.values()){for(const M of D.values())"undefined"!=typeof HTMLCanvasElement&&M instanceof HTMLCanvasElement&&(M.width=M.height=0);D.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(D,M){const E=D.width,P=D.height;let Q,ee,A=Math.max(Math.hypot(M[0],M[1]),1),k=Math.max(Math.hypot(M[2],M[3]),1),R=E,j=P,z="prescale1";for(;A>2&&R>1||k>2&&j>1;){let se=R,J=j;A>2&&R>1&&(se=Math.ceil(R/2),A/=R/se),k>2&&j>1&&(J=Math.ceil(j/2),k/=j/J),Q=this.cachedCanvases.getCanvas(z,se,J,!1),ee=Q.context,ee.clearRect(0,0,se,J),ee.drawImage(D,0,0,R,j,0,0,se,J),D=Q.canvas,R=se,j=J,z="prescale1"===z?"prescale2":"prescale1"}return{img:D,paintWidth:R,paintHeight:j}}_createMaskCanvas(D){const M=this.ctx,{width:E,height:P}=D,A=this.current.fillColor,k=this.current.patternFill,R=M.mozCurrentTransform;let j,z,Q,ee;if((D.bitmap||D.data)&&D.count>1){const Se=D.bitmap||D.data.buffer,xe=R.slice(0,4);z=JSON.stringify(k?xe:[xe,A]),j=this._cachedBitmapsMap.get(Se),j||(j=new Map,this._cachedBitmapsMap.set(Se,j));const Te=j.get(z);if(Te&&!k)return{canvas:Te,offsetX:Math.round(Math.min(R[0],R[2])+R[4]),offsetY:Math.round(Math.min(R[1],R[3])+R[5])};Q=Te}Q||(ee=this.cachedCanvases.getCanvas("maskCanvas",E,P,!1),T(ee.context,D));let se=S.Util.transform(R,[1/E,0,0,-1/P,0,0]);se=S.Util.transform(se,[1,0,0,1,0,-P]);const J=S.Util.applyTransform([0,0],se),X=S.Util.applyTransform([E,P],se),he=S.Util.normalizeRect([J[0],J[1],X[0],X[1]]),_e=Math.round(he[2]-he[0])||1,te=Math.round(he[3]-he[1])||1,ue=this.cachedCanvases.getCanvas("fillCanvas",_e,te,!0),ge=ue.context,U=Math.min(J[0],X[0]),q=Math.min(J[1],X[1]);ge.translate(-U,-q),ge.transform.apply(ge,se),Q||(Q=this._scaleImage(ee.canvas,ge.mozCurrentTransformInverse),Q=Q.img,j&&k&&j.set(z,Q)),ge.imageSmoothingEnabled=ce(ge.mozCurrentTransform,D.interpolate),b(ge,Q,0,0,Q.width,Q.height,0,0,E,P),ge.globalCompositeOperation="source-in";const Z=S.Util.transform(ge.mozCurrentTransformInverse,[1,0,0,1,-U,-q]);return ge.fillStyle=k?A.getPattern(M,this,Z,ke.PathType.FILL):A,ge.fillRect(0,0,E,P),j&&!k&&(this.cachedCanvases.delete("fillCanvas"),j.set(z,ue.canvas)),{canvas:ue.canvas,offsetX:Math.round(U),offsetY:Math.round(q)}}setLineWidth(D){D!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=D,this.ctx.lineWidth=D}setLineCap(D){this.ctx.lineCap=Y[D]}setLineJoin(D){this.ctx.lineJoin=de[D]}setMiterLimit(D){this.ctx.miterLimit=D}setDash(D,M){const E=this.ctx;void 0!==E.setLineDash&&(E.setLineDash(D),E.lineDashOffset=M)}setRenderingIntent(D){}setFlatness(D){}setGState(D){for(let M=0,E=D.length;M<E;M++){const P=D[M],k=P[1];switch(P[0]){case"LW":this.setLineWidth(k);break;case"LC":this.setLineCap(k);break;case"LJ":this.setLineJoin(k);break;case"ML":this.setMiterLimit(k);break;case"D":this.setDash(k[0],k[1]);break;case"RI":this.setRenderingIntent(k);break;case"FL":this.setFlatness(k);break;case"Font":this.setFont(k[0],k[1]);break;case"CA":this.current.strokeAlpha=P[1];break;case"ca":this.current.fillAlpha=P[1],this.ctx.globalAlpha=P[1];break;case"BM":this.ctx.globalCompositeOperation=k;break;case"SMask":this.current.activeSMask=k?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=k}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const D=this.inSMaskMode;this.current.activeSMask&&!D?this.beginSMaskMode():!this.current.activeSMask&&D&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const P=this.cachedCanvases.getCanvas("smaskGroupAt"+this.groupLevel,this.ctx.canvas.width,this.ctx.canvas.height,!0);this.suspendedCtx=this.ctx,this.ctx=P.context;const A=this.ctx;A.setTransform.apply(A,this.suspendedCtx.mozCurrentTransform),I(this.suspendedCtx,A),function(L,D){if(L._removeMirroring)throw new Error("Context is already forwarding operations.");L.__originalSave=L.save,L.__originalRestore=L.restore,L.__originalRotate=L.rotate,L.__originalScale=L.scale,L.__originalTranslate=L.translate,L.__originalTransform=L.transform,L.__originalSetTransform=L.setTransform,L.__originalResetTransform=L.resetTransform,L.__originalClip=L.clip,L.__originalMoveTo=L.moveTo,L.__originalLineTo=L.lineTo,L.__originalBezierCurveTo=L.bezierCurveTo,L.__originalRect=L.rect,L.__originalClosePath=L.closePath,L.__originalBeginPath=L.beginPath,L._removeMirroring=()=>{L.save=L.__originalSave,L.restore=L.__originalRestore,L.rotate=L.__originalRotate,L.scale=L.__originalScale,L.translate=L.__originalTranslate,L.transform=L.__originalTransform,L.setTransform=L.__originalSetTransform,L.resetTransform=L.__originalResetTransform,L.clip=L.__originalClip,L.moveTo=L.__originalMoveTo,L.lineTo=L.__originalLineTo,L.bezierCurveTo=L.__originalBezierCurveTo,L.rect=L.__originalRect,L.closePath=L.__originalClosePath,L.beginPath=L.__originalBeginPath,delete L._removeMirroring},L.save=function(){D.save(),this.__originalSave()},L.restore=function(){D.restore(),this.__originalRestore()},L.translate=function(E,P){D.translate(E,P),this.__originalTranslate(E,P)},L.scale=function(E,P){D.scale(E,P),this.__originalScale(E,P)},L.transform=function(E,P,A,k,R,j){D.transform(E,P,A,k,R,j),this.__originalTransform(E,P,A,k,R,j)},L.setTransform=function(E,P,A,k,R,j){D.setTransform(E,P,A,k,R,j),this.__originalSetTransform(E,P,A,k,R,j)},L.resetTransform=function(){D.resetTransform(),this.__originalResetTransform()},L.rotate=function(E){D.rotate(E),this.__originalRotate(E)},L.clip=function(E){D.clip(E),this.__originalClip(E)},L.moveTo=function(M,E){D.moveTo(M,E),this.__originalMoveTo(M,E)},L.lineTo=function(M,E){D.lineTo(M,E),this.__originalLineTo(M,E)},L.bezierCurveTo=function(M,E,P,A,k,R){D.bezierCurveTo(M,E,P,A,k,R),this.__originalBezierCurveTo(M,E,P,A,k,R)},L.rect=function(M,E,P,A){D.rect(M,E,P,A),this.__originalRect(M,E,P,A)},L.closePath=function(){D.closePath(),this.__originalClosePath()},L.beginPath=function(){D.beginPath(),this.__originalBeginPath()}}(A,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),I(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(D){this.current.activeSMask&&(D?(D[0]=Math.floor(D[0]),D[1]=Math.floor(D[1]),D[2]=Math.ceil(D[2]),D[3]=Math.ceil(D[3])):D=[0,0,this.ctx.canvas.width,this.ctx.canvas.height],function(L,D,M,E){const P=E[0],A=E[1],k=E[2]-P,R=E[3]-A;0===k||0===R||(function(L,D,M,E,P,A,k,R,j,z,Q){const ee=!!A,se=ee?A[0]:0,J=ee?A[1]:0,X=ee?A[2]:0;let he;he="Luminosity"===P?K:W;const te=Math.min(E,Math.ceil(1048576/M));for(let ue=0;ue<E;ue+=te){const ge=Math.min(te,E-ue),U=L.getImageData(R-z,ue+(j-Q),M,ge),q=D.getImageData(R,ue+j,M,ge);ee&&H(U.data,se,J,X),he(U.data,q.data,k),D.putImageData(q,R,ue+j)}}(D.context,M,k,R,D.subtype,D.backdrop,D.transferMap,P,A,D.offsetX,D.offsetY),L.save(),L.globalAlpha=1,L.globalCompositeOperation="source-over",L.setTransform(1,0,0,1,0,0),L.drawImage(M.canvas,0,0),L.restore())}(this.suspendedCtx,this.current.activeSMask,this.ctx,D),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore())}save(){this.inSMaskMode?(I(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const D=this.current;this.stateStack.push(D),this.current=D.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),I(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(D,M,E,P,A,k){this.ctx.transform(D,M,E,P,A,k),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(D,M,E){const P=this.ctx,A=this.current;let j,z,k=A.x,R=A.y;const Q=P.mozCurrentTransform,ee=0===Q[0]&&0===Q[3]||0===Q[1]&&0===Q[2],se=ee?E.slice(0):null;for(let J=0,X=0,he=D.length;J<he;J++)switch(0|D[J]){case S.OPS.rectangle:k=M[X++],R=M[X++];const _e=M[X++],te=M[X++],ue=k+_e,ge=R+te;P.moveTo(k,R),0===_e||0===te?P.lineTo(ue,ge):(P.lineTo(ue,R),P.lineTo(ue,ge),P.lineTo(k,ge)),ee||A.updateRectMinMax(Q,[k,R,ue,ge]),P.closePath();break;case S.OPS.moveTo:k=M[X++],R=M[X++],P.moveTo(k,R),ee||A.updatePathMinMax(Q,k,R);break;case S.OPS.lineTo:k=M[X++],R=M[X++],P.lineTo(k,R),ee||A.updatePathMinMax(Q,k,R);break;case S.OPS.curveTo:j=k,z=R,k=M[X+4],R=M[X+5],P.bezierCurveTo(M[X],M[X+1],M[X+2],M[X+3],k,R),A.updateCurvePathMinMax(Q,j,z,M[X],M[X+1],M[X+2],M[X+3],k,R,se),X+=6;break;case S.OPS.curveTo2:j=k,z=R,P.bezierCurveTo(k,R,M[X],M[X+1],M[X+2],M[X+3]),A.updateCurvePathMinMax(Q,j,z,k,R,M[X],M[X+1],M[X+2],M[X+3],se),k=M[X+2],R=M[X+3],X+=4;break;case S.OPS.curveTo3:j=k,z=R,k=M[X+2],R=M[X+3],P.bezierCurveTo(M[X],M[X+1],k,R,k,R),A.updateCurvePathMinMax(Q,j,z,M[X],M[X+1],k,R,k,R,se),X+=4;break;case S.OPS.closePath:P.closePath()}ee&&A.updateScalingPathMinMax(Q,se),A.setCurrentPoint(k,R)}closePath(){this.ctx.closePath()}stroke(D){D=void 0===D||D;const M=this.ctx,E=this.current.strokeColor;M.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof E&&(null==E?void 0:E.getPattern)?(M.save(),M.strokeStyle=E.getPattern(M,this,M.mozCurrentTransformInverse,ke.PathType.STROKE),this.rescaleAndStroke(!1),M.restore()):this.rescaleAndStroke(!0)),D&&this.consumePath(this.current.getClippedPathBoundingBox()),M.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(D){D=void 0===D||D;const M=this.ctx,E=this.current.fillColor;let A=!1;this.current.patternFill&&(M.save(),M.fillStyle=E.getPattern(M,this,M.mozCurrentTransformInverse,ke.PathType.FILL),A=!0);const k=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==k&&(this.pendingEOFill?(M.fill("evenodd"),this.pendingEOFill=!1):M.fill()),A&&M.restore(),D&&this.consumePath(k)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=fe}eoClip(){this.pendingClip=me}beginText(){this.current.textMatrix=S.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const D=this.pendingTextPaths,M=this.ctx;if(void 0!==D){M.save(),M.beginPath();for(let E=0;E<D.length;E++){const P=D[E];M.setTransform.apply(M,P.transform),M.translate(P.x,P.y),P.addToPath(M,P.fontSize)}M.restore(),M.clip(),M.beginPath(),delete this.pendingTextPaths}else M.beginPath()}setCharSpacing(D){this.current.charSpacing=D}setWordSpacing(D){this.current.wordSpacing=D}setHScale(D){this.current.textHScale=D/100}setLeading(D){this.current.leading=-D}setFont(D,M){const E=this.commonObjs.get(D),P=this.current;if(!E)throw new Error(`Can't find font for ${D}`);if(P.fontMatrix=E.fontMatrix||S.FONT_IDENTITY_MATRIX,(0===P.fontMatrix[0]||0===P.fontMatrix[3])&&(0,S.warn)("Invalid font matrix for font "+D),M<0?(M=-M,P.fontDirection=-1):P.fontDirection=1,this.current.font=E,this.current.fontSize=M,E.isType3Font)return;let k="normal";E.black?k="900":E.bold&&(k="bold");const R=E.italic?"italic":"normal",j=`"${E.loadedName||"sans-serif"}", ${E.fallbackName}`;let z=M;M<16?z=16:M>100&&(z=100),this.current.fontSizeScale=M/z,this.ctx.font=`${R} ${k} ${z}px ${j}`}setTextRenderingMode(D){this.current.textRenderingMode=D}setTextRise(D){this.current.textRise=D}moveText(D,M){this.current.x=this.current.lineX+=D,this.current.y=this.current.lineY+=M}setLeadingMoveText(D,M){this.setLeading(-M),this.moveText(D,M)}setTextMatrix(D,M,E,P,A,k){this.current.textMatrix=[D,M,E,P,A,k],this.current.textMatrixScale=Math.hypot(D,M),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(D,M,E,P){const A=this.ctx,k=this.current,R=k.font,j=k.textRenderingMode,z=k.fontSize/k.fontSizeScale,Q=j&S.TextRenderingMode.FILL_STROKE_MASK,ee=!!(j&S.TextRenderingMode.ADD_TO_PATH_FLAG),se=k.patternFill&&!R.missingFile;let J;(R.disableFontFace||ee||se)&&(J=R.getPathGenerator(this.commonObjs,D)),R.disableFontFace||se?(A.save(),A.translate(M,E),A.beginPath(),J(A,z),P&&A.setTransform.apply(A,P),(Q===S.TextRenderingMode.FILL||Q===S.TextRenderingMode.FILL_STROKE)&&A.fill(),(Q===S.TextRenderingMode.STROKE||Q===S.TextRenderingMode.FILL_STROKE)&&A.stroke(),A.restore()):((Q===S.TextRenderingMode.FILL||Q===S.TextRenderingMode.FILL_STROKE)&&A.fillText(D,M,E),(Q===S.TextRenderingMode.STROKE||Q===S.TextRenderingMode.FILL_STROKE)&&A.strokeText(D,M,E)),ee&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:A.mozCurrentTransform,x:M,y:E,fontSize:z,addToPath:J})}get isFontSubpixelAAEnabled(){const{context:D}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10,!1);D.scale(1.5,1),D.fillText("I",0,10);const M=D.getImageData(0,0,10,10).data;let E=!1;for(let P=3;P<M.length;P+=4)if(M[P]>0&&M[P]<255){E=!0;break}return(0,S.shadow)(this,"isFontSubpixelAAEnabled",E)}showText(D){const M=this.current,E=M.font;if(E.isType3Font)return this.showType3Text(D);const P=M.fontSize;if(0===P)return;const A=this.ctx,k=M.fontSizeScale,R=M.charSpacing,j=M.wordSpacing,z=M.fontDirection,Q=M.textHScale*z,ee=D.length,se=E.vertical,J=se?1:-1,X=E.defaultVMetrics,he=P*M.fontMatrix[0],_e=M.textRenderingMode===S.TextRenderingMode.FILL&&!E.disableFontFace&&!M.patternFill;let te;if(A.save(),A.transform.apply(A,M.textMatrix),A.translate(M.x,M.y+M.textRise),A.scale(Q,z>0?-1:1),M.patternFill){A.save();const Z=M.fillColor.getPattern(A,this,A.mozCurrentTransformInverse,ke.PathType.FILL);te=A.mozCurrentTransform,A.restore(),A.fillStyle=Z}let ue=M.lineWidth;const ge=M.textMatrixScale;if(0===ge||0===ue){const Z=M.textRenderingMode&S.TextRenderingMode.FILL_STROKE_MASK;(Z===S.TextRenderingMode.STROKE||Z===S.TextRenderingMode.FILL_STROKE)&&(ue=this.getSinglePixelWidth())}else ue/=ge;1!==k&&(A.scale(k,k),ue/=k),A.lineWidth=ue;let q,U=0;for(q=0;q<ee;++q){const Z=D[q];if("number"==typeof Z){U+=J*Z*P/1e3;continue}let Se=!1;const xe=(Z.isSpace?j:0)+R,Te=Z.fontChar,Re=Z.accent;let Oe,Ye,yt,qe=Z.width;if(se){const Ce=Z.vmetric||X,re=-(Z.vmetric?Ce[1]:.5*qe)*he;qe=Ce?-Ce[0]:qe,Oe=re/k,Ye=(U+Ce[2]*he)/k}else Oe=U/k,Ye=0;if(E.remeasure&&qe>0){const Ce=1e3*A.measureText(Te).width/P*k;if(qe<Ce&&this.isFontSubpixelAAEnabled){const re=qe/Ce;Se=!0,A.save(),A.scale(re,1),Oe/=re}else qe!==Ce&&(Oe+=(qe-Ce)/2e3*P/k)}this.contentVisible&&(Z.isInFont||E.missingFile)&&(_e&&!Re?A.fillText(Te,Oe,Ye):(this.paintChar(Te,Oe,Ye,te),Re&&this.paintChar(Re.fontChar,Oe+P*Re.offset.x/k,Ye-P*Re.offset.y/k,te))),yt=se?qe*he-xe*z:qe*he+xe*z,U+=yt,Se&&A.restore()}se?M.y-=U:M.x+=U*Q,A.restore(),this.compose()}showType3Text(D){const M=this.ctx,E=this.current,P=E.font,A=E.fontSize,k=E.fontDirection,R=P.vertical?1:-1,j=E.charSpacing,z=E.wordSpacing,Q=E.textHScale*k,ee=E.fontMatrix||S.FONT_IDENTITY_MATRIX,se=D.length;let X,he,_e,te;if(E.textRenderingMode!==S.TextRenderingMode.INVISIBLE&&0!==A){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,M.save(),M.transform.apply(M,E.textMatrix),M.translate(E.x,E.y),M.scale(Q,k),X=0;X<se;++X){if(he=D[X],"number"==typeof he){te=R*he*A/1e3,this.ctx.translate(te,0),E.x+=te*Q;continue}const ue=(he.isSpace?z:0)+j,ge=P.charProcOperatorList[he.operatorListId];ge?(this.contentVisible&&(this.processingType3=he,this.save(),M.scale(A,A),M.transform.apply(M,ee),this.executeOperatorList(ge),this.restore()),_e=S.Util.applyTransform([he.width,0],ee)[0]*A+ue,M.translate(_e,0),E.x+=_e*Q):(0,S.warn)(`Type3 character "${he.operatorListId}" is not available.`)}M.restore(),this.processingType3=null}}setCharWidth(D,M){}setCharWidthAndBounds(D,M,E,P,A,k){this.ctx.rect(E,P,A-E,k-P),this.ctx.clip(),this.endPath()}getColorN_Pattern(D){let M;if("TilingPattern"===D[0]){const E=D[1],P=this.baseTransform||this.ctx.mozCurrentTransform.slice();M=new ke.TilingPattern(D,E,this.ctx,{createCanvasGraphics:k=>new B(k,this.commonObjs,this.objs,this.canvasFactory)},P)}else M=this._getPattern(D[1],D[2]);return M}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(D,M,E){var A;const P=(null==(A=this.selectColor)?void 0:A.call(this,D,M,E))||S.Util.makeHexColor(D,M,E);this.ctx.strokeStyle=P,this.current.strokeColor=P}setFillRGBColor(D,M,E){var A;const P=(null==(A=this.selectColor)?void 0:A.call(this,D,M,E))||S.Util.makeHexColor(D,M,E);this.ctx.fillStyle=P,this.current.fillColor=P,this.current.patternFill=!1}_getPattern(D,M=null){let E;return this.cachedPatterns.has(D)?E=this.cachedPatterns.get(D):(E=(0,ke.getShadingPattern)(this.objs.get(D)),this.cachedPatterns.set(D,E)),M&&(E.matrix=M),E}shadingFill(D){if(!this.contentVisible)return;const M=this.ctx;this.save();const E=this._getPattern(D);M.fillStyle=E.getPattern(M,this,M.mozCurrentTransformInverse,ke.PathType.SHADING);const P=M.mozCurrentTransformInverse;if(P){const A=M.canvas,k=A.width,R=A.height,j=S.Util.applyTransform([0,0],P),z=S.Util.applyTransform([0,R],P),Q=S.Util.applyTransform([k,0],P),ee=S.Util.applyTransform([k,R],P),se=Math.min(j[0],z[0],Q[0],ee[0]),J=Math.min(j[1],z[1],Q[1],ee[1]),X=Math.max(j[0],z[0],Q[0],ee[0]),he=Math.max(j[1],z[1],Q[1],ee[1]);this.ctx.fillRect(se,J,X-se,he-J)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,S.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,S.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(D,M){this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(D)&&6===D.length&&this.transform.apply(this,D),this.baseTransform=this.ctx.mozCurrentTransform,M)&&(this.ctx.rect(M[0],M[1],M[2]-M[0],M[3]-M[1]),this.current.updateRectMinMax(this.ctx.mozCurrentTransform,M),this.clip(),this.endPath())}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(D){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const M=this.ctx;D.isolated||(0,S.info)("TODO: Support non-isolated groups."),D.knockout&&(0,S.warn)("Knockout groups not supported.");const E=M.mozCurrentTransform;if(D.matrix&&M.transform.apply(M,D.matrix),!D.bbox)throw new Error("Bounding box is required.");let P=S.Util.getAxialAlignedBoundingBox(D.bbox,M.mozCurrentTransform);P=S.Util.intersect(P,[0,0,M.canvas.width,M.canvas.height])||[0,0,0,0];const k=Math.floor(P[0]),R=Math.floor(P[1]);let j=Math.max(Math.ceil(P[2])-k,1),z=Math.max(Math.ceil(P[3])-R,1),Q=1,ee=1;j>h&&(Q=j/h,j=h),z>h&&(ee=z/h,z=h),this.current.startNewPathAndClipBox([0,0,j,z]);let se="groupAt"+this.groupLevel;D.smask&&(se+="_smask_"+this.smaskCounter++%2);const J=this.cachedCanvases.getCanvas(se,j,z,!0),X=J.context;X.scale(1/Q,1/ee),X.translate(-k,-R),X.transform.apply(X,E),D.smask?this.smaskStack.push({canvas:J.canvas,context:X,offsetX:k,offsetY:R,scaleX:Q,scaleY:ee,subtype:D.smask.subtype,backdrop:D.smask.backdrop,transferMap:D.smask.transferMap||null,startTransformInverse:null}):(M.setTransform(1,0,0,1,0,0),M.translate(k,R),M.scale(Q,ee),M.save()),I(M,X),this.ctx=X,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(M),this.groupLevel++}endGroup(D){if(!this.contentVisible)return;this.groupLevel--;const M=this.ctx,E=this.groupStack.pop();if(this.ctx=E,this.ctx.imageSmoothingEnabled=!1,D.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const P=this.ctx.mozCurrentTransform;this.restore(),this.ctx.save(),this.ctx.setTransform.apply(this.ctx,P);const A=S.Util.getAxialAlignedBoundingBox([0,0,M.canvas.width,M.canvas.height],P);this.ctx.drawImage(M.canvas,0,0),this.ctx.restore(),this.compose(A)}}beginAnnotations(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)}endAnnotations(){this.restore()}beginAnnotation(D,M,E,P,A){if(this.save(),Array.isArray(M)&&4===M.length){const k=M[2]-M[0],R=M[3]-M[1];if(A&&this.annotationCanvasMap){(E=E.slice())[4]-=M[0],E[5]-=M[1],(M=M.slice())[0]=M[1]=0,M[2]=k,M[3]=R;const[j,z]=S.Util.singularValueDecompose2dScale(this.ctx.mozCurrentTransform),{viewportScale:Q}=this,ee=Math.ceil(k*this.outputScaleX*Q),se=Math.ceil(R*this.outputScaleY*Q);this.annotationCanvas=this.canvasFactory.create(ee,se);const{canvas:J,context:X}=this.annotationCanvas,he=`var(--zoom-factor) * ${be.PixelsPerInch.PDF_TO_CSS_UNITS}`;J.style.width=`calc(${k}px * ${he})`,J.style.height=`calc(${R}px * ${he})`,this.annotationCanvasMap.set(D,J),this.annotationCanvas.savedCtx=this.ctx,this.ctx=X,this.ctx.setTransform(j,0,0,-z,0,R*z),u(this.ctx),N(this.ctx,this.foregroundColor)}else N(this.ctx,this.foregroundColor),this.ctx.rect(M[0],M[1],k,R),this.ctx.clip(),this.endPath()}this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.transform.apply(this,E),this.transform.apply(this,P)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas),this.restore()}paintImageMaskXObject(D){if(!this.contentVisible)return;const M=D.count;(D=this.getObject(D.data,D)).count=M;const E=this.ctx,P=this.processingType3;if(P&&(void 0===P.compiled&&(P.compiled=function(L){const{width:D,height:M}=L;if(D>1e3||M>1e3)return null;const P=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),A=D+1;let R,j,z,k=new Uint8Array(A*(M+1));const Q=D+7&-8;let ee=new Uint8Array(Q*M),se=0;for(const ge of L.data){let U=128;for(;U>0;)ee[se++]=ge&U?0:255,U>>=1}let J=0;for(se=0,0!==ee[se]&&(k[0]=1,++J),j=1;j<D;j++)ee[se]!==ee[se+1]&&(k[j]=ee[se]?2:1,++J),se++;for(0!==ee[se]&&(k[j]=2,++J),R=1;R<M;R++){se=R*Q,z=R*A,ee[se-Q]!==ee[se]&&(k[z]=ee[se]?1:8,++J);let ge=(ee[se]?4:0)+(ee[se-Q]?8:0);for(j=1;j<D;j++)ge=(ge>>2)+(ee[se+1]?4:0)+(ee[se-Q+1]?8:0),P[ge]&&(k[z+j]=P[ge],++J),se++;if(ee[se-Q]!==ee[se]&&(k[z+j]=ee[se]?2:4,++J),J>1e3)return null}for(se=Q*(M-1),z=R*A,0!==ee[se]&&(k[z]=8,++J),j=1;j<D;j++)ee[se]!==ee[se+1]&&(k[z+j]=ee[se]?4:8,++J),se++;if(0!==ee[se]&&(k[z+j]=4,++J),J>1e3)return null;const X=new Int32Array([0,A,-1,0,-A,0,0,0,1]);let he,_e,te;for(ye.isNodeJS?_e=[]:he=new Path2D,R=0;J&&R<=M;R++){let ge=R*A;const U=ge+D;for(;ge<U&&!k[ge];)ge++;if(ge===U)continue;he?he.moveTo(ge%A,R):te=[ge%A,R];const q=ge;let Z=k[ge];do{const Se=X[Z];do{ge+=Se}while(!k[ge]);const xe=k[ge];5!==xe&&10!==xe?(Z=xe,k[ge]=0):(Z=xe&51*Z>>4,k[ge]&=Z>>2|Z<<2),he?he.lineTo(ge%A,ge/A|0):te.push(ge%A,ge/A|0),k[ge]||--J}while(q!==ge);he||_e.push(te),--R}return ee=null,k=null,function(ge){if(ge.save(),ge.scale(1/D,-1/M),ge.translate(0,-M),he)ge.fill(he);else{ge.beginPath();for(const U of _e){ge.moveTo(U[0],U[1]);for(let q=2,Z=U.length;q<Z;q+=2)ge.lineTo(U[q],U[q+1])}ge.fill()}ge.beginPath(),ge.restore()}}(D)),P.compiled))return void P.compiled(E);const A=this._createMaskCanvas(D),k=A.canvas;E.save(),E.setTransform(1,0,0,1,0,0),E.drawImage(k,A.offsetX,A.offsetY),E.restore(),this.compose()}paintImageMaskXObjectRepeat(D,M,E=0,P=0,A,k){if(!this.contentVisible)return;D=this.getObject(D.data,D);const R=this.ctx;R.save();const j=R.mozCurrentTransform;R.transform(M,E,P,A,0,0);const z=this._createMaskCanvas(D);R.setTransform(1,0,0,1,0,0);for(let Q=0,ee=k.length;Q<ee;Q+=2){const se=S.Util.transform(j,[M,E,P,A,k[Q],k[Q+1]]),[J,X]=S.Util.applyTransform([0,0],se);R.drawImage(z.canvas,J,X)}R.restore(),this.compose()}paintImageMaskXObjectGroup(D){if(!this.contentVisible)return;const M=this.ctx,E=this.current.fillColor,P=this.current.patternFill;for(let A=0,k=D.length;A<k;A++){const R=D[A],j=R.width,z=R.height,Q=this.cachedCanvases.getCanvas("maskCanvas",j,z,!1),ee=Q.context;ee.save(),T(ee,R),ee.globalCompositeOperation="source-in",ee.fillStyle=P?E.getPattern(ee,this,M.mozCurrentTransformInverse,ke.PathType.FILL):E,ee.fillRect(0,0,j,z),ee.restore(),M.save(),M.transform.apply(M,R.transform),M.scale(1,-1),b(M,Q.canvas,0,0,j,z,0,-1,1,1),M.restore()}this.compose()}paintImageXObject(D){if(!this.contentVisible)return;const M=this.getObject(D);M?this.paintInlineImageXObject(M):(0,S.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(D,M,E,P){if(!this.contentVisible)return;const A=this.getObject(D);if(!A)return void(0,S.warn)("Dependent image isn't ready yet");const k=A.width,R=A.height,j=[];for(let z=0,Q=P.length;z<Q;z+=2)j.push({transform:[M,0,0,E,P[z],P[z+1]],x:0,y:0,w:k,h:R});this.paintInlineImageXObjectGroup(A,j)}paintInlineImageXObject(D){if(!this.contentVisible)return;const M=D.width,E=D.height,P=this.ctx;let A;if(this.save(),P.scale(1/M,-1/E),"function"==typeof HTMLElement&&D instanceof HTMLElement||!D.data)A=D;else{const z=this.cachedCanvases.getCanvas("inlineImage",M,E,!1);x(z.context,D,this.current.transferMaps),A=z.canvas}const k=this._scaleImage(A,P.mozCurrentTransformInverse);P.imageSmoothingEnabled=ce(P.mozCurrentTransform,D.interpolate);const[R,j]=b(P,k.img,0,0,k.paintWidth,k.paintHeight,0,-E,M,E);if(this.imageLayer){const z=this.getCanvasPosition(0,-E);this.imageLayer.appendImage({imgData:D,left:z[0],top:z[1],width:R,height:j})}this.compose(),this.restore()}paintInlineImageXObjectGroup(D,M){if(!this.contentVisible)return;const E=this.ctx,P=D.width,A=D.height,k=this.cachedCanvases.getCanvas("inlineImage",P,A,!1);x(k.context,D,this.current.transferMaps);for(let j=0,z=M.length;j<z;j++){const Q=M[j];if(E.save(),E.transform.apply(E,Q.transform),E.scale(1,-1),b(E,k.canvas,Q.x,Q.y,Q.w,Q.h,0,-1,1,1),this.imageLayer){const ee=this.getCanvasPosition(Q.x,Q.y);this.imageLayer.appendImage({imgData:D,left:ee[0],top:ee[1],width:P,height:A})}E.restore()}this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(D){}markPointProps(D,M){}beginMarkedContent(D){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(D,M){this.markedContentStack.push("OC"===D?{visible:this.optionalContentConfig.isVisible(M)}:{visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(D){const M=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(D);const E=this.ctx;this.pendingClip&&(M||(this.pendingClip===me?E.clip("evenodd"):E.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),E.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const D=this.ctx.mozCurrentTransform;if(0===D[1]&&0===D[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(D[0]),Math.abs(D[3]));else{const M=Math.abs(D[0]*D[3]-D[2]*D[1]),E=Math.hypot(D[0],D[2]),P=Math.hypot(D[1],D[3]);this._cachedGetSinglePixelWidth=Math.max(E,P)/M}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:D}=this.current,M=this.ctx.mozCurrentTransform;let E,P;if(0===M[1]&&0===M[2]){const A=Math.abs(M[0]),k=Math.abs(M[3]);if(0===D)E=1/A,P=1/k;else{const R=A*D,j=k*D;E=R<1?1/R:1,P=j<1?1/j:1}}else{const A=Math.abs(M[0]*M[3]-M[2]*M[1]),k=Math.hypot(M[0],M[1]),R=Math.hypot(M[2],M[3]);if(0===D)E=R/A,P=k/A;else{const j=D*A;E=R>j?R/j:1,P=k>j?k/j:1}}this._cachedScaleForStroking=[E,P]}return this._cachedScaleForStroking}rescaleAndStroke(D){const{ctx:M}=this,{lineWidth:E}=this.current,[P,A]=this.getScaleForStroking();if(M.lineWidth=E||1,1===P&&1===A)return void M.stroke();let k,R,j;D&&(k=M.mozCurrentTransform.slice(),R=M.getLineDash().slice(),j=M.lineDashOffset),M.scale(P,A);const z=Math.max(P,A);M.setLineDash(M.getLineDash().map(Q=>Q/z)),M.lineDashOffset/=z,M.stroke(),D&&(M.setTransform(...k),M.setLineDash(R),M.lineDashOffset=j)}getCanvasPosition(D,M){const E=this.ctx.mozCurrentTransform;return[E[0]*D+E[2]*M+E[4],E[1]*D+E[3]*M+E[5]]}isContentVisible(){for(let D=this.markedContentStack.length-1;D>=0;D--)if(!this.markedContentStack[D].visible)return!1;return!0}}$.CanvasGraphics=B;for(const L in S.OPS)void 0!==B.prototype[L]&&(B.prototype[S.OPS[L]]=B.prototype[L])},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.TilingPattern=$.PathType=void 0,$.getShadingPattern=function(a){switch(a[0]){case"RadialAxial":return new le(a);case"Mesh":return new p(a);case"Dummy":return new g}throw new Error(`Unknown IR type: ${a[0]}`)};var S=Ae(1),ke=Ae(3);const we={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function ye(a,f){if(!f||ke.isNodeJS)return;const u=f[2]-f[0],m=f[3]-f[1],b=new Path2D;b.rect(f[0],f[1],u,m),a.clip(b)}$.PathType=we;class be{constructor(){this.constructor===be&&(0,S.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,S.unreachable)("Abstract method `getPattern` called.")}}class le extends be{constructor(f){super(),this._type=f[1],this._bbox=f[2],this._colorStops=f[3],this._p0=f[4],this._p1=f[5],this._r0=f[6],this._r1=f[7],this.matrix=null}_createGradient(f){let u;"axial"===this._type?u=f.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(u=f.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const m of this._colorStops)u.addColorStop(m[0],m[1]);return u}getPattern(f,u,m,b){let v;if(b===we.STROKE||b===we.FILL){const C=u.current.getClippedPathBoundingBox(b,f.mozCurrentTransform)||[0,0,0,0],x=Math.ceil(C[2]-C[0])||1,T=Math.ceil(C[3]-C[1])||1,I=u.cachedCanvases.getCanvas("pattern",x,T,!0),N=I.context;N.clearRect(0,0,N.canvas.width,N.canvas.height),N.beginPath(),N.rect(0,0,N.canvas.width,N.canvas.height),N.translate(-C[0],-C[1]),m=S.Util.transform(m,[1,0,0,1,C[0],C[1]]),N.transform.apply(N,u.baseTransform),this.matrix&&N.transform.apply(N,this.matrix),ye(N,this._bbox),N.fillStyle=this._createGradient(N),N.fill(),v=f.createPattern(I.canvas,"no-repeat");const H=new DOMMatrix(m);try{v.setTransform(H)}catch(W){(0,S.warn)(`RadialAxialShadingPattern.getPattern: "${null==W?void 0:W.message}".`)}}else ye(f,this._bbox),v=this._createGradient(f);return v}}function _(a,f,u,m,b,v,C,x){const T=f.coords,I=f.colors,N=a.data,H=4*a.width;let W;T[u+1]>T[m+1]&&(W=u,u=m,m=W,W=v,v=C,C=W),T[m+1]>T[b+1]&&(W=m,m=b,b=W,W=C,C=x,x=W),T[u+1]>T[m+1]&&(W=u,u=m,m=W,W=v,v=C,C=W);const K=(T[u]+f.offsetX)*f.scaleX,ne=(T[u+1]+f.offsetY)*f.scaleY,ae=(T[m]+f.offsetX)*f.scaleX,ce=(T[m+1]+f.offsetY)*f.scaleY,Y=(T[b]+f.offsetX)*f.scaleX,de=(T[b+1]+f.offsetY)*f.scaleY;if(ne>=de)return;const fe=I[v],me=I[v+1],B=I[v+2],L=I[C],D=I[C+1],M=I[C+2],E=I[x],P=I[x+1],A=I[x+2],k=Math.round(ne),R=Math.round(de);let j,z,Q,ee,se,J,X,he;for(let _e=k;_e<=R;_e++){if(_e<ce){let q;q=_e<ne?0:(ne-_e)/(ne-ce),j=K-(K-ae)*q,z=fe-(fe-L)*q,Q=me-(me-D)*q,ee=B-(B-M)*q}else{let q;q=_e>de?1:ce===de?0:(ce-_e)/(ce-de),j=ae-(ae-Y)*q,z=L-(L-E)*q,Q=D-(D-P)*q,ee=M-(M-A)*q}let te;te=_e<ne?0:_e>de?1:(ne-_e)/(ne-de),se=K-(K-Y)*te,J=fe-(fe-E)*te,X=me-(me-P)*te,he=B-(B-A)*te;const ue=Math.round(Math.min(j,se)),ge=Math.round(Math.max(j,se));let U=H*_e+4*ue;for(let q=ue;q<=ge;q++)te=(j-q)/(j-se),te<0?te=0:te>1&&(te=1),N[U++]=z-(z-J)*te|0,N[U++]=Q-(Q-X)*te|0,N[U++]=ee-(ee-he)*te|0,N[U++]=255}}function h(a,f,u){const m=f.coords,b=f.colors;let v,C;switch(f.type){case"lattice":const x=f.verticesPerRow,T=Math.floor(m.length/x)-1,I=x-1;for(v=0;v<T;v++){let N=v*x;for(let H=0;H<I;H++,N++)_(a,u,m[N],m[N+1],m[N+x],b[N],b[N+1],b[N+x]),_(a,u,m[N+x+1],m[N+1],m[N+x],b[N+x+1],b[N+1],b[N+x])}break;case"triangles":for(v=0,C=m.length;v<C;v+=3)_(a,u,m[v],m[v+1],m[v+2],b[v],b[v+1],b[v+2]);break;default:throw new Error("illegal figure")}}class p extends be{constructor(f){super(),this._coords=f[2],this._colors=f[3],this._figures=f[4],this._bounds=f[5],this._bbox=f[7],this._background=f[8],this.matrix=null}_createMeshCanvas(f,u,m){const x=Math.floor(this._bounds[0]),T=Math.floor(this._bounds[1]),I=Math.ceil(this._bounds[2])-x,N=Math.ceil(this._bounds[3])-T,H=Math.min(Math.ceil(Math.abs(I*f[0]*1.1)),3e3),W=Math.min(Math.ceil(Math.abs(N*f[1]*1.1)),3e3),K=I/H,ne=N/W,ae={coords:this._coords,colors:this._colors,offsetX:-x,offsetY:-T,scaleX:1/K,scaleY:1/ne},de=m.getCanvas("mesh",H+4,W+4,!1),fe=de.context,me=fe.createImageData(H,W);if(u){const L=me.data;for(let D=0,M=L.length;D<M;D+=4)L[D]=u[0],L[D+1]=u[1],L[D+2]=u[2],L[D+3]=255}for(const L of this._figures)h(me,L,ae);return fe.putImageData(me,2,2),{canvas:de.canvas,offsetX:x-2*K,offsetY:T-2*ne,scaleX:K,scaleY:ne}}getPattern(f,u,m,b){let v;if(ye(f,this._bbox),b===we.SHADING)v=S.Util.singularValueDecompose2dScale(f.mozCurrentTransform);else if(v=S.Util.singularValueDecompose2dScale(u.baseTransform),this.matrix){const x=S.Util.singularValueDecompose2dScale(this.matrix);v=[v[0]*x[0],v[1]*x[1]]}const C=this._createMeshCanvas(v,b===we.SHADING?null:this._background,u.cachedCanvases);return b!==we.SHADING&&(f.setTransform.apply(f,u.baseTransform),this.matrix&&f.transform.apply(f,this.matrix)),f.translate(C.offsetX,C.offsetY),f.scale(C.scaleX,C.scaleY),f.createPattern(C.canvas,"no-repeat")}}class g extends be{getPattern(){return"hotpink"}}class o{static get MAX_PATTERN_SIZE(){return(0,S.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(f,u,m,b,v){this.operatorList=f[2],this.matrix=f[3]||[1,0,0,1,0,0],this.bbox=f[4],this.xstep=f[5],this.ystep=f[6],this.paintType=f[7],this.tilingType=f[8],this.color=u,this.ctx=m,this.canvasGraphicsFactory=b,this.baseTransform=v}createPatternCanvas(f){const u=this.operatorList,m=this.bbox,b=this.xstep,v=this.ystep,C=this.paintType,T=this.color,I=this.canvasGraphicsFactory;(0,S.info)("TilingType: "+this.tilingType);const N=m[0],H=m[1],W=m[2],K=m[3],ne=S.Util.singularValueDecompose2dScale(this.matrix),ae=S.Util.singularValueDecompose2dScale(this.baseTransform),ce=[ne[0]*ae[0],ne[1]*ae[1]],Y=this.getSizeAndScale(b,this.ctx.canvas.width,ce[0]),de=this.getSizeAndScale(v,this.ctx.canvas.height,ce[1]),fe=f.cachedCanvases.getCanvas("pattern",Y.size,de.size,!0),me=fe.context,B=I.createCanvasGraphics(me);B.groupLevel=f.groupLevel,this.setFillAndStrokeStyleToContext(B,C,T);let L=N,D=H,M=W,E=K;return N<0&&(L=0,M+=Math.abs(N)),H<0&&(D=0,E+=Math.abs(H)),me.translate(-Y.scale*L,-de.scale*D),B.transform(Y.scale,0,0,de.scale,0,0),me.save(),this.clipBbox(B,L,D,M,E),B.baseTransform=B.ctx.mozCurrentTransform.slice(),B.executeOperatorList(u),B.endDrawing(),{canvas:fe.canvas,scaleX:Y.scale,scaleY:de.scale,offsetX:L,offsetY:D}}getSizeAndScale(f,u,m){f=Math.abs(f);const b=Math.max(o.MAX_PATTERN_SIZE,u);let v=Math.ceil(f*m);return v>=b?v=b:m=v/f,{scale:m,size:v}}clipBbox(f,u,m,b,v){f.ctx.rect(u,m,b-u,v-m),f.current.updateRectMinMax(f.ctx.mozCurrentTransform,[u,m,b,v]),f.clip(),f.endPath()}setFillAndStrokeStyleToContext(f,u,m){const b=f.ctx,v=f.current;switch(u){case 1:const C=this.ctx;b.fillStyle=C.fillStyle,b.strokeStyle=C.strokeStyle,v.fillColor=C.fillStyle,v.strokeColor=C.strokeStyle;break;case 2:const x=S.Util.makeHexColor(m[0],m[1],m[2]);b.fillStyle=x,b.strokeStyle=x,v.fillColor=x,v.strokeColor=x;break;default:throw new S.FormatError(`Unsupported paint type: ${u}`)}}getPattern(f,u,m,b){let v=m;b!==we.SHADING&&(v=S.Util.transform(v,u.baseTransform),this.matrix&&(v=S.Util.transform(v,this.matrix)));const C=this.createPatternCanvas(u);let x=new DOMMatrix(v);x=x.translate(C.offsetX,C.offsetY),x=x.scale(1/C.scaleX,1/C.scaleY);const T=f.createPattern(C.canvas,"repeat");try{T.setTransform(x)}catch(I){(0,S.warn)(`TilingPattern.getPattern: "${null==I?void 0:I.message}".`)}return T}}$.TilingPattern=o},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.applyMaskImageData=function({src:we,srcPos:ye=0,dest:be,destPos:le=0,width:_,height:h,inverseDecode:p=!1}){const g=S.FeatureTest.isLittleEndian?4278190080:255,[c,l]=p?[0,g]:[g,0],o=_>>3,a=7&_,f=we.length;be=new Uint32Array(be.buffer);for(let u=0;u<h;u++){for(const b=ye+o;ye<b;ye++){const v=ye<f?we[ye]:255;be[le++]=128&v?l:c,be[le++]=64&v?l:c,be[le++]=32&v?l:c,be[le++]=16&v?l:c,be[le++]=8&v?l:c,be[le++]=4&v?l:c,be[le++]=2&v?l:c,be[le++]=1&v?l:c}if(0===a)continue;const m=ye<f?we[ye++]:255;for(let b=0;b<a;b++)be[le++]=m&1<<7-b?l:c}return{srcPos:ye,destPos:le}};var S=Ae(1)},(Ie,$)=>{Object.defineProperty($,"__esModule",{value:!0}),$.GlobalWorkerOptions=void 0;const Ae=Object.create(null);$.GlobalWorkerOptions=Ae,Ae.workerPort=void 0===Ae.workerPort?null:Ae.workerPort,Ae.workerSrc=void 0===Ae.workerSrc?"":Ae.workerSrc},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.MessageHandler=void 0;var S=Ae(1);function ye(le){switch(le instanceof Error||"object"==typeof le&&null!==le||(0,S.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),le.name){case"AbortException":return new S.AbortException(le.message);case"MissingPDFException":return new S.MissingPDFException(le.message);case"PasswordException":return new S.PasswordException(le.message,le.code);case"UnexpectedResponseException":return new S.UnexpectedResponseException(le.message,le.status);case"UnknownErrorException":return new S.UnknownErrorException(le.message,le.details);default:return new S.UnknownErrorException(le.message,le.toString())}}$.MessageHandler=class{constructor(_,h,p){this.sourceName=_,this.targetName=h,this.comObj=p,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=g=>{const c=g.data;if(c.targetName!==this.sourceName)return;if(c.stream)return void this._processStreamMessage(c);if(c.callback){const o=c.callbackId,a=this.callbackCapabilities[o];if(!a)throw new Error(`Cannot resolve callback ${o}`);if(delete this.callbackCapabilities[o],1===c.callback)a.resolve(c.data);else{if(2!==c.callback)throw new Error("Unexpected callback case");a.reject(ye(c.reason))}return}const l=this.actionHandler[c.action];if(!l)throw new Error(`Unknown action from worker: ${c.action}`);if(c.callbackId){const o=this.sourceName,a=c.sourceName;new Promise(function(f){f(l(c.data))}).then(function(f){p.postMessage({sourceName:o,targetName:a,callback:1,callbackId:c.callbackId,data:f})},function(f){p.postMessage({sourceName:o,targetName:a,callback:2,callbackId:c.callbackId,reason:ye(f)})})}else c.streamId?this._createStreamSink(c):l(c.data)},p.addEventListener("message",this._onComObjOnMessage)}on(_,h){const p=this.actionHandler;if(p[_])throw new Error(`There is already an actionName called "${_}"`);p[_]=h}send(_,h,p){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:_,data:h},p)}sendWithPromise(_,h,p){const g=this.callbackId++,c=(0,S.createPromiseCapability)();this.callbackCapabilities[g]=c;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:_,callbackId:g,data:h},p)}catch(l){c.reject(l)}return c.promise}sendWithStream(_,h,p,g){const c=this.streamId++,l=this.sourceName,o=this.targetName,a=this.comObj;return new ReadableStream({start:f=>{const u=(0,S.createPromiseCapability)();return this.streamControllers[c]={controller:f,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},a.postMessage({sourceName:l,targetName:o,action:_,streamId:c,data:h,desiredSize:f.desiredSize},g),u.promise},pull:f=>{const u=(0,S.createPromiseCapability)();return this.streamControllers[c].pullCall=u,a.postMessage({sourceName:l,targetName:o,stream:6,streamId:c,desiredSize:f.desiredSize}),u.promise},cancel:f=>{(0,S.assert)(f instanceof Error,"cancel must have a valid reason");const u=(0,S.createPromiseCapability)();return this.streamControllers[c].cancelCall=u,this.streamControllers[c].isClosed=!0,a.postMessage({sourceName:l,targetName:o,stream:1,streamId:c,reason:ye(f)}),u.promise}},p)}_createStreamSink(_){const h=_.streamId,p=this.sourceName,g=_.sourceName,c=this.comObj,l=this,o=this.actionHandler[_.action],a={enqueue(f,u=1,m){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=u,b>0&&this.desiredSize<=0&&(this.sinkCapability=(0,S.createPromiseCapability)(),this.ready=this.sinkCapability.promise),c.postMessage({sourceName:p,targetName:g,stream:4,streamId:h,chunk:f},m)},close(){this.isCancelled||(this.isCancelled=!0,c.postMessage({sourceName:p,targetName:g,stream:3,streamId:h}),delete l.streamSinks[h])},error(f){(0,S.assert)(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,c.postMessage({sourceName:p,targetName:g,stream:5,streamId:h,reason:ye(f)}))},sinkCapability:(0,S.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:_.desiredSize,ready:null};a.sinkCapability.resolve(),a.ready=a.sinkCapability.promise,this.streamSinks[h]=a,new Promise(function(f){f(o(_.data,a))}).then(function(){c.postMessage({sourceName:p,targetName:g,stream:8,streamId:h,success:!0})},function(f){c.postMessage({sourceName:p,targetName:g,stream:8,streamId:h,reason:ye(f)})})}_processStreamMessage(_){const h=_.streamId,p=this.sourceName,g=_.sourceName,c=this.comObj,l=this.streamControllers[h],o=this.streamSinks[h];switch(_.stream){case 8:_.success?l.startCall.resolve():l.startCall.reject(ye(_.reason));break;case 7:_.success?l.pullCall.resolve():l.pullCall.reject(ye(_.reason));break;case 6:if(!o){c.postMessage({sourceName:p,targetName:g,stream:7,streamId:h,success:!0});break}o.desiredSize<=0&&_.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=_.desiredSize,new Promise(function(a){a(o.onPull&&o.onPull())}).then(function(){c.postMessage({sourceName:p,targetName:g,stream:7,streamId:h,success:!0})},function(a){c.postMessage({sourceName:p,targetName:g,stream:7,streamId:h,reason:ye(a)})});break;case 4:if((0,S.assert)(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(_.chunk);break;case 3:if((0,S.assert)(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this._deleteStreamController(l,h);break;case 5:(0,S.assert)(l,"error should have stream controller"),l.controller.error(ye(_.reason)),this._deleteStreamController(l,h);break;case 2:_.success?l.cancelCall.resolve():l.cancelCall.reject(ye(_.reason)),this._deleteStreamController(l,h);break;case 1:if(!o)break;new Promise(function(a){a(o.onCancel&&o.onCancel(ye(_.reason)))}).then(function(){c.postMessage({sourceName:p,targetName:g,stream:2,streamId:h,success:!0})},function(a){c.postMessage({sourceName:p,targetName:g,stream:2,streamId:h,reason:ye(a)})}),o.sinkCapability.reject(ye(_.reason)),o.isCancelled=!0,delete this.streamSinks[h];break;default:throw new Error("Unexpected stream case")}}_deleteStreamController(_,h){var p=this;return _asyncToGenerator(function*(){yield Promise.allSettled([_.startCall&&_.startCall.promise,_.pullCall&&_.pullCall.promise,_.cancelCall&&_.cancelCall.promise]),delete p.streamControllers[h]})()}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(Ie,$,Ae)=>{var we,ye;Object.defineProperty($,"__esModule",{value:!0}),$.Metadata=void 0;var S=Ae(1);we=new WeakMap,ye=new WeakMap,$.Metadata=class{constructor({parsedData:le,rawData:_}){Ze(this,we,void 0),Ze(this,ye,void 0),Ut(this,we,le),Ut(this,ye,_)}getRaw(){return $e(this,ye)}get(le){var _;return null!=(_=$e(this,we).get(le))?_:null}getAll(){return(0,S.objectFromMap)($e(this,we))}has(le){return $e(this,we).has(le)}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.OptionalContentConfig=void 0;var S=Ae(1);class ke{constructor(be,le){this.visible=!0,this.name=be,this.intent=le}}$.OptionalContentConfig=class{constructor(be){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,null!==be){this.name=be.name,this.creator=be.creator,this._order=be.order;for(const le of be.groups)this._groups.set(le.id,new ke(le.name,le.intent));if("OFF"===be.baseState)for(const le of this._groups)le.visible=!1;for(const le of be.on)this._groups.get(le).visible=!0;for(const le of be.off)this._groups.get(le).visible=!1}}_evaluateVisibilityExpression(be){const le=be.length;if(le<2)return!0;const _=be[0];for(let h=1;h<le;h++){const p=be[h];let g;if(Array.isArray(p))g=this._evaluateVisibilityExpression(p);else{if(!this._groups.has(p))return(0,S.warn)(`Optional content group not found: ${p}`),!0;g=this._groups.get(p).visible}switch(_){case"And":if(!g)return!1;break;case"Or":if(g)return!0;break;case"Not":return!g;default:return!0}}return"And"===_}isVisible(be){if(0===this._groups.size)return!0;if(!be)return(0,S.warn)("Optional content group not defined."),!0;if("OCG"===be.type)return this._groups.has(be.id)?this._groups.get(be.id).visible:((0,S.warn)(`Optional content group not found: ${be.id}`),!0);if("OCMD"===be.type){if(be.expression)return this._evaluateVisibilityExpression(be.expression);if(!be.policy||"AnyOn"===be.policy){for(const le of be.ids){if(!this._groups.has(le))return(0,S.warn)(`Optional content group not found: ${le}`),!0;if(this._groups.get(le).visible)return!0}return!1}if("AllOn"===be.policy){for(const le of be.ids){if(!this._groups.has(le))return(0,S.warn)(`Optional content group not found: ${le}`),!0;if(!this._groups.get(le).visible)return!1}return!0}if("AnyOff"===be.policy){for(const le of be.ids){if(!this._groups.has(le))return(0,S.warn)(`Optional content group not found: ${le}`),!0;if(!this._groups.get(le).visible)return!0}return!1}if("AllOff"===be.policy){for(const le of be.ids){if(!this._groups.has(le))return(0,S.warn)(`Optional content group not found: ${le}`),!0;if(this._groups.get(le).visible)return!1}return!0}return(0,S.warn)(`Unknown optional content policy ${be.policy}.`),!0}return(0,S.warn)(`Unknown group type ${be.type}.`),!0}setVisibility(be,le=!0){this._groups.has(be)?this._groups.get(be).visible=!!le:(0,S.warn)(`Optional content group not found: ${be}`)}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,S.objectFromMap)(this._groups):null}getGroup(be){return this._groups.get(be)||null}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.PDFDataTransportStream=void 0;var S=Ae(1),ke=Ae(5);$.PDFDataTransportStream=class{constructor(_,h){(0,S.assert)(h,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=_.progressiveDone||!1,this._contentDispositionFilename=_.contentDispositionFilename||null;const p=_.initialData;if((null==p?void 0:p.length)>0){const g=new Uint8Array(p).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=h,this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._contentLength=_.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((g,c)=>{this._onReceiveData({begin:g,chunk:c})}),this._pdfDataRangeTransport.addProgressListener((g,c)=>{this._onProgress({loaded:g,total:c})}),this._pdfDataRangeTransport.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(_){const h=new Uint8Array(_.chunk).buffer;if(void 0===_.begin)this._fullRequestReader?this._fullRequestReader._enqueue(h):this._queuedChunks.push(h);else{const p=this._rangeReaders.some(function(g){return g._begin===_.begin&&(g._enqueue(h),!0)});(0,S.assert)(p,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var _,h;return null!=(h=null==(_=this._fullRequestReader)?void 0:_._loaded)?h:0}_onProgress(_){if(void 0===_.total){const h=this._rangeReaders[0];(null==h?void 0:h.onProgress)&&h.onProgress({loaded:_.loaded})}else{const h=this._fullRequestReader;(null==h?void 0:h.onProgress)&&h.onProgress({loaded:_.loaded,total:_.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(_){const h=this._rangeReaders.indexOf(_);h>=0&&this._rangeReaders.splice(h,1)}getFullReader(){(0,S.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const _=this._queuedChunks;return this._queuedChunks=null,new ye(this,_,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(_,h){if(h<=this._progressiveDataLength)return null;const p=new be(this,_,h);return this._pdfDataRangeTransport.requestDataRange(_,h),this._rangeReaders.push(p),p}cancelAllRequests(_){this._fullRequestReader&&this._fullRequestReader.cancel(_);for(const h of this._rangeReaders.slice(0))h.cancel(_);this._pdfDataRangeTransport.abort()}};class ye{constructor(_,h,p=!1,g=null){this._stream=_,this._done=p||!1,this._filename=(0,ke.isPdfFile)(g)?g:null,this._queuedChunks=h||[],this._loaded=0;for(const c of this._queuedChunks)this._loaded+=c.byteLength;this._requests=[],this._headersReady=Promise.resolve(),_._fullRequestReader=this,this.onProgress=null}_enqueue(_){this._done||(this._requests.length>0?this._requests.shift().resolve({value:_,done:!1}):this._queuedChunks.push(_),this._loaded+=_.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){var _=this;return _asyncToGenerator(function*(){if(_._queuedChunks.length>0)return{value:_._queuedChunks.shift(),done:!1};if(_._done)return{value:void 0,done:!0};const h=(0,S.createPromiseCapability)();return _._requests.push(h),h.promise})()}cancel(_){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class be{constructor(_,h,p){this._stream=_,this._begin=h,this._end=p,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(_){if(!this._done){if(0===this._requests.length)this._queuedChunk=_;else{this._requests.shift().resolve({value:_,done:!1});for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){var _=this;return _asyncToGenerator(function*(){if(_._queuedChunk){const p=_._queuedChunk;return _._queuedChunk=null,{value:p,done:!1}}if(_._done)return{value:void 0,done:!0};const h=(0,S.createPromiseCapability)();return _._requests.push(h),h.promise})()}cancel(_){this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(Ie,$)=>{Object.defineProperty($,"__esModule",{value:!0}),$.XfaText=void 0;class Ae{static textContent(ke){const we=[],ye={items:we,styles:Object.create(null)};return function be(le){var p;if(!le)return;let _=null;const h=le.name;if("#text"===h)_=le.value;else{if(!Ae.shouldBuildText(h))return;(null==(p=null==le?void 0:le.attributes)?void 0:p.textContent)?_=le.attributes.textContent:le.value&&(_=le.value)}if(null!==_&&we.push({str:_}),le.children)for(const g of le.children)be(g)}(ke),ye}static shouldBuildText(ke){return!("textarea"===ke||"input"===ke||"option"===ke||"select"===ke)}}$.XfaText=Ae},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.NodeStandardFontDataFactory=$.NodeCanvasFactory=$.NodeCMapReaderFactory=void 0;var S=Ae(6);const ke=function(le){return new Promise((_,h)=>{__webpack_require__(172).readFile(le,(g,c)=>{!g&&c?_(new Uint8Array(c)):h(new Error(g))})})};$.NodeCanvasFactory=class extends S.BaseCanvasFactory{_createCanvas(_,h){return __webpack_require__(414).createCanvas(_,h)}},$.NodeCMapReaderFactory=class extends S.BaseCMapReaderFactory{_fetchData(_,h){return ke(_).then(p=>({cMapData:p,compressionType:h}))}},$.NodeStandardFontDataFactory=class extends S.BaseStandardFontDataFactory{_fetchData(_){return ke(_)}}},(Ie,$,Ae)=>{var L,EC;Object.defineProperty($,"__esModule",{value:!0}),$.AnnotationLayer=void 0;var S=Ae(1),ke=Ae(5),we=Ae(8),ye=Ae(21),be=Ae(22);const _=new WeakSet;function h(M){return{width:M[2]-M[0],height:M[3]-M[1]}}class p{static create(E){switch(E.data.annotationType){case S.AnnotationType.LINK:return new c(E);case S.AnnotationType.TEXT:return new l(E);case S.AnnotationType.WIDGET:switch(E.data.fieldType){case"Tx":return new a(E);case"Btn":return E.data.radioButton?new u(E):E.data.checkBox?new f(E):new m(E);case"Ch":return new b(E)}return new o(E);case S.AnnotationType.POPUP:return new v(E);case S.AnnotationType.FREETEXT:return new x(E);case S.AnnotationType.LINE:return new T(E);case S.AnnotationType.SQUARE:return new I(E);case S.AnnotationType.CIRCLE:return new N(E);case S.AnnotationType.POLYLINE:return new H(E);case S.AnnotationType.CARET:return new K(E);case S.AnnotationType.INK:return new ne(E);case S.AnnotationType.POLYGON:return new W(E);case S.AnnotationType.HIGHLIGHT:return new ae(E);case S.AnnotationType.UNDERLINE:return new ce(E);case S.AnnotationType.SQUIGGLY:return new Y(E);case S.AnnotationType.STRIKEOUT:return new de(E);case S.AnnotationType.STAMP:return new fe(E);case S.AnnotationType.FILEATTACHMENT:return new me(E);default:return new g(E)}}}class g{constructor(E,{isRenderable:P=!1,ignoreBorder:A=!1,createQuadrilaterals:k=!1}={}){this.isRenderable=P,this.data=E.data,this.layer=E.layer,this.page=E.page,this.viewport=E.viewport,this.linkService=E.linkService,this.downloadManager=E.downloadManager,this.imageResourcesPath=E.imageResourcesPath,this.renderForms=E.renderForms,this.svgFactory=E.svgFactory,this.annotationStorage=E.annotationStorage,this.enableScripting=E.enableScripting,this.hasJSActions=E.hasJSActions,this._fieldObjects=E.fieldObjects,this._mouseState=E.mouseState,P&&(this.container=this._createContainer(A)),k&&(this.quadrilaterals=this._createQuadrilaterals(A))}_createContainer(E=!1){const P=this.data,A=this.page,k=this.viewport,R=document.createElement("section");let{width:j,height:z}=h(P.rect);R.setAttribute("data-annotation-id",P.id);const Q=S.Util.normalizeRect([P.rect[0],A.view[3]-P.rect[1]+A.view[1],P.rect[2],A.view[3]-P.rect[3]+A.view[1]]);if(P.hasOwnCanvas){const ee=k.transform.slice(),[se,J]=S.Util.singularValueDecompose2dScale(ee);j=Math.ceil(j*se),z=Math.ceil(z*J),Q[0]*=se,Q[1]*=J;for(let X=0;X<4;X++)ee[X]=Math.sign(ee[X]);R.style.transform=`matrix(${ee.join(",")})`}else R.style.transform=`matrix(${k.transform.join(",")})`;if(R.style.transformOrigin=`${-Q[0]}px ${-Q[1]}px`,!E&&P.borderStyle.width>0){R.style.borderWidth=`${P.borderStyle.width}px`,P.borderStyle.style!==S.AnnotationBorderStyleType.UNDERLINE&&(j-=2*P.borderStyle.width,z-=2*P.borderStyle.width);const ee=P.borderStyle.horizontalCornerRadius,se=P.borderStyle.verticalCornerRadius;switch((ee>0||se>0)&&(R.style.borderRadius=`${ee}px / ${se}px`),P.borderStyle.style){case S.AnnotationBorderStyleType.SOLID:R.style.borderStyle="solid";break;case S.AnnotationBorderStyleType.DASHED:R.style.borderStyle="dashed";break;case S.AnnotationBorderStyleType.BEVELED:(0,S.warn)("Unimplemented border style: beveled");break;case S.AnnotationBorderStyleType.INSET:(0,S.warn)("Unimplemented border style: inset");break;case S.AnnotationBorderStyleType.UNDERLINE:R.style.borderBottomStyle="solid"}P.borderColor||P.color?R.style.borderColor=S.Util.makeHexColor(0|P.color[0],0|P.color[1],0|P.color[2]):R.style.borderWidth=0}return R.style.left=`${Q[0]}px`,R.style.top=`${Q[1]}px`,P.hasOwnCanvas?R.style.width=R.style.height="auto":(R.style.width=`${j}px`,R.style.height=`${z}px`),R}get _commonActions(){const E=(P,A,k)=>{const R=k.detail[P];k.target.style[A]=ye.ColorConverters[`${R[0]}_HTML`](R.slice(1))};return(0,S.shadow)(this,"_commonActions",{display:P=>{const A=P.detail.display%2==1;P.target.style.visibility=A?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:A,print:0===P.detail.display||3===P.detail.display})},print:P=>{this.annotationStorage.setValue(this.data.id,{print:P.detail.print})},hidden:P=>{P.target.style.visibility=P.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:P.detail.hidden})},focus:P=>{setTimeout(()=>P.target.focus({preventScroll:!1}),0)},userName:P=>{P.target.title=P.detail.userName},readonly:P=>{P.detail.readonly?P.target.setAttribute("readonly",""):P.target.removeAttribute("readonly")},required:P=>{P.detail.required?P.target.setAttribute("required",""):P.target.removeAttribute("required")},bgColor:P=>{E("bgColor","backgroundColor",P)},fillColor:P=>{E("fillColor","backgroundColor",P)},fgColor:P=>{E("fgColor","color",P)},textColor:P=>{E("textColor","color",P)},borderColor:P=>{E("borderColor","borderColor",P)},strokeColor:P=>{E("strokeColor","borderColor",P)}})}_dispatchEventFromSandbox(E,P){const A=this._commonActions;for(const k of Object.keys(P.detail)){const R=E[k]||A[k];R&&R(P)}}_setDefaultPropertiesFromJS(E){if(!this.enableScripting)return;const P=this.annotationStorage.getRawValue(this.data.id);if(!P)return;const A=this._commonActions;for(const[k,R]of Object.entries(P)){const j=A[k];j&&(j({detail:R,target:E}),delete P[k])}}_createQuadrilaterals(E=!1){if(!this.data.quadPoints)return null;const P=[],A=this.data.rect;for(const k of this.data.quadPoints)this.data.rect=[k[2].x,k[2].y,k[1].x,k[1].y],P.push(this._createContainer(E));return this.data.rect=A,P}_createPopup(E,P){let A=this.container;this.quadrilaterals&&(E=E||this.quadrilaterals,A=this.quadrilaterals[0]),E||((E=document.createElement("div")).style.height=A.style.height,E.style.width=A.style.width,A.appendChild(E));const R=new C({container:A,trigger:E,color:P.color,titleObj:P.titleObj,modificationDate:P.modificationDate,contentsObj:P.contentsObj,richText:P.richText,hideWrapper:!0}).render();R.style.left=A.style.width,A.appendChild(R)}_renderQuadrilaterals(E){for(const P of this.quadrilaterals)P.className=E;return this.quadrilaterals}render(){(0,S.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(E,P=null){const A=[];if(this._fieldObjects){const k=this._fieldObjects[E];if(k)for(const{page:R,id:j,exportValues:z}of k){if(-1===R||j===P)continue;const Q="string"==typeof z?z:null,ee=document.getElementById(j);!ee||_.has(ee)?A.push({id:j,exportValue:Q,domElement:ee}):(0,S.warn)(`_getElementsByName - element not allowed: ${j}`)}return A}for(const k of document.getElementsByName(E)){const{id:R,exportValue:j}=k;R!==P&&(!_.has(k)||A.push({id:R,exportValue:j,domElement:k}))}return A}static get platform(){const E="undefined"!=typeof navigator?navigator.platform:"";return(0,S.shadow)(this,"platform",{isWin:E.includes("Win"),isMac:E.includes("Mac")})}}class c extends g{constructor(E,P=null){super(E,{isRenderable:!!(E.data.url||E.data.dest||E.data.action||E.data.isTooltipOnly||E.data.resetForm||E.data.actions&&(E.data.actions.Action||E.data.actions["Mouse Up"]||E.data.actions["Mouse Down"])),ignoreBorder:!!(null==P?void 0:P.ignoreBorder),createQuadrilaterals:!0})}render(){const{data:E,linkService:P}=this,A=document.createElement("a");if(E.url)P.addLinkAttributes(A,E.url,E.newWindow);else if(E.action)this._bindNamedAction(A,E.action);else if(E.dest)this._bindLink(A,E.dest);else{let k=!1;E.actions&&(E.actions.Action||E.actions["Mouse Up"]||E.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(k=!0,this._bindJSAction(A,E)),E.resetForm?this._bindResetFormAction(A,E.resetForm):k||this._bindLink(A,"")}return this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((k,R)=>{const j=0===R?A:A.cloneNode();return k.appendChild(j),k}):(this.container.className="linkAnnotation",this.container.appendChild(A),this.container)}_bindLink(E,P){E.href=this.linkService.getDestinationHash(P),E.onclick=()=>(P&&this.linkService.goToDestination(P),!1),(P||""===P)&&(E.className="internalLink")}_bindNamedAction(E,P){E.href=this.linkService.getAnchorUrl(""),E.onclick=()=>(this.linkService.executeNamedAction(P),!1),E.className="internalLink"}_bindJSAction(E,P){E.href=this.linkService.getAnchorUrl("");const A=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const k of Object.keys(P.actions)){const R=A.get(k);!R||(E[R]=()=>{var j;return null==(j=this.linkService.eventBus)||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P.id,name:k}}),!1})}E.onclick||(E.onclick=()=>!1),E.className="internalLink"}_bindResetFormAction(E,P){const A=E.onclick;if(A||(E.href=this.linkService.getAnchorUrl("")),E.className="internalLink",!this._fieldObjects)return(0,S.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(A||(E.onclick=()=>!1));E.onclick=()=>{var se;A&&A();const{fields:k,refs:R,include:j}=P,z=[];if(0!==k.length||0!==R.length){const J=new Set(R);for(const X of k){const he=this._fieldObjects[X]||[];for(const{id:_e}of he)J.add(_e)}for(const X of Object.values(this._fieldObjects))for(const he of X)J.has(he.id)===j&&z.push(he)}else for(const J of Object.values(this._fieldObjects))z.push(...J);const Q=this.annotationStorage,ee=[];for(const J of z){const{id:X}=J;switch(ee.push(X),J.type){case"text":case"combobox":case"listbox":Q.setValue(X,{value:J.defaultValue||""});break;case"checkbox":case"radiobutton":Q.setValue(X,{value:J.defaultValue===J.exportValues});break;default:continue}const he=document.getElementById(X);!he||!_.has(he)||he.dispatchEvent(new Event("resetform"))}return this.enableScripting&&(null==(se=this.linkService.eventBus)||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:ee,name:"ResetForm"}})),!1}}}class l extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str))})}render(){this.container.className="textAnnotation";const E=document.createElement("img");return E.style.height=this.container.style.height,E.style.width=this.container.style.width,E.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",E.alt="[{{type}} Annotation]",E.dataset.l10nId="text_annotation_type",E.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(E,this.data),this.container.appendChild(E),this.container}}class o extends g{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(E){const{isWin:P,isMac:A}=g.platform;return P&&E.ctrlKey||A&&E.metaKey}_setEventListener(E,P,A,k){P.includes("mouse")?E.addEventListener(P,R=>{var j;null==(j=this.linkService.eventBus)||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:A,value:k(R),shift:R.shiftKey,modifier:this._getKeyModifier(R)}})}):E.addEventListener(P,R=>{var j;null==(j=this.linkService.eventBus)||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:A,value:k(R)}})})}_setEventListeners(E,P,A){var k;for(const[R,j]of P)("Action"===j||(null==(k=this.data.actions)?void 0:k[j]))&&this._setEventListener(E,R,j,A)}_setBackgroundColor(E){const P=this.data.backgroundColor||null;E.style.backgroundColor=null===P?"transparent":S.Util.makeHexColor(P[0],P[1],P[2])}}class a extends o{constructor(E){super(E,{isRenderable:E.renderForms||!E.data.hasAppearance&&!!E.data.fieldValue})}setPropertyOnSiblings(E,P,A,k){const R=this.annotationStorage;for(const j of this._getElementsByName(E.name,E.id))j.domElement&&(j.domElement[P]=A),R.setValue(j.id,{[k]:A})}render(){var k;const E=this.annotationStorage,P=this.data.id;this.container.className="textWidgetAnnotation";let A=null;if(this.renderForms){const R=E.getValue(P,{value:this.data.fieldValue}),j=R.formattedValue||R.value||"",z={userValue:null,formattedValue:null,valueOnFocus:""};this.data.multiLine?(A=document.createElement("textarea"),A.textContent=j):(A=document.createElement("input"),A.type="text",A.setAttribute("value",j)),_.add(A),A.disabled=this.data.readOnly,A.name=this.data.fieldName,A.tabIndex=1e3,z.userValue=j,A.setAttribute("id",P),A.addEventListener("input",ee=>{E.setValue(P,{value:ee.target.value}),this.setPropertyOnSiblings(A,"value",ee.target.value,"value")}),A.addEventListener("resetform",ee=>{var J;const se=null!=(J=this.data.defaultFieldValue)?J:"";A.value=z.userValue=se,z.formattedValue=null});let Q=ee=>{const{formattedValue:se}=z;null!=se&&(ee.target.value=se),ee.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){A.addEventListener("focus",se=>{z.userValue&&(se.target.value=z.userValue),z.valueOnFocus=se.target.value}),A.addEventListener("updatefromsandbox",se=>{this._dispatchEventFromSandbox({value(X){var he;z.userValue=null!=(he=X.detail.value)?he:"",E.setValue(P,{value:z.userValue.toString()}),X.target.value=z.userValue},formattedValue(X){const{formattedValue:he}=X.detail;z.formattedValue=he,null!=he&&X.target!==document.activeElement&&(X.target.value=he),E.setValue(P,{formattedValue:he})},selRange(X){X.target.setSelectionRange(...X.detail.selRange)}},se)}),A.addEventListener("keydown",se=>{var he;let J=-1;if("Escape"===se.key?J=0:"Enter"===se.key?J=2:"Tab"===se.key&&(J=3),-1===J)return;const{value:X}=se.target;z.valueOnFocus!==X&&(z.userValue=X,null==(he=this.linkService.eventBus)||he.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:X,willCommit:!0,commitKey:J,selStart:se.target.selectionStart,selEnd:se.target.selectionEnd}}))});const ee=Q;Q=null,A.addEventListener("blur",se=>{var X;const{value:J}=se.target;z.userValue=J,this._mouseState.isDown&&z.valueOnFocus!==J&&(null==(X=this.linkService.eventBus)||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:J,willCommit:!0,commitKey:1,selStart:se.target.selectionStart,selEnd:se.target.selectionEnd}})),ee(se)}),(null==(k=this.data.actions)?void 0:k.Keystroke)&&A.addEventListener("beforeinput",se=>{var U;const{data:J,target:X}=se,{value:he,selectionStart:_e,selectionEnd:te}=X;let ue=_e,ge=te;switch(se.inputType){case"deleteWordBackward":{const q=he.substring(0,_e).match(/\w*[^\w]*$/);q&&(ue-=q[0].length);break}case"deleteWordForward":{const q=he.substring(_e).match(/^[^\w]*\w*/);q&&(ge+=q[0].length);break}case"deleteContentBackward":_e===te&&(ue-=1);break;case"deleteContentForward":_e===te&&(ge+=1)}se.preventDefault(),null==(U=this.linkService.eventBus)||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:he,change:J||"",willCommit:!1,selStart:ue,selEnd:ge}})}),this._setEventListeners(A,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],se=>se.target.value)}if(Q&&A.addEventListener("blur",Q),null!==this.data.maxLen&&(A.maxLength=this.data.maxLen),this.data.comb){const se=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;A.classList.add("comb"),A.style.letterSpacing=`calc(${se}px - 1ch)`}}else A=document.createElement("div"),A.textContent=this.data.fieldValue,A.style.verticalAlign="middle",A.style.display="table-cell";return this._setTextStyle(A),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.appendChild(A),this.container}_setTextStyle(E){const{fontSize:A,fontColor:k}=this.data.defaultAppearanceData,R=E.style;A&&(R.fontSize=`${A}px`),R.color=S.Util.makeHexColor(k[0],k[1],k[2]),null!==this.data.textAlignment&&(R.textAlign=["left","center","right"][this.data.textAlignment])}}class f extends o{constructor(E){super(E,{isRenderable:E.renderForms})}render(){const E=this.annotationStorage,P=this.data,A=P.id;let k=E.getValue(A,{value:P.exportValue===P.fieldValue}).value;"string"==typeof k&&(k="Off"!==k,E.setValue(A,{value:k})),this.container.className="buttonWidgetAnnotation checkBox";const R=document.createElement("input");return _.add(R),R.disabled=P.readOnly,R.type="checkbox",R.name=P.fieldName,k&&R.setAttribute("checked",!0),R.setAttribute("id",A),R.setAttribute("exportValue",P.exportValue),R.tabIndex=1e3,R.addEventListener("change",j=>{const{name:z,checked:Q}=j.target;for(const ee of this._getElementsByName(z,A)){const se=Q&&ee.exportValue===P.exportValue;ee.domElement&&(ee.domElement.checked=se),E.setValue(ee.id,{value:se})}E.setValue(A,{value:Q})}),R.addEventListener("resetform",j=>{j.target.checked=(P.defaultFieldValue||"Off")===P.exportValue}),this.enableScripting&&this.hasJSActions&&(R.addEventListener("updatefromsandbox",j=>{this._dispatchEventFromSandbox({value(Q){Q.target.checked="Off"!==Q.detail.value,E.setValue(A,{value:Q.target.checked})}},j)}),this._setEventListeners(R,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],j=>j.target.checked)),this._setBackgroundColor(R),this._setDefaultPropertiesFromJS(R),this.container.appendChild(R),this.container}}class u extends o{constructor(E){super(E,{isRenderable:E.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const E=this.annotationStorage,P=this.data,A=P.id;let k=E.getValue(A,{value:P.fieldValue===P.buttonValue}).value;"string"==typeof k&&(k=k!==P.buttonValue,E.setValue(A,{value:k}));const R=document.createElement("input");if(_.add(R),R.disabled=P.readOnly,R.type="radio",R.name=P.fieldName,k&&R.setAttribute("checked",!0),R.setAttribute("id",A),R.tabIndex=1e3,R.addEventListener("change",j=>{const{name:z,checked:Q}=j.target;for(const ee of this._getElementsByName(z,A))E.setValue(ee.id,{value:!1});E.setValue(A,{value:Q})}),R.addEventListener("resetform",j=>{const z=P.defaultFieldValue;j.target.checked=null!=z&&z===P.buttonValue}),this.enableScripting&&this.hasJSActions){const j=P.buttonValue;R.addEventListener("updatefromsandbox",z=>{this._dispatchEventFromSandbox({value:ee=>{const se=j===ee.detail.value;for(const J of this._getElementsByName(ee.target.name)){const X=se&&J.id===A;J.domElement&&(J.domElement.checked=X),E.setValue(J.id,{value:X})}}},z)}),this._setEventListeners(R,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],z=>z.target.checked)}return this._setBackgroundColor(R),this._setDefaultPropertiesFromJS(R),this.container.appendChild(R),this.container}}class m extends c{constructor(E){super(E,{ignoreBorder:E.data.hasAppearance})}render(){const E=super.render();return E.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(E.title=this.data.alternativeText),this._setDefaultPropertiesFromJS(E),E}}class b extends o{constructor(E){super(E,{isRenderable:E.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const E=this.annotationStorage,P=this.data.id,A=E.getValue(P,{value:this.data.fieldValue});let{fontSize:k}=this.data.defaultAppearanceData;k||(k=9);const R=`calc(${k}px * var(--zoom-factor))`,j=document.createElement("select");_.add(j),j.disabled=this.data.readOnly,j.name=this.data.fieldName,j.setAttribute("id",P),j.tabIndex=1e3,j.style.fontSize=`${k}px`,this.data.combo||(j.size=this.data.options.length,this.data.multiSelect&&(j.multiple=!0)),j.addEventListener("resetform",ee=>{const se=this.data.defaultFieldValue;for(const J of j.options)J.selected=J.value===se});for(const ee of this.data.options){const se=document.createElement("option");se.textContent=ee.displayValue,se.value=ee.exportValue,this.data.combo&&(se.style.fontSize=R),A.value.includes(ee.exportValue)&&se.setAttribute("selected",!0),j.appendChild(se)}const z=(ee,se)=>{const J=se?"value":"textContent",X=ee.target.options;return ee.target.multiple?Array.prototype.filter.call(X,he=>he.selected).map(he=>he[J]):-1===X.selectedIndex?null:X[X.selectedIndex][J]},Q=ee=>Array.prototype.map.call(ee.target.options,J=>({displayValue:J.textContent,exportValue:J.value}));return this.enableScripting&&this.hasJSActions?(j.addEventListener("updatefromsandbox",ee=>{this._dispatchEventFromSandbox({value(J){const X=J.detail.value,he=new Set(Array.isArray(X)?X:[X]);for(const _e of j.options)_e.selected=he.has(_e.value);E.setValue(P,{value:z(J,!0)})},multipleSelection(J){j.multiple=!0},remove(J){const X=j.options,he=J.detail.remove;X[he].selected=!1,j.remove(he),X.length>0&&-1===Array.prototype.findIndex.call(X,te=>te.selected)&&(X[0].selected=!0),E.setValue(P,{value:z(J,!0),items:Q(J)})},clear(J){for(;0!==j.length;)j.remove(0);E.setValue(P,{value:null,items:[]})},insert(J){const{index:X,displayValue:he,exportValue:_e}=J.detail.insert,te=document.createElement("option");te.textContent=he,te.value=_e,j.insertBefore(te,j.children[X]),E.setValue(P,{value:z(J,!0),items:Q(J)})},items(J){const{items:X}=J.detail;for(;0!==j.length;)j.remove(0);for(const he of X){const{displayValue:_e,exportValue:te}=he,ue=document.createElement("option");ue.textContent=_e,ue.value=te,j.appendChild(ue)}j.options.length>0&&(j.options[0].selected=!0),E.setValue(P,{value:z(J,!0),items:Q(J)})},indices(J){const X=new Set(J.detail.indices);for(const he of J.target.options)he.selected=X.has(he.index);E.setValue(P,{value:z(J,!0)})},editable(J){J.target.disabled=!J.detail.editable}},ee)}),j.addEventListener("input",ee=>{var X;const se=z(ee,!0),J=z(ee,!1);E.setValue(P,{value:se}),null==(X=this.linkService.eventBus)||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:J,changeEx:se,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(j,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],ee=>ee.target.checked)):j.addEventListener("input",function(ee){E.setValue(P,{value:z(ee,!0)})}),this._setBackgroundColor(j),this._setDefaultPropertiesFromJS(j),this.container.appendChild(j),this.container}}class v extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!((null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str))})}render(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;const A=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(0===A.length)return this.container;const k=new C({container:this.container,trigger:Array.from(A),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),R=this.page,j=S.Util.normalizeRect([this.data.parentRect[0],R.view[3]-this.data.parentRect[1]+R.view[1],this.data.parentRect[2],R.view[3]-this.data.parentRect[3]+R.view[1]]),z=j[0]+this.data.parentRect[2]-this.data.parentRect[0],Q=j[1];return this.container.style.transformOrigin=`${-z}px ${-Q}px`,this.container.style.left=`${z}px`,this.container.style.top=`${Q}px`,this.container.appendChild(k.render()),this.container}}class C{constructor(E){this.container=E.container,this.trigger=E.trigger,this.color=E.color,this.titleObj=E.titleObj,this.modificationDate=E.modificationDate,this.contentsObj=E.contentsObj,this.richText=E.richText,this.hideWrapper=E.hideWrapper||!1,this.pinned=!1}render(){var z,Q;const P=document.createElement("div");P.className="popupWrapper",this.hideElement=this.hideWrapper?P:this.container,this.hideElement.hidden=!0;const A=document.createElement("div");A.className="popup";const k=this.color;k&&(A.style.backgroundColor=S.Util.makeHexColor(0|.7*(255-k[0])+k[0],0|.7*(255-k[1])+k[1],0|.7*(255-k[2])+k[2]));const R=document.createElement("h1");R.dir=this.titleObj.dir,R.textContent=this.titleObj.str,A.appendChild(R);const j=ke.PDFDateString.toDateObject(this.modificationDate);if(j){const ee=document.createElement("span");ee.className="popupDate",ee.textContent="{{date}}, {{time}}",ee.dataset.l10nId="annotation_date_string",ee.dataset.l10nArgs=JSON.stringify({date:j.toLocaleDateString(),time:j.toLocaleTimeString()}),A.appendChild(ee)}if(!(null==(z=this.richText)?void 0:z.str)||(null==(Q=this.contentsObj)?void 0:Q.str)&&this.contentsObj.str!==this.richText.str){const ee=this._formatContents(this.contentsObj);A.appendChild(ee)}else be.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:A}),A.lastChild.className="richText popupContent";Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const ee of this.trigger)ee.addEventListener("click",this._toggle.bind(this)),ee.addEventListener("mouseover",this._show.bind(this,!1)),ee.addEventListener("mouseout",this._hide.bind(this,!1));return A.addEventListener("click",this._hide.bind(this,!0)),P.appendChild(A),P}_formatContents({str:E,dir:P}){const A=document.createElement("p");A.className="popupContent",A.dir=P;const k=E.split(/(?:\r\n?|\n)/);for(let R=0,j=k.length;R<j;++R)A.appendChild(document.createTextNode(k[R])),R<j-1&&A.appendChild(document.createElement("br"));return A}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(E=!1){E&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(E=!0){E&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class x extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class T extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const E=this.data,{width:P,height:A}=h(E.rect),k=this.svgFactory.create(P,A),R=this.svgFactory.createElement("svg:line");return R.setAttribute("x1",E.rect[2]-E.lineCoordinates[0]),R.setAttribute("y1",E.rect[3]-E.lineCoordinates[1]),R.setAttribute("x2",E.rect[2]-E.lineCoordinates[2]),R.setAttribute("y2",E.rect[3]-E.lineCoordinates[3]),R.setAttribute("stroke-width",E.borderStyle.width||1),R.setAttribute("stroke","transparent"),R.setAttribute("fill","transparent"),k.appendChild(R),this.container.append(k),this._createPopup(R,E),this.container}}class I extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const E=this.data,{width:P,height:A}=h(E.rect),k=this.svgFactory.create(P,A),R=E.borderStyle.width,j=this.svgFactory.createElement("svg:rect");return j.setAttribute("x",R/2),j.setAttribute("y",R/2),j.setAttribute("width",P-R),j.setAttribute("height",A-R),j.setAttribute("stroke-width",R||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),k.appendChild(j),this.container.append(k),this._createPopup(j,E),this.container}}class N extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const E=this.data,{width:P,height:A}=h(E.rect),k=this.svgFactory.create(P,A),R=E.borderStyle.width,j=this.svgFactory.createElement("svg:ellipse");return j.setAttribute("cx",P/2),j.setAttribute("cy",A/2),j.setAttribute("rx",P/2-R/2),j.setAttribute("ry",A/2-R/2),j.setAttribute("stroke-width",R||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),k.appendChild(j),this.container.append(k),this._createPopup(j,E),this.container}}class H extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const E=this.data,{width:P,height:A}=h(E.rect),k=this.svgFactory.create(P,A);let R=[];for(const z of E.vertices)R.push(z.x-E.rect[0]+","+(E.rect[3]-z.y));R=R.join(" ");const j=this.svgFactory.createElement(this.svgElementName);return j.setAttribute("points",R),j.setAttribute("stroke-width",E.borderStyle.width||1),j.setAttribute("stroke","transparent"),j.setAttribute("fill","transparent"),k.appendChild(j),this.container.append(k),this._createPopup(j,E),this.container}}class W extends H{constructor(E){super(E),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class K extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class ne extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const E=this.data,{width:P,height:A}=h(E.rect),k=this.svgFactory.create(P,A);for(const R of E.inkLists){let j=[];for(const Q of R)j.push(`${Q.x-E.rect[0]},${E.rect[3]-Q.y}`);j=j.join(" ");const z=this.svgFactory.createElement(this.svgElementName);z.setAttribute("points",j),z.setAttribute("stroke-width",E.borderStyle.width||1),z.setAttribute("stroke","transparent"),z.setAttribute("fill","transparent"),this._createPopup(z,E),k.appendChild(z)}return this.container.append(k),this.container}}class ae extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class ce extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class Y extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class de extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class fe extends g{constructor(E){var A,k,R;super(E,{isRenderable:!!(E.data.hasPopup||(null==(A=E.data.titleObj)?void 0:A.str)||(null==(k=E.data.contentsObj)?void 0:k.str)||(null==(R=E.data.richText)?void 0:R.str)),ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class me extends g{constructor(E){var k;super(E,{isRenderable:!0});const{filename:P,content:A}=this.data.file;this.filename=(0,ke.getFilenameFromUrl)(P),this.content=A,null==(k=this.linkService.eventBus)||k.dispatch("fileattachmentannotation",{source:this,filename:P,content:A})}render(){var P,A;this.container.className="fileAttachmentAnnotation";const E=document.createElement("div");return E.style.height=this.container.style.height,E.style.width=this.container.style.width,E.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((null==(P=this.data.titleObj)?void 0:P.str)||(null==(A=this.data.contentsObj)?void 0:A.str)||this.data.richText)&&this._createPopup(E,this.data),this.container.appendChild(E),this.container}_download(){var E;null==(E=this.downloadManager)||E.openOrDownloadData(this.container,this.content,this.filename)}}class B{static render(E){const P=[],A=[];for(const R of E.annotations){if(!R)continue;const{width:j,height:z}=h(R.rect);if(!(j<=0||z<=0)){if(R.annotationType===S.AnnotationType.POPUP){A.push(R);continue}P.push(R)}}A.length&&P.push(...A);const k=E.div;for(const R of P){const j=p.create({data:R,layer:k,page:E.page,viewport:E.viewport,linkService:E.linkService,downloadManager:E.downloadManager,imageResourcesPath:E.imageResourcesPath||"",renderForms:!1!==E.renderForms,svgFactory:new ke.DOMSVGFactory,annotationStorage:E.annotationStorage||new we.AnnotationStorage,enableScripting:E.enableScripting,hasJSActions:E.hasJSActions,fieldObjects:E.fieldObjects,mouseState:E.mouseState||{isDown:!1}});if(j.isRenderable){const z=j.render();if(R.hidden&&(z.style.visibility="hidden"),Array.isArray(z))for(const Q of z)k.appendChild(Q);else j instanceof v?k.prepend(z):k.appendChild(z)}}Xe(this,L,EC).call(this,k,E.annotationCanvasMap)}static update(E){const{page:P,viewport:A,annotations:k,annotationCanvasMap:R,div:j}=E,z=A.transform,Q=`matrix(${z.join(",")})`;let ee,se;for(const J of k){const X=j.querySelectorAll(`[data-annotation-id="${J.id}"]`);if(X)for(const he of X)if(J.hasOwnCanvas){const _e=S.Util.normalizeRect([J.rect[0],P.view[3]-J.rect[1]+P.view[1],J.rect[2],P.view[3]-J.rect[3]+P.view[1]]);if(!se){ee=Math.abs(z[0]||z[1]);const ge=z.slice();for(let U=0;U<4;U++)ge[U]=Math.sign(ge[U]);se=`matrix(${ge.join(",")})`}const te=_e[0]*ee,ue=_e[1]*ee;he.style.left=`${te}px`,he.style.top=`${ue}px`,he.style.transformOrigin=`${-te}px ${-ue}px`,he.style.transform=se}else he.style.transform=Q}Xe(this,L,EC).call(this,j,R),j.hidden=!1}}L=new WeakSet,EC=function(E,P){if(P){for(const[A,k]of P){const R=E.querySelector(`[data-annotation-id="${A}"]`);if(!R)continue;const{firstChild:j}=R;"CANVAS"===j.nodeName?R.replaceChild(k,j):R.insertBefore(k,j)}P.clear()}},Ze(B,L),$.AnnotationLayer=B},(Ie,$)=>{function Ae(ke){return Math.floor(255*Math.max(0,Math.min(1,ke))).toString(16).padStart(2,"0")}Object.defineProperty($,"__esModule",{value:!0}),$.ColorConverters=void 0,$.ColorConverters=class{static CMYK_G([we,ye,be,le]){return["G",1-Math.min(1,.3*we+.59*be+.11*ye+le)]}static G_CMYK([we]){return["CMYK",0,0,0,1-we]}static G_RGB([we]){return["RGB",we,we,we]}static G_HTML([we]){const ye=Ae(we);return`#${ye}${ye}${ye}`}static RGB_G([we,ye,be]){return["G",.3*we+.59*ye+.11*be]}static RGB_HTML([we,ye,be]){return`#${Ae(we)}${Ae(ye)}${Ae(be)}`}static T_HTML(){return"#00000000"}static CMYK_RGB([we,ye,be,le]){return["RGB",1-Math.min(1,we+le),1-Math.min(1,be+le),1-Math.min(1,ye+le)]}static CMYK_HTML(we){return this.RGB_HTML(this.CMYK_RGB(we))}static RGB_CMYK([we,ye,be]){const le=1-we,_=1-ye,h=1-be;return["CMYK",le,_,h,Math.min(le,_,h)]}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.XfaLayer=void 0;var S=Ae(18);$.XfaLayer=class{static setupStorage(ye,be,le,_,h){const p=_.getValue(be,{value:null});switch(le.name){case"textarea":if(null!==p.value&&(ye.textContent=p.value),"print"===h)break;ye.addEventListener("input",g=>{_.setValue(be,{value:g.target.value})});break;case"input":if("radio"===le.attributes.type||"checkbox"===le.attributes.type){if(p.value===le.attributes.xfaOn?ye.setAttribute("checked",!0):p.value===le.attributes.xfaOff&&ye.removeAttribute("checked"),"print"===h)break;ye.addEventListener("change",g=>{_.setValue(be,{value:g.target.getAttribute(g.target.checked?"xfaOn":"xfaOff")})})}else{if(null!==p.value&&ye.setAttribute("value",p.value),"print"===h)break;ye.addEventListener("input",g=>{_.setValue(be,{value:g.target.value})})}break;case"select":if(null!==p.value)for(const g of le.children)g.attributes.value===p.value&&(g.attributes.selected=!0);ye.addEventListener("input",g=>{const c=g.target.options;_.setValue(be,{value:-1===c.selectedIndex?"":c[c.selectedIndex].value})})}}static setAttributes({html:ye,element:be,storage:le=null,intent:_,linkService:h}){const{attributes:p}=be,g=ye instanceof HTMLAnchorElement;"radio"===p.type&&(p.name=`${p.name}-${_}`);for(const[c,l]of Object.entries(p))if(null!=l&&"dataId"!==c)if("style"!==c)if("textContent"===c)ye.textContent=l;else if("class"===c)l.length&&ye.setAttribute(c,l.join(" "));else{if(g&&("href"===c||"newWindow"===c))continue;ye.setAttribute(c,l)}else Object.assign(ye.style,l);g&&h.addLinkAttributes(ye,p.href,p.newWindow),le&&p.dataId&&this.setupStorage(ye,p.dataId,be,le)}static render(ye){var o;const be=ye.annotationStorage,le=ye.linkService,_=ye.xfaHtml,h=ye.intent||"display",p=document.createElement(_.name);_.attributes&&this.setAttributes({html:p,element:_,intent:h,linkService:le});const g=[[_,-1,p]],c=ye.div;if(c.appendChild(p),ye.viewport){const a=`matrix(${ye.viewport.transform.join(",")})`;c.style.transform=a}"richText"!==h&&c.setAttribute("class","xfaLayer xfaFont");const l=[];for(;g.length>0;){const[a,f,u]=g[g.length-1];if(f+1===a.children.length){g.pop();continue}const m=a.children[++g[g.length-1][1]];if(null===m)continue;const{name:b}=m;if("#text"===b){const C=document.createTextNode(m.value);l.push(C),u.appendChild(C);continue}let v;if(v=(null==(o=null==m?void 0:m.attributes)?void 0:o.xmlns)?document.createElementNS(m.attributes.xmlns,b):document.createElement(b),u.appendChild(v),m.attributes&&this.setAttributes({html:v,element:m,storage:be,intent:h,linkService:le}),m.children&&m.children.length>0)g.push([m,-1,v]);else if(m.value){const C=document.createTextNode(m.value);S.XfaText.shouldBuildText(b)&&l.push(C),v.appendChild(C)}}for(const a of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))a.setAttribute("readOnly",!0);return{textDivs:l}}static update(ye){const be=`matrix(${ye.viewport.transform.join(",")})`;ye.div.style.transform=be,ye.div.hidden=!1}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.renderTextLayer=function(u){const m=new a({textContent:u.textContent,textContentStream:u.textContentStream,container:u.container,viewport:u.viewport,textDivs:u.textDivs,textContentItemsStr:u.textContentItemsStr,enhanceTextSelection:u.enhanceTextSelection});return m._render(u.timeout),m};var S=Ae(1);const be=new Map,le=/^\s+$/g;function h(u,m,b,v){const C=document.createElement("span"),x=u._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:""!==m.str,hasEOL:m.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1}:{angle:0,canvasWidth:0,hasText:""!==m.str,hasEOL:m.hasEOL};u._textDivs.push(C);const T=S.Util.transform(u._viewport.transform,m.transform);let I=Math.atan2(T[1],T[0]);const N=b[m.fontName];N.vertical&&(I+=Math.PI/2);const H=Math.hypot(T[2],T[3]),W=H*function(u,m){const b=be.get(u);if(b)return b;m.save(),m.font=`30px ${u}`;const v=m.measureText("");let C=v.fontBoundingBoxAscent,x=Math.abs(v.fontBoundingBoxDescent);if(C){m.restore();const I=C/(C+x);return be.set(u,I),I}m.strokeStyle="red",m.clearRect(0,0,30,30),m.strokeText("g",0,0);let T=m.getImageData(0,0,30,30).data;x=0;for(let I=T.length-1-3;I>=0;I-=4)if(T[I]>0){x=Math.ceil(I/4/30);break}m.clearRect(0,0,30,30),m.strokeText("A",0,30),T=m.getImageData(0,0,30,30).data,C=0;for(let I=0,N=T.length;I<N;I+=4)if(T[I]>0){C=30-Math.floor(I/4/30);break}if(m.restore(),C){const I=C/(C+x);return be.set(u,I),I}return be.set(u,.8),.8}(N.fontFamily,v);let K,ne;0===I?(K=T[4],ne=T[5]-W):(K=T[4]+W*Math.sin(I),ne=T[5]-W*Math.cos(I)),C.style.left=`${K}px`,C.style.top=`${ne}px`,C.style.fontSize=`${H}px`,C.style.fontFamily=N.fontFamily,C.setAttribute("role","presentation"),C.textContent=m.str,C.dir=m.dir,u._fontInspectorEnabled&&(C.dataset.fontName=m.fontName),0!==I&&(x.angle=I*(180/Math.PI));let ae=!1;if(m.str.length>1||u._enhanceTextSelection&&le.test(m.str))ae=!0;else if(" "!==m.str&&m.transform[0]!==m.transform[3]){const ce=Math.abs(m.transform[0]),Y=Math.abs(m.transform[3]);ce!==Y&&Math.max(ce,Y)/Math.min(ce,Y)>1.5&&(ae=!0)}if(ae&&(x.canvasWidth=N.vertical?m.height*u._viewport.scale:m.width*u._viewport.scale),u._textDivProperties.set(C,x),u._textContentStream&&u._layoutText(C),u._enhanceTextSelection&&x.hasText){let ce=1,Y=0;0!==I&&(ce=Math.cos(I),Y=Math.sin(I));const de=(N.vertical?m.height:m.width)*u._viewport.scale,fe=H;let me,B;0!==I?(me=[ce,Y,-Y,ce,K,ne],B=S.Util.getAxialAlignedBoundingBox([0,0,de,fe],me)):B=[K,ne,K+de,ne+fe],u._bounds.push({left:B[0],top:B[1],right:B[2],bottom:B[3],div:C,size:[de,fe],m:me})}}function p(u){if(u._canceled)return;const m=u._textDivs,b=u._capability,v=m.length;if(v>1e5)return u._renderingDone=!0,void b.resolve();if(!u._textContentStream)for(let C=0;C<v;C++)u._layoutText(m[C]);u._renderingDone=!0,b.resolve()}function g(u,m,b){let v=0;for(let C=0;C<b;C++){const x=u[m++];x>0&&(v=v?Math.min(x,v):x)}return v}function o(u,m){m.sort(function(C,x){return C.x1-x.x1||C.index-x.index});const v=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const C of m){let x=0;for(;x<v.length&&v[x].end<=C.y1;)x++;let T=v.length-1;for(;T>=0&&v[T].start>=C.y2;)T--;let I,N,H,W,K=-1/0;for(H=x;H<=T;H++){let ce;I=v[H],N=I.boundary,ce=N.x2>C.x1?N.index>C.index?N.x1New:C.x1:void 0===N.x2New?(N.x2+C.x1)/2:N.x2New,ce>K&&(K=ce)}for(C.x1New=K,H=x;H<=T;H++)I=v[H],N=I.boundary,void 0===N.x2New?N.x2>C.x1?N.index>C.index&&(N.x2New=N.x2):N.x2New=K:N.x2New>K&&(N.x2New=Math.max(K,N.x2));const ne=[];let ae=null;for(H=x;H<=T;H++){I=v[H],N=I.boundary;const ce=N.x2>C.x2?N:C;ae===ce?ne[ne.length-1].end=I.end:(ne.push({start:I.start,end:I.end,boundary:ce}),ae=ce)}for(v[x].start<C.y1&&(ne[0].start=C.y1,ne.unshift({start:v[x].start,end:C.y1,boundary:v[x].boundary})),C.y2<v[T].end&&(ne[ne.length-1].end=C.y2,ne.push({start:C.y2,end:v[T].end,boundary:v[T].boundary})),H=x;H<=T;H++){if(I=v[H],N=I.boundary,void 0!==N.x2New)continue;let ce=!1;for(W=x-1;!ce&&W>=0&&v[W].start>=N.y1;W--)ce=v[W].boundary===N;for(W=T+1;!ce&&W<v.length&&v[W].end<=N.y2;W++)ce=v[W].boundary===N;for(W=0;!ce&&W<ne.length;W++)ce=ne[W].boundary===N;ce||(N.x2New=K)}Array.prototype.splice.apply(v,[x,T-x+1].concat(ne))}for(const C of v){const x=C.boundary;void 0===x.x2New&&(x.x2New=Math.max(u,x.x2))}}class a{constructor({textContent:m,textContentStream:b,container:v,viewport:C,textDivs:x,textContentItemsStr:T,enhanceTextSelection:I}){var N;this._textContent=m,this._textContentStream=b,this._container=v,this._document=v.ownerDocument,this._viewport=C,this._textDivs=x||[],this._textContentItemsStr=T||[],this._enhanceTextSelection=!!I,this._fontInspectorEnabled=!!(null==(N=globalThis.FontInspector)?void 0:N.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,S.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new S.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(m,b){for(let v=0,C=m.length;v<C;v++)if(void 0!==m[v].str)this._textContentItemsStr.push(m[v].str),h(this,m[v],b,this._layoutTextCtx);else if("beginMarkedContentProps"===m[v].type||"beginMarkedContent"===m[v].type){const x=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==m[v].id&&this._container.setAttribute("id",`${m[v].id}`),x.appendChild(this._container)}else"endMarkedContent"===m[v].type&&(this._container=this._container.parentNode)}_layoutText(m){const b=this._textDivProperties.get(m);let v="";if(0!==b.canvasWidth&&b.hasText){const{fontSize:C,fontFamily:x}=m.style;(C!==this._layoutTextLastFontSize||x!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${C} ${x}`,this._layoutTextLastFontSize=C,this._layoutTextLastFontFamily=x);const{width:T}=this._layoutTextCtx.measureText(m.textContent);if(T>0){const I=b.canvasWidth/T;this._enhanceTextSelection&&(b.scale=I),v=`scaleX(${I})`}}if(0!==b.angle&&(v=`rotate(${b.angle}deg) ${v}`),v.length>0&&(this._enhanceTextSelection&&(b.originalTransform=v),m.style.transform=v),b.hasText&&this._container.appendChild(m),b.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),this._container.appendChild(C)}}_render(m=0){const b=(0,S.createPromiseCapability)();let v=Object.create(null);const C=this._document.createElement("canvas");if(C.height=C.width=30,this._layoutTextCtx=C.getContext("2d",{alpha:!1}),this._textContent)this._processItems(this._textContent.items,this._textContent.styles),b.resolve();else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const x=()=>{this._reader.read().then(({value:T,done:I})=>{I?b.resolve():(Object.assign(v,T.styles),this._processItems(T.items,v),x())},b.reject)};this._reader=this._textContentStream.getReader(),x()}}b.promise.then(()=>{v=null,m?this._renderTimer=setTimeout(()=>{p(this),this._renderTimer=null},m):p(this)},this._capability.reject)}expandTextDivs(m=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;null!==this._bounds&&(function(u){const m=u._bounds,b=u._viewport,v=function(u,m,b){const v=b.map(function(x,T){return{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom,index:T,x1New:void 0,x2New:void 0}});o(u,v);const C=new Array(b.length);for(const x of v)C[x.index]={left:x.x1New,top:0,right:x.x2New,bottom:0};b.map(function(x,T){const I=C[T],N=v[T];N.x1=x.top,N.y1=u-I.right,N.x2=x.bottom,N.y2=u-I.left,N.index=T,N.x1New=void 0,N.x2New=void 0}),o(m,v);for(const x of v){const T=x.index;C[T].top=x.x1New,C[T].bottom=x.x2New}return C}(b.width,b.height,m);for(let C=0;C<v.length;C++){const x=m[C].div,T=u._textDivProperties.get(x);if(0===T.angle){T.paddingLeft=m[C].left-v[C].left,T.paddingTop=m[C].top-v[C].top,T.paddingRight=v[C].right-m[C].right,T.paddingBottom=v[C].bottom-m[C].bottom,u._textDivProperties.set(x,T);continue}const I=v[C],N=m[C],H=N.m,W=H[0],K=H[1],ne=[[0,0],[0,N.size[1]],[N.size[0],0],N.size],ae=new Float64Array(64);for(let Y=0,de=ne.length;Y<de;Y++){const fe=S.Util.applyTransform(ne[Y],H);ae[Y+0]=W&&(I.left-fe[0])/W,ae[Y+4]=K&&(I.top-fe[1])/K,ae[Y+8]=W&&(I.right-fe[0])/W,ae[Y+12]=K&&(I.bottom-fe[1])/K,ae[Y+16]=K&&(I.left-fe[0])/-K,ae[Y+20]=W&&(I.top-fe[1])/W,ae[Y+24]=K&&(I.right-fe[0])/-K,ae[Y+28]=W&&(I.bottom-fe[1])/W,ae[Y+32]=W&&(I.left-fe[0])/-W,ae[Y+36]=K&&(I.top-fe[1])/-K,ae[Y+40]=W&&(I.right-fe[0])/-W,ae[Y+44]=K&&(I.bottom-fe[1])/-K,ae[Y+48]=K&&(I.left-fe[0])/K,ae[Y+52]=W&&(I.top-fe[1])/-W,ae[Y+56]=K&&(I.right-fe[0])/K,ae[Y+60]=W&&(I.bottom-fe[1])/-W}const ce=1+Math.min(Math.abs(W),Math.abs(K));T.paddingLeft=g(ae,32,16)/ce,T.paddingTop=g(ae,48,16)/ce,T.paddingRight=g(ae,0,16)/ce,T.paddingBottom=g(ae,16,16)/ce,u._textDivProperties.set(x,T)}}(this),this._bounds=null);const b=[],v=[];for(let C=0,x=this._textDivs.length;C<x;C++){const T=this._textDivs[C],I=this._textDivProperties.get(T);!I.hasText||(m?(b.length=0,v.length=0,I.originalTransform&&b.push(I.originalTransform),I.paddingTop>0?(v.push(`${I.paddingTop}px`),b.push(`translateY(${-I.paddingTop}px)`)):v.push(0),v.push(I.paddingRight>0?I.paddingRight/I.scale+"px":0),v.push(I.paddingBottom>0?`${I.paddingBottom}px`:0),I.paddingLeft>0?(v.push(I.paddingLeft/I.scale+"px"),b.push(`translateX(${-I.paddingLeft/I.scale}px)`)):v.push(0),T.style.padding=v.join(" "),b.length&&(T.style.transform=b.join(" "))):(T.style.padding=null,T.style.transform=I.originalTransform))}}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.SVGGraphics=void 0;var S=Ae(1),ke=Ae(5),we=Ae(3);let ye=class{constructor(){(0,S.unreachable)("Not implemented: SVGGraphics")}};$.SVGGraphics=ye;{let o=function(v){let C=[];const x=[];for(const T of v)"save"!==T.fn?"restore"===T.fn?C=x.pop():C.push(T):(C.push({fnId:92,fn:"group",items:[]}),x.push(C),C=C[C.length-1].items);return C},a=function(v){if(Number.isInteger(v))return v.toString();const C=v.toFixed(10);let x=C.length-1;if("0"!==C[x])return C;do{x--}while("0"===C[x]);return C.substring(0,"."===C[x]?x:x+1)},f=function(v){if(0===v[4]&&0===v[5]){if(0===v[1]&&0===v[2])return 1===v[0]&&1===v[3]?"":`scale(${a(v[0])} ${a(v[3])})`;if(v[0]===v[3]&&v[1]===-v[2]){const C=180*Math.acos(v[0])/Math.PI;return`rotate(${a(C)})`}}else if(1===v[0]&&0===v[1]&&0===v[2]&&1===v[3])return`translate(${a(v[4])} ${a(v[5])})`;return`matrix(${a(v[0])} ${a(v[1])} ${a(v[2])} ${a(v[3])} ${a(v[4])} ${a(v[5])})`};const be={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},le="http://www.w3.org/XML/1998/namespace",_="http://www.w3.org/1999/xlink",h=["butt","round","square"],p=["miter","round","bevel"],g=function(v,C="",x=!1){if(URL.createObjectURL&&"undefined"!=typeof Blob&&!x)return URL.createObjectURL(new Blob([v],{type:C}));const T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let I=`data:${C};base64,`;for(let N=0,H=v.length;N<H;N+=3){const W=255&v[N],K=255&v[N+1],ne=255&v[N+2];I+=T[W>>2]+T[(3&W)<<4|K>>4]+T[N+1<H?(15&K)<<2|ne>>6:64]+T[N+2<H?63&ne:64]}return I},c=function(){const v=new Uint8Array([137,80,78,71,13,10,26,10]),x=new Int32Array(256);for(let ne=0;ne<256;ne++){let ae=ne;for(let ce=0;ce<8;ce++)ae=1&ae?3988292384^ae>>1&2147483647:ae>>1&2147483647;x[ne]=ae}function I(ne,ae,ce,Y){let de=Y;const fe=ae.length;ce[de]=fe>>24&255,ce[de+1]=fe>>16&255,ce[de+2]=fe>>8&255,ce[de+3]=255&fe,de+=4,ce[de]=255&ne.charCodeAt(0),ce[de+1]=255&ne.charCodeAt(1),ce[de+2]=255&ne.charCodeAt(2),ce[de+3]=255&ne.charCodeAt(3),de+=4,ce.set(ae,de),de+=ae.length;const me=function(ne,ae,ce){let Y=-1;for(let de=ae;de<ce;de++)Y=Y>>>8^x[255&(Y^ne[de])];return-1^Y}(ce,Y+4,de);ce[de]=me>>24&255,ce[de+1]=me>>16&255,ce[de+2]=me>>8&255,ce[de+3]=255&me}function W(ne){let ae=ne.length;const ce=65535,Y=Math.ceil(ae/ce),de=new Uint8Array(2+ae+5*Y+4);let fe=0;de[fe++]=120,de[fe++]=156;let me=0;for(;ae>ce;)de[fe++]=0,de[fe++]=255,de[fe++]=255,de[fe++]=0,de[fe++]=0,de.set(ne.subarray(me,me+ce),fe),fe+=ce,me+=ce,ae-=ce;de[fe++]=1,de[fe++]=255&ae,de[fe++]=ae>>8&255,de[fe++]=255&~ae,de[fe++]=(65535&~ae)>>8&255,de.set(ne.subarray(me),fe),fe+=ne.length-me;const B=function(ne,ae,ce){let Y=1,de=0;for(let fe=0;fe<ce;++fe)Y=(Y+(255&ne[fe]))%65521,de=(de+Y)%65521;return de<<16|Y}(ne,0,ne.length);return de[fe++]=B>>24&255,de[fe++]=B>>16&255,de[fe++]=B>>8&255,de[fe++]=255&B,de}return function(ae,ce,Y){return function(ne,ae,ce,Y){const de=ne.width,fe=ne.height;let me,B,L;const D=ne.data;switch(ae){case S.ImageKind.GRAYSCALE_1BPP:B=0,me=1,L=de+7>>3;break;case S.ImageKind.RGB_24BPP:B=2,me=8,L=3*de;break;case S.ImageKind.RGBA_32BPP:B=6,me=8,L=4*de;break;default:throw new Error("invalid format")}const M=new Uint8Array((1+L)*fe);let E=0,P=0;for(let Q=0;Q<fe;++Q)M[E++]=0,M.set(D.subarray(P,P+L),E),P+=L,E+=L;if(ae===S.ImageKind.GRAYSCALE_1BPP&&Y){E=0;for(let Q=0;Q<fe;Q++){E++;for(let ee=0;ee<L;ee++)M[E++]^=255}}const A=new Uint8Array([de>>24&255,de>>16&255,de>>8&255,255&de,fe>>24&255,fe>>16&255,fe>>8&255,255&fe,me,B,0,0,0]),k=function(ne){if(!we.isNodeJS)return W(ne);try{let ae;ae=parseInt(process.versions.node)>=8?ne:Buffer.from(ne);const ce=__webpack_require__(258).deflateSync(ae,{level:9});return ce instanceof Uint8Array?ce:new Uint8Array(ce)}catch(ae){(0,S.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+ae)}return W(ne)}(M),j=new Uint8Array(v.length+36+A.length+k.length);let z=0;return j.set(v,z),z+=v.length,I("IHDR",A,j,z),z+=12+A.length,I("IDATA",k,j,z),z+=12+k.length,I("IEND",new Uint8Array(0),j,z),g(j,"image/png",ce)}(ae,void 0===ae.kind?S.ImageKind.GRAYSCALE_1BPP:ae.kind,ce,Y)}}();class l{constructor(){this.fontSizeScale=1,this.fontWeight=be.fontWeight,this.fontSize=0,this.textMatrix=S.IDENTITY_MATRIX,this.fontMatrix=S.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=S.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=be.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(C,x){this.x=C,this.y=x}}let u=0,m=0,b=0;$.SVGGraphics=ye=class{constructor(v,C,x=!1){this.svgFactory=new ke.DOMSVGFactory,this.current=new l,this.transformMatrix=S.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=v,this.objs=C,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!x,this._operatorIdMapping=[];for(const T in S.OPS)this._operatorIdMapping[S.OPS[T]]=T}save(){this.transformStack.push(this.transformMatrix);const v=this.current;this.extraStack.push(v),this.current=v.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(v){this.save(),this.executeOpTree(v),this.restore()}loadDependencies(v){const C=v.fnArray,x=v.argsArray;for(let T=0,I=C.length;T<I;T++)if(C[T]===S.OPS.dependency)for(const N of x[T]){const H=N.startsWith("g_")?this.commonObjs:this.objs,W=new Promise(K=>{H.get(N,K)});this.current.dependencies.push(W)}return Promise.all(this.current.dependencies)}transform(v,C,x,T,I,N){this.transformMatrix=S.Util.transform(this.transformMatrix,[v,C,x,T,I,N]),this.tgrp=null}getSVG(v,C){this.viewport=C;const x=this._initialize(C);return this.loadDependencies(v).then(()=>(this.transformMatrix=S.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(v)),x))}convertOpList(v){const C=this._operatorIdMapping,x=v.argsArray,T=v.fnArray,I=[];for(let N=0,H=T.length;N<H;N++){const W=T[N];I.push({fnId:W,fn:C[W],args:x[N]})}return o(I)}executeOpTree(v){for(const C of v){const x=C.fn,I=C.args;switch(0|C.fnId){case S.OPS.beginText:this.beginText();break;case S.OPS.dependency:break;case S.OPS.setLeading:this.setLeading(I);break;case S.OPS.setLeadingMoveText:this.setLeadingMoveText(I[0],I[1]);break;case S.OPS.setFont:this.setFont(I);break;case S.OPS.showText:case S.OPS.showSpacedText:this.showText(I[0]);break;case S.OPS.endText:this.endText();break;case S.OPS.moveText:this.moveText(I[0],I[1]);break;case S.OPS.setCharSpacing:this.setCharSpacing(I[0]);break;case S.OPS.setWordSpacing:this.setWordSpacing(I[0]);break;case S.OPS.setHScale:this.setHScale(I[0]);break;case S.OPS.setTextMatrix:this.setTextMatrix(I[0],I[1],I[2],I[3],I[4],I[5]);break;case S.OPS.setTextRise:this.setTextRise(I[0]);break;case S.OPS.setTextRenderingMode:this.setTextRenderingMode(I[0]);break;case S.OPS.setLineWidth:this.setLineWidth(I[0]);break;case S.OPS.setLineJoin:this.setLineJoin(I[0]);break;case S.OPS.setLineCap:this.setLineCap(I[0]);break;case S.OPS.setMiterLimit:this.setMiterLimit(I[0]);break;case S.OPS.setFillRGBColor:this.setFillRGBColor(I[0],I[1],I[2]);break;case S.OPS.setStrokeRGBColor:this.setStrokeRGBColor(I[0],I[1],I[2]);break;case S.OPS.setStrokeColorN:this.setStrokeColorN(I);break;case S.OPS.setFillColorN:this.setFillColorN(I);break;case S.OPS.shadingFill:this.shadingFill(I[0]);break;case S.OPS.setDash:this.setDash(I[0],I[1]);break;case S.OPS.setRenderingIntent:this.setRenderingIntent(I[0]);break;case S.OPS.setFlatness:this.setFlatness(I[0]);break;case S.OPS.setGState:this.setGState(I[0]);break;case S.OPS.fill:this.fill();break;case S.OPS.eoFill:this.eoFill();break;case S.OPS.stroke:this.stroke();break;case S.OPS.fillStroke:this.fillStroke();break;case S.OPS.eoFillStroke:this.eoFillStroke();break;case S.OPS.clip:this.clip("nonzero");break;case S.OPS.eoClip:this.clip("evenodd");break;case S.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case S.OPS.paintImageXObject:this.paintImageXObject(I[0]);break;case S.OPS.paintInlineImageXObject:this.paintInlineImageXObject(I[0]);break;case S.OPS.paintImageMaskXObject:this.paintImageMaskXObject(I[0]);break;case S.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(I[0],I[1]);break;case S.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case S.OPS.closePath:this.closePath();break;case S.OPS.closeStroke:this.closeStroke();break;case S.OPS.closeFillStroke:this.closeFillStroke();break;case S.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case S.OPS.nextLine:this.nextLine();break;case S.OPS.transform:this.transform(I[0],I[1],I[2],I[3],I[4],I[5]);break;case S.OPS.constructPath:this.constructPath(I[0],I[1]);break;case S.OPS.endPath:this.endPath();break;case 92:this.group(C.items);break;default:(0,S.warn)(`Unimplemented operator ${x}`)}}}setWordSpacing(v){this.current.wordSpacing=v}setCharSpacing(v){this.current.charSpacing=v}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(v,C,x,T,I,N){const H=this.current;H.textMatrix=H.lineMatrix=[v,C,x,T,I,N],H.textMatrixScale=Math.hypot(v,C),H.x=H.lineX=0,H.y=H.lineY=0,H.xcoords=[],H.ycoords=[],H.tspan=this.svgFactory.createElement("svg:tspan"),H.tspan.setAttributeNS(null,"font-family",H.fontFamily),H.tspan.setAttributeNS(null,"font-size",`${a(H.fontSize)}px`),H.tspan.setAttributeNS(null,"y",a(-H.y)),H.txtElement=this.svgFactory.createElement("svg:text"),H.txtElement.appendChild(H.tspan)}beginText(){const v=this.current;v.x=v.lineX=0,v.y=v.lineY=0,v.textMatrix=S.IDENTITY_MATRIX,v.lineMatrix=S.IDENTITY_MATRIX,v.textMatrixScale=1,v.tspan=this.svgFactory.createElement("svg:tspan"),v.txtElement=this.svgFactory.createElement("svg:text"),v.txtgrp=this.svgFactory.createElement("svg:g"),v.xcoords=[],v.ycoords=[]}moveText(v,C){const x=this.current;x.x=x.lineX+=v,x.y=x.lineY+=C,x.xcoords=[],x.ycoords=[],x.tspan=this.svgFactory.createElement("svg:tspan"),x.tspan.setAttributeNS(null,"font-family",x.fontFamily),x.tspan.setAttributeNS(null,"font-size",`${a(x.fontSize)}px`),x.tspan.setAttributeNS(null,"y",a(-x.y))}showText(v){const C=this.current,x=C.font,T=C.fontSize;if(0===T)return;const I=C.fontSizeScale,N=C.charSpacing,H=C.wordSpacing,W=C.fontDirection,K=C.textHScale*W,ne=x.vertical,ae=ne?1:-1,ce=x.defaultVMetrics,Y=T*C.fontMatrix[0];let de=0;for(const B of v){if(null===B){de+=W*H;continue}if("number"==typeof B){de+=ae*B*T/1e3;continue}const L=(B.isSpace?H:0)+N,D=B.fontChar;let M,E,A,P=B.width;if(ne){let k;const R=B.vmetric||ce;k=B.vmetric?R[1]:.5*P,k=-k*Y,P=R?-R[0]:P,M=k/I,E=(de+R[2]*Y)/I}else M=de/I,E=0;(B.isInFont||x.missingFile)&&(C.xcoords.push(C.x+M),ne&&C.ycoords.push(-C.y+E),C.tspan.textContent+=D),A=ne?P*Y-L*W:P*Y+L*W,de+=A}C.tspan.setAttributeNS(null,"x",C.xcoords.map(a).join(" ")),C.tspan.setAttributeNS(null,"y",ne?C.ycoords.map(a).join(" "):a(-C.y)),ne?C.y-=de:C.x+=de*K,C.tspan.setAttributeNS(null,"font-family",C.fontFamily),C.tspan.setAttributeNS(null,"font-size",`${a(C.fontSize)}px`),C.fontStyle!==be.fontStyle&&C.tspan.setAttributeNS(null,"font-style",C.fontStyle),C.fontWeight!==be.fontWeight&&C.tspan.setAttributeNS(null,"font-weight",C.fontWeight);const fe=C.textRenderingMode&S.TextRenderingMode.FILL_STROKE_MASK;fe===S.TextRenderingMode.FILL||fe===S.TextRenderingMode.FILL_STROKE?(C.fillColor!==be.fillColor&&C.tspan.setAttributeNS(null,"fill",C.fillColor),C.fillAlpha<1&&C.tspan.setAttributeNS(null,"fill-opacity",C.fillAlpha)):C.tspan.setAttributeNS(null,"fill",C.textRenderingMode===S.TextRenderingMode.ADD_TO_PATH?"transparent":"none"),(fe===S.TextRenderingMode.STROKE||fe===S.TextRenderingMode.FILL_STROKE)&&this._setStrokeAttributes(C.tspan,1/(C.textMatrixScale||1));let me=C.textMatrix;0!==C.textRise&&(me=me.slice(),me[5]+=C.textRise),C.txtElement.setAttributeNS(null,"transform",`${f(me)} scale(${a(K)}, -1)`),C.txtElement.setAttributeNS(le,"xml:space","preserve"),C.txtElement.appendChild(C.tspan),C.txtgrp.appendChild(C.txtElement),this._ensureTransformGroup().appendChild(C.txtElement)}setLeadingMoveText(v,C){this.setLeading(-C),this.moveText(v,C)}addFontStyle(v){if(!v.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const C=g(v.data,v.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${v.loadedName}"; src: url(${C}); }\n`}setFont(v){const C=this.current,x=this.commonObjs.get(v[0]);let T=v[1];C.font=x,this.embedFonts&&!x.missingFile&&!this.embeddedFonts[x.loadedName]&&(this.addFontStyle(x),this.embeddedFonts[x.loadedName]=x),C.fontMatrix=x.fontMatrix||S.FONT_IDENTITY_MATRIX;let I="normal";x.black?I="900":x.bold&&(I="bold");const N=x.italic?"italic":"normal";T<0?(T=-T,C.fontDirection=-1):C.fontDirection=1,C.fontSize=T,C.fontFamily=x.loadedName,C.fontWeight=I,C.fontStyle=N,C.tspan=this.svgFactory.createElement("svg:tspan"),C.tspan.setAttributeNS(null,"y",a(-C.y)),C.xcoords=[],C.ycoords=[]}endText(){var C;const v=this.current;v.textRenderingMode&S.TextRenderingMode.ADD_TO_PATH_FLAG&&(null==(C=v.txtElement)?void 0:C.hasChildNodes())&&(v.element=v.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(v){v>0&&(this.current.lineWidth=v)}setLineCap(v){this.current.lineCap=h[v]}setLineJoin(v){this.current.lineJoin=p[v]}setMiterLimit(v){this.current.miterLimit=v}setStrokeAlpha(v){this.current.strokeAlpha=v}setStrokeRGBColor(v,C,x){this.current.strokeColor=S.Util.makeHexColor(v,C,x)}setFillAlpha(v){this.current.fillAlpha=v}setFillRGBColor(v,C,x){this.current.fillColor=S.Util.makeHexColor(v,C,x),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(v){this.current.strokeColor=this._makeColorN_Pattern(v)}setFillColorN(v){this.current.fillColor=this._makeColorN_Pattern(v)}shadingFill(v){const C=this.viewport.width,x=this.viewport.height,T=S.Util.inverseTransform(this.transformMatrix),I=S.Util.applyTransform([0,0],T),N=S.Util.applyTransform([0,x],T),H=S.Util.applyTransform([C,0],T),W=S.Util.applyTransform([C,x],T),K=Math.min(I[0],N[0],H[0],W[0]),ne=Math.min(I[1],N[1],H[1],W[1]),ae=Math.max(I[0],N[0],H[0],W[0]),ce=Math.max(I[1],N[1],H[1],W[1]),Y=this.svgFactory.createElement("svg:rect");Y.setAttributeNS(null,"x",K),Y.setAttributeNS(null,"y",ne),Y.setAttributeNS(null,"width",ae-K),Y.setAttributeNS(null,"height",ce-ne),Y.setAttributeNS(null,"fill",this._makeShadingPattern(v)),this.current.fillAlpha<1&&Y.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(Y)}_makeColorN_Pattern(v){return"TilingPattern"===v[0]?this._makeTilingPattern(v):this._makeShadingPattern(v)}_makeTilingPattern(v){const C=v[1],x=v[2],T=v[3]||S.IDENTITY_MATRIX,[I,N,H,W]=v[4],K=v[5],ne=v[6],ae=v[7],ce="shading"+b++,[Y,de,fe,me]=S.Util.normalizeRect([...S.Util.applyTransform([I,N],T),...S.Util.applyTransform([H,W],T)]),[B,L]=S.Util.singularValueDecompose2dScale(T),D=K*B,M=ne*L,E=this.svgFactory.createElement("svg:pattern");E.setAttributeNS(null,"id",ce),E.setAttributeNS(null,"patternUnits","userSpaceOnUse"),E.setAttributeNS(null,"width",D),E.setAttributeNS(null,"height",M),E.setAttributeNS(null,"x",`${Y}`),E.setAttributeNS(null,"y",`${de}`);const P=this.svg,A=this.transformMatrix,k=this.current.fillColor,R=this.current.strokeColor,j=this.svgFactory.create(fe-Y,me-de);if(this.svg=j,this.transformMatrix=T,2===ae){const z=S.Util.makeHexColor(...C);this.current.fillColor=z,this.current.strokeColor=z}return this.executeOpTree(this.convertOpList(x)),this.svg=P,this.transformMatrix=A,this.current.fillColor=k,this.current.strokeColor=R,E.appendChild(j.childNodes[0]),this.defs.appendChild(E),`url(#${ce})`}_makeShadingPattern(v){switch("string"==typeof v&&(v=this.objs.get(v)),v[0]){case"RadialAxial":const C="shading"+b++,x=v[3];let T;switch(v[1]){case"axial":const I=v[4],N=v[5];T=this.svgFactory.createElement("svg:linearGradient"),T.setAttributeNS(null,"id",C),T.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),T.setAttributeNS(null,"x1",I[0]),T.setAttributeNS(null,"y1",I[1]),T.setAttributeNS(null,"x2",N[0]),T.setAttributeNS(null,"y2",N[1]);break;case"radial":const H=v[4],W=v[5],K=v[6],ne=v[7];T=this.svgFactory.createElement("svg:radialGradient"),T.setAttributeNS(null,"id",C),T.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),T.setAttributeNS(null,"cx",W[0]),T.setAttributeNS(null,"cy",W[1]),T.setAttributeNS(null,"r",ne),T.setAttributeNS(null,"fx",H[0]),T.setAttributeNS(null,"fy",H[1]),T.setAttributeNS(null,"fr",K);break;default:throw new Error(`Unknown RadialAxial type: ${v[1]}`)}for(const I of x){const N=this.svgFactory.createElement("svg:stop");N.setAttributeNS(null,"offset",I[0]),N.setAttributeNS(null,"stop-color",I[1]),T.appendChild(N)}return this.defs.appendChild(T),`url(#${C})`;case"Mesh":return(0,S.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${v[0]}`)}}setDash(v,C){this.current.dashArray=v,this.current.dashPhase=C}constructPath(v,C){const x=this.current;let T=x.x,I=x.y,N=[],H=0;for(const W of v)switch(0|W){case S.OPS.rectangle:T=C[H++],I=C[H++];const ae=T+C[H++],ce=I+C[H++];N.push("M",a(T),a(I),"L",a(ae),a(I),"L",a(ae),a(ce),"L",a(T),a(ce),"Z");break;case S.OPS.moveTo:T=C[H++],I=C[H++],N.push("M",a(T),a(I));break;case S.OPS.lineTo:T=C[H++],I=C[H++],N.push("L",a(T),a(I));break;case S.OPS.curveTo:T=C[H+4],I=C[H+5],N.push("C",a(C[H]),a(C[H+1]),a(C[H+2]),a(C[H+3]),a(T),a(I)),H+=6;break;case S.OPS.curveTo2:N.push("C",a(T),a(I),a(C[H]),a(C[H+1]),a(C[H+2]),a(C[H+3])),T=C[H+2],I=C[H+3],H+=4;break;case S.OPS.curveTo3:T=C[H+2],I=C[H+3],N.push("C",a(C[H]),a(C[H+1]),a(T),a(I),a(T),a(I)),H+=4;break;case S.OPS.closePath:N.push("Z")}N=N.join(" "),x.path&&v.length>0&&v[0]!==S.OPS.rectangle&&v[0]!==S.OPS.moveTo?N=x.path.getAttributeNS(null,"d")+N:(x.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(x.path)),x.path.setAttributeNS(null,"d",N),x.path.setAttributeNS(null,"fill","none"),x.element=x.path,x.setCurrentPoint(T,I)}endPath(){const v=this.current;if(v.path=null,!this.pendingClip)return;if(!v.element)return void(this.pendingClip=null);const C="clippath"+u++,x=this.svgFactory.createElement("svg:clipPath");x.setAttributeNS(null,"id",C),x.setAttributeNS(null,"transform",f(this.transformMatrix));const T=v.element.cloneNode(!0);if(T.setAttributeNS(null,"clip-rule","evenodd"===this.pendingClip?"evenodd":"nonzero"),this.pendingClip=null,x.appendChild(T),this.defs.appendChild(x),v.activeClipUrl){v.clipGroup=null;for(const I of this.extraStack)I.clipGroup=null;x.setAttributeNS(null,"clip-path",v.activeClipUrl)}v.activeClipUrl=`url(#${C})`,this.tgrp=null}clip(v){this.pendingClip=v}closePath(){const v=this.current;if(v.path){const C=`${v.path.getAttributeNS(null,"d")}Z`;v.path.setAttributeNS(null,"d",C)}}setLeading(v){this.current.leading=-v}setTextRise(v){this.current.textRise=v}setTextRenderingMode(v){this.current.textRenderingMode=v}setHScale(v){this.current.textHScale=v/100}setRenderingIntent(v){}setFlatness(v){}setGState(v){for(const[C,x]of v)switch(C){case"LW":this.setLineWidth(x);break;case"LC":this.setLineCap(x);break;case"LJ":this.setLineJoin(x);break;case"ML":this.setMiterLimit(x);break;case"D":this.setDash(x[0],x[1]);break;case"RI":this.setRenderingIntent(x);break;case"FL":this.setFlatness(x);break;case"Font":this.setFont(x);break;case"CA":this.setStrokeAlpha(x);break;case"ca":this.setFillAlpha(x);break;default:(0,S.warn)(`Unimplemented graphic state operator ${C}`)}}fill(){const v=this.current;v.element&&(v.element.setAttributeNS(null,"fill",v.fillColor),v.element.setAttributeNS(null,"fill-opacity",v.fillAlpha),this.endPath())}stroke(){const v=this.current;v.element&&(this._setStrokeAttributes(v.element),v.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(v,C=1){const x=this.current;let T=x.dashArray;1!==C&&T.length>0&&(T=T.map(function(I){return C*I})),v.setAttributeNS(null,"stroke",x.strokeColor),v.setAttributeNS(null,"stroke-opacity",x.strokeAlpha),v.setAttributeNS(null,"stroke-miterlimit",a(x.miterLimit)),v.setAttributeNS(null,"stroke-linecap",x.lineCap),v.setAttributeNS(null,"stroke-linejoin",x.lineJoin),v.setAttributeNS(null,"stroke-width",a(C*x.lineWidth)+"px"),v.setAttributeNS(null,"stroke-dasharray",T.map(a).join(" ")),v.setAttributeNS(null,"stroke-dashoffset",a(C*x.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const v=this.svgFactory.createElement("svg:rect");v.setAttributeNS(null,"x","0"),v.setAttributeNS(null,"y","0"),v.setAttributeNS(null,"width","1px"),v.setAttributeNS(null,"height","1px"),v.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(v)}paintImageXObject(v){const C=v.startsWith("g_")?this.commonObjs.get(v):this.objs.get(v);C?this.paintInlineImageXObject(C):(0,S.warn)(`Dependent image with object ID ${v} is not ready yet`)}paintInlineImageXObject(v,C){const x=v.width,T=v.height,I=c(v,this.forceDataSchema,!!C),N=this.svgFactory.createElement("svg:rect");N.setAttributeNS(null,"x","0"),N.setAttributeNS(null,"y","0"),N.setAttributeNS(null,"width",a(x)),N.setAttributeNS(null,"height",a(T)),this.current.element=N,this.clip("nonzero");const H=this.svgFactory.createElement("svg:image");H.setAttributeNS(_,"xlink:href",I),H.setAttributeNS(null,"x","0"),H.setAttributeNS(null,"y",a(-T)),H.setAttributeNS(null,"width",a(x)+"px"),H.setAttributeNS(null,"height",a(T)+"px"),H.setAttributeNS(null,"transform",`scale(${a(1/x)} ${a(-1/T)})`),C?C.appendChild(H):this._ensureTransformGroup().appendChild(H)}paintImageMaskXObject(v){const C=this.current,x=v.width,T=v.height,I=C.fillColor;C.maskId="mask"+m++;const N=this.svgFactory.createElement("svg:mask");N.setAttributeNS(null,"id",C.maskId);const H=this.svgFactory.createElement("svg:rect");H.setAttributeNS(null,"x","0"),H.setAttributeNS(null,"y","0"),H.setAttributeNS(null,"width",a(x)),H.setAttributeNS(null,"height",a(T)),H.setAttributeNS(null,"fill",I),H.setAttributeNS(null,"mask",`url(#${C.maskId})`),this.defs.appendChild(N),this._ensureTransformGroup().appendChild(H),this.paintInlineImageXObject(v,N)}paintFormXObjectBegin(v,C){if(Array.isArray(v)&&6===v.length&&this.transform(v[0],v[1],v[2],v[3],v[4],v[5]),C){const x=C[2]-C[0],T=C[3]-C[1],I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x",C[0]),I.setAttributeNS(null,"y",C[1]),I.setAttributeNS(null,"width",a(x)),I.setAttributeNS(null,"height",a(T)),this.current.element=I,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(v){const C=this.svgFactory.create(v.width,v.height),x=this.svgFactory.createElement("svg:defs");C.appendChild(x),this.defs=x;const T=this.svgFactory.createElement("svg:g");return T.setAttributeNS(null,"transform",f(v.transform)),C.appendChild(T),this.svg=T,C}_ensureClipGroup(){if(!this.current.clipGroup){const v=this.svgFactory.createElement("svg:g");v.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(v),this.current.clipGroup=v}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",f(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.PDFNodeStream=void 0;var S=Ae(1),ke=Ae(26);const we=__webpack_require__(172),ye=__webpack_require__(1),be=__webpack_require__(779),le=__webpack_require__(558),_=/^file:\/\/\/[a-zA-Z]:\//;$.PDFNodeStream=class{constructor(b){this.source=b,this.url=function(m){const b=le.parse(m);return"file:"===b.protocol||b.host?b:/^[a-z]:[/\\]/i.test(m)?le.parse(`file:///${m}`):(b.host||(b.protocol="file:"),b)}(b.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&b.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var b,v;return null!=(v=null==(b=this._fullRequestReader)?void 0:b._loaded)?v:0}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new f(this):new o(this),this._fullRequestReader}getRangeReader(b,v){if(v<=this._progressiveDataLength)return null;const C=this.isFsUrl?new u(this,b,v):new a(this,b,v);return this._rangeRequestReaders.push(C),C}cancelAllRequests(b){this._fullRequestReader&&this._fullRequestReader.cancel(b);for(const v of this._rangeRequestReaders.slice(0))v.cancel(b)}};class g{constructor(b){this._url=b.url,this._done=!1,this._storedError=null,this.onProgress=null;const v=b.source;this._contentLength=v.length,this._loaded=0,this._filename=null,this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._readableStream=null,this._readCapability=(0,S.createPromiseCapability)(),this._headersCapability=(0,S.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){var b=this;return _asyncToGenerator(function*(){if(yield b._readCapability.promise,b._done)return{value:void 0,done:!0};if(b._storedError)throw b._storedError;const v=b._readableStream.read();return null===v?(b._readCapability=(0,S.createPromiseCapability)(),b.read()):(b._loaded+=v.length,b.onProgress&&b.onProgress({loaded:b._loaded,total:b._contentLength}),{value:new Uint8Array(v).buffer,done:!1})})()}cancel(b){this._readableStream?this._readableStream.destroy(b):this._error(b)}_error(b){this._storedError=b,this._readCapability.resolve()}_setReadableStream(b){this._readableStream=b,b.on("readable",()=>{this._readCapability.resolve()}),b.on("end",()=>{b.destroy(),this._done=!0,this._readCapability.resolve()}),b.on("error",v=>{this._error(v)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new S.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class c{constructor(b){this._url=b.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,S.createPromiseCapability)(),this._isStreamingSupported=!b.source.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){var b=this;return _asyncToGenerator(function*(){if(yield b._readCapability.promise,b._done)return{value:void 0,done:!0};if(b._storedError)throw b._storedError;const v=b._readableStream.read();return null===v?(b._readCapability=(0,S.createPromiseCapability)(),b.read()):(b._loaded+=v.length,b.onProgress&&b.onProgress({loaded:b._loaded}),{value:new Uint8Array(v).buffer,done:!1})})()}cancel(b){this._readableStream?this._readableStream.destroy(b):this._error(b)}_error(b){this._storedError=b,this._readCapability.resolve()}_setReadableStream(b){this._readableStream=b,b.on("readable",()=>{this._readCapability.resolve()}),b.on("end",()=>{b.destroy(),this._done=!0,this._readCapability.resolve()}),b.on("error",v=>{this._error(v)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function l(m,b){return{protocol:m.protocol,auth:m.auth,host:m.hostname,port:m.port,path:m.path,method:"GET",headers:b}}class o extends g{constructor(b){super(b);const v=C=>{if(404===C.statusCode){const N=new S.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=N,void this._headersCapability.reject(N)}this._headersCapability.resolve(),this._setReadableStream(C);const x=N=>this._readableStream.headers[N.toLowerCase()],{allowRangeRequests:T,suggestedLength:I}=(0,ke.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:b.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=T,this._contentLength=I||this._contentLength,this._filename=(0,ke.extractFilenameFromHeader)(x)};this._request=null,this._request="http:"===this._url.protocol?ye.request(l(this._url,b.httpHeaders),v):be.request(l(this._url,b.httpHeaders),v),this._request.on("error",C=>{this._storedError=C,this._headersCapability.reject(C)}),this._request.end()}}class a extends c{constructor(b,v,C){super(b),this._httpHeaders={};for(const T in b.httpHeaders){const I=b.httpHeaders[T];void 0!==I&&(this._httpHeaders[T]=I)}this._httpHeaders.Range=`bytes=${v}-${C-1}`;const x=T=>{if(404!==T.statusCode)this._setReadableStream(T);else{const I=new S.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=I}};this._request=null,this._request="http:"===this._url.protocol?ye.request(l(this._url,this._httpHeaders),x):be.request(l(this._url,this._httpHeaders),x),this._request.on("error",T=>{this._storedError=T}),this._request.end()}}class f extends g{constructor(b){super(b);let v=decodeURIComponent(this._url.path);_.test(this._url.href)&&(v=v.replace(/^\//,"")),we.lstat(v,(C,x)=>{if(C)return"ENOENT"===C.code&&(C=new S.MissingPDFException(`Missing PDF "${v}".`)),this._storedError=C,void this._headersCapability.reject(C);this._contentLength=x.size,this._setReadableStream(we.createReadStream(v)),this._headersCapability.resolve()})}}class u extends c{constructor(b,v,C){super(b);let x=decodeURIComponent(this._url.path);_.test(this._url.href)&&(x=x.replace(/^\//,"")),this._setReadableStream(we.createReadStream(x,{start:v,end:C-1}))}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.createResponseStatusError=function(h,p){return 404===h||0===h&&p.startsWith("file:")?new S.MissingPDFException('Missing PDF "'+p+'".'):new S.UnexpectedResponseException(`Unexpected server response (${h}) while retrieving PDF "${p}".`,h)},$.extractFilenameFromHeader=function(h){const p=h("Content-Disposition");if(p){let g=(0,ke.getFilenameFromContentDispositionHeader)(p);if(g.includes("%"))try{g=decodeURIComponent(g)}catch(c){}if((0,we.isPdfFile)(g))return g}return null},$.validateRangeRequestCapabilities=function({getResponseHeader:h,isHttp:p,rangeChunkSize:g,disableRange:c}){const l={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(h("Content-Length"),10);return!Number.isInteger(o)||(l.suggestedLength=o,o<=2*g)||c||!p||"bytes"!==h("Accept-Ranges")||"identity"!==(h("Content-Encoding")||"identity")||(l.allowRangeRequests=!0),l},$.validateResponseStatus=function(h){return 200===h||206===h};var S=Ae(1),ke=Ae(27),we=Ae(5)},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.getFilenameFromContentDispositionHeader=function(we){let ye=!0,be=le("filename\\*","i").exec(we);if(be){be=be[1];let o=g(be);return o=unescape(o),o=c(o),o=l(o),h(o)}if(be=function(o){const a=[];let f;const u=le("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(f=u.exec(o));){let[,b,v,C]=f;if(b=parseInt(b,10),b in a){if(0===b)break}else a[b]=[v,C]}const m=[];for(let b=0;b<a.length&&b in a;++b){let[v,C]=a[b];C=g(C),v&&(C=unescape(C),0===b&&(C=c(C))),m.push(C)}return m.join("")}(we),be)return h(l(be));if(be=le("filename","i").exec(we),be){be=be[1];let o=g(be);return o=l(o),h(o)}function le(o,a){return new RegExp("(?:^|;)\\s*"+o+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',a)}function _(o,a){if(o){if(!/^[\x00-\xFF]+$/.test(a))return a;try{const f=new TextDecoder(o,{fatal:!0}),u=(0,S.stringToBytes)(a);a=f.decode(u),ye=!1}catch(f){}}return a}function h(o){return ye&&/[\x80-\xff]/.test(o)&&(o=_("utf-8",o),ye&&(o=_("iso-8859-1",o))),o}function g(o){if(o.startsWith('"')){const a=o.slice(1).split('\\"');for(let f=0;f<a.length;++f){const u=a[f].indexOf('"');-1!==u&&(a[f]=a[f].slice(0,u),a.length=f+1),a[f]=a[f].replace(/\\(.)/g,"$1")}o=a.join('"')}return o}function c(o){const a=o.indexOf("'");return-1===a?o:_(o.slice(0,a),o.slice(a+1).replace(/^[^']*'/,""))}function l(o){return!o.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(o)?o:o.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(a,f,u,m){if("q"===u||"Q"===u)return _(f,m=(m=m.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,function(b,v){return String.fromCharCode(parseInt(v,16))}));try{m=atob(m)}catch(b){}return _(f,m)})}return""};var S=Ae(1)},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.PDFNetworkStream=void 0;var S=Ae(1),ke=Ae(26);class le{constructor(c,l={}){this.url=c,this.isHttp=/^https?:/i.test(c),this.httpHeaders=this.isHttp&&l.httpHeaders||Object.create(null),this.withCredentials=l.withCredentials||!1,this.getXhr=l.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(c,l,o){const a={begin:c,end:l};for(const f in o)a[f]=o[f];return this.request(a)}requestFull(c){return this.request(c)}request(c){const l=this.getXhr(),o=this.currXhrId++,a=this.pendingRequests[o]={xhr:l};l.open("GET",this.url),l.withCredentials=this.withCredentials;for(const f in this.httpHeaders){const u=this.httpHeaders[f];void 0!==u&&l.setRequestHeader(f,u)}return this.isHttp&&"begin"in c&&"end"in c?(l.setRequestHeader("Range",`bytes=${c.begin}-${c.end-1}`),a.expectedStatus=206):a.expectedStatus=200,l.responseType="arraybuffer",c.onError&&(l.onerror=function(f){c.onError(l.status)}),l.onreadystatechange=this.onStateChange.bind(this,o),l.onprogress=this.onProgress.bind(this,o),a.onHeadersReceived=c.onHeadersReceived,a.onDone=c.onDone,a.onError=c.onError,a.onProgress=c.onProgress,l.send(null),o}onProgress(c,l){var a;const o=this.pendingRequests[c];!o||null==(a=o.onProgress)||a.call(o,l)}onStateChange(c,l){var b,v,C;const o=this.pendingRequests[c];if(!o)return;const a=o.xhr;if(a.readyState>=2&&o.onHeadersReceived&&(o.onHeadersReceived(),delete o.onHeadersReceived),4!==a.readyState||!(c in this.pendingRequests))return;if(delete this.pendingRequests[c],0===a.status&&this.isHttp)return void(null==(b=o.onError)||b.call(o,a.status));const f=a.status||200;if((200!==f||206!==o.expectedStatus)&&f!==o.expectedStatus)return void(null==(v=o.onError)||v.call(o,a.status));const m=function(g){const c=g.response;return"string"!=typeof c?c:(0,S.stringToBytes)(c).buffer}(a);if(206===f){const x=a.getResponseHeader("Content-Range"),T=/bytes (\d+)-(\d+)\/(\d+)/.exec(x);o.onDone({begin:parseInt(T[1],10),chunk:m})}else m?o.onDone({begin:0,chunk:m}):null==(C=o.onError)||C.call(o,a.status)}getRequestXhr(c){return this.pendingRequests[c].xhr}isPendingRequest(c){return c in this.pendingRequests}abortRequest(c){const l=this.pendingRequests[c].xhr;delete this.pendingRequests[c],l.abort()}}$.PDFNetworkStream=class{constructor(c){this._source=c,this._manager=new le(c.url,{httpHeaders:c.httpHeaders,withCredentials:c.withCredentials}),this._rangeChunkSize=c.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(c){const l=this._rangeRequestReaders.indexOf(c);l>=0&&this._rangeRequestReaders.splice(l,1)}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new h(this._manager,this._source),this._fullRequestReader}getRangeReader(c,l){const o=new p(this._manager,c,l);return o.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(o),o}cancelAllRequests(c){var l;null==(l=this._fullRequestReader)||l.cancel(c);for(const o of this._rangeRequestReaders.slice(0))o.cancel(c)}};class h{constructor(c,l){this._manager=c;const o={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=l.url,this._fullRequestId=c.requestFull(o),this._headersReceivedCapability=(0,S.createPromiseCapability)(),this._disableRange=l.disableRange||!1,this._contentLength=l.length,this._rangeChunkSize=l.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const c=this._fullRequestId,l=this._manager.getRequestXhr(c),o=u=>l.getResponseHeader(u),{allowRangeRequests:a,suggestedLength:f}=(0,ke.validateRangeRequestCapabilities)({getResponseHeader:o,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=f||this._contentLength,this._filename=(0,ke.extractFilenameFromHeader)(o),this._isRangeSupported&&this._manager.abortRequest(c),this._headersReceivedCapability.resolve()}_onDone(c){if(c&&(this._requests.length>0?this._requests.shift().resolve({value:c.chunk,done:!1}):this._cachedChunks.push(c.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(c){this._storedError=(0,ke.createResponseStatusError)(c,this._url),this._headersReceivedCapability.reject(this._storedError);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(c){var l;null==(l=this.onProgress)||l.call(this,{loaded:c.loaded,total:c.lengthComputable?c.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){var c=this;return _asyncToGenerator(function*(){if(c._storedError)throw c._storedError;if(c._cachedChunks.length>0)return{value:c._cachedChunks.shift(),done:!1};if(c._done)return{value:void 0,done:!0};const l=(0,S.createPromiseCapability)();return c._requests.push(l),l.promise})()}cancel(c){this._done=!0,this._headersReceivedCapability.reject(c);for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class p{constructor(c,l,o){this._manager=c;const a={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=c.url,this._requestId=c.requestRange(l,o,a),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var c;null==(c=this.onClosed)||c.call(this,this)}_onDone(c){const l=c.chunk;this._requests.length>0?this._requests.shift().resolve({value:l,done:!1}):this._queuedChunk=l,this._done=!0;for(const o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(c){this._storedError=(0,ke.createResponseStatusError)(c,this._url);for(const l of this._requests)l.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(c){var l;this.isStreamingSupported||null==(l=this.onProgress)||l.call(this,{loaded:c.loaded})}get isStreamingSupported(){return!1}read(){var c=this;return _asyncToGenerator(function*(){if(c._storedError)throw c._storedError;if(null!==c._queuedChunk){const o=c._queuedChunk;return c._queuedChunk=null,{value:o,done:!1}}if(c._done)return{value:void 0,done:!0};const l=(0,S.createPromiseCapability)();return c._requests.push(l),l.promise})()}cancel(c){this._done=!0;for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(Ie,$,Ae)=>{Object.defineProperty($,"__esModule",{value:!0}),$.PDFFetchStream=void 0;var S=Ae(1),ke=Ae(26);function we(h,p,g){return{method:"GET",headers:h,signal:null==g?void 0:g.signal,mode:"cors",credentials:p?"include":"same-origin",redirect:"follow"}}function ye(h){const p=new Headers;for(const g in h){const c=h[g];void 0!==c&&p.append(g,c)}return p}$.PDFFetchStream=class{constructor(p){this.source=p,this.isHttp=/^https?:/i.test(p.url),this.httpHeaders=this.isHttp&&p.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var p,g;return null!=(g=null==(p=this._fullRequestReader)?void 0:p._loaded)?g:0}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new le(this),this._fullRequestReader}getRangeReader(p,g){if(g<=this._progressiveDataLength)return null;const c=new _(this,p,g);return this._rangeRequestReaders.push(c),c}cancelAllRequests(p){this._fullRequestReader&&this._fullRequestReader.cancel(p);for(const g of this._rangeRequestReaders.slice(0))g.cancel(p)}};class le{constructor(p){this._stream=p,this._reader=null,this._loaded=0,this._filename=null;const g=p.source;this._withCredentials=g.withCredentials||!1,this._contentLength=g.length,this._headersCapability=(0,S.createPromiseCapability)(),this._disableRange=g.disableRange||!1,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._isStreamingSupported=!g.disableStream,this._isRangeSupported=!g.disableRange,this._headers=ye(this._stream.httpHeaders);const c=g.url;fetch(c,we(this._headers,this._withCredentials,this._abortController)).then(l=>{if(!(0,ke.validateResponseStatus)(l.status))throw(0,ke.createResponseStatusError)(l.status,c);this._reader=l.body.getReader(),this._headersCapability.resolve();const o=u=>l.headers.get(u),{allowRangeRequests:a,suggestedLength:f}=(0,ke.validateRangeRequestCapabilities)({getResponseHeader:o,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=f||this._contentLength,this._filename=(0,ke.extractFilenameFromHeader)(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new S.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){var p=this;return _asyncToGenerator(function*(){yield p._headersCapability.promise;const{value:g,done:c}=yield p._reader.read();return c?{value:g,done:c}:(p._loaded+=g.byteLength,p.onProgress&&p.onProgress({loaded:p._loaded,total:p._contentLength}),{value:new Uint8Array(g).buffer,done:!1})})()}cancel(p){this._reader&&this._reader.cancel(p),this._abortController&&this._abortController.abort()}}class _{constructor(p,g,c){this._stream=p,this._reader=null,this._loaded=0;const l=p.source;this._withCredentials=l.withCredentials||!1,this._readCapability=(0,S.createPromiseCapability)(),this._isStreamingSupported=!l.disableStream,"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._headers=ye(this._stream.httpHeaders),this._headers.append("Range",`bytes=${g}-${c-1}`);const o=l.url;fetch(o,we(this._headers,this._withCredentials,this._abortController)).then(a=>{if(!(0,ke.validateResponseStatus)(a.status))throw(0,ke.createResponseStatusError)(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){var p=this;return _asyncToGenerator(function*(){yield p._readCapability.promise;const{value:g,done:c}=yield p._reader.read();return c?{value:g,done:c}:(p._loaded+=g.byteLength,p.onProgress&&p.onProgress({loaded:p._loaded}),{value:new Uint8Array(g).buffer,done:!1})})()}cancel(p){this._reader&&this._reader.cancel(p),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(Ie){var $=__webpack_module_cache__[Ie];if(void 0!==$)return $.exports;var Ae=__webpack_module_cache__[Ie]={exports:{}};return __webpack_modules__[Ie](Ae,Ae.exports,__w_pdfjs_require__),Ae.exports}var __webpack_exports__={};return(()=>{var Ie=__webpack_exports__;Object.defineProperty(Ie,"__esModule",{value:!0}),Object.defineProperty(Ie,"AnnotationLayer",{enumerable:!0,get:function(){return ke.AnnotationLayer}}),Object.defineProperty(Ie,"AnnotationMode",{enumerable:!0,get:function(){return $.AnnotationMode}}),Object.defineProperty(Ie,"CMapCompressionType",{enumerable:!0,get:function(){return $.CMapCompressionType}}),Object.defineProperty(Ie,"GlobalWorkerOptions",{enumerable:!0,get:function(){return we.GlobalWorkerOptions}}),Object.defineProperty(Ie,"InvalidPDFException",{enumerable:!0,get:function(){return $.InvalidPDFException}}),Object.defineProperty(Ie,"LoopbackPort",{enumerable:!0,get:function(){return Ae.LoopbackPort}}),Object.defineProperty(Ie,"MissingPDFException",{enumerable:!0,get:function(){return $.MissingPDFException}}),Object.defineProperty(Ie,"OPS",{enumerable:!0,get:function(){return $.OPS}}),Object.defineProperty(Ie,"PDFDataRangeTransport",{enumerable:!0,get:function(){return Ae.PDFDataRangeTransport}}),Object.defineProperty(Ie,"PDFDateString",{enumerable:!0,get:function(){return S.PDFDateString}}),Object.defineProperty(Ie,"PDFWorker",{enumerable:!0,get:function(){return Ae.PDFWorker}}),Object.defineProperty(Ie,"PasswordResponses",{enumerable:!0,get:function(){return $.PasswordResponses}}),Object.defineProperty(Ie,"PermissionFlag",{enumerable:!0,get:function(){return $.PermissionFlag}}),Object.defineProperty(Ie,"PixelsPerInch",{enumerable:!0,get:function(){return S.PixelsPerInch}}),Object.defineProperty(Ie,"RenderingCancelledException",{enumerable:!0,get:function(){return S.RenderingCancelledException}}),Object.defineProperty(Ie,"SVGGraphics",{enumerable:!0,get:function(){return le.SVGGraphics}}),Object.defineProperty(Ie,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return $.UNSUPPORTED_FEATURES}}),Object.defineProperty(Ie,"UnexpectedResponseException",{enumerable:!0,get:function(){return $.UnexpectedResponseException}}),Object.defineProperty(Ie,"Util",{enumerable:!0,get:function(){return $.Util}}),Object.defineProperty(Ie,"VerbosityLevel",{enumerable:!0,get:function(){return $.VerbosityLevel}}),Object.defineProperty(Ie,"XfaLayer",{enumerable:!0,get:function(){return _.XfaLayer}}),Object.defineProperty(Ie,"build",{enumerable:!0,get:function(){return Ae.build}}),Object.defineProperty(Ie,"createPromiseCapability",{enumerable:!0,get:function(){return $.createPromiseCapability}}),Object.defineProperty(Ie,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return $.createValidAbsoluteUrl}}),Object.defineProperty(Ie,"getDocument",{enumerable:!0,get:function(){return Ae.getDocument}}),Object.defineProperty(Ie,"getFilenameFromUrl",{enumerable:!0,get:function(){return S.getFilenameFromUrl}}),Object.defineProperty(Ie,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return S.getPdfFilenameFromUrl}}),Object.defineProperty(Ie,"getXfaPageViewport",{enumerable:!0,get:function(){return S.getXfaPageViewport}}),Object.defineProperty(Ie,"isPdfFile",{enumerable:!0,get:function(){return S.isPdfFile}}),Object.defineProperty(Ie,"loadScript",{enumerable:!0,get:function(){return S.loadScript}}),Object.defineProperty(Ie,"renderTextLayer",{enumerable:!0,get:function(){return be.renderTextLayer}}),Object.defineProperty(Ie,"shadow",{enumerable:!0,get:function(){return $.shadow}}),Object.defineProperty(Ie,"version",{enumerable:!0,get:function(){return Ae.version}});var $=__w_pdfjs_require__(1),Ae=__w_pdfjs_require__(4),S=__w_pdfjs_require__(5),ke=__w_pdfjs_require__(20),we=__w_pdfjs_require__(13),ye=__w_pdfjs_require__(3),be=__w_pdfjs_require__(23),le=__w_pdfjs_require__(24),_=__w_pdfjs_require__(22);if(ye.isNodeJS){const{PDFNodeStream:g}=__w_pdfjs_require__(25);(0,Ae.setPDFNetworkStreamFactory)(c=>new g(c))}else{const{PDFNetworkStream:g}=__w_pdfjs_require__(28),{PDFFetchStream:c}=__w_pdfjs_require__(29);(0,Ae.setPDFNetworkStreamFactory)(l=>(0,S.isValidFetchUrl)(l.url)?new c(l):new g(l))}})(),__webpack_exports__})(),module.exports=Ae()},837:function(Ie,$,Ae){var ye,S=Ae(52).default;ye=()=>(()=>{"use strict";var ke=[,(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.DefaultXfaLayerFactory=_.DefaultTextLayerFactory=_.DefaultStructTreeLayerFactory=_.DefaultAnnotationLayerFactory=void 0;var p=h(2),g=h(4),c=h(5),l=h(7),o=h(8),a=h(9);_.DefaultAnnotationLayerFactory=class{createAnnotationLayerBuilder(C,x,T=null,I="",N=!0,H=g.NullL10n,W=!1,K=null,ne=null,ae=null,ce=null){return new p.AnnotationLayerBuilder({pageDiv:C,pdfPage:x,imageResourcesPath:I,renderForms:N,linkService:new c.SimpleLinkService,l10n:H,annotationStorage:T,enableScripting:W,hasJSActionsPromise:K,fieldObjectsPromise:ae,mouseState:ne,annotationCanvasMap:ce})}},_.DefaultStructTreeLayerFactory=class{createStructTreeLayerBuilder(C){return new l.StructTreeLayerBuilder({pdfPage:C})}},_.DefaultTextLayerFactory=class{createTextLayerBuilder(C,x,T,I=!1,N,H){return new o.TextLayerBuilder({textLayerDiv:C,pageIndex:x,viewport:T,enhanceTextSelection:I,eventBus:N,highlighter:H})}},_.DefaultXfaLayerFactory=class{createXfaLayerBuilder(C,x,T=null,I=null){return new a.XfaLayerBuilder({pageDiv:C,pdfPage:x,annotationStorage:T,linkService:new c.SimpleLinkService,xfaHtml:I})}}},(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.AnnotationLayerBuilder=void 0;var p=h(3),g=h(4);_.AnnotationLayerBuilder=class{constructor({pageDiv:o,pdfPage:a,linkService:f,downloadManager:u,annotationStorage:m=null,imageResourcesPath:b="",renderForms:v=!0,l10n:C=g.NullL10n,enableScripting:x=!1,hasJSActionsPromise:T=null,fieldObjectsPromise:I=null,mouseState:N=null,annotationCanvasMap:H=null}){this.pageDiv=o,this.pdfPage=a,this.linkService=f,this.downloadManager=u,this.imageResourcesPath=b,this.renderForms=v,this.l10n=C,this.annotationStorage=m,this.enableScripting=x,this._hasJSActionsPromise=T,this._fieldObjectsPromise=I,this._mouseState=N,this._annotationCanvasMap=H,this.div=null,this._cancelled=!1}render(o,a="display"){var f=this;return S(function*(){const[u,m=!1,b=null]=yield Promise.all([f.pdfPage.getAnnotations({intent:a}),f._hasJSActionsPromise,f._fieldObjectsPromise]);if(f._cancelled||0===u.length)return;const v={viewport:o.clone({dontFlip:!0}),div:f.div,annotations:u,page:f.pdfPage,imageResourcesPath:f.imageResourcesPath,renderForms:f.renderForms,linkService:f.linkService,downloadManager:f.downloadManager,annotationStorage:f.annotationStorage,enableScripting:f.enableScripting,hasJSActions:m,fieldObjects:b,mouseState:f._mouseState,annotationCanvasMap:f._annotationCanvasMap};f.div?p.AnnotationLayer.update(v):(f.div=document.createElement("div"),f.div.className="annotationLayer",f.pageDiv.appendChild(f.div),v.div=f.div,p.AnnotationLayer.render(v),f.l10n.translate(f.div))})()}cancel(){this._cancelled=!0}hide(){!this.div||(this.div.hidden=!0)}}},le=>{let _;_="undefined"!=typeof window&&window["pdfjs-dist/build/pdf"]?window["pdfjs-dist/build/pdf"]:Ae(552),le.exports=_},(le,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.NullL10n=void 0,_.fixupLangCode=function(a){return g[null==a?void 0:a.toLowerCase()]||a},_.getL10nFallback=p;const h={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} \xd7 {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} \xd7 {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",print_progress_percent:"{{progress}}%","toggle_sidebar.title":"Toggle Sidebar","toggle_sidebar_notification2.title":"Toggle Sidebar (document contains outline/attachments/layers)",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",error_version_info:"PDF.js v{{version}} (build: {{build}})",error_message:"Message: {{message}}",error_stack:"Stack: {{stack}}",error_file:"File: {{file}}",error_line:"Line: {{line}}",rendering_error:"An error occurred while rendering the page.",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading:"Loading\u2026",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts."};function p(a,f){switch(a){case"find_match_count":a=`find_match_count[${1===f.total?"one":"other"}]`;break;case"find_match_count_limit":a=`find_match_count_limit[${1===f.limit?"one":"other"}]`}return h[a]||""}const g={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};_.NullL10n={getLanguage:()=>S(function*(){return"en-us"})(),getDirection:()=>S(function*(){return"ltr"})(),get:(a,f=null,u=p(a,f))=>S(function*(){return function(a,f){return f?a.replace(/\{\{\s*(\w+)\s*\}\}/g,(u,m)=>m in f?f[m]:"{{"+m+"}}"):a}(u,f)})(),translate:a=>S(function*(){})()}},(le,_,h)=>{var f,u,AC,b,K2;Object.defineProperty(_,"__esModule",{value:!0}),_.SimpleLinkService=_.PDFLinkService=_.LinkTarget=void 0;var p=h(6);const c={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};function l(x,{url:T,target:I,rel:N,enabled:H=!0}={}){if(!T||"string"!=typeof T)throw new Error('A valid "url" parameter must provided.');const W=(0,p.removeNullCharacters)(T);H?x.href=x.title=W:(x.href="",x.title=`Disabled: ${W}`,x.onclick=()=>!1);let K="";switch(I){case c.NONE:break;case c.SELF:K="_self";break;case c.BLANK:K="_blank";break;case c.PARENT:K="_parent";break;case c.TOP:K="_top"}x.target=K,x.rel="string"==typeof N?N:"noopener noreferrer nofollow"}_.LinkTarget=c;const C=class{constructor({eventBus:T,externalLinkTarget:I=null,externalLinkRel:N=null,ignoreDestinationZoom:H=!1}={}){Ze(this,u),Ze(this,f,new Map),this.eventBus=T,this.externalLinkTarget=I,this.externalLinkRel=N,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=H,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(T,I=null){this.baseUrl=I,this.pdfDocument=T,$e(this,f).clear()}setViewer(T){this.pdfViewer=T}setHistory(T){this.pdfHistory=T}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(T){this.pdfViewer.currentPageNumber=T}get rotation(){return this.pdfViewer.pagesRotation}set rotation(T){this.pdfViewer.pagesRotation=T}goToDestination(T){var I=this;return S(function*(){var W;if(!I.pdfDocument)return;let N,H;"string"==typeof T?(N=T,H=yield I.pdfDocument.getDestination(T)):(N=null,H=yield T),Array.isArray(H)?Xe(W=I,u,AC).call(W,T,N,H):console.error(`PDFLinkService.goToDestination: "${H}" is not a valid destination array, for dest="${T}".`)})()}goToPage(T){if(!this.pdfDocument)return;const I="string"==typeof T&&this.pdfViewer.pageLabelToPageNumber(T)||0|T;Number.isInteger(I)&&I>0&&I<=this.pagesCount?(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(I)),this.pdfViewer.scrollPageIntoView({pageNumber:I})):console.error(`PDFLinkService.goToPage: "${T}" is not a valid page.`)}addLinkAttributes(T,I,N=!1){l(T,{url:I,target:N?c.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(T){if("string"==typeof T){if(T.length>0)return this.getAnchorUrl("#"+escape(T))}else if(Array.isArray(T)){const I=JSON.stringify(T);if(I.length>0)return this.getAnchorUrl("#"+escape(I))}return this.getAnchorUrl("")}getAnchorUrl(T){return(this.baseUrl||"")+T}setHash(T){var H;if(!this.pdfDocument)return;let I,N;if(T.includes("=")){const W=(0,p.parseQueryString)(T);if(W.has("search")&&this.eventBus.dispatch("findfromurlhash",{source:this,query:W.get("search").replace(/"/g,""),phraseSearch:"true"===W.get("phrase")}),W.has("page")&&(I=0|W.get("page")||1),W.has("zoom")){const K=W.get("zoom").split(","),ne=K[0],ae=parseFloat(ne);ne.includes("Fit")?"Fit"===ne||"FitB"===ne?N=[null,{name:ne}]:"FitH"===ne||"FitBH"===ne||"FitV"===ne||"FitBV"===ne?N=[null,{name:ne},K.length>1?0|K[1]:null]:"FitR"===ne?5!==K.length?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):N=[null,{name:ne},0|K[1],0|K[2],0|K[3],0|K[4]]:console.error(`PDFLinkService.setHash: "${ne}" is not a valid zoom value.`):N=[null,{name:"XYZ"},K.length>1?0|K[1]:null,K.length>2?0|K[2]:null,ae?ae/100:ne]}N?this.pdfViewer.scrollPageIntoView({pageNumber:I||this.page,destArray:N,allowNegativeOffset:!0}):I&&(this.page=I),W.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:W.get("pagemode")}),W.has("nameddest")&&this.goToDestination(W.get("nameddest"))}else{N=unescape(T);try{N=JSON.parse(N),Array.isArray(N)||(N=N.toString())}catch(W){}if("string"==typeof N||Xe(H=C,b,K2).call(H,N))return void this.goToDestination(N);console.error(`PDFLinkService.setHash: "${unescape(T)}" is not a valid destination.`)}}executeNamedAction(T){var I,N;switch(T){case"GoBack":null==(I=this.pdfHistory)||I.back();break;case"GoForward":null==(N=this.pdfHistory)||N.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1}this.eventBus.dispatch("namedaction",{source:this,action:T})}cachePageRef(T,I){if(!I)return;const N=0===I.gen?`${I.num}R`:`${I.num}R${I.gen}`;$e(this,f).set(N,T)}_cachedPageNumber(T){if(!T)return null;const I=0===T.gen?`${T.num}R`:`${T.num}R${T.gen}`;return $e(this,f).get(I)||null}isPageVisible(T){return this.pdfViewer.isPageVisible(T)}isPageCached(T){return this.pdfViewer.isPageCached(T)}};let o=C;f=new WeakMap,u=new WeakSet,AC=function(T,I=null,N){const H=N[0];let W;if("object"==typeof H&&null!==H){if(W=this._cachedPageNumber(H),!W)return void this.pdfDocument.getPageIndex(H).then(K=>{this.cachePageRef(K+1,H),Xe(this,u,AC).call(this,T,I,N)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${H}" is not a valid page reference, for dest="${T}".`)})}else{if(!Number.isInteger(H))return void console.error(`PDFLinkService.#goToDestinationHelper: "${H}" is not a valid destination reference, for dest="${T}".`);W=H+1}!W||W<1||W>this.pagesCount?console.error(`PDFLinkService.#goToDestinationHelper: "${W}" is not a valid page number, for dest="${T}".`):(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:I,explicitDest:N,pageNumber:W})),this.pdfViewer.scrollPageIntoView({pageNumber:W,destArray:N,ignoreDestinationZoom:this._ignoreDestinationZoom}))},b=new WeakSet,K2=function(T){if(!Array.isArray(T))return!1;const I=T.length;if(I<2)return!1;const N=T[0];if(!("object"==typeof N&&Number.isInteger(N.num)&&Number.isInteger(N.gen)||Number.isInteger(N)&&N>=0))return!1;const H=T[1];if("object"!=typeof H||"string"!=typeof H.name)return!1;let W=!0;switch(H.name){case"XYZ":if(5!==I)return!1;break;case"Fit":case"FitB":return 2===I;case"FitH":case"FitBH":case"FitV":case"FitBV":if(3!==I)return!1;break;case"FitR":if(6!==I)return!1;W=!1;break;default:return!1}for(let K=2;K<I;K++){const ne=T[K];if(!("number"==typeof ne||W&&null===ne))return!1}return!0},Ze(o,b),_.PDFLinkService=o,_.SimpleLinkService=class{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(T){}get rotation(){return 0}set rotation(T){}goToDestination(T){return S(function*(){})()}goToPage(T){}addLinkAttributes(T,I,N=!1){l(T,{url:I,enabled:this.externalLinkEnabled})}getDestinationHash(T){return"#"}getAnchorUrl(T){return"#"}setHash(T){}executeNamedAction(T){}cachePageRef(T,I){}isPageVisible(T){return!0}isPageCached(T){return!0}}},(le,_)=>{var he,J2;Object.defineProperty(_,"__esModule",{value:!0}),_.animationStarted=_.VERTICAL_PADDING=_.UNKNOWN_SCALE=_.TextLayerMode=_.SpreadMode=_.SidebarView=_.ScrollMode=_.SCROLLBAR_PADDING=_.RenderingStates=_.RendererType=_.ProgressBar=_.PresentationModeState=_.OutputScale=_.MIN_SCALE=_.MAX_SCALE=_.MAX_AUTO_SCALE=_.DEFAULT_SCALE_VALUE=_.DEFAULT_SCALE_DELTA=_.DEFAULT_SCALE=_.AutoPrintRegExp=void 0,_.apiPageLayoutToViewerModes=function(te){let ue=T.VERTICAL,ge=I.NONE;switch(te){case"SinglePage":ue=T.PAGE;break;case"OneColumn":break;case"TwoPageLeft":ue=T.PAGE;case"TwoColumnLeft":ge=I.ODD;break;case"TwoPageRight":ue=T.PAGE;case"TwoColumnRight":ge=I.EVEN}return{scrollMode:ue,spreadMode:ge}},_.apiPageModeToSidebarView=function(te){switch(te){case"UseNone":return v.NONE;case"UseThumbs":return v.THUMBS;case"UseOutlines":return v.OUTLINE;case"UseAttachments":return v.ATTACHMENTS;case"UseOC":return v.LAYERS}return v.NONE},_.approximateFraction=function(te){if(Math.floor(te)===te)return[te,1];const ue=1/te;if(ue>8)return[1,8];if(Math.floor(ue)===ue)return[1,ue];const U=te>1?ue:te;let Te,q=0,Z=1,Se=1,xe=1;for(;;){const Re=q+Se,Oe=Z+xe;if(Oe>8)break;U<=Re/Oe?(Se=Re,xe=Oe):(q=Re,Z=Oe)}return Te=U-q/Z<Se/xe-U?U===te?[q,Z]:[Z,q]:U===te?[Se,xe]:[xe,Se],Te},_.backtrackBeforeAllVisibleElements=L,_.binarySearchFirstItem=de,_.getActiveOrFocusedElement=function(){let te=document,ue=te.activeElement||te.querySelector(":focus");for(;null==ue?void 0:ue.shadowRoot;)te=ue.shadowRoot,ue=te.activeElement||te.querySelector(":focus");return ue},_.getPageSizeInches=function({view:te,userUnit:ue,rotate:ge}){const[U,q,Z,Se]=te,xe=ge%180!=0,Te=(Z-U)/72*ue,Re=(Se-q)/72*ue;return{width:xe?Re:Te,height:xe?Te:Re}},_.getVisibleElements=function({scrollEl:te,views:ue,sortByVisibility:ge=!1,horizontal:U=!1,rtl:q=!1}){const Z=te.scrollTop,Se=Z+te.clientHeight,xe=te.scrollLeft,Te=xe+te.clientWidth,Ye=[],qe=new Set,yt=ue.length;let Ce=de(ue,U?function(Me){const Be=Me.div,Ve=Be.offsetLeft+Be.clientLeft;return q?Ve<Te:Ve+Be.clientWidth>xe}:function(Me){const Be=Me.div;return Be.offsetTop+Be.clientTop+Be.clientHeight>Z});Ce>0&&Ce<yt&&!U&&(Ce=L(Ce,ue,Z));let re=U?Te:-1;for(let Me=Ce;Me<yt;Me++){const Be=ue[Me],Ve=Be.div,ut=Ve.offsetLeft+Ve.clientLeft,mt=Ve.offsetTop+Ve.clientTop,et=Ve.clientWidth,bt=Ve.clientHeight,Ke=ut+et,Ft=mt+bt;if(-1===re)Ft>=Se&&(re=Ft);else if((U?ut:mt)>re)break;if(Ft<=Z||mt>=Se||Ke<=xe||ut>=Te)continue;const jn=Math.max(0,Z-mt)+Math.max(0,Ft-Se),Vn=(et-(Math.max(0,xe-ut)+Math.max(0,Ke-Te)))/et;Ye.push({id:Be.id,x:ut,y:mt,view:Be,percent:(bt-jn)/bt*Vn*100|0,widthPercent:100*Vn|0}),qe.add(Be.id)}const oe=Ye[0],De=Ye[Ye.length-1];return ge&&Ye.sort(function(Me,Be){const Ve=Me.percent-Be.percent;return Math.abs(Ve)>.001?-Ve:Me.id-Be.id}),{first:oe,last:De,views:Ye,ids:qe}},_.isPortraitOrientation=function(te){return te.width<=te.height},_.isValidRotation=function(te){return Number.isInteger(te)&&te%90==0},_.isValidScrollMode=function(te){return Number.isInteger(te)&&Object.values(T).includes(te)&&te!==T.UNKNOWN},_.isValidSpreadMode=function(te){return Number.isInteger(te)&&Object.values(I).includes(te)&&te!==I.UNKNOWN},_.noContextMenuHandler=function(te){te.preventDefault()},_.normalizeWheelEventDelta=function(te){let ue=E(te);return 0===te.deltaMode?ue/=900:1===te.deltaMode&&(ue/=30),ue},_.normalizeWheelEventDirection=E,_.parseQueryString=function(te){const ue=new Map;for(const[ge,U]of new URLSearchParams(te))ue.set(ge.toLowerCase(),U);return ue},_.removeNullCharacters=function(te,ue=!1){return"string"!=typeof te?(console.error("The argument must be a string."),te):(ue&&(te=te.replace(ce," ")),te.replace(ae,""))},_.roundToDivide=function(te,ue){const ge=te%ue;return 0===ge?te:Math.round(te-ge+ue)},_.scrollIntoView=function(te,ue,ge=!1){let U=te.offsetParent;if(!U)return void console.error("offsetParent is not set -- cannot scroll");let q=te.offsetTop+te.clientTop,Z=te.offsetLeft+te.clientLeft;for(;U.clientHeight===U.scrollHeight&&U.clientWidth===U.scrollWidth||ge&&(U.classList.contains("markedContent")||"hidden"===getComputedStyle(U).overflow);)if(q+=U.offsetTop,Z+=U.offsetLeft,U=U.offsetParent,!U)return;ue&&(void 0!==ue.top&&(q+=ue.top),void 0!==ue.left&&(Z+=ue.left,U.scrollLeft=Z)),U.scrollTop=q},_.watchScroll=function(te,ue){const ge=function(Z){q||(q=window.requestAnimationFrame(function(){q=null;const xe=te.scrollLeft,Te=U.lastX;xe!==Te&&(U.right=xe>Te),U.lastX=xe;const Re=te.scrollTop,Oe=U.lastY;Re!==Oe&&(U.down=Re>Oe),U.lastY=Re,ue(U)}))},U={right:!0,down:!0,lastX:te.scrollLeft,lastY:te.scrollTop,_eventHandler:ge};let q=null;return te.addEventListener("scroll",ge,!0),U},_.DEFAULT_SCALE_VALUE="auto",_.DEFAULT_SCALE=1,_.DEFAULT_SCALE_DELTA=1.1,_.MIN_SCALE=.1,_.MAX_SCALE=10,_.UNKNOWN_SCALE=0,_.MAX_AUTO_SCALE=1.25,_.SCROLLBAR_PADDING=40,_.VERTICAL_PADDING=5,_.RenderingStates={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},_.PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};const v={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};_.SidebarView=v,_.RendererType={CANVAS:"canvas",SVG:"svg"},_.TextLayerMode={DISABLE:0,ENABLE:1,ENABLE_ENHANCE:2};const T={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};_.ScrollMode=T;const I={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};_.SpreadMode=I,_.AutoPrintRegExp=/\bprint\s*\(/,_.OutputScale=class{constructor(){const ue=window.devicePixelRatio||1;this.sx=ue,this.sy=ue}get scaled(){return 1!==this.sx||1!==this.sy}};const ae=/\x00/g,ce=/[\x01-\x1F]/g;function de(te,ue,ge=0){let U=ge,q=te.length-1;if(q<0||!ue(te[q]))return te.length;if(ue(te[U]))return U;for(;U<q;){const Z=U+q>>1;ue(te[Z])?q=Z:U=Z+1}return U}function L(te,ue,ge){if(te<2)return te;let U=ue[te].div,q=U.offsetTop+U.clientTop;q>=ge&&(U=ue[te-1].div,q=U.offsetTop+U.clientTop);for(let Z=te-2;Z>=0&&(U=ue[Z].div,!(U.offsetTop+U.clientTop+U.clientHeight<=q));--Z)te=Z;return te}function E(te){let ue=Math.hypot(te.deltaX,te.deltaY);const ge=Math.atan2(te.deltaY,te.deltaX);return-.25*Math.PI<ge&&ge<.75*Math.PI&&(ue=-ue),ue}const z=new Promise(function(te){window.requestAnimationFrame(te)});_.animationStarted=z,he=new WeakSet,J2=function(){this._indeterminate?this.div.classList.add("indeterminate"):(this.div.classList.remove("indeterminate"),document.documentElement.style.setProperty("--progressBar-percent",`${this._percent}%`))},_.ProgressBar=class{constructor(ue){if(Ze(this,he),arguments.length>1)throw new Error("ProgressBar no longer accepts any additional options, please use CSS rules to modify its appearance instead.");this.visible=!0,this.div=document.querySelector(ue+" .progress"),this.bar=this.div.parentNode,this.percent=0}get percent(){return this._percent}set percent(ue){var te;this._indeterminate=isNaN(ue),this._percent=(te=ue,Math.min(Math.max(te,0),100)),Xe(this,he,J2).call(this)}setWidth(ue){if(!ue)return;const U=ue.parentNode.offsetWidth-ue.offsetWidth;U>0&&document.documentElement.style.setProperty("--progressBar-end-offset",`${U}px`)}hide(){!this.visible||(this.visible=!1,this.bar.classList.add("hidden"))}show(){this.visible||(this.visible=!0,this.bar.classList.remove("hidden"))}}},(le,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.StructTreeLayerBuilder=void 0;const h={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},p=/^H(\d+)$/;_.StructTreeLayerBuilder=class{constructor({pdfPage:l}){this.pdfPage=l}render(l){return this._walk(l)}_setAttributes(l,o){void 0!==l.alt&&o.setAttribute("aria-label",l.alt),void 0!==l.id&&o.setAttribute("aria-owns",l.id),void 0!==l.lang&&o.setAttribute("lang",l.lang)}_walk(l){if(!l)return null;const o=document.createElement("span");if("role"in l){const{role:a}=l,f=a.match(p);f?(o.setAttribute("role","heading"),o.setAttribute("aria-level",f[1])):h[a]&&o.setAttribute("role",h[a])}if(this._setAttributes(l,o),l.children)if(1===l.children.length&&"id"in l.children[0])this._setAttributes(l.children[0],o);else for(const a of l.children)o.appendChild(this._walk(a));return o}}},(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.TextLayerBuilder=void 0;var p=h(3);_.TextLayerBuilder=class{constructor({textLayerDiv:o,eventBus:a,pageIndex:f,viewport:u,highlighter:m=null,enhanceTextSelection:b=!1}){this.textLayerDiv=o,this.eventBus=a,this.textContent=null,this.textContentItemsStr=[],this.textContentStream=null,this.renderingDone=!1,this.pageNumber=f+1,this.viewport=u,this.textDivs=[],this.textLayerRenderTask=null,this.highlighter=m,this.enhanceTextSelection=b,this._bindMouse()}_finishRendering(){if(this.renderingDone=!0,!this.enhanceTextSelection){const o=document.createElement("div");o.className="endOfContent",this.textLayerDiv.appendChild(o)}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.pageNumber,numTextDivs:this.textDivs.length})}render(o=0){var f;if(!this.textContent&&!this.textContentStream||this.renderingDone)return;this.cancel(),this.textDivs.length=0,null==(f=this.highlighter)||f.setTextMapping(this.textDivs,this.textContentItemsStr);const a=document.createDocumentFragment();this.textLayerRenderTask=(0,p.renderTextLayer)({textContent:this.textContent,textContentStream:this.textContentStream,container:a,viewport:this.viewport,textDivs:this.textDivs,textContentItemsStr:this.textContentItemsStr,timeout:o,enhanceTextSelection:this.enhanceTextSelection}),this.textLayerRenderTask.promise.then(()=>{var u;this.textLayerDiv.appendChild(a),this._finishRendering(),null==(u=this.highlighter)||u.enable()},function(u){})}cancel(){var o;this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),null==(o=this.highlighter)||o.disable()}setTextContentStream(o){this.cancel(),this.textContentStream=o}setTextContent(o){this.cancel(),this.textContent=o}_bindMouse(){const o=this.textLayerDiv;let a=null;o.addEventListener("mousedown",f=>{if(this.enhanceTextSelection&&this.textLayerRenderTask)return this.textLayerRenderTask.expandTextDivs(!0),void(a&&(clearTimeout(a),a=null));const u=o.querySelector(".endOfContent");if(!u)return;let m=f.target!==o;if(m=m&&"none"!==window.getComputedStyle(u).getPropertyValue("-moz-user-select"),m){const b=o.getBoundingClientRect(),v=Math.max(0,(f.pageY-b.top)/b.height);u.style.top=(100*v).toFixed(2)+"%"}u.classList.add("active")}),o.addEventListener("mouseup",()=>{if(this.enhanceTextSelection&&this.textLayerRenderTask)return void(a=setTimeout(()=>{this.textLayerRenderTask&&this.textLayerRenderTask.expandTextDivs(!1),a=null},300));const f=o.querySelector(".endOfContent");!f||(f.style.top="",f.classList.remove("active"))})}}},(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.XfaLayerBuilder=void 0;var p=h(3);_.XfaLayerBuilder=class{constructor({pageDiv:l,pdfPage:o,annotationStorage:a=null,linkService:f,xfaHtml:u=null}){this.pageDiv=l,this.pdfPage=o,this.annotationStorage=a,this.linkService=f,this.xfaHtml=u,this.div=null,this._cancelled=!1}render(l,o="display"){if("print"===o){const a={viewport:l.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:o},f=document.createElement("div");this.pageDiv.appendChild(f),a.div=f;const u=p.XfaLayer.render(a);return Promise.resolve(u)}return this.pdfPage.getXfa().then(a=>{if(this._cancelled||!a)return{textDivs:[]};const f={viewport:l.clone({dontFlip:!0}),div:this.div,xfaHtml:a,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:o};return this.div?p.XfaLayer.update(f):(this.div=document.createElement("div"),this.pageDiv.appendChild(this.div),f.div=this.div,p.XfaLayer.render(f))}).catch(a=>{console.error(a)})}cancel(){this._cancelled=!0}hide(){!this.div||(this.div.hidden=!0)}}},(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.PDFViewer=_.PDFSinglePageViewer=void 0;var p=h(6),g=h(11);_.PDFViewer=class extends g.BaseViewer{},_.PDFSinglePageViewer=class extends g.BaseViewer{_resetView(){super._resetView(),this._scrollMode=p.ScrollMode.PAGE,this._spreadMode=p.SpreadMode.NONE}set scrollMode(a){}_updateScrollMode(){}set spreadMode(a){}_updateSpreadMode(){}}},(le,_,h)=>{var H,W,K,TC,ae,ce,Y,de,fe,me,B,L,Z2,M,eN,P,Xc,k,Zf,j,tN,Q,DC,se,nN,X,iN,_e,rN;Object.defineProperty(_,"__esModule",{value:!0}),_.PagesCountLimit=_.PDFPageViewBuffer=_.BaseViewer=void 0;var p=h(3),g=h(6),c=h(2),l=h(4),o=h(12),a=h(14),f=h(5),u=h(7),m=h(15),b=h(8),v=h(9);const x="enablePermissions",T={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};_.PagesCountLimit=T;class I{constructor(U){Ze(this,K),Ze(this,H,new Set),Ze(this,W,0),Ut(this,W,U)}push(U){const q=$e(this,H);q.has(U)&&q.delete(U),q.add(U),q.size>$e(this,W)&&Xe(this,K,TC).call(this)}resize(U,q=null){Ut(this,W,U);const Z=$e(this,H);if(q){const Se=Z.size;let xe=1;for(const Te of Z)if(q.has(Te.id)&&(Z.delete(Te),Z.add(Te)),++xe>Se)break}for(;Z.size>$e(this,W);)Xe(this,K,TC).call(this)}has(U){return $e(this,H).has(U)}[Symbol.iterator](){return $e(this,H).keys()}}H=new WeakMap,W=new WeakMap,K=new WeakSet,TC=function(){const U=$e(this,H).keys().next().value;null==U||U.destroy(),$e(this,H).delete(U)},_.PDFPageViewBuffer=I;const ue=class{constructor(U){var Z,Se,xe,Te;if(Ze(this,L),Ze(this,M),Ze(this,P),Ze(this,k),Ze(this,j),Ze(this,Q),Ze(this,se),Ze(this,X),Ze(this,_e),Ze(this,ae,null),Ze(this,ce,p.AnnotationMode.ENABLE_FORMS),Ze(this,Y,null),Ze(this,de,!1),Ze(this,fe,0),Ze(this,me,null),Ze(this,B,null),this.constructor===ue)throw new Error("Cannot initialize BaseViewer.");const q="2.14.305";if(p.version!==q)throw new Error(`The API version "${p.version}" does not match the Viewer version "${q}".`);if(this.container=U.container,this.viewer=U.viewer||U.container.firstElementChild,"DIV"!==(null==(Z=this.container)?void 0:Z.tagName.toUpperCase())||"DIV"!==(null==(Se=this.viewer)?void 0:Se.tagName.toUpperCase()))throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&"absolute"!==getComputedStyle(this.container).position)throw new Error("The `container` must be absolutely positioned.");this.eventBus=U.eventBus,this.linkService=U.linkService||new f.SimpleLinkService,this.downloadManager=U.downloadManager||null,this.findController=U.findController||null,this._scriptingManager=U.scriptingManager||null,this.removePageBorders=U.removePageBorders||!1,this.textLayerMode=null!=(xe=U.textLayerMode)?xe:g.TextLayerMode.ENABLE,Ut(this,ce,null!=(Te=U.annotationMode)?Te:p.AnnotationMode.ENABLE_FORMS),this.imageResourcesPath=U.imageResourcesPath||"",this.enablePrintAutoRotate=U.enablePrintAutoRotate||!1,this.renderer=U.renderer||g.RendererType.CANVAS,this.useOnlyCssZoom=U.useOnlyCssZoom||!1,this.maxCanvasPixels=U.maxCanvasPixels,this.l10n=U.l10n||l.NullL10n,Ut(this,de,U.enablePermissions||!1),this.pageColors=U.pageColors||null,U.pageColors&&(!CSS.supports("color",U.pageColors.background)||!CSS.supports("color",U.pageColors.foreground))&&((U.pageColors.background||U.pageColors.foreground)&&console.warn("Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.defaultRenderingQueue=!U.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new a.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=U.renderingQueue,this._doc=document.documentElement,this.scroll=(0,g.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=g.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.updateContainerHeightCss(),Promise.resolve().then(()=>{this.eventBus.dispatch("baseviewerinit",{source:this})})}get pagesCount(){return this._pages.length}getPageView(U){return this._pages[U]}get pageViewsReady(){return!!this._pagesCapability.settled&&this._pages.every(function(U){return null==U?void 0:U.pdfPage})}get renderForms(){return $e(this,ce)===p.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(U){if(!Number.isInteger(U))throw new Error("Invalid page number.");!this.pdfDocument||this._setCurrentPageNumber(U,!0)||console.error(`currentPageNumber: "${U}" is not a valid page.`)}_setCurrentPageNumber(U,q=!1){var Se,xe;if(this._currentPageNumber===U)return q&&Xe(this,Q,DC).call(this),!0;if(!(0<U&&U<=this.pagesCount))return!1;const Z=this._currentPageNumber;return this._currentPageNumber=U,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:U,pageLabel:null!=(xe=null==(Se=this._pageLabels)?void 0:Se[U-1])?xe:null,previous:Z}),q&&Xe(this,Q,DC).call(this),!0}get currentPageLabel(){var U,q;return null!=(q=null==(U=this._pageLabels)?void 0:U[this._currentPageNumber-1])?q:null}set currentPageLabel(U){if(!this.pdfDocument)return;let q=0|U;if(this._pageLabels){const Z=this._pageLabels.indexOf(U);Z>=0&&(q=Z+1)}this._setCurrentPageNumber(q,!0)||console.error(`currentPageLabel: "${U}" is not a valid page.`)}get currentScale(){return this._currentScale!==g.UNKNOWN_SCALE?this._currentScale:g.DEFAULT_SCALE}set currentScale(U){if(isNaN(U))throw new Error("Invalid numeric scale.");!this.pdfDocument||this._setScale(U,!1)}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(U){!this.pdfDocument||this._setScale(U,!1)}get pagesRotation(){return this._pagesRotation}set pagesRotation(U){if(!(0,g.isValidRotation)(U))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||((U%=360)<0&&(U+=360),this._pagesRotation===U))return;this._pagesRotation=U;const q=this._currentPageNumber,Z={rotation:U};for(const Se of this._pages)Se.update(Z);this._currentScaleValue&&this._setScale(this._currentScaleValue,!0),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:U,pageNumber:q}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}setDocument(U){var q=this;if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController&&this.findController.setDocument(null),this._scriptingManager&&this._scriptingManager.setDocument(null)),this.pdfDocument=U,!U)return;const Z=U.isPureXfa,Se=U.numPages,xe=U.getPage(1),Te=U.getOptionalContentConfig(),Re=$e(this,de)?U.getPermissions():Promise.resolve();if(Se>T.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const Oe=this._scrollMode=g.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:Oe})}this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:Se})},()=>{}),this._onBeforeDraw=Oe=>{const Ye=this._pages[Oe.pageNumber-1];!Ye||$e(this,ae).push(Ye)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=Oe=>{Oe.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:Oe.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,$e(this,B)&&(document.removeEventListener("visibilitychange",$e(this,B)),Ut(this,B,null)))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([xe,Re]).then(([Oe,Ye])=>{if(U!==this.pdfDocument)return;this._firstPageCapability.resolve(Oe),this._optionalContentConfigPromise=Te,Xe(this,L,Z2).call(this,Ye);const qe=this._scrollMode===g.ScrollMode.PAGE?null:this.viewer,yt=this.currentScale,Ce=Oe.getViewport({scale:yt*p.PixelsPerInch.PDF_TO_CSS_UNITS}),re=this.textLayerMode===g.TextLayerMode.DISABLE||Z?null:this,oe=$e(this,ce)!==p.AnnotationMode.DISABLE?this:null,De=Z?this:null;for(let Be=1;Be<=Se;++Be){const Ve=new o.PDFPageView({container:qe,eventBus:this.eventBus,id:Be,scale:yt,defaultViewport:Ce.clone(),optionalContentConfigPromise:Te,renderingQueue:this.renderingQueue,textLayerFactory:re,textLayerMode:this.textLayerMode,annotationLayerFactory:oe,annotationMode:$e(this,ce),xfaLayerFactory:De,textHighlighterFactory:this,structTreeLayerFactory:this,imageResourcesPath:this.imageResourcesPath,renderer:this.renderer,useOnlyCssZoom:this.useOnlyCssZoom,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n});this._pages.push(Ve)}const Me=this._pages[0];Me&&(Me.setPdfPage(Oe),this.linkService.cachePageRef(1,Oe.ref)),this._scrollMode===g.ScrollMode.PAGE?Xe(this,P,Xc).call(this):this._spreadMode!==g.SpreadMode.NONE&&this._updateSpreadMode(),Xe(this,M,eN).call(this).then(S(function*(){if(q.findController&&q.findController.setDocument(U),q._scriptingManager&&q._scriptingManager.setDocument(U),U.loadingParams.disableAutoFetch||Se>T.FORCE_LAZY_PAGE_INIT)return void q._pagesCapability.resolve();let Be=Se-1;if(Be<=0)q._pagesCapability.resolve();else for(let Ve=2;Ve<=Se;++Ve){const ut=U.getPage(Ve).then(mt=>{const et=q._pages[Ve-1];et.pdfPage||et.setPdfPage(mt),q.linkService.cachePageRef(Ve,mt.ref),0==--Be&&q._pagesCapability.resolve()},mt=>{console.error(`Unable to get page ${Ve} to initialize viewer`,mt),0==--Be&&q._pagesCapability.resolve()});Ve%T.PAUSE_EAGER_PAGE_INIT==0&&(yield ut)}})),this.eventBus.dispatch("pagesinit",{source:this}),U.getMetadata().then(({info:Be})=>{U===this.pdfDocument&&Be.Language&&(this.viewer.lang=Be.Language)}),this.defaultRenderingQueue&&this.update()}).catch(Oe=>{console.error("Unable to initialize viewer",Oe),this._pagesCapability.reject(Oe)})}setPageLabels(U){var q,Z;if(this.pdfDocument){U?Array.isArray(U)&&this.pdfDocument.numPages===U.length?this._pageLabels=U:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let Se=0,xe=this._pages.length;Se<xe;Se++)this._pages[Se].setPageLabel(null!=(Z=null==(q=this._pageLabels)?void 0:q[Se])?Z:null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=g.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,Ut(this,ae,new I(10)),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=(0,p.createPromiseCapability)(),this._onePageRenderedCapability=(0,p.createPromiseCapability)(),this._pagesCapability=(0,p.createPromiseCapability)(),this._scrollMode=g.ScrollMode.VERTICAL,this._previousScrollMode=g.ScrollMode.UNKNOWN,this._spreadMode=g.SpreadMode.NONE,Ut(this,me,{previousPageNumber:1,scrollDown:!0,pages:[]}),this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),$e(this,B)&&(document.removeEventListener("visibilitychange",$e(this,B)),Ut(this,B,null)),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.viewer.classList.remove(x),null!==$e(this,Y)&&(Ut(this,ce,$e(this,Y)),Ut(this,Y,null))}_scrollUpdate(){0!==this.pagesCount&&this.update()}_setScaleUpdatePages(U,q,Z=!1,Se=!1){if(this._currentScaleValue=q.toString(),Xe(this,j,tN).call(this,U))return void(Se&&this.eventBus.dispatch("scalechanging",{source:this,scale:U,presetValue:q}));this._doc.style.setProperty("--zoom-factor",U);const xe={scale:U};for(const Te of this._pages)Te.update(xe);if(this._currentScale=U,!Z){let Re,Te=this._currentPageNumber;this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(Te=this._location.pageNumber,Re=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:Te,destArray:Re,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:U,presetValue:Se?q:void 0}),this.defaultRenderingQueue&&this.update(),this.updateContainerHeightCss()}get _pageWidthScaleFactor(){return this._spreadMode!==g.SpreadMode.NONE&&this._scrollMode!==g.ScrollMode.HORIZONTAL?2:1}_setScale(U,q=!1){let Z=parseFloat(U);if(Z>0)this._setScaleUpdatePages(Z,U,q,!1);else{const Se=this._pages[this._currentPageNumber-1];if(!Se)return;let xe=g.SCROLLBAR_PADDING,Te=g.VERTICAL_PADDING;this.isInPresentationMode?xe=Te=4:this.removePageBorders?xe=Te=0:this._scrollMode===g.ScrollMode.HORIZONTAL&&([xe,Te]=[Te,xe]);const Re=(this.container.clientWidth-xe)/Se.width*Se.scale/this._pageWidthScaleFactor,Oe=(this.container.clientHeight-Te)/Se.height*Se.scale;switch(U){case"page-actual":Z=1;break;case"page-width":Z=Re;break;case"page-height":Z=Oe;break;case"page-fit":Z=Math.min(Re,Oe);break;case"auto":const Ye=(0,g.isPortraitOrientation)(Se)?Re:Math.min(Oe,Re);Z=Math.min(g.MAX_AUTO_SCALE,Ye);break;default:return void console.error(`_setScale: "${U}" is an unknown zoom value.`)}this._setScaleUpdatePages(Z,U,q,!0)}}pageLabelToPageNumber(U){if(!this._pageLabels)return null;const q=this._pageLabels.indexOf(U);return q<0?null:q+1}scrollPageIntoView({pageNumber:U,destArray:q=null,allowNegativeOffset:Z=!1,ignoreDestinationZoom:Se=!1}){if(!this.pdfDocument)return;const xe=Number.isInteger(U)&&this._pages[U-1];if(!xe)return void console.error(`scrollPageIntoView: "${U}" is not a valid pageNumber parameter.`);if(this.isInPresentationMode||!q)return void this._setCurrentPageNumber(U,!0);let qe,yt,Te=0,Re=0,Oe=0,Ye=0;const Ce=xe.rotation%180!=0,re=(Ce?xe.height:xe.width)/xe.scale/p.PixelsPerInch.PDF_TO_CSS_UNITS,oe=(Ce?xe.width:xe.height)/xe.scale/p.PixelsPerInch.PDF_TO_CSS_UNITS;let De=0;switch(q[1].name){case"XYZ":Te=q[2],Re=q[3],De=q[4],Te=null!==Te?Te:0,Re=null!==Re?Re:oe;break;case"Fit":case"FitB":De="page-fit";break;case"FitH":case"FitBH":Re=q[2],De="page-width",null===Re&&this._location?(Te=this._location.left,Re=this._location.top):("number"!=typeof Re||Re<0)&&(Re=oe);break;case"FitV":case"FitBV":Te=q[2],Oe=re,Ye=oe,De="page-height";break;case"FitR":Te=q[2],Re=q[3],Oe=q[4]-Te,Ye=q[5]-Re,qe=(this.container.clientWidth-(this.removePageBorders?0:g.SCROLLBAR_PADDING))/Oe/p.PixelsPerInch.PDF_TO_CSS_UNITS,yt=(this.container.clientHeight-(this.removePageBorders?0:g.VERTICAL_PADDING))/Ye/p.PixelsPerInch.PDF_TO_CSS_UNITS,De=Math.min(Math.abs(qe),Math.abs(yt));break;default:return void console.error(`scrollPageIntoView: "${q[1].name}" is not a valid destination type.`)}if(Se||(De&&De!==this._currentScale?this.currentScaleValue=De:this._currentScale===g.UNKNOWN_SCALE&&(this.currentScaleValue=g.DEFAULT_SCALE_VALUE)),"page-fit"===De&&!q[4])return void Xe(this,k,Zf).call(this,xe);const Me=[xe.viewport.convertToViewportPoint(Te,Re),xe.viewport.convertToViewportPoint(Te+Oe,Re+Ye)];let Be=Math.min(Me[0][0],Me[1][0]),Ve=Math.min(Me[0][1],Me[1][1]);Z||(Be=Math.max(Be,0),Ve=Math.max(Ve,0)),Xe(this,k,Zf).call(this,xe,{left:Be,top:Ve})}_updateLocation(U){const q=this._currentScale,Z=this._currentScaleValue,Se=parseFloat(Z)===q?Math.round(1e4*q)/100:Z,xe=U.id,Re=this.container,Oe=this._pages[xe-1].getPagePoint(Re.scrollLeft-U.x,Re.scrollTop-U.y),Ye=Math.round(Oe[0]),qe=Math.round(Oe[1]);let yt=`#page=${xe}`;this.isInPresentationMode||(yt+=`&zoom=${Se},${Ye},${qe}`),this._location={pageNumber:xe,scale:Se,top:qe,left:Ye,rotation:this._pagesRotation,pdfOpenParams:yt}}update(){const U=this._getVisiblePages(),q=U.views,Z=q.length;if(0===Z)return;const Se=Math.max(10,2*Z+1);$e(this,ae).resize(Se,U.ids),this.renderingQueue.renderHighestPriority(U);const xe=this._spreadMode===g.SpreadMode.NONE&&(this._scrollMode===g.ScrollMode.PAGE||this._scrollMode===g.ScrollMode.VERTICAL),Te=this._currentPageNumber;let Re=!1;for(const Oe of q){if(Oe.percent<100)break;if(Oe.id===Te&&xe){Re=!0;break}}this._setCurrentPageNumber(Re?Te:q[0].id),this._updateLocation(U.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(U){return this.container.contains(U)}focus(){this.container.focus()}get _isContainerRtl(){return"rtl"===getComputedStyle(this.container).direction}get isInPresentationMode(){return this.presentationModeState===g.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===g.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const U=this._scrollMode===g.ScrollMode.PAGE?$e(this,me).pages:this._pages,q=this._scrollMode===g.ScrollMode.HORIZONTAL;return(0,g.getVisibleElements)({scrollEl:this.container,views:U,sortByVisibility:!0,horizontal:q,rtl:q&&this._isContainerRtl})}isPageVisible(U){return!!this.pdfDocument&&(Number.isInteger(U)&&U>0&&U<=this.pagesCount?this._getVisiblePages().ids.has(U):(console.error(`isPageVisible: "${U}" is not a valid page.`),!1))}isPageCached(U){if(!this.pdfDocument)return!1;if(!(Number.isInteger(U)&&U>0&&U<=this.pagesCount))return console.error(`isPageCached: "${U}" is not a valid page.`),!1;const q=this._pages[U-1];return $e(this,ae).has(q)}cleanup(){for(const U of this._pages)U.renderingState!==g.RenderingStates.FINISHED&&U.reset()}_cancelRendering(){for(const U of this._pages)U.cancelRendering()}forceRendering(U){const q=U||this._getVisiblePages(),Z=Xe(this,X,iN).call(this,q),xe=this.renderingQueue.getHighestPriority(q,this._pages,Z,this._spreadMode!==g.SpreadMode.NONE&&this._scrollMode!==g.ScrollMode.HORIZONTAL);return Xe(this,_e,rN).call(this,q.ids),!!xe&&(Xe(this,se,nN).call(this,xe).then(()=>{this.renderingQueue.renderView(xe)}),!0)}createTextLayerBuilder(U,q,Z,Se=!1,xe,Te){return new b.TextLayerBuilder({textLayerDiv:U,eventBus:xe,pageIndex:q,viewport:Z,enhanceTextSelection:!this.isInPresentationMode&&Se,highlighter:Te})}createTextHighlighter(U,q){return new m.TextHighlighter({eventBus:q,pageIndex:U,findController:this.isInPresentationMode?null:this.findController})}createAnnotationLayerBuilder(U,q,Z=null,Se="",xe=!0,Te=l.NullL10n,Re=null,Oe=null,Ye=null,qe=null,yt=null){var Ce,re,oe,De;return new c.AnnotationLayerBuilder({pageDiv:U,pdfPage:q,annotationStorage:Z||(null==(Ce=this.pdfDocument)?void 0:Ce.annotationStorage),imageResourcesPath:Se,renderForms:xe,linkService:this.linkService,downloadManager:this.downloadManager,l10n:Te,enableScripting:null!=Re?Re:this.enableScripting,hasJSActionsPromise:Oe||(null==(re=this.pdfDocument)?void 0:re.hasJSActions()),fieldObjectsPromise:qe||(null==(oe=this.pdfDocument)?void 0:oe.getFieldObjects()),mouseState:Ye||(null==(De=this._scriptingManager)?void 0:De.mouseState),annotationCanvasMap:yt})}createXfaLayerBuilder(U,q,Z=null){var Se;return new v.XfaLayerBuilder({pageDiv:U,pdfPage:q,annotationStorage:Z||(null==(Se=this.pdfDocument)?void 0:Se.annotationStorage),linkService:this.linkService})}createStructTreeLayerBuilder(U){return new u.StructTreeLayerBuilder({pdfPage:U})}get hasEqualPageSizes(){const U=this._pages[0];for(let q=1,Z=this._pages.length;q<Z;++q){const Se=this._pages[q];if(Se.width!==U.width||Se.height!==U.height)return!1}return!0}getPagesOverview(){return this._pages.map(U=>{const q=U.pdfPage.getViewport({scale:1});return!this.enablePrintAutoRotate||(0,g.isPortraitOrientation)(q)?{width:q.width,height:q.height,rotation:q.rotation}:{width:q.height,height:q.width,rotation:(q.rotation-90)%360}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:this.pdfDocument.getOptionalContentConfig():Promise.resolve(null)}set optionalContentConfigPromise(U){if(!(U instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${U}`);if(!this.pdfDocument||!this._optionalContentConfigPromise)return;this._optionalContentConfigPromise=U;const q={optionalContentConfigPromise:U};for(const Z of this._pages)Z.update(q);this.update(),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:U})}get scrollMode(){return this._scrollMode}set scrollMode(U){if(this._scrollMode!==U){if(!(0,g.isValidScrollMode)(U))throw new Error(`Invalid scroll mode: ${U}`);this.pagesCount>T.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=U,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:U}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(U=null){const q=this._scrollMode,Z=this.viewer;Z.classList.toggle("scrollHorizontal",q===g.ScrollMode.HORIZONTAL),Z.classList.toggle("scrollWrapped",q===g.ScrollMode.WRAPPED),this.pdfDocument&&U&&(q===g.ScrollMode.PAGE?Xe(this,P,Xc).call(this):this._previousScrollMode===g.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(U,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(U){if(this._spreadMode!==U){if(!(0,g.isValidSpreadMode)(U))throw new Error(`Invalid spread mode: ${U}`);this._spreadMode=U,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:U}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(U=null){if(!this.pdfDocument)return;const q=this.viewer,Z=this._pages;if(this._scrollMode===g.ScrollMode.PAGE)Xe(this,P,Xc).call(this);else if(q.textContent="",this._spreadMode===g.SpreadMode.NONE)for(const Se of this._pages)q.appendChild(Se.div);else{const Se=this._spreadMode-1;let xe=null;for(let Te=0,Re=Z.length;Te<Re;++Te)null===xe?(xe=document.createElement("div"),xe.className="spread",q.appendChild(xe)):Te%2===Se&&(xe=xe.cloneNode(!1),q.appendChild(xe)),xe.appendChild(Z[Te].div)}!U||(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(U,!0),this.update())}_getPageAdvance(U,q=!1){switch(this._scrollMode){case g.ScrollMode.WRAPPED:{const{views:Z}=this._getVisiblePages(),Se=new Map;for(const{id:xe,y:Te,percent:Re,widthPercent:Oe}of Z){if(0===Re||Oe<100)continue;let Ye=Se.get(Te);Ye||Se.set(Te,Ye||(Ye=[])),Ye.push(xe)}for(const xe of Se.values()){const Te=xe.indexOf(U);if(-1===Te)continue;const Re=xe.length;if(1===Re)break;if(q)for(let Oe=Te-1,Ye=0;Oe>=Ye;Oe--){const yt=xe[Oe+1]-1;if(xe[Oe]<yt)return U-yt}else for(let Oe=Te+1,Ye=Re;Oe<Ye;Oe++){const yt=xe[Oe-1]+1;if(xe[Oe]>yt)return yt-U}if(q){const Oe=xe[0];if(Oe<U)return U-Oe+1}else{const Oe=xe[Re-1];if(Oe>U)return Oe-U+1}break}break}case g.ScrollMode.HORIZONTAL:break;case g.ScrollMode.PAGE:case g.ScrollMode.VERTICAL:{if(this._spreadMode===g.SpreadMode.NONE)break;const Z=this._spreadMode-1;if(q&&U%2!==Z)break;if(!q&&U%2===Z)break;const{views:Se}=this._getVisiblePages(),xe=q?U-1:U+1;for(const{id:Te,percent:Re,widthPercent:Oe}of Se)if(Te===xe){if(Re>0&&100===Oe)return 2;break}break}}return 1}nextPage(){const U=this._currentPageNumber,q=this.pagesCount;if(U>=q)return!1;const Z=this._getPageAdvance(U,!1)||1;return this.currentPageNumber=Math.min(U+Z,q),!0}previousPage(){const U=this._currentPageNumber;if(U<=1)return!1;const q=this._getPageAdvance(U,!0)||1;return this.currentPageNumber=Math.max(U-q,1),!0}increaseScale(U=1){let q=this._currentScale;do{q=(q*g.DEFAULT_SCALE_DELTA).toFixed(2),q=Math.ceil(10*q)/10,q=Math.min(g.MAX_SCALE,q)}while(--U>0&&q<g.MAX_SCALE);this.currentScaleValue=q}decreaseScale(U=1){let q=this._currentScale;do{q=(q/g.DEFAULT_SCALE_DELTA).toFixed(2),q=Math.floor(10*q)/10,q=Math.max(g.MIN_SCALE,q)}while(--U>0&&q>g.MIN_SCALE);this.currentScaleValue=q}updateContainerHeightCss(){const U=this.container.clientHeight;U!==$e(this,fe)&&(Ut(this,fe,U),this._doc.style.setProperty("--viewer-container-height",`${U}px`))}};let N=ue;ae=new WeakMap,ce=new WeakMap,Y=new WeakMap,de=new WeakMap,fe=new WeakMap,me=new WeakMap,B=new WeakMap,L=new WeakSet,Z2=function(U){!U||(U.includes(p.PermissionFlag.COPY)||this.viewer.classList.add(x),!U.includes(p.PermissionFlag.MODIFY_ANNOTATIONS)&&!U.includes(p.PermissionFlag.FILL_INTERACTIVE_FORMS)&&$e(this,ce)===p.AnnotationMode.ENABLE_FORMS&&(Ut(this,Y,$e(this,ce)),Ut(this,ce,p.AnnotationMode.ENABLE)))},M=new WeakSet,eN=function(){if("hidden"===document.visibilityState||!this.container.offsetParent||0===this._getVisiblePages().views.length)return Promise.resolve();const U=new Promise(q=>{Ut(this,B,()=>{"hidden"===document.visibilityState&&(q(),document.removeEventListener("visibilitychange",$e(this,B)),Ut(this,B,null))}),document.addEventListener("visibilitychange",$e(this,B))});return Promise.race([this._onePageRenderedCapability.promise,U])},P=new WeakSet,Xc=function(){if(this._scrollMode!==g.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const U=this._currentPageNumber,q=$e(this,me),Z=this.viewer;if(Z.textContent="",q.pages.length=0,this._spreadMode!==g.SpreadMode.NONE||this.isInPresentationMode){const Se=new Set,xe=this._spreadMode-1;-1===xe?Se.add(U-1):U%2!==xe?(Se.add(U-1),Se.add(U)):(Se.add(U-2),Se.add(U-1));const Te=document.createElement("div");if(Te.className="spread",this.isInPresentationMode){const Re=document.createElement("div");Re.className="dummyPage",Te.appendChild(Re)}for(const Re of Se){const Oe=this._pages[Re];!Oe||(Te.appendChild(Oe.div),q.pages.push(Oe))}Z.appendChild(Te)}else{const Se=this._pages[U-1];Z.appendChild(Se.div),q.pages.push(Se)}q.scrollDown=U>=q.previousPageNumber,q.previousPageNumber=U},k=new WeakSet,Zf=function(U,q=null){const{div:Z,id:Se}=U;if(this._scrollMode===g.ScrollMode.PAGE&&(this._setCurrentPageNumber(Se),Xe(this,P,Xc).call(this),this.update()),!q&&!this.isInPresentationMode){const xe=Z.offsetLeft+Z.clientLeft,Te=xe+Z.clientWidth,{scrollLeft:Re,clientWidth:Oe}=this.container;(this._scrollMode===g.ScrollMode.HORIZONTAL||xe<Re||Te>Re+Oe)&&(q={left:0,top:0})}(0,g.scrollIntoView)(Z,q)},j=new WeakSet,tN=function(U){return U===this._currentScale||Math.abs(U-this._currentScale)<1e-15},Q=new WeakSet,DC=function(){const U=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this._setScale(this._currentScaleValue,!0),Xe(this,k,Zf).call(this,U)},se=new WeakSet,nN=function(U){var q=this;return S(function*(){var Z,Se;if(U.pdfPage)return U.pdfPage;try{const xe=yield q.pdfDocument.getPage(U.id);return U.pdfPage||U.setPdfPage(xe),(null==(Se=(Z=q.linkService)._cachedPageNumber)?void 0:Se.call(Z,xe.ref))||q.linkService.cachePageRef(U.id,xe.ref),xe}catch(xe){return console.error("Unable to get page for page view",xe),null}})()},X=new WeakSet,iN=function(U){var q,Z;if(1===(null==(q=U.first)?void 0:q.id))return!0;if((null==(Z=U.last)?void 0:Z.id)===this.pagesCount)return!1;switch(this._scrollMode){case g.ScrollMode.PAGE:return $e(this,me).scrollDown;case g.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down},_e=new WeakSet,rN=function(U){for(const q of U){const Z=this._pages[q-1];null==Z||Z.toggleLoadingIconSpinner(!0)}for(const q of $e(this,ae))U.has(q.id)||q.toggleLoadingIconSpinner(!1)},_.BaseViewer=N},(le,_,h)=>{var f;Object.defineProperty(_,"__esModule",{value:!0}),_.PDFPageView=void 0;var p=h(3),g=h(6),c=h(13),l=h(4);const o=c.compatibilityParams.maxCanvasPixels||16777216;f=new WeakMap,_.PDFPageView=class{constructor(m){var x,T,I,N;Ze(this,f,p.AnnotationMode.ENABLE_FORMS);const b=m.container,v=m.defaultViewport;this.id=m.id,this.renderingId="page"+this.id,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=m.scale||g.DEFAULT_SCALE,this.viewport=v,this.pdfPageRotate=v.rotation,this._optionalContentConfigPromise=m.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.textLayerMode=null!=(x=m.textLayerMode)?x:g.TextLayerMode.ENABLE,Ut(this,f,null!=(T=m.annotationMode)?T:p.AnnotationMode.ENABLE_FORMS),this.imageResourcesPath=m.imageResourcesPath||"",this.useOnlyCssZoom=m.useOnlyCssZoom||!1,this.maxCanvasPixels=m.maxCanvasPixels||o,this.pageColors=m.pageColors||null,this.eventBus=m.eventBus,this.renderingQueue=m.renderingQueue,this.textLayerFactory=m.textLayerFactory,this.annotationLayerFactory=m.annotationLayerFactory,this.xfaLayerFactory=m.xfaLayerFactory,this.textHighlighter=null==(I=m.textHighlighterFactory)?void 0:I.createTextHighlighter(this.id-1,this.eventBus),this.structTreeLayerFactory=m.structTreeLayerFactory,this.renderer=m.renderer||g.RendererType.CANVAS,this.l10n=m.l10n||l.NullL10n,this.paintTask=null,this.paintedViewportMap=new WeakMap,this.renderingState=g.RenderingStates.INITIAL,this.resume=null,this._renderError=null,this._isStandalone=!(null==(N=this.renderingQueue)?void 0:N.hasViewer()),this._annotationCanvasMap=null,this.annotationLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const C=document.createElement("div");C.className="page",C.style.width=Math.floor(this.viewport.width)+"px",C.style.height=Math.floor(this.viewport.height)+"px",C.setAttribute("data-page-number",this.id),C.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(H=>{C.setAttribute("aria-label",H)}),this.div=C,null==b||b.appendChild(C)}setPdfPage(m){this.pdfPage=m,this.pdfPageRotate=m.rotate,this.viewport=m.getViewport({scale:this.scale*p.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:(this.rotation+this.pdfPageRotate)%360}),this.reset()}destroy(){this.reset(),this.pdfPage&&this.pdfPage.cleanup()}_renderAnnotationLayer(){var m=this;return S(function*(){let b=null;try{yield m.annotationLayer.render(m.viewport,"display")}catch(v){b=v}finally{m.eventBus.dispatch("annotationlayerrendered",{source:m,pageNumber:m.id,error:b})}})()}_renderXfaLayer(){var m=this;return S(function*(){let b=null;try{const v=yield m.xfaLayer.render(m.viewport,"display");m.textHighlighter&&m._buildXfaTextContentItems(v.textDivs)}catch(v){b=v}finally{m.eventBus.dispatch("xfalayerrendered",{source:m,pageNumber:m.id,error:b})}})()}_buildXfaTextContentItems(m){var b=this;return S(function*(){const v=yield b.pdfPage.getTextContent(),C=[];for(const x of v.items)C.push(x.str);b.textHighlighter.setTextMapping(m,C),b.textHighlighter.enable()})()}_resetZoomLayer(m=!1){if(!this.zoomLayer)return;const b=this.zoomLayer.firstChild;this.paintedViewportMap.delete(b),b.width=0,b.height=0,m&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:m=!1,keepAnnotationLayer:b=!1,keepXfaLayer:v=!1}={}){var H,W;this.cancelRendering({keepAnnotationLayer:b,keepXfaLayer:v}),this.renderingState=g.RenderingStates.INITIAL;const C=this.div;C.style.width=Math.floor(this.viewport.width)+"px",C.style.height=Math.floor(this.viewport.height)+"px";const x=C.childNodes,T=m&&this.zoomLayer||null,I=b&&(null==(H=this.annotationLayer)?void 0:H.div)||null,N=v&&(null==(W=this.xfaLayer)?void 0:W.div)||null;for(let K=x.length-1;K>=0;K--){const ne=x[K];switch(ne){case T:case I:case N:continue}ne.remove()}C.removeAttribute("data-loaded"),I&&this.annotationLayer.hide(),N&&this.xfaLayer.hide(),T||(this.canvas&&(this.paintedViewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer()),this.svg&&(this.paintedViewportMap.delete(this.svg),delete this.svg),this.loadingIconDiv=document.createElement("div"),this.loadingIconDiv.className="loadingIcon notVisible",this._isStandalone&&this.toggleLoadingIconSpinner(!0),this.loadingIconDiv.setAttribute("role","img"),this.l10n.get("loading").then(K=>{var ne;null==(ne=this.loadingIconDiv)||ne.setAttribute("aria-label",K)}),C.appendChild(this.loadingIconDiv)}update({scale:m=0,rotation:b=null,optionalContentConfigPromise:v=null}){if(this.scale=m||this.scale,"number"==typeof b&&(this.rotation=b),v instanceof Promise&&(this._optionalContentConfigPromise=v),this.viewport=this.viewport.clone({scale:this.scale*p.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:(this.rotation+this.pdfPageRotate)%360}),this._isStandalone){const{style:T}=document.documentElement;T.setProperty("--zoom-factor",this.scale)}if(this.svg)return this.cssTransform({target:this.svg,redrawAnnotationLayer:!0,redrawXfaLayer:!0}),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});let x=!1;if(this.canvas&&this.maxCanvasPixels>0){const T=this.outputScale;(Math.floor(this.viewport.width)*T.sx|0)*(Math.floor(this.viewport.height)*T.sy|0)>this.maxCanvasPixels&&(x=!0)}if(this.canvas){if(this.useOnlyCssZoom||this.hasRestrictedScaling&&x)return this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawXfaLayer:!0}),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepXfaLayer:!0})}cancelRendering({keepAnnotationLayer:m=!1,keepXfaLayer:b=!1}={}){var v;this.paintTask&&(this.paintTask.cancel(),this.paintTask=null),this.resume=null,this.textLayer&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!m||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.xfaLayer&&(!b||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,null==(v=this.textHighlighter)||v.disable()),this._onTextLayerRendered&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null)}cssTransform({target:m,redrawAnnotationLayer:b=!1,redrawXfaLayer:v=!1}){const C=this.viewport.width,x=this.viewport.height,T=this.div;m.style.width=m.parentNode.style.width=T.style.width=Math.floor(C)+"px",m.style.height=m.parentNode.style.height=T.style.height=Math.floor(x)+"px";const I=this.viewport.rotation-this.paintedViewportMap.get(m).rotation,N=Math.abs(I);let H=1,W=1;if((90===N||270===N)&&(H=x/C,W=C/x),m.style.transform=`rotate(${I}deg) scale(${H}, ${W})`,this.textLayer){const K=this.textLayer.viewport,ae=Math.abs(this.viewport.rotation-K.rotation);let ce=C/K.width;(90===ae||270===ae)&&(ce=C/K.height);const Y=this.textLayer.textLayerDiv;let de,fe;switch(ae){case 0:de=fe=0;break;case 90:de=0,fe="-"+Y.style.height;break;case 180:de="-"+Y.style.width,fe="-"+Y.style.height;break;case 270:de="-"+Y.style.width,fe=0;break;default:console.error("Bad rotation value.")}Y.style.transform=`rotate(${ae}deg) scale(${ce}) translate(${de}, ${fe})`,Y.style.transformOrigin="0% 0%"}b&&this.annotationLayer&&this._renderAnnotationLayer(),v&&this.xfaLayer&&this._renderXfaLayer()}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(m,b){return this.viewport.convertToPdfPoint(m,b)}toggleLoadingIconSpinner(m=!1){var b;null==(b=this.loadingIconDiv)||b.classList.toggle("notVisible",!m)}draw(){var W,K,ne,m=this;this.renderingState!==g.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:b,pdfPage:v}=this;if(!v)return this.renderingState=g.RenderingStates.FINISHED,this.loadingIconDiv&&(this.loadingIconDiv.remove(),delete this.loadingIconDiv),Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=g.RenderingStates.RUNNING;const C=document.createElement("div");C.style.width=b.style.width,C.style.height=b.style.height,C.classList.add("canvasWrapper"),(null==(W=this.annotationLayer)?void 0:W.div)?b.insertBefore(C,this.annotationLayer.div):b.appendChild(C);let x=null;if(this.textLayerMode!==g.TextLayerMode.DISABLE&&this.textLayerFactory){const ae=document.createElement("div");ae.className="textLayer",ae.style.width=C.style.width,ae.style.height=C.style.height,(null==(K=this.annotationLayer)?void 0:K.div)?b.insertBefore(ae,this.annotationLayer.div):b.appendChild(ae),x=this.textLayerFactory.createTextLayerBuilder(ae,this.id-1,this.viewport,this.textLayerMode===g.TextLayerMode.ENABLE_ENHANCE,this.eventBus,this.textHighlighter)}this.textLayer=x,$e(this,f)!==p.AnnotationMode.DISABLE&&this.annotationLayerFactory&&(this._annotationCanvasMap||(this._annotationCanvasMap=new Map),this.annotationLayer||(this.annotationLayer=this.annotationLayerFactory.createAnnotationLayerBuilder(b,v,null,this.imageResourcesPath,$e(this,f)===p.AnnotationMode.ENABLE_FORMS,this.l10n,null,null,null,null,this._annotationCanvasMap))),(null==(ne=this.xfaLayer)?void 0:ne.div)&&b.appendChild(this.xfaLayer.div);let T=null;this.renderingQueue&&(T=ae=>{if(!this.renderingQueue.isHighestPriority(this))return this.renderingState=g.RenderingStates.PAUSED,void(this.resume=()=>{this.renderingState=g.RenderingStates.RUNNING,ae()});ae()});const I=function(){var ae=S(function*(ce=null){if(N===m.paintTask&&(m.paintTask=null),ce instanceof p.RenderingCancelledException)m._renderError=null;else if(m._renderError=ce,m.renderingState=g.RenderingStates.FINISHED,m.loadingIconDiv&&(m.loadingIconDiv.remove(),delete m.loadingIconDiv),m._resetZoomLayer(!0),m.eventBus.dispatch("pagerendered",{source:m,pageNumber:m.id,cssTransform:!1,timestamp:performance.now(),error:m._renderError}),ce)throw ce});return function(){return ae.apply(this,arguments)}}(),N=this.renderer===g.RendererType.SVG?this.paintOnSvg(C):this.paintOnCanvas(C);N.onRenderContinue=T,this.paintTask=N;const H=N.promise.then(()=>I(null).then(()=>{if(x){const ae=v.streamTextContent({includeMarkedContent:!0});x.setTextContentStream(ae),x.render()}this.annotationLayer&&this._renderAnnotationLayer()}),function(ae){return I(ae)});return this.xfaLayerFactory&&(this.xfaLayer||(this.xfaLayer=this.xfaLayerFactory.createXfaLayerBuilder(b,v,null)),this._renderXfaLayer()),this.structTreeLayerFactory&&this.textLayer&&this.canvas&&(this._onTextLayerRendered=ae=>{ae.pageNumber===this.id&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null,this.canvas&&this.pdfPage.getStructTree().then(ce=>{if(!ce||!this.canvas)return;const Y=this.structTreeLayer.render(ce);Y.classList.add("structTree"),this.canvas.appendChild(Y)}))},this.eventBus._on("textlayerrendered",this._onTextLayerRendered),this.structTreeLayer=this.structTreeLayerFactory.createStructTreeLayerBuilder(v)),b.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),H}paintOnCanvas(m){const b=(0,p.createPromiseCapability)(),v={promise:b.promise,onRenderContinue(Y){Y()},cancel(){ce.cancel()}},C=this.viewport,x=document.createElement("canvas");x.hidden=!0;let T=!0;const I=function(){T&&(x.hidden=!1,T=!1)};m.appendChild(x),this.canvas=x;const N=x.getContext("2d",{alpha:!1}),H=this.outputScale=new g.OutputScale;if(this.useOnlyCssZoom){const Y=C.clone({scale:p.PixelsPerInch.PDF_TO_CSS_UNITS});H.sx*=Y.width/C.width,H.sy*=Y.height/C.height}if(this.maxCanvasPixels>0){const de=Math.sqrt(this.maxCanvasPixels/(C.width*C.height));H.sx>de||H.sy>de?(H.sx=de,H.sy=de,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}const W=(0,g.approximateFraction)(H.sx),K=(0,g.approximateFraction)(H.sy);x.width=(0,g.roundToDivide)(C.width*H.sx,W[0]),x.height=(0,g.roundToDivide)(C.height*H.sy,K[0]),x.style.width=(0,g.roundToDivide)(C.width,W[1])+"px",x.style.height=(0,g.roundToDivide)(C.height,K[1])+"px",this.paintedViewportMap.set(x,C);const ae={canvasContext:N,transform:H.scaled?[H.sx,0,0,H.sy,0,0]:null,viewport:this.viewport,annotationMode:$e(this,f),optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors},ce=this.pdfPage.render(ae);return ce.onContinue=function(Y){I(),v.onRenderContinue?v.onRenderContinue(Y):Y()},ce.promise.then(function(){I(),b.resolve()},function(Y){I(),b.reject(Y)}),v}paintOnSvg(m){let b=!1;const v=()=>{if(b)throw new p.RenderingCancelledException(`Rendering cancelled, page ${this.id}`,"svg")},C=this.pdfPage,x=this.viewport.clone({scale:p.PixelsPerInch.PDF_TO_CSS_UNITS});return{promise:C.getOperatorList({annotationMode:$e(this,f)}).then(I=>(v(),new p.SVGGraphics(C.commonObjs,C.objs).getSVG(I,x).then(H=>{v(),this.svg=H,this.paintedViewportMap.set(H,x),H.style.width=m.style.width,H.style.height=m.style.height,this.renderingState=g.RenderingStates.FINISHED,m.appendChild(H)}))),onRenderContinue(I){I()},cancel(){b=!0}}}setPageLabel(m){this.pageLabel="string"==typeof m?m:null,null!==this.pageLabel?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}}},(le,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.compatibilityParams=_.OptionKind=_.AppOptions=void 0;const h=Object.create(null);_.compatibilityParams=h;{const o=navigator.userAgent||"",a=navigator.platform||"",f=navigator.maxTouchPoints||1,u=/Android/.test(o);(/\b(iPad|iPhone|iPod)(?=;)/.test(o)||"MacIntel"===a&&f>1||u)&&(h.maxCanvasPixels=5242880)}const p={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};_.OptionKind=p;const g={annotationMode:{value:2,kind:p.VIEWER+p.PREFERENCE},cursorToolOnLoad:{value:0,kind:p.VIEWER+p.PREFERENCE},defaultUrl:{value:"compressed.tracemonkey-pldi-09.pdf",kind:p.VIEWER},defaultZoomValue:{value:"",kind:p.VIEWER+p.PREFERENCE},disableHistory:{value:!1,kind:p.VIEWER},disablePageLabels:{value:!1,kind:p.VIEWER+p.PREFERENCE},enablePermissions:{value:!1,kind:p.VIEWER+p.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:p.VIEWER+p.PREFERENCE},enableScripting:{value:!0,kind:p.VIEWER+p.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:p.VIEWER},externalLinkTarget:{value:0,kind:p.VIEWER+p.PREFERENCE},historyUpdateUrl:{value:!1,kind:p.VIEWER+p.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:p.VIEWER+p.PREFERENCE},imageResourcesPath:{value:"./images/",kind:p.VIEWER},maxCanvasPixels:{value:16777216,compatibility:h.maxCanvasPixels,kind:p.VIEWER},pageColorsBackground:{value:"Canvas",kind:p.VIEWER+p.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:p.VIEWER+p.PREFERENCE},pdfBugEnabled:{value:!1,kind:p.VIEWER+p.PREFERENCE},printResolution:{value:150,kind:p.VIEWER},renderer:{value:"canvas",kind:p.VIEWER},sidebarViewOnLoad:{value:-1,kind:p.VIEWER+p.PREFERENCE},scrollModeOnLoad:{value:-1,kind:p.VIEWER+p.PREFERENCE},spreadModeOnLoad:{value:-1,kind:p.VIEWER+p.PREFERENCE},textLayerMode:{value:1,kind:p.VIEWER+p.PREFERENCE},useOnlyCssZoom:{value:!1,kind:p.VIEWER+p.PREFERENCE},viewerCssTheme:{value:0,kind:p.VIEWER+p.PREFERENCE},viewOnLoad:{value:0,kind:p.VIEWER+p.PREFERENCE},cMapPacked:{value:!0,kind:p.API},cMapUrl:{value:"../web/cmaps/",kind:p.API},disableAutoFetch:{value:!1,kind:p.API+p.PREFERENCE},disableFontFace:{value:!1,kind:p.API+p.PREFERENCE},disableRange:{value:!1,kind:p.API+p.PREFERENCE},disableStream:{value:!1,kind:p.API+p.PREFERENCE},docBaseUrl:{value:"",kind:p.API},enableXfa:{value:!0,kind:p.API+p.PREFERENCE},fontExtraProperties:{value:!1,kind:p.API},isEvalSupported:{value:!0,kind:p.API},maxImageSize:{value:-1,kind:p.API},pdfBug:{value:!1,kind:p.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:p.API},verbosity:{value:1,kind:p.API},workerPort:{value:null,kind:p.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:p.WORKER}};g.disablePreferences={value:!1,kind:p.VIEWER},g.locale={value:navigator.language||"en-US",kind:p.VIEWER},g.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:p.VIEWER},g.renderer.kind+=p.PREFERENCE;const c=Object.create(null);_.AppOptions=class{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(a){var m;const f=c[a];if(void 0!==f)return f;const u=g[a];return void 0!==u?null!=(m=u.compatibility)?m:u.value:void 0}static getAll(a=null){var u;const f=Object.create(null);for(const m in g){const b=g[m];if(a){if(0==(a&b.kind))continue;if(a===p.PREFERENCE){const C=b.value,x=typeof C;if("boolean"===x||"string"===x||"number"===x&&Number.isInteger(C)){f[m]=C;continue}throw new Error(`Invalid type for preference: ${m}`)}}const v=c[m];f[m]=void 0!==v?v:null!=(u=b.compatibility)?u:b.value}return f}static set(a,f){c[a]=f}static setAll(a){for(const f in a)c[f]=a[f]}static remove(a){delete c[a]}static _hasUserOptions(){return Object.keys(c).length>0}}},(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.PDFRenderingQueue=void 0;var p=h(3),g=h(6);_.PDFRenderingQueue=class{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(a){this.pdfViewer=a}setThumbnailViewer(a){this.pdfThumbnailViewer=a}isHighestPriority(a){return this.highestPriorityPage===a.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(a){var f;this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(a)&&(this.isThumbnailViewEnabled&&(null==(f=this.pdfThumbnailViewer)?void 0:f.forceRendering())||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),3e4)))}getHighestPriority(a,f,u,m=!1){const b=a.views,v=b.length;if(0===v)return null;for(let N=0;N<v;N++){const H=b[N].view;if(!this.isViewFinished(H))return H}const C=a.first.id,x=a.last.id;if(x-C+1>v){const N=a.ids;for(let H=1,W=x-C;H<W;H++){const K=u?C+H:x-H;if(N.has(K))continue;const ne=f[K-1];if(!this.isViewFinished(ne))return ne}}let T=u?x:C-2,I=f[T];return I&&!this.isViewFinished(I)||m&&(T+=u?1:-1,I=f[T],I&&!this.isViewFinished(I))?I:null}isViewFinished(a){return a.renderingState===g.RenderingStates.FINISHED}renderView(a){switch(a.renderingState){case g.RenderingStates.FINISHED:return!1;case g.RenderingStates.PAUSED:this.highestPriorityPage=a.renderingId,a.resume();break;case g.RenderingStates.RUNNING:this.highestPriorityPage=a.renderingId;break;case g.RenderingStates.INITIAL:this.highestPriorityPage=a.renderingId,a.draw().finally(()=>{this.renderHighestPriority()}).catch(f=>{f instanceof p.RenderingCancelledException||console.error(`renderView: "${f}"`)})}return!0}}},(le,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.TextHighlighter=void 0,_.TextHighlighter=class{constructor({findController:g,eventBus:c,pageIndex:l}){this.findController=g,this.matches=[],this.eventBus=c,this.pageIdx=l,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(g,c){this.textDivs=g,this.textContentItemsStr=c}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=g=>{(g.pageIndex===this.pageIdx||-1===g.pageIndex)&&this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){!this.enabled||(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null))}_convertMatches(g,c){if(!g)return[];const{textContentItemsStr:l}=this;let o=0,a=0;const f=l.length-1,u=[];for(let m=0,b=g.length;m<b;m++){let v=g[m];for(;o!==f&&v>=a+l[o].length;)a+=l[o].length,o++;o===l.length&&console.error("Could not find a matching mapping");const C={begin:{divIdx:o,offset:v-a}};for(v+=c[m];o!==f&&v>a+l[o].length;)a+=l[o].length,o++;C.end={divIdx:o,offset:v-a},u.push(C)}return u}_renderMatches(g){if(0===g.length)return;const{findController:c,pageIdx:l}=this,{textContentItemsStr:o,textDivs:a}=this,f=l===c.selected.pageIdx,u=c.selected.matchIdx;let b=null;function C(N,H){const W=N.divIdx;return a[W].textContent="",x(W,0,N.offset,H)}function x(N,H,W,K){let ne=a[N];if(ne.nodeType===Node.TEXT_NODE){const Y=document.createElement("span");ne.parentNode.insertBefore(Y,ne),Y.appendChild(ne),a[N]=Y,ne=Y}const ae=o[N].substring(H,W),ce=document.createTextNode(ae);if(K){const Y=document.createElement("span");return Y.className=`${K} appended`,Y.appendChild(ce),ne.appendChild(Y),K.includes("selected")?Y.offsetLeft:0}return ne.appendChild(ce),0}let T=u,I=T+1;if(c.state.highlightAll)T=0,I=g.length;else if(!f)return;for(let N=T;N<I;N++){const H=g[N],W=H.begin,K=H.end,ne=f&&N===u,ae=ne?" selected":"";let ce=0;if(b&&W.divIdx===b.divIdx?x(b.divIdx,b.offset,W.offset):(null!==b&&x(b.divIdx,b.offset,undefined),C(W)),W.divIdx===K.divIdx)ce=x(W.divIdx,W.offset,K.offset,"highlight"+ae);else{ce=x(W.divIdx,W.offset,undefined,"highlight begin"+ae);for(let Y=W.divIdx+1,de=K.divIdx;Y<de;Y++)a[Y].className="highlight middle"+ae;C(K,"highlight end"+ae)}b=K,ne&&c.scrollMatchIntoView({element:a[W.divIdx],selectedLeft:ce,pageIndex:l,matchIndex:u})}b&&x(b.divIdx,b.offset,undefined)}_updateMatches(){if(!this.enabled)return;const{findController:g,matches:c,pageIdx:l}=this,{textContentItemsStr:o,textDivs:a}=this;let f=-1;for(let b=0,v=c.length;b<v;b++){const C=c[b];for(let T=Math.max(f,C.begin.divIdx),I=C.end.divIdx;T<=I;T++){const N=a[T];N.textContent=o[T],N.className=""}f=C.end.divIdx+1}(null==g?void 0:g.highlightMatches)&&(this.matches=this._convertMatches(g.pageMatches[l]||null,g.pageMatchesLength[l]||null),this._renderMatches(this.matches))}}},(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.DownloadManager=void 0;var p=h(3);function g(l,o){const a=document.createElement("a");if(!a.click)throw new Error('DownloadManager: "a.click()" is not supported.');a.href=l,a.target="_parent","download"in a&&(a.download=o),(document.body||document.documentElement).appendChild(a),a.click(),a.remove()}_.DownloadManager=class{constructor(){this._openBlobUrls=new WeakMap}downloadUrl(o,a){(0,p.createValidAbsoluteUrl)(o,"http://example.com")?g(o+"#pdfjs.action=download",a):console.error(`downloadUrl - not a valid URL: ${o}`)}downloadData(o,a,f){g(URL.createObjectURL(new Blob([o],{type:f})),a)}openOrDownloadData(o,a,f){const u=(0,p.isPdfFile)(f),m=u?"application/pdf":"";if(u){let v,b=this._openBlobUrls.get(o);b||(b=URL.createObjectURL(new Blob([a],{type:m})),this._openBlobUrls.set(o,b)),v="?file="+encodeURIComponent(b+"#"+f);try{return window.open(v),!0}catch(C){console.error(`openOrDownloadData: ${C}`),URL.revokeObjectURL(b),this._openBlobUrls.delete(o)}}return this.downloadData(a,f,m),!1}download(o,a,f,u="download"){g(URL.createObjectURL(o),f)}}},(le,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.WaitOnType=_.EventBus=_.AutomationEventBus=void 0,_.waitOnEventOrTimeout=function({target:l,name:o,delay:a=0}){return new Promise(function(f,u){if("object"!=typeof l||!o||"string"!=typeof o||!(Number.isInteger(a)&&a>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function m(x){l instanceof g?l._off(o,b):l.removeEventListener(o,b),C&&clearTimeout(C),f(x)}const b=m.bind(null,h.EVENT);l instanceof g?l._on(o,b):l.addEventListener(o,b);const v=m.bind(null,h.TIMEOUT),C=setTimeout(v,a)})};const h={EVENT:"event",TIMEOUT:"timeout"};_.WaitOnType=h;class g{constructor(){this._listeners=Object.create(null)}on(o,a,f=null){this._on(o,a,{external:!0,once:null==f?void 0:f.once})}off(o,a,f=null){this._off(o,a,{external:!0,once:null==f?void 0:f.once})}dispatch(o,a){const f=this._listeners[o];if(!f||0===f.length)return;let u;for(const{listener:m,external:b,once:v}of f.slice(0))v&&this._off(o,m),b?(u||(u=[])).push(m):m(a);if(u){for(const m of u)m(a);u=null}}_on(o,a,f=null){var m;((m=this._listeners)[o]||(m[o]=[])).push({listener:a,external:!0===(null==f?void 0:f.external),once:!0===(null==f?void 0:f.once)})}_off(o,a,f=null){const u=this._listeners[o];if(u)for(let m=0,b=u.length;m<b;m++)if(u[m].listener===a)return void u.splice(m,1)}}_.EventBus=g,_.AutomationEventBus=class extends g{dispatch(o,a){throw new Error("Not implemented: AutomationEventBus.dispatch")}}},(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.GenericL10n=void 0,h(19);var p=h(4);const g=document.webL10n;_.GenericL10n=class{constructor(o){this._lang=o,this._ready=new Promise((a,f)=>{g.setLanguage((0,p.fixupLangCode)(o),()=>{a(g)})})}getLanguage(){var o=this;return S(function*(){return(yield o._ready).getLanguage()})()}getDirection(){var o=this;return S(function*(){return(yield o._ready).getDirection()})()}get(o,a=null,f=(0,p.getL10nFallback)(o,a)){var u=this;return S(function*(){return(yield u._ready).get(o,a,f)})()}translate(o){var a=this;return S(function*(){return(yield a._ready).translate(o)})()}}},()=>{document.webL10n=function(le,_,h){var p={},g="",c="textContent",l="",o={},a="loading";function C(Y,de,fe){de=de||function(L){},fe=fe||function(){};var me=new XMLHttpRequest;me.open("GET",Y,!0),me.overrideMimeType&&me.overrideMimeType("text/plain; charset=utf-8"),me.onreadystatechange=function(){4==me.readyState&&(200==me.status||0===me.status?de(me.responseText):fe())},me.onerror=fe,me.ontimeout=fe;try{me.send(null)}catch(B){fe()}}function x(Y,de,fe,me){var B=Y.replace(/[^\/]*$/,"")||"./";function L(M){return M.lastIndexOf("\\")<0?M:M.replace(/\\\\/g,"\\").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}C(Y,function(M){g+=M,function(M,E){var P={},A=/^\s*|\s*$/,k=/^\s*#|^\s*$/,R=/^\s*\[(.*)\]\s*$/,j=/^\s*@import\s+url\((.*)\)\s*$/i,z=/^([^=\s]*)\s*=\s*(.+)$/;function Q(se,J,X){var he=se.replace(A,"").split(/[\r\n]+/),_e="*",te=de.split("-",1)[0],ue=!1,ge="";!function U(){for(;;){if(!he.length)return void X();var q=he.shift();if(!k.test(q)){if(J){if(ge=R.exec(q)){_e=ge[1].toLowerCase(),ue="*"!==_e&&_e!==de&&_e!==te;continue}if(ue)continue;if(ge=j.exec(q))return void ee(B+ge[1],U)}var Z=q.match(z);Z&&3==Z.length&&(P[Z[1]]=L(Z[2]))}}}()}function ee(se,J){C(se,function(X){Q(X,!1,J)},function(){console.warn(se+" not found."),J()})}Q(M,!0,function(){!function(E){for(var P in E){var A,k,R=P.lastIndexOf(".");R>0?(A=P.substring(0,R),k=P.substring(R+1)):(A=P,k=c),p[A]||(p[A]={}),p[A][k]=E[P]}fe&&fe()}(P)})}(M)},me)}function H(Y,de,fe){var me=p[Y];if(!me){if(console.warn("#"+Y+" is undefined."),!fe)return null;me=fe}var B={};for(var L in me){var D=me[L];D=K(D=W(D,de,Y,L),de,Y),B[L]=D}return B}function W(Y,de,fe,me){var L=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/.exec(Y);if(!L||!L.length)return Y;var E,D=L[1],M=L[2];return de&&M in de?E=de[M]:M in p&&(E=p[M]),D in o&&(Y=(0,o[D])(Y,E,fe,me)),Y}function K(Y,de,fe){return Y.replace(/\{\{\s*(.+?)\s*\}\}/g,function(B,L){return de&&L in de?de[L]:L in p?p[L]:(console.log("argument {{"+L+"}} for #"+fe+" is undefined."),B)})}function ne(Y){var de=function(Y){if(!Y)return{};var de=Y.getAttribute("data-l10n-id"),fe=Y.getAttribute("data-l10n-args"),me={};if(fe)try{me=JSON.parse(fe)}catch(B){console.warn("could not parse arguments for #"+de)}return{id:de,args:me}}(Y);if(de.id){var fe=H(de.id,de.args);if(!fe)return void console.warn("#"+de.id+" is undefined.");if(fe[c]){if(0===function(Y){if(Y.children)return Y.children.length;if(void 0!==Y.childElementCount)return Y.childElementCount;for(var de=0,fe=0;fe<Y.childNodes.length;fe++)de+=1===Y.nodeType?1:0;return de}(Y))Y[c]=fe[c];else{for(var me=Y.childNodes,B=!1,L=0,D=me.length;L<D;L++)3===me[L].nodeType&&/\S/.test(me[L].nodeValue)&&(B?me[L].nodeValue="":(me[L].nodeValue=fe[c],B=!0));if(!B){var M=_.createTextNode(fe[c]);Y.insertBefore(M,Y.firstChild)}}delete fe[c]}for(var E in fe)Y[E]=fe[E]}}return o.plural=function(Y,de,fe,me){var B=parseFloat(de);if(isNaN(B)||me!=c)return Y;o._pluralRules||(o._pluralRules=function(Y){function fe(D,M){return-1!==M.indexOf(D)}function me(D,M,E){return M<=D&&D<=E}var B={0:function(D){return"other"},1:function(D){return me(D%100,3,10)?"few":0===D?"zero":me(D%100,11,99)?"many":2==D?"two":1==D?"one":"other"},2:function(D){return 0!==D&&D%10==0?"many":2==D?"two":1==D?"one":"other"},3:function(D){return 1==D?"one":"other"},4:function(D){return me(D,0,1)?"one":"other"},5:function(D){return me(D,0,2)&&2!=D?"one":"other"},6:function(D){return 0===D?"zero":D%10==1&&D%100!=11?"one":"other"},7:function(D){return 2==D?"two":1==D?"one":"other"},8:function(D){return me(D,3,6)?"few":me(D,7,10)?"many":2==D?"two":1==D?"one":"other"},9:function(D){return 0===D||1!=D&&me(D%100,1,19)?"few":1==D?"one":"other"},10:function(D){return me(D%10,2,9)&&!me(D%100,11,19)?"few":D%10!=1||me(D%100,11,19)?"other":"one"},11:function(D){return me(D%10,2,4)&&!me(D%100,12,14)?"few":D%10==0||me(D%10,5,9)||me(D%100,11,14)?"many":D%10==1&&D%100!=11?"one":"other"},12:function(D){return me(D,2,4)?"few":1==D?"one":"other"},13:function(D){return me(D%10,2,4)&&!me(D%100,12,14)?"few":1!=D&&me(D%10,0,1)||me(D%10,5,9)||me(D%100,12,14)?"many":1==D?"one":"other"},14:function(D){return me(D%100,3,4)?"few":D%100==2?"two":D%100==1?"one":"other"},15:function(D){return 0===D||me(D%100,2,10)?"few":me(D%100,11,19)?"many":1==D?"one":"other"},16:function(D){return D%10==1&&11!=D?"one":"other"},17:function(D){return 3==D?"few":0===D?"zero":6==D?"many":2==D?"two":1==D?"one":"other"},18:function(D){return 0===D?"zero":me(D,0,2)&&0!==D&&2!=D?"one":"other"},19:function(D){return me(D,2,10)?"few":me(D,0,1)?"one":"other"},20:function(D){return!me(D%10,3,4)&&D%10!=9||me(D%100,10,19)||me(D%100,70,79)||me(D%100,90,99)?D%1e6==0&&0!==D?"many":D%10!=2||fe(D%100,[12,72,92])?D%10!=1||fe(D%100,[11,71,91])?"other":"one":"two":"few"},21:function(D){return 0===D?"zero":1==D?"one":"other"},22:function(D){return me(D,0,1)||me(D,11,99)?"one":"other"},23:function(D){return me(D%10,1,2)||D%20==0?"one":"other"},24:function(D){return me(D,3,10)||me(D,13,19)?"few":fe(D,[2,12])?"two":fe(D,[1,11])?"one":"other"}},L={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3}[Y.replace(/-.*$/,"")];return L in B?B[L]:(console.warn("plural form unknown for ["+Y+"]"),function(){return"other"})}(l));var L="["+o._pluralRules(B)+"]";return 0===B&&fe+"[zero]"in p?Y=p[fe+"[zero]"][me]:1==B&&fe+"[one]"in p?Y=p[fe+"[one]"][me]:2==B&&fe+"[two]"in p?Y=p[fe+"[two]"][me]:fe+L in p?Y=p[fe+L][me]:fe+"[other]"in p&&(Y=p[fe+"[other]"][me]),Y},{get:function(Y,de,fe){var L,me=Y.lastIndexOf("."),B=c;me>0&&(B=Y.substring(me+1),Y=Y.substring(0,me)),fe&&((L={})[B]=fe);var D=H(Y,de,L);return D&&B in D?D[B]:"{{"+Y+"}}"},getData:function(){return p},getText:function(){return g},getLanguage:function(){return l},setLanguage:function(Y,de){!function(Y,de){Y&&(Y=Y.toLowerCase()),de=de||function(){},p={},g="",l="",l=Y;var fe=_.querySelectorAll('link[type="application/l10n"]'),me=fe.length;if(0!==me){var M,E=0;M=function(){++E>=me&&(de(),a="complete")};for(var A=0;A<me;A++)new P(fe[A]).load(Y,M)}else{var B=function(){var Y=_.querySelector('script[type="application/l10n"]');return Y?JSON.parse(Y.innerHTML):null}();if(B&&B.locales&&B.default_locale){if(console.log("using the embedded JSON directory, early way out"),!(p=B.locales[Y])){var L=B.default_locale.toLowerCase();for(var D in B.locales){if((D=D.toLowerCase())===Y){p=B.locales[Y];break}D===L&&(p=B.locales[L])}}de()}else console.log("no resource to load, early way out");a="complete"}function P(R){var j=R.href;this.load=function(z,Q){x(j,z,Q,function(){console.warn(j+" not found."),console.warn('"'+z+'" resource not found'),l="",Q()})}}}(Y,function(){de&&de()})},getDirection:function(){var de=l.split("-",1)[0];return["ar","he","fa","ps","ur"].indexOf(de)>=0?"rtl":"ltr"},translate:function(Y){for(var de=function(Y){return Y?Y.querySelectorAll("*[data-l10n-id]"):[]}(Y=Y||_.documentElement),fe=de.length,me=0;me<fe;me++)ne(de[me]);ne(Y)},getReadyState:function(){return a},ready:function(Y){Y&&("complete"==a||"interactive"==a?le.setTimeout(function(){Y()}):_.addEventListener&&_.addEventListener("localized",function de(){_.removeEventListener("localized",de),Y()}))}}}(window,document)},(le,_,h)=>{var K,sN,ae,PC,Y,MC,fe,oN,B,aN,D,lN,E,OC,A,cN,R,uN,z,eg,ee,qc,J,Va,he,hN,te,IC,ge,kC,q,tg,Se,dN,Te,RC,Oe,fN,qe,Qc;Object.defineProperty(_,"__esModule",{value:!0}),_.PDFFindController=_.FindState=void 0;var p=h(6),g=h(3),c=h(21);const l={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};_.FindState=l;const u={"\u2010":"-","\u2018":"'","\u2019":"'","\u201a":"'","\u201b":"'","\u201c":'"',"\u201d":'"',"\u201e":'"',"\u201f":'"',"\xbc":"1/4","\xbd":"1/2","\xbe":"3/4"},m=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]),b=[...m.values()].map(Ce=>String.fromCharCode(Ce)).join(""),v=/\p{M}+/gu,C=/([.*+?^${}()|[\]\\])|(\p{P})|(\s+)|(\p{M})|(\p{L})/gu,x=/([^\p{M}])\p{M}*$/u,T=/^\p{M}*([^\p{M}])/u;let I=null;function N(Ce){if(!I){const bt=Object.keys(u).join("");I=new RegExp(`([${bt}])|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|(\\n)`,"gum")}const re=[];let oe;for(;null!==(oe=v.exec(Ce));)re.push([oe[0].length,oe.index]);let De=Ce.normalize("NFD");const Me=[[0,0]];let Be=0,Ve=0,ut=0,mt=0,et=!1;return De=De.replace(I,(bt,Ke,Ft,jn,kt,We)=>{var Vn;if(We-=ut,Ke){const Jn=u[bt],dn=Jn.length;for(let vn=1;vn<dn;vn++)Me.push([We-Ve+vn,Ve-vn]);return Ve-=dn-1,Jn}if(Ft){const Jn=Ft.endsWith("\n"),dn=Jn?Ft.length-2:Ft.length;et=!0;let vn=dn;We+mt===(null==(Vn=re[Be])?void 0:Vn[1])&&(vn-=re[Be][0],++Be);for(let $t=1;$t<vn+1;$t++)Me.push([We-1-Ve+$t,Ve-$t]);return Ve-=vn,ut+=vn,Jn?(Me.push([(We+=dn-1)-Ve+1,1+Ve]),Ve+=1,ut+=1,mt+=1,Ft.slice(0,dn)):Ft}return jn?(Me.push([We-Ve+1,1+Ve]),Ve+=1,ut+=1,mt+=1,jn.charAt(0)):(Me.push([We-Ve+1,Ve-1]),Ve-=1,ut+=1,mt+=1," ")}),Me.push([De.length,Ve]),[De,Me,et]}function H(Ce,re,oe){if(!Ce)return[re,oe];const De=re,Me=re+oe;let Be=(0,p.binarySearchFirstItem)(Ce,ut=>ut[0]>=De);Ce[Be][0]>De&&--Be;let Ve=(0,p.binarySearchFirstItem)(Ce,ut=>ut[0]>=Me,Be);return Ce[Ve][0]>Me&&--Ve,[De+Ce[Be][1],oe+Ce[Ve][1]-Ce[Be][1]]}K=new WeakSet,sN=function(re){if(!re)return;const oe=this._pdfDocument,{type:De}=re;(null===this._state||Xe(this,fe,oN).call(this,re))&&(this._dirtyMatch=!0),this._state=re,"highlightallchange"!==De&&Xe(this,qe,Qc).call(this,l.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||oe&&this._pdfDocument!==oe)return;Xe(this,R,uN).call(this);const Me=!this._highlightMatches,Be=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),De?this._dirtyMatch?Xe(this,J,Va).call(this):"again"===De?(Xe(this,J,Va).call(this),Me&&this._state.highlightAll&&Xe(this,ee,qc).call(this)):"highlightallchange"===De?(Be?Xe(this,J,Va).call(this):this._highlightMatches=!0,Xe(this,ee,qc).call(this)):Xe(this,J,Va).call(this):this._findTimeout=setTimeout(()=>{Xe(this,J,Va).call(this),this._findTimeout=null},250)})},ae=new WeakSet,PC=function(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this._state=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=(0,g.createPromiseCapability)()},Y=new WeakSet,MC=function(){return this._state.query!==this._rawQuery&&(this._rawQuery=this._state.query,[this._normalizedQuery]=N(this._state.query)),this._normalizedQuery},fe=new WeakSet,oN=function(re){if(re.query!==this._state.query)return!0;switch(re.type){case"again":const oe=this._selected.pageIdx+1,De=this._linkService;return oe>=1&&oe<=De.pagesCount&&oe!==De.page&&!De.isPageVisible(oe);case"highlightallchange":return!1}return!0},B=new WeakSet,aN=function(re,oe,De){let Me=re.slice(0,oe).match(x);if(Me){const Be=re.charCodeAt(oe),Ve=Me[1].charCodeAt(0);if((0,c.getCharacterType)(Be)===(0,c.getCharacterType)(Ve))return!1}if(Me=re.slice(oe+De).match(T),Me){const Be=re.charCodeAt(oe+De-1),Ve=Me[1].charCodeAt(0);if((0,c.getCharacterType)(Be)===(0,c.getCharacterType)(Ve))return!1}return!0},D=new WeakSet,lN=function(re,oe,De,Me){const Be=[],Ve=[],ut=this._pageDiffs[De];let mt;for(;null!==(mt=re.exec(Me));){if(oe&&!Xe(this,B,aN).call(this,Me,mt.index,mt[0].length))continue;const[et,bt]=H(ut,mt.index,mt[0].length);bt&&(Be.push(et),Ve.push(bt))}this._pageMatches[De]=Be,this._pageMatchesLength[De]=Ve},E=new WeakSet,OC=function(re,oe){const{matchDiacritics:De}=this._state;let Me=!1;return(re=re.replace(C,(Ve,ut,mt,et,bt,Ke)=>ut?`[ ]*\\${ut}[ ]*`:mt?`[ ]*${mt}[ ]*`:et?"[ ]+":De?bt||Ke:bt?m.has(bt.charCodeAt(0))?bt:"":oe?(Me=!0,`${Ke}\\p{M}*`):Ke)).endsWith("[ ]*")&&(re=re.slice(0,re.length-"[ ]*".length)),De&&oe&&(Me=!0,re=`${re}(?=[${b}]|[^\\p{M}]|$)`),[Me,re]},A=new WeakSet,cN=function(re){let oe=$e(this,Y,MC);if(0===oe.length)return;const{caseSensitive:De,entireWord:Me,phraseSearch:Be}=this._state,Ve=this._pageContents[re],ut=this._hasDiacritics[re];let mt=!1;if(Be)[mt,oe]=Xe(this,E,OC).call(this,oe,ut);else{const Ke=oe.match(/\S+/g);Ke&&(oe=Ke.sort().reverse().map(Ft=>{const[jn,kt]=Xe(this,E,OC).call(this,Ft,ut);return mt||(mt=jn),`(${kt})`}).join("|"))}oe=new RegExp(oe,`g${mt?"u":""}${De?"":"i"}`),Xe(this,D,lN).call(this,oe,Me,re,Ve),this._state.highlightAll&&Xe(this,z,eg).call(this,re),this._resumePageIdx===re&&(this._resumePageIdx=null,Xe(this,te,IC).call(this));const bt=this._pageMatches[re].length;bt>0&&(this._matchesCountTotal+=bt,Xe(this,Oe,fN).call(this))},R=new WeakSet,uN=function(){if(this._extractTextPromises.length>0)return;let re=Promise.resolve();for(let oe=0,De=this._linkService.pagesCount;oe<De;oe++){const Me=(0,g.createPromiseCapability)();this._extractTextPromises[oe]=Me.promise,re=re.then(()=>this._pdfDocument.getPage(oe+1).then(Be=>Be.getTextContent()).then(Be=>{const Ve=[];for(const ut of Be.items)Ve.push(ut.str),ut.hasEOL&&Ve.push("\n");[this._pageContents[oe],this._pageDiffs[oe],this._hasDiacritics[oe]]=N(Ve.join("")),Me.resolve()},Be=>{console.error(`Unable to get text content for page ${oe+1}`,Be),this._pageContents[oe]="",this._pageDiffs[oe]=null,this._hasDiacritics[oe]=!1,Me.resolve()}))}},z=new WeakSet,eg=function(re){this._scrollMatches&&this._selected.pageIdx===re&&(this._linkService.page=re+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:re})},ee=new WeakSet,qc=function(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})},J=new WeakSet,Va=function(){const re=this._state.findPrevious,oe=this._linkService.page-1,De=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=oe,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this._matchesCountTotal=0,Xe(this,ee,qc).call(this);for(let Be=0;Be<De;Be++)this._pendingFindMatches.has(Be)||(this._pendingFindMatches.add(Be),this._extractTextPromises[Be].then(()=>{this._pendingFindMatches.delete(Be),Xe(this,A,cN).call(this,Be)}))}if(""===$e(this,Y,MC))return void Xe(this,qe,Qc).call(this,l.FOUND);if(this._resumePageIdx)return;const Me=this._offset;if(this._pagesToSearch=De,null!==Me.matchIdx){const Be=this._pageMatches[Me.pageIdx].length;if(!re&&Me.matchIdx+1<Be||re&&Me.matchIdx>0)return Me.matchIdx=re?Me.matchIdx-1:Me.matchIdx+1,void Xe(this,q,tg).call(this,!0);Xe(this,ge,kC).call(this,re)}Xe(this,te,IC).call(this)},he=new WeakSet,hN=function(re){const oe=this._offset,De=re.length,Me=this._state.findPrevious;return De?(oe.matchIdx=Me?De-1:0,Xe(this,q,tg).call(this,!0),!0):(Xe(this,ge,kC).call(this,Me),!!(oe.wrapped&&(oe.matchIdx=null,this._pagesToSearch<0))&&(Xe(this,q,tg).call(this,!1),!0))},te=new WeakSet,IC=function(){null!==this._resumePageIdx&&console.error("There can only be one pending page.");let re=null;do{const oe=this._offset.pageIdx;if(re=this._pageMatches[oe],!re){this._resumePageIdx=oe;break}}while(!Xe(this,he,hN).call(this,re))},ge=new WeakSet,kC=function(re){const oe=this._offset,De=this._linkService.pagesCount;oe.pageIdx=re?oe.pageIdx-1:oe.pageIdx+1,oe.matchIdx=null,this._pagesToSearch--,(oe.pageIdx>=De||oe.pageIdx<0)&&(oe.pageIdx=re?De-1:0,oe.wrapped=!0)},q=new WeakSet,tg=function(re=!1){let oe=l.NOT_FOUND;const De=this._offset.wrapped;if(this._offset.wrapped=!1,re){const Me=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,oe=De?l.WRAPPED:l.FOUND,-1!==Me&&Me!==this._selected.pageIdx&&Xe(this,z,eg).call(this,Me)}Xe(this,qe,Qc).call(this,oe,this._state.findPrevious),-1!==this._selected.pageIdx&&(this._scrollMatches=!0,Xe(this,z,eg).call(this,this._selected.pageIdx))},Se=new WeakSet,dN=function(re){const oe=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||oe&&this._pdfDocument!==oe||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),Xe(this,qe,Qc).call(this,l.FOUND),this._highlightMatches=!1,Xe(this,ee,qc).call(this))})},Te=new WeakSet,RC=function(){var Be;const{pageIdx:re,matchIdx:oe}=this._selected;let De=0,Me=this._matchesCountTotal;if(-1!==oe){for(let Ve=0;Ve<re;Ve++)De+=(null==(Be=this._pageMatches[Ve])?void 0:Be.length)||0;De+=oe+1}return(De<1||De>Me)&&(De=Me=0),{current:De,total:Me}},Oe=new WeakSet,fN=function(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:Xe(this,Te,RC).call(this)})},qe=new WeakSet,Qc=function(re,oe=!1){var De,Me;this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:re,previous:oe,matchesCount:Xe(this,Te,RC).call(this),rawQuery:null!=(Me=null==(De=this._state)?void 0:De.query)?Me:null})},_.PDFFindController=class{constructor({linkService:re,eventBus:oe}){Ze(this,K),Ze(this,ae),Ze(this,Y),Ze(this,fe),Ze(this,B),Ze(this,D),Ze(this,E),Ze(this,A),Ze(this,R),Ze(this,z),Ze(this,ee),Ze(this,J),Ze(this,he),Ze(this,te),Ze(this,ge),Ze(this,q),Ze(this,Se),Ze(this,Te),Ze(this,Oe),Ze(this,qe),this._linkService=re,this._eventBus=oe,Xe(this,ae,PC).call(this),oe._on("find",Xe(this,K,sN).bind(this)),oe._on("findbarclose",Xe(this,Se,dN).bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this._state}setDocument(re){this._pdfDocument&&Xe(this,ae,PC).call(this),re&&(this._pdfDocument=re,this._firstPageCapability.resolve())}scrollMatchIntoView({element:re=null,selectedLeft:oe=0,pageIndex:De=-1,matchIndex:Me=-1}){this._scrollMatches&&re&&-1!==Me&&Me===this._selected.matchIdx&&-1!==De&&De===this._selected.pageIdx&&(this._scrollMatches=!1,(0,p.scrollIntoView)(re,{top:-50,left:oe+-400},!0))}}},(le,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.CharacterType=void 0,_.getCharacterType=function(C){return function(C){return C<11904}(C)?function(C){return 0==(65408&C)}(C)?function(C){return 32===C||9===C||13===C||10===C}(C)?h.SPACE:function(C){return C>=97&&C<=122||C>=65&&C<=90}(C)||function(C){return C>=48&&C<=57}(C)||95===C?h.ALPHA_LETTER:h.PUNCT:function(C){return 3584==(65408&C)}(C)?h.THAI_LETTER:160===C?h.SPACE:h.ALPHA_LETTER:function(C){return C>=13312&&C<=40959||C>=63744&&C<=64255}(C)?h.HAN_LETTER:function(C){return C>=12448&&C<=12543}(C)?h.KATAKANA_LETTER:function(C){return C>=12352&&C<=12447}(C)?h.HIRAGANA_LETTER:function(C){return C>=65376&&C<=65439}(C)?h.HALFWIDTH_KATAKANA_LETTER:h.ALPHA_LETTER};const h={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};_.CharacterType=h},(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.PDFHistory=void 0,_.isDestArraysEqual=m,_.isDestHashesEqual=u;var p=h(6),g=h(17);function a(){return document.location.hash}function u(b,v){return"string"==typeof b&&"string"==typeof v&&(b===v||(0,p.parseQueryString)(b).get("nameddest")===v)}function m(b,v){function C(x,T){if(typeof x!=typeof T||Array.isArray(x)||Array.isArray(T))return!1;if(null!==x&&"object"==typeof x&&null!==T){if(Object.keys(x).length!==Object.keys(T).length)return!1;for(const I in x)if(!C(x[I],T[I]))return!1;return!0}return x===T||Number.isNaN(x)&&Number.isNaN(T)}if(!Array.isArray(b)||!Array.isArray(v)||b.length!==v.length)return!1;for(let x=0,T=b.length;x<T;x++)if(!C(b[x],v[x]))return!1;return!0}_.PDFHistory=class{constructor({linkService:v,eventBus:C}){this.linkService=v,this.eventBus=C,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",x=>{this._isPagesLoaded=!!x.pagesCount},{once:!0})})}initialize({fingerprint:v,resetHistory:C=!1,updateUrl:x=!1}){if(!v||"string"!=typeof v)return void console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');this._initialized&&this.reset();const T=""!==this._fingerprint&&this._fingerprint!==v;this._fingerprint=v,this._updateUrl=!0===x,this._initialized=!0,this._bindEvents();const I=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=a(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(I,!0)||C){const{hash:H,page:W,rotation:K}=this._parseCurrentHash(!0);return!H||T||C?void this._pushOrReplaceState(null,!0):void this._pushOrReplaceState({hash:H,page:W,rotation:K},!0)}const N=I.destination;this._updateInternalState(N,I.uid,!0),void 0!==N.rotation&&(this._initialRotation=N.rotation),N.dest?(this._initialBookmark=JSON.stringify(N.dest),this._destination.page=null):N.hash?this._initialBookmark=N.hash:N.page&&(this._initialBookmark=`page=${N.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:v=null,explicitDest:C,pageNumber:x}){if(!this._initialized)return;if(v&&"string"!=typeof v)return void console.error(`PDFHistory.push: "${v}" is not a valid namedDest parameter.`);if(!Array.isArray(C))return void console.error(`PDFHistory.push: "${C}" is not a valid explicitDest parameter.`);if(!this._isValidPage(x)&&(null!==x||this._destination))return void console.error(`PDFHistory.push: "${x}" is not a valid pageNumber parameter.`);const T=v||JSON.stringify(C);if(!T)return;let I=!1;if(this._destination&&(u(this._destination.hash,T)||m(this._destination.dest,C))){if(this._destination.page)return;I=!0}this._popStateInProgress&&!I||(this._pushOrReplaceState({dest:C,hash:T,page:x,rotation:this.linkService.rotation},I),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(v){var C;if(this._initialized){if(!this._isValidPage(v))return void console.error(`PDFHistory.pushPage: "${v}" is not a valid page number.`);(null==(C=this._destination)?void 0:C.page)!==v&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${v}`,page:v,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const v=window.history.state;this._isValidState(v)&&v.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const v=window.history.state;this._isValidState(v)&&v.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(v,C=!1){const x=C||!this._destination,T={fingerprint:this._fingerprint,uid:x?this._uid:this._uid+1,destination:v};let I;if(this._updateInternalState(v,T.uid),this._updateUrl&&(null==v?void 0:v.hash)){const N=document.location.href.split("#")[0];N.startsWith("file://")||(I=`${N}#${v.hash}`)}x?window.history.replaceState(T,"",I):window.history.pushState(T,"",I)}_tryPushCurrentPosition(v=!1){if(!this._position)return;let C=this._position;if(v&&(C=Object.assign(Object.create(null),this._position),C.temporary=!0),!this._destination)return void this._pushOrReplaceState(C);if(this._destination.temporary)return void this._pushOrReplaceState(C,!0);if(this._destination.hash===C.hash||!this._destination.page&&this._numPositionUpdates<=50)return;let x=!1;if(this._destination.page>=C.first&&this._destination.page<=C.page){if(void 0!==this._destination.dest||!this._destination.first)return;x=!0}this._pushOrReplaceState(C,x)}_isValidPage(v){return Number.isInteger(v)&&v>0&&v<=this.linkService.pagesCount}_isValidState(v,C=!1){if(!v)return!1;if(v.fingerprint!==this._fingerprint){if(!C)return!1;{if("string"!=typeof v.fingerprint||v.fingerprint.length!==this._fingerprint.length)return!1;const[x]=performance.getEntriesByType("navigation");if("reload"!==(null==x?void 0:x.type))return!1}}return!(!Number.isInteger(v.uid)||v.uid<0||null===v.destination||"object"!=typeof v.destination)}_updateInternalState(v,C,x=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),x&&(null==v?void 0:v.temporary)&&delete v.temporary,this._destination=v,this._uid=C,this._maxUid=Math.max(this._maxUid,C),this._numPositionUpdates=0}_parseCurrentHash(v=!1){const C=unescape(a()).substring(1),x=(0,p.parseQueryString)(C),T=x.get("nameddest")||"";let I=0|x.get("page");return(!this._isValidPage(I)||v&&T.length>0)&&(I=null),{hash:C,page:I,rotation:this.linkService.rotation}}_updateViewarea({location:v}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:v.pdfOpenParams.substring(1),page:this.linkService.page,first:v.pageNumber,rotation:v.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},1e3))}_popState({state:v}){const C=a(),x=this._currentHash!==C;if(this._currentHash=C,!v){this._uid++;const{hash:I,page:N,rotation:H}=this._parseCurrentHash();return void this._pushOrReplaceState({hash:I,page:N,rotation:H},!0)}if(!this._isValidState(v))return;this._popStateInProgress=!0,x&&(this._blockHashChange++,(0,g.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:1e3}).then(()=>{this._blockHashChange--}));const T=v.destination;this._updateInternalState(T,v.uid,!0),(0,p.isValidRotation)(T.rotation)&&(this.linkService.rotation=T.rotation),T.dest?this.linkService.goToDestination(T.dest):T.hash?this.linkService.setHash(T.hash):T.page&&(this.linkService.page=T.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}_pageHide(){(!this._destination||this._destination.temporary)&&this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){!this._boundEvents||(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}},(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.PDFScriptingManager=void 0;var p=h(6),g=h(3);_.PDFScriptingManager=class{constructor({eventBus:o,sandboxBundleSrc:a=null,scriptingFactory:f=null,docPropertiesLookup:u=null}){this._pdfDocument=null,this._pdfViewer=null,this._closeCapability=null,this._destroyCapability=null,this._scripting=null,this._mouseState=Object.create(null),this._ready=!1,this._eventBus=o,this._sandboxBundleSrc=a,this._scriptingFactory=f,this._docPropertiesLookup=u,this._scriptingFactory||window.addEventListener("updatefromsandbox",m=>{this._eventBus.dispatch("updatefromsandbox",{source:window,detail:m.detail})})}setViewer(o){this._pdfViewer=o}setDocument(o){var a=this;return S(function*(){var b;if(a._pdfDocument&&(yield a._destroyScripting()),a._pdfDocument=o,!o)return;const[f,u,m]=yield Promise.all([o.getFieldObjects(),o.getCalculationOrderIds(),o.getJSActions()]);if(f||m){if(o===a._pdfDocument){try{a._scripting=a._createScripting()}catch(v){return console.error(`PDFScriptingManager.setDocument: "${null==v?void 0:v.message}".`),void(yield a._destroyScripting())}a._internalEvents.set("updatefromsandbox",v=>{(null==v?void 0:v.source)===window&&a._updateFromSandbox(v.detail)}),a._internalEvents.set("dispatcheventinsandbox",v=>{var C;null==(C=a._scripting)||C.dispatchEventInSandbox(v.detail)}),a._internalEvents.set("pagechanging",({pageNumber:v,previous:C})=>{v!==C&&(a._dispatchPageClose(C),a._dispatchPageOpen(v))}),a._internalEvents.set("pagerendered",({pageNumber:v})=>{!a._pageOpenPending.has(v)||v===a._pdfViewer.currentPageNumber&&a._dispatchPageOpen(v)}),a._internalEvents.set("pagesdestroy",function(){var v=S(function*(C){var x,T;yield a._dispatchPageClose(a._pdfViewer.currentPageNumber),yield null==(x=a._scripting)?void 0:x.dispatchEventInSandbox({id:"doc",name:"WillClose"}),null==(T=a._closeCapability)||T.resolve()});return function(C){return v.apply(this,arguments)}}()),a._domEvents.set("mousedown",v=>{a._mouseState.isDown=!0}),a._domEvents.set("mouseup",v=>{a._mouseState.isDown=!1});for(const[v,C]of a._internalEvents)a._eventBus._on(v,C);for(const[v,C]of a._domEvents)window.addEventListener(v,C,!0);try{const v=yield a._getDocProperties();if(o!==a._pdfDocument)return;yield a._scripting.createSandbox({objects:f,calculationOrder:u,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:Kf(Qf({},v),{actions:m})}),a._eventBus.dispatch("sandboxcreated",{source:a})}catch(v){return console.error(`PDFScriptingManager.setDocument: "${null==v?void 0:v.message}".`),void(yield a._destroyScripting())}yield null==(b=a._scripting)?void 0:b.dispatchEventInSandbox({id:"doc",name:"Open"}),yield a._dispatchPageOpen(a._pdfViewer.currentPageNumber,!0),Promise.resolve().then(()=>{o===a._pdfDocument&&(a._ready=!0)})}}else yield a._destroyScripting()})()}dispatchWillSave(o){var a=this;return S(function*(){var f;return null==(f=a._scripting)?void 0:f.dispatchEventInSandbox({id:"doc",name:"WillSave"})})()}dispatchDidSave(o){var a=this;return S(function*(){var f;return null==(f=a._scripting)?void 0:f.dispatchEventInSandbox({id:"doc",name:"DidSave"})})()}dispatchWillPrint(o){var a=this;return S(function*(){var f;return null==(f=a._scripting)?void 0:f.dispatchEventInSandbox({id:"doc",name:"WillPrint"})})()}dispatchDidPrint(o){var a=this;return S(function*(){var f;return null==(f=a._scripting)?void 0:f.dispatchEventInSandbox({id:"doc",name:"DidPrint"})})()}get mouseState(){return this._mouseState}get destroyPromise(){var o;return(null==(o=this._destroyCapability)?void 0:o.promise)||null}get ready(){return this._ready}get _internalEvents(){return(0,g.shadow)(this,"_internalEvents",new Map)}get _domEvents(){return(0,g.shadow)(this,"_domEvents",new Map)}get _pageOpenPending(){return(0,g.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,g.shadow)(this,"_visitedPages",new Map)}_updateFromSandbox(o){var a=this;return S(function*(){var x;const f=a._pdfViewer.isInPresentationMode||a._pdfViewer.isChangingPresentationMode,{id:u,siblings:m,command:b,value:v}=o;if(!u){switch(b){case"clear":console.clear();break;case"error":console.error(v);break;case"layout":if(f)return;const T=(0,p.apiPageLayoutToViewerModes)(v);a._pdfViewer.spreadMode=T.spreadMode;break;case"page-num":a._pdfViewer.currentPageNumber=v+1;break;case"print":yield a._pdfViewer.pagesPromise,a._eventBus.dispatch("print",{source:a});break;case"println":console.log(v);break;case"zoom":if(f)return;a._pdfViewer.currentScaleValue=v;break;case"SaveAs":a._eventBus.dispatch("save",{source:a});break;case"FirstPage":a._pdfViewer.currentPageNumber=1;break;case"LastPage":a._pdfViewer.currentPageNumber=a._pdfViewer.pagesCount;break;case"NextPage":a._pdfViewer.nextPage();break;case"PrevPage":a._pdfViewer.previousPage();break;case"ZoomViewIn":if(f)return;a._pdfViewer.increaseScale();break;case"ZoomViewOut":if(f)return;a._pdfViewer.decreaseScale()}return}if(f&&o.focus)return;delete o.id,delete o.siblings;const C=m?[u,...m]:[u];for(const T of C){const I=document.getElementById(T);I?I.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:o})):null==(x=a._pdfDocument)||x.annotationStorage.setValue(T,o)}})()}_dispatchPageOpen(o,a=!1){var f=this;return S(function*(){const u=f._pdfDocument,m=f._visitedPages;if(a&&(f._closeCapability=(0,g.createPromiseCapability)()),!f._closeCapability)return;const b=f._pdfViewer.getPageView(o-1);if((null==b?void 0:b.renderingState)!==p.RenderingStates.FINISHED)return void f._pageOpenPending.add(o);f._pageOpenPending.delete(o);const v=S(function*(){var x,T;const C=yield m.has(o)?null:null==(x=b.pdfPage)?void 0:x.getJSActions();u===f._pdfDocument&&(yield null==(T=f._scripting)?void 0:T.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:o,actions:C}))})();m.set(o,v)})()}_dispatchPageClose(o){var a=this;return S(function*(){var b;const f=a._pdfDocument,u=a._visitedPages;if(!a._closeCapability||a._pageOpenPending.has(o))return;const m=u.get(o);!m||(u.set(o,null),yield m,f===a._pdfDocument&&(yield null==(b=a._scripting)?void 0:b.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:o})))})()}_getDocProperties(){var o=this;return S(function*(){if(o._docPropertiesLookup)return o._docPropertiesLookup(o._pdfDocument);const{docPropertiesLookup:a}=h(24);return a(o._pdfDocument)})()}_createScripting(){if(this._destroyCapability=(0,g.createPromiseCapability)(),this._scripting)throw new Error("_createScripting: Scripting already exists.");if(this._scriptingFactory)return this._scriptingFactory.createScripting({sandboxBundleSrc:this._sandboxBundleSrc});const{GenericScripting:o}=h(24);return new o(this._sandboxBundleSrc)}_destroyScripting(){var o=this;return S(function*(){var a,f;if(!o._scripting)return o._pdfDocument=null,void(null==(a=o._destroyCapability)||a.resolve());o._closeCapability&&(yield Promise.race([o._closeCapability.promise,new Promise(u=>{setTimeout(u,1e3)})]).catch(u=>{}),o._closeCapability=null),o._pdfDocument=null;try{yield o._scripting.destroySandbox()}catch(u){}for(const[u,m]of o._internalEvents)o._eventBus._off(u,m);o._internalEvents.clear();for(const[u,m]of o._domEvents)window.removeEventListener(u,m,!0);o._domEvents.clear(),o._pageOpenPending.clear(),o._visitedPages.clear(),o._scripting=null,delete o._mouseState.isDown,o._ready=!1,null==(f=o._destroyCapability)||f.resolve()})()}}},(le,_,h)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.GenericScripting=void 0,_.docPropertiesLookup=function(o){return c.apply(this,arguments)};var p=h(3);function c(){return(c=S(function*(o){const f="".split("#")[0];let{info:u,metadata:m,contentDispositionFilename:b,contentLength:v}=yield o.getMetadata();if(!v){const{length:C}=yield o.getDownloadInfo();v=C}return Kf(Qf({},u),{baseURL:f,filesize:v,filename:b||(0,p.getPdfFilenameFromUrl)(""),metadata:null==m?void 0:m.getRaw(),authors:null==m?void 0:m.get("dc:creator"),numPages:o.numPages,URL:""})})).apply(this,arguments)}_.GenericScripting=class{constructor(a){this._ready=(0,p.loadScript)(a,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}createSandbox(a){var f=this;return S(function*(){(yield f._ready).create(a)})()}dispatchEventInSandbox(a){var f=this;return S(function*(){const u=yield f._ready;setTimeout(()=>u.dispatchEvent(a),0)})()}destroySandbox(){var a=this;return S(function*(){(yield a._ready).nukeSandbox()})()}}}],we={};function ye(le){var _=we[le];if(void 0!==_)return _.exports;var h=we[le]={exports:{}};return ke[le](h,h.exports,ye),h.exports}var be={};return(()=>{var le=be;Object.defineProperty(le,"__esModule",{value:!0}),Object.defineProperty(le,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return c.AnnotationLayerBuilder}}),Object.defineProperty(le,"DefaultAnnotationLayerFactory",{enumerable:!0,get:function(){return _.DefaultAnnotationLayerFactory}}),Object.defineProperty(le,"DefaultStructTreeLayerFactory",{enumerable:!0,get:function(){return _.DefaultStructTreeLayerFactory}}),Object.defineProperty(le,"DefaultTextLayerFactory",{enumerable:!0,get:function(){return _.DefaultTextLayerFactory}}),Object.defineProperty(le,"DefaultXfaLayerFactory",{enumerable:!0,get:function(){return _.DefaultXfaLayerFactory}}),Object.defineProperty(le,"DownloadManager",{enumerable:!0,get:function(){return l.DownloadManager}}),Object.defineProperty(le,"EventBus",{enumerable:!0,get:function(){return o.EventBus}}),Object.defineProperty(le,"GenericL10n",{enumerable:!0,get:function(){return a.GenericL10n}}),Object.defineProperty(le,"LinkTarget",{enumerable:!0,get:function(){return h.LinkTarget}}),Object.defineProperty(le,"NullL10n",{enumerable:!0,get:function(){return f.NullL10n}}),Object.defineProperty(le,"PDFFindController",{enumerable:!0,get:function(){return u.PDFFindController}}),Object.defineProperty(le,"PDFHistory",{enumerable:!0,get:function(){return m.PDFHistory}}),Object.defineProperty(le,"PDFLinkService",{enumerable:!0,get:function(){return h.PDFLinkService}}),Object.defineProperty(le,"PDFPageView",{enumerable:!0,get:function(){return b.PDFPageView}}),Object.defineProperty(le,"PDFScriptingManager",{enumerable:!0,get:function(){return v.PDFScriptingManager}}),Object.defineProperty(le,"PDFSinglePageViewer",{enumerable:!0,get:function(){return g.PDFSinglePageViewer}}),Object.defineProperty(le,"PDFViewer",{enumerable:!0,get:function(){return g.PDFViewer}}),Object.defineProperty(le,"ProgressBar",{enumerable:!0,get:function(){return p.ProgressBar}}),Object.defineProperty(le,"SimpleLinkService",{enumerable:!0,get:function(){return h.SimpleLinkService}}),Object.defineProperty(le,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return C.StructTreeLayerBuilder}}),Object.defineProperty(le,"TextLayerBuilder",{enumerable:!0,get:function(){return x.TextLayerBuilder}}),Object.defineProperty(le,"XfaLayerBuilder",{enumerable:!0,get:function(){return T.XfaLayerBuilder}}),Object.defineProperty(le,"parseQueryString",{enumerable:!0,get:function(){return p.parseQueryString}});var _=ye(1),h=ye(5),p=ye(6),g=ye(10),c=ye(2),l=ye(16),o=ye(17),a=ye(18),f=ye(4),u=ye(20),m=ye(22),b=ye(12),v=ye(23),C=ye(7),x=ye(8),T=ye(9)})(),be})(),Ie.exports=ye()},859:(Ie,$,Ae)=>{"use strict";function S(t){return"function"==typeof t}let ke=!1;const we={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else ke&&console.log("RxJS: Back to a better error behavior. Thank you. <3");ke=t},get useDeprecatedSynchronousErrorHandling(){return ke}};function ye(t){setTimeout(()=>{throw t},0)}const be={closed:!0,next(t){},error(t){if(we.useDeprecatedSynchronousErrorHandling)throw t;ye(t)},complete(){}},le=Array.isArray||(t=>t&&"number"==typeof t.length);function _(t){return null!==t&&"object"==typeof t}const p=(()=>{function t(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((n,i)=>`${i+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return t.prototype=Object.create(Error.prototype),t})();class g{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:i,_unsubscribe:r,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof g)n.remove(this);else if(null!==n)for(let d=0;d<n.length;++d)n[d].remove(this);if(S(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(d){e=d instanceof p?c(d.errors):[d]}}if(le(s)){let d=-1,y=s.length;for(;++d<y;){const w=s[d];if(_(w))try{w.unsubscribe()}catch(O){e=e||[],O instanceof p?e=e.concat(c(O.errors)):e.push(O)}}}if(e)throw new p(e)}add(e){let n=e;if(!e)return g.EMPTY;switch(typeof e){case"function":n=new g(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof g)){const s=n;n=new g,n._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=n;if(null===i)n._parentOrParents=this;else if(i instanceof g){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[n]:r.push(n),n}remove(e){const n=this._subscriptions;if(n){const i=n.indexOf(e);-1!==i&&n.splice(i,1)}}}var t;function c(t){return t.reduce((e,n)=>e.concat(n instanceof p?n.errors:n),[])}g.EMPTY=((t=new g).closed=!0,t);const l="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class a extends g{constructor(e,n,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=be;break;case 1:if(!e){this.destination=be;break}if("object"==typeof e){e instanceof a?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new f(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new f(this,e,n,i)}}[l](){return this}static create(e,n,i){const r=new a(e,n,i);return r.syncErrorThrowable=!1,r}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class f extends a{constructor(e,n,i,r){super(),this._parentSubscriber=e;let s,d=this;S(n)?s=n:n&&(s=n.next,i=n.error,r=n.complete,n!==be&&(d=Object.create(n),S(d.unsubscribe)&&this.add(d.unsubscribe.bind(d)),d.unsubscribe=this.unsubscribe.bind(this))),this._context=d,this._next=s,this._error=i,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:n}=this;we.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable?this.__tryOrSetError(n,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:n}=this,{useDeprecatedSynchronousErrorHandling:i}=we;if(this._error)i&&n.syncErrorThrowable?(this.__tryOrSetError(n,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(n.syncErrorThrowable)i?(n.syncErrorValue=e,n.syncErrorThrown=!0):ye(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;ye(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const n=()=>this._complete.call(this._context);we.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,n){try{e.call(this._context,n)}catch(i){if(this.unsubscribe(),we.useDeprecatedSynchronousErrorHandling)throw i;ye(i)}}__tryOrSetError(e,n,i){if(!we.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,i)}catch(r){return we.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(ye(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const b="function"==typeof Symbol&&Symbol.observable||"@@observable";function v(t){return t}let T=(()=>{class t{constructor(n){this._isScalar=!1,n&&(this._subscribe=n)}lift(n){const i=new t;return i.source=this,i.operator=n,i}subscribe(n,i,r){const{operator:s}=this,d=function(t,e,n){if(t){if(t instanceof a)return t;if(t[l])return t[l]()}return t||e||n?new a(t,e,n):new a(be)}(n,i,r);if(d.add(s?s.call(d,this.source):this.source||we.useDeprecatedSynchronousErrorHandling&&!d.syncErrorThrowable?this._subscribe(d):this._trySubscribe(d)),we.useDeprecatedSynchronousErrorHandling&&d.syncErrorThrowable&&(d.syncErrorThrowable=!1,d.syncErrorThrown))throw d.syncErrorValue;return d}_trySubscribe(n){try{return this._subscribe(n)}catch(i){we.useDeprecatedSynchronousErrorHandling&&(n.syncErrorThrown=!0,n.syncErrorValue=i),function(t){for(;t;){const{closed:e,destination:n,isStopped:i}=t;if(e||i)return!1;t=n&&n instanceof a?n:null}return!0}(n)?n.error(i):console.warn(i)}}forEach(n,i){return new(i=I(i))((r,s)=>{let d;d=this.subscribe(y=>{try{n(y)}catch(w){s(w),d&&d.unsubscribe()}},s,r)})}_subscribe(n){const{source:i}=this;return i&&i.subscribe(n)}[b](){return this}pipe(...n){return 0===n.length?this:function(t){return 0===t.length?v:1===t.length?t[0]:function(n){return t.reduce((i,r)=>r(i),n)}}(n)(this)}toPromise(n){return new(n=I(n))((i,r)=>{let s;this.subscribe(d=>s=d,d=>r(d),()=>i(s))})}}return t.create=e=>new t(e),t})();function I(t){if(t||(t=we.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const H=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class W extends g{constructor(e,n){super(),this.subject=e,this.subscriber=n,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,n=e.observers;if(this.subject=null,!n||0===n.length||e.isStopped||e.closed)return;const i=n.indexOf(this.subscriber);-1!==i&&n.splice(i,1)}}class K extends a{constructor(e){super(e),this.destination=e}}let ne=(()=>{class t extends T{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[l](){return new K(this)}lift(n){const i=new ae(this,this);return i.operator=n,i}next(n){if(this.closed)throw new H;if(!this.isStopped){const{observers:i}=this,r=i.length,s=i.slice();for(let d=0;d<r;d++)s[d].next(n)}}error(n){if(this.closed)throw new H;this.hasError=!0,this.thrownError=n,this.isStopped=!0;const{observers:i}=this,r=i.length,s=i.slice();for(let d=0;d<r;d++)s[d].error(n);this.observers.length=0}complete(){if(this.closed)throw new H;this.isStopped=!0;const{observers:n}=this,i=n.length,r=n.slice();for(let s=0;s<i;s++)r[s].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(n){if(this.closed)throw new H;return super._trySubscribe(n)}_subscribe(n){if(this.closed)throw new H;return this.hasError?(n.error(this.thrownError),g.EMPTY):this.isStopped?(n.complete(),g.EMPTY):(this.observers.push(n),new W(this,n))}asObservable(){const n=new T;return n.source=this,n}}return t.create=(e,n)=>new ae(e,n),t})();class ae extends ne{constructor(e,n){super(),this.destination=e,this.source=n}next(e){const{destination:n}=this;n&&n.next&&n.next(e)}error(e){const{destination:n}=this;n&&n.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:n}=this;return n?this.source.subscribe(e):g.EMPTY}}function ce(t){return t&&"function"==typeof t.schedule}function Y(t,e){return function(i){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new de(t,e))}}class de{constructor(e,n){this.project=e,this.thisArg=n}call(e,n){return n.subscribe(new fe(e,this.project,this.thisArg))}}class fe extends a{constructor(e,n,i){super(e),this.project=n,this.count=0,this.thisArg=i||this}_next(e){let n;try{n=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(n)}}const me=t=>e=>{for(let n=0,i=t.length;n<i&&!e.closed;n++)e.next(t[n]);e.complete()},D="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",A=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function k(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const R=t=>{if(t&&"function"==typeof t[b])return(t=>e=>{const n=t[b]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)})(t);if(A(t))return me(t);if(k(t))return(t=>e=>(t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,ye),e))(t);if(t&&"function"==typeof t[D])return(t=>e=>{const n=t[D]();for(;;){let i;try{i=n.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e})(t);{const n=`You provided ${_(t)?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(n)}};function Q(t,e){return new T(n=>{const i=new g;let r=0;return i.add(e.schedule(function(){r!==t.length?(n.next(t[r++]),n.closed||i.add(this.schedule())):n.complete()})),i})}function he(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[b]}(t))return function(t,e){return new T(n=>{const i=new g;return i.add(e.schedule(()=>{const r=t[b]();i.add(r.subscribe({next(s){i.add(e.schedule(()=>n.next(s)))},error(s){i.add(e.schedule(()=>n.error(s)))},complete(){i.add(e.schedule(()=>n.complete()))}}))})),i})}(t,e);if(k(t))return function(t,e){return new T(n=>{const i=new g;return i.add(e.schedule(()=>t.then(r=>{i.add(e.schedule(()=>{n.next(r),i.add(e.schedule(()=>n.complete()))}))},r=>{i.add(e.schedule(()=>n.error(r)))}))),i})}(t,e);if(A(t))return Q(t,e);if(function(t){return t&&"function"==typeof t[D]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new T(n=>{const i=new g;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=t[D](),i.add(e.schedule(function(){if(n.closed)return;let s,d;try{const y=r.next();s=y.value,d=y.done}catch(y){return void n.error(y)}d?n.complete():(n.next(s),this.schedule())}))})),i})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof T?t:new T(R(t))}class _e extends a{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class ue extends a{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function U(t,e){if(e.closed)return;if(t instanceof T)return t.subscribe(e);let n;try{n=R(t)(e)}catch(i){e.error(i)}return n}function q(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?i=>i.pipe(q((r,s)=>he(t(r,s)).pipe(Y((d,y)=>e(r,d,s,y))),n)):("number"==typeof e&&(n=e),i=>i.lift(new Z(t,n)))}class Z{constructor(e,n=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=n}call(e,n){return n.subscribe(new Se(e,this.project,this.concurrent))}}class Se extends ue{constructor(e,n,i=Number.POSITIVE_INFINITY){super(e),this.project=n,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let n;const i=this.index++;try{n=this.project(e,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(n)}_innerSub(e){const n=new _e(this),i=this.destination;i.add(n);const r=U(e,n);r!==n&&i.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Te(t=Number.POSITIVE_INFINITY){return q(v,t)}function Re(t,e){return e?Q(t,e):new T(me(t))}function Oe(...t){let e=Number.POSITIVE_INFINITY,n=null,i=t[t.length-1];return ce(i)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof i&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof T?t[0]:Te(e)(Re(t,n))}function Ye(){return function(e){return e.lift(new qe(e))}}class qe{constructor(e){this.connectable=e}call(e,n){const{connectable:i}=this;i._refCount++;const r=new yt(e,i),s=n.subscribe(r);return r.closed||(r.connection=i.connect()),s}}class yt extends a{constructor(e,n){super(e),this.connectable=n}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const n=e._refCount;if(n<=0)return void(this.connection=null);if(e._refCount=n-1,n>1)return void(this.connection=null);const{connection:i}=this,r=e._connection;this.connection=null,r&&(!i||r===i)&&r.unsubscribe()}}class Ce extends T{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new g,e.add(this.source.subscribe(new oe(this.getSubject(),this))),e.closed&&(this._connection=null,e=g.EMPTY)),e}refCount(){return Ye()(this)}}const re=(()=>{const t=Ce.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class oe extends K{constructor(e,n){super(e),this.connectable=n}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const n=e._connection;e._refCount=0,e._subject=null,e._connection=null,n&&n.unsubscribe()}}}function ut(){return new ne}function et(t){for(let e in t)if(t[e]===et)return e;throw Error("Could not find renamed property on target object.")}function Ke(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Ke).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function Ft(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const jn=et({__forward_ref__:et});function kt(t){return t.__forward_ref__=kt,t.toString=function(){return Ke(this())},t}function We(t){return function(t){return"function"==typeof t&&t.hasOwnProperty(jn)&&t.__forward_ref__===kt}(t)?t():t}class dn extends Error{constructor(e,n){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(e,n)),this.code=e}}function it(t){return"string"==typeof t?t:null==t?"":String(t)}function nn(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():it(t)}function Ua(t,e){const n=e?` in ${e}`:"";throw new dn("201",`No provider for ${nn(t)} found${n}`)}function Hn(t,e){null==t&&function(t,e,n,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${n} ${i} ${e} <=Actual]`))}(e,t,null,"!=")}function gt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function fi(t){return{providers:t.providers||[],imports:t.imports||[]}}function Ki(t){return ng(t,Ha)||ng(t,rg)}function ng(t,e){return t.hasOwnProperty(e)?t[e]:null}function ig(t){return t&&(t.hasOwnProperty(Kc)||t.hasOwnProperty(UC))?t[Kc]:null}const Ha=et({\u0275prov:et}),Kc=et({\u0275inj:et}),rg=et({ngInjectableDef:et}),UC=et({ngInjectorDef:et});var tt=(()=>((tt=tt||{})[tt.Default=0]="Default",tt[tt.Host=1]="Host",tt[tt.Self=2]="Self",tt[tt.SkipSelf=4]="SkipSelf",tt[tt.Optional=8]="Optional",tt))();let Jc;function dr(t){const e=Jc;return Jc=t,e}function sg(t,e,n){const i=Ki(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&tt.Optional?null:void 0!==e?e:void Ua(Ke(t),"Injector")}function fr(t){return{toString:t}.toString()}var Zn=(()=>((Zn=Zn||{})[Zn.OnPush=0]="OnPush",Zn[Zn.Default=1]="Default",Zn))(),rn=(()=>((rn=rn||{})[rn.Emulated=0]="Emulated",rn[rn.None=2]="None",rn[rn.ShadowDom=3]="ShadowDom",rn))();const WC="undefined"!=typeof globalThis&&globalThis,zC="undefined"!=typeof window&&window,GC="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Pt=WC||"undefined"!=typeof global&&global||zC||GC,as={},Ot=[],Wa=et({\u0275cmp:et}),Zc=et({\u0275dir:et}),eu=et({\u0275pipe:et}),og=et({\u0275mod:et}),$C=et({\u0275loc:et}),Ji=et({\u0275fac:et}),yo=et({__NG_ELEMENT_ID__:et});let YC=0;function gi(t){return fr(()=>{const n={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Zn.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||Ot,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||rn.Emulated,id:"c",styles:t.styles||Ot,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,s=t.features,d=t.pipes;return i.id+=YC++,i.inputs=ug(t.inputs,n),i.outputs=ug(t.outputs),s&&s.forEach(y=>y(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(ag):null,i.pipeDefs=d?()=>("function"==typeof d?d():d).map(lg):null,i})}function ag(t){return An(t)||function(t){return t[Zc]||null}(t)}function lg(t){return function(t){return t[eu]||null}(t)}const cg={};function Zi(t){return fr(()=>{const e={type:t.type,bootstrap:t.bootstrap||Ot,declarations:t.declarations||Ot,imports:t.imports||Ot,exports:t.exports||Ot,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(cg[t.id]=t.type),e})}function ug(t,e){if(null==t)return as;const n={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),n[r]=i,e&&(e[r]=s)}return n}const yn=gi;function An(t){return t[Wa]||null}function ei(t,e){const n=t[og]||null;if(!n&&!0===e)throw new Error(`Type ${Ke(t)} does not have '\u0275mod' property.`);return n}function Fi(t){return Array.isArray(t)&&"object"==typeof t[1]}function mi(t){return Array.isArray(t)&&!0===t[1]}function iu(t){return 0!=(8&t.flags)}function Ya(t){return 2==(2&t.flags)}function Xa(t){return 1==(1&t.flags)}function _i(t){return null!==t.template}function eS(t){return 0!=(512&t[2])}function Nr(t,e){return t.hasOwnProperty(Ji)?t[Ji]:null}class dg{constructor(e,n,i){this.previousValue=e,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}}function pr(){return fg}function fg(t){return t.type.prototype.ngOnChanges&&(t.setInput=rS),iS}function iS(){const t=pg(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===as)t.previous=e;else for(let i in e)n[i]=e[i];t.current=null,this.ngOnChanges(e)}}function rS(t,e,n,i){const r=pg(t)||function(t,e){return t[gg]=e}(t,{previous:as,current:null}),s=r.current||(r.current={}),d=r.previous,y=this.declaredInputs[n],w=d[y];s[y]=new dg(w&&w.currentValue,e,d===as),t[i]=e}pr.ngInherit=!0;const gg="__ngSimpleChanges__";function pg(t){return t[gg]||null}let ou;function Yt(t){return!!t.listen}const vg={createRenderer:(t,e)=>void 0!==ou?ou:"undefined"!=typeof document?document:void 0};function Zt(t){for(;Array.isArray(t);)t=t[0];return t}function ii(t,e){return Zt(e[t.index])}function lu(t,e){return t.data[e]}function zn(t,e){const n=e[t];return Fi(n)?n:n[0]}function yg(t){return 4==(4&t[2])}function cu(t){return 128==(128&t[2])}function mr(t,e){return null==e?null:t[e]}function bg(t){t[18]=0}function uu(t,e){t[5]+=e;let n=t,i=t[3];for(;null!==i&&(1===e&&1===n[5]||-1===e&&0===n[5]);)i[5]+=e,n=i,i=i[3]}const st={lFrame:Dg(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Cg(){return st.bindingsEnabled}function je(){return st.lFrame.lView}function Et(){return st.lFrame.tView}function Cn(t){return st.lFrame.contextLView=t,t[8]}function sn(){let t=Sg();for(;null!==t&&64===t.type;)t=t.parent;return t}function Sg(){return st.lFrame.currentTNode}function Li(t,e){const n=st.lFrame;n.currentTNode=t,n.isParent=e}function hu(){return st.lFrame.isParent}function du(){st.lFrame.isParent=!1}function Qa(){return st.isInCheckNoChangesMode}function Ka(t){st.isInCheckNoChangesMode=t}function fs(){return st.lFrame.bindingIndex++}function yS(t,e){const n=st.lFrame;n.bindingIndex=n.bindingRootIndex=t,fu(e)}function fu(t){st.lFrame.currentDirectiveIndex=t}function Eg(){return st.lFrame.currentQueryIndex}function pu(t){st.lFrame.currentQueryIndex=t}function CS(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function Ag(t,e,n){if(n&tt.SkipSelf){let r=e,s=t;for(;!(r=r.parent,null!==r||n&tt.Host||(r=CS(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,t=s}const i=st.lFrame=Tg();return i.currentTNode=e,i.lView=t,!0}function Ja(t){const e=Tg(),n=t[1];st.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Tg(){const t=st.lFrame,e=null===t?null:t.child;return null===e?Dg(t):e}function Dg(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Pg(){const t=st.lFrame;return st.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Mg=Pg;function Za(){const t=Pg();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Dn(){return st.lFrame.selectedIndex}function _r(t){st.lFrame.selectedIndex=t}function Xt(){const t=st.lFrame;return lu(t.tView,t.selectedIndex)}function el(t,e){for(let n=e.directiveStart,i=e.directiveEnd;n<i;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:d,ngAfterContentChecked:y,ngAfterViewInit:w,ngAfterViewChecked:O,ngOnDestroy:F}=s;d&&(t.contentHooks||(t.contentHooks=[])).push(-n,d),y&&((t.contentHooks||(t.contentHooks=[])).push(n,y),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,y)),w&&(t.viewHooks||(t.viewHooks=[])).push(-n,w),O&&((t.viewHooks||(t.viewHooks=[])).push(n,O),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,O)),null!=F&&(t.destroyHooks||(t.destroyHooks=[])).push(n,F)}}function tl(t,e,n){Og(t,e,3,n)}function nl(t,e,n,i){(3&t[2])===n&&Og(t,e,n,i)}function mu(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function Og(t,e,n,i){const s=null!=i?i:-1,d=e.length-1;let y=0;for(let w=void 0!==i?65535&t[18]:0;w<d;w++)if("number"==typeof e[w+1]){if(y=e[w],null!=i&&y>=i)break}else e[w]<0&&(t[18]+=65536),(y<s||-1==s)&&(MS(t,n,e,w),t[18]=(4294901760&t[18])+w+2),w++}function MS(t,e,n,i){const r=n[i]<0,s=n[i+1],y=t[r?-n[i]:n[i]];if(r){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{s.call(y)}finally{}}}else try{s.call(y)}finally{}}class xo{constructor(e,n,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}}function il(t,e,n){const i=Yt(t);let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const d=n[r++],y=n[r++],w=n[r++];i?t.setAttribute(e,y,w,d):e.setAttributeNS(d,y,w)}else{const d=s,y=n[++r];vu(d)?i&&t.setProperty(e,d,y):i?t.setAttribute(e,d,y):e.setAttribute(d,y),r++}}return r}function Ig(t){return 3===t||4===t||6===t}function vu(t){return 64===t.charCodeAt(0)}function rl(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?n=r:0===n||kg(t,n,r,null,-1===n||2===n?e[++i]:null)}}return t}function kg(t,e,n,i,r){let s=0,d=t.length;if(-1===e)d=-1;else for(;s<t.length;){const y=t[s++];if("number"==typeof y){if(y===e){d=-1;break}if(y>e){d=s-1;break}}}for(;s<t.length;){const y=t[s];if("number"==typeof y)break;if(y===n){if(null===i)return void(null!==r&&(t[s+1]=r));if(i===t[s+1])return void(t[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==d&&(t.splice(d,0,e),s=d+1),t.splice(s++,0,n),null!==i&&t.splice(s++,0,i),null!==r&&t.splice(s++,0,r)}function Rg(t){return-1!==t}function gs(t){return 32767&t}function ps(t,e){let n=function(t){return t>>16}(t),i=e;for(;n>0;)i=i[15],n--;return i}let yu=!0;function sl(t){const e=yu;return yu=t,e}let LS=0;function Ao(t,e){const n=Cu(t,e);if(-1!==n)return n;const i=e[1];i.firstCreatePass&&(t.injectorIndex=e.length,bu(i.data,t),bu(e,null),bu(i.blueprint,null));const r=ol(t,e),s=t.injectorIndex;if(Rg(r)){const d=gs(r),y=ps(r,e),w=y[1].data;for(let O=0;O<8;O++)e[s+O]=y[d+O]|w[d+O]}return e[s+8]=r,s}function bu(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Cu(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function ol(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,i=null,r=e;for(;null!==r;){const s=r[1],d=s.type;if(i=2===d?s.declTNode:1===d?r[6]:null,null===i)return-1;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return-1}function al(t,e,n){!function(t,e,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(yo)&&(i=n[yo]),null==i&&(i=n[yo]=LS++);const r=255&i;e.data[t+(r>>5)]|=1<<r}(t,e,n)}function Ng(t,e,n){if(n&tt.Optional)return t;Ua(e,"NodeInjector")}function Bg(t,e,n,i){if(n&tt.Optional&&void 0===i&&(i=null),0==(n&(tt.Self|tt.Host))){const r=t[9],s=dr(void 0);try{return r?r.get(e,i,n&tt.Optional):sg(e,i,n&tt.Optional)}finally{dr(s)}}return Ng(i,e,n)}function jg(t,e,n,i=tt.Default,r){if(null!==t){const s=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(yo)?t[yo]:void 0;return"number"==typeof e?e>=0?255&e:jS:e}(n);if("function"==typeof s){if(!Ag(e,t,i))return i&tt.Host?Ng(r,n,i):Bg(e,n,i,r);try{const d=s(i);if(null!=d||i&tt.Optional)return d;Ua(n)}finally{Mg()}}else if("number"==typeof s){let d=null,y=Cu(t,e),w=-1,O=i&tt.Host?e[16][6]:null;for((-1===y||i&tt.SkipSelf)&&(w=-1===y?ol(t,e):e[y+8],-1!==w&&Hg(i,!1)?(d=e[1],y=gs(w),e=ps(w,e)):y=-1);-1!==y;){const F=e[1];if(Ug(s,y,F.data)){const V=VS(y,e,n,d,i,O);if(V!==Vg)return V}w=e[y+8],-1!==w&&Hg(i,e[1].data[y+8]===O)&&Ug(s,y,e)?(d=F,y=gs(w),e=ps(w,e)):y=-1}}}return Bg(e,n,i,r)}const Vg={};function jS(){return new ms(sn(),je())}function VS(t,e,n,i,r,s){const d=e[1],y=d.data[t+8],F=ll(y,d,n,null==i?Ya(y)&&yu:i!=d&&0!=(3&y.type),r&tt.Host&&s===y);return null!==F?To(e,d,F,y):Vg}function ll(t,e,n,i,r){const s=t.providerIndexes,d=e.data,y=1048575&s,w=t.directiveStart,F=s>>20,G=r?y+F:t.directiveEnd;for(let ie=i?y:y+F;ie<G;ie++){const pe=d[ie];if(ie<w&&n===pe||ie>=w&&pe.type===n)return ie}if(r){const ie=d[w];if(ie&&_i(ie)&&ie.type===n)return w}return null}function To(t,e,n,i){let r=t[n];const s=e.data;if(function(t){return t instanceof xo}(r)){const d=r;d.resolving&&function(t,e){throw new dn("200",`Circular dependency in DI detected for ${t}`)}(nn(s[n]));const y=sl(d.canSeeViewProviders);d.resolving=!0;const w=d.injectImpl?dr(d.injectImpl):null;Ag(t,i,tt.Default);try{r=t[n]=d.factory(void 0,s,t,i),e.firstCreatePass&&n>=i.directiveStart&&function(t,e,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const d=fg(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,d),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,d)}r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,r),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,s))}(n,s[n],e)}finally{null!==w&&dr(w),sl(y),d.resolving=!1,Mg()}}return r}function Ug(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function Hg(t,e){return!(t&tt.Self||t&tt.Host&&e)}class ms{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,i){return jg(this._tNode,this._lView,e,i,n)}}function Do(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const i=n.length;let r=0;for(;r<i;){const s=n[r];if(Ig(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof n[r];)r++;else{if(s===e)return n[r+1];r+=2}}}return null}(sn(),t)}const vs="__parameters__";function Br(t,e,n){return fr(()=>{const i=function(t){return function(...n){if(t){const i=t(...n);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const d=new r(...s);return y.annotation=d,y;function y(w,O,F){const V=w.hasOwnProperty(vs)?w[vs]:Object.defineProperty(w,vs,{value:[]})[vs];for(;V.length<=F;)V.push(null);return(V[F]=V[F]||[]).push(d),w}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class At{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=gt({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}const GS=new At("AnalyzeForEntryComponents"),cl=Function;function ri(t,e){void 0===e&&(e=t);for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)?(e===t&&(e=t.slice(0,n)),ri(i,e)):e!==t&&e.push(i)}return e}function Bi(t,e){t.forEach(n=>Array.isArray(n)?Bi(n,e):e(n))}function hl(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function jr(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function Gn(t,e,n){let i=bs(t,e);return i>=0?t[1|i]=n:(i=~i,function(t,e,n,i){let r=t.length;if(r==e)t.push(n,i);else if(1===r)t.push(i,t[0]),t[0]=n;else{for(r--,t.push(t[r-1],t[r]);r>e;)t[r]=t[r-2],r--;t[e]=n,t[e+1]=i}}(t,i,e,n)),i}function xu(t,e){const n=bs(t,e);if(n>=0)return t[1|n]}function bs(t,e){return function(t,e,n){let i=0,r=t.length>>n;for(;r!==i;){const s=i+(r-i>>1),d=t[s<<n];if(e===d)return s<<n;d>e?r=s:i=s+1}return~(r<<n)}(t,e,1)}const Io={},Au="__NG_DI_FLAG__",Cs="ngTempTokenPath",tw=/\n/gm,Tu="__source",Du=et({provide:String,useValue:et});let ko;function Ss(t){const e=ko;return ko=t,e}function iw(t,e=tt.Default){if(void 0===ko)throw new Error("inject() must be called from an injection context");return null===ko?sg(t,void 0,e):ko.get(t,e&tt.Optional?null:void 0,e)}function Ge(t,e=tt.Default){return(Jc||iw)(We(t),e)}function Vr(t){const e=[];for(let n=0;n<t.length;n++){const i=We(t[n]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let r,s=tt.Default;for(let d=0;d<i.length;d++){const y=i[d],w=rw(y);"number"==typeof w?-1===w?r=y.token:s|=w:r=y}e.push(Ge(r,s))}else e.push(Ge(i))}return e}function Ro(t,e){return t[Au]=e,t.prototype[Au]=e,t}function rw(t){return t[Au]}function Xg(t,e,n,i){const r=t[Cs];throw e[Tu]&&r.unshift(e[Tu]),t.message=function(t,e,n,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=Ke(e);if(Array.isArray(e))r=e.map(Ke).join(" -> ");else if("object"==typeof e){let s=[];for(let d in e)if(e.hasOwnProperty(d)){let y=e[d];s.push(d+":"+("string"==typeof y?JSON.stringify(y):Ke(y)))}r=`{${s.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${t.replace(tw,"\n  ")}`}("\n"+t.message,r,n,i),t.ngTokenPath=r,t[Cs]=null,t}const ws=Ro(Br("Inject",t=>({token:t})),-1),Ln=Ro(Br("Optional"),8),br=Ro(Br("SkipSelf"),4);class Ur{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function $n(t){return t instanceof Ur?t.changingThisBreaksApplicationSecurity:t}function ji(t,e){const n=function(t){return t instanceof Ur&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===e}const Dw=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Pw=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var Rt=(()=>((Rt=Rt||{})[Rt.NONE=0]="NONE",Rt[Rt.HTML=1]="HTML",Rt[Rt.STYLE=2]="STYLE",Rt[Rt.SCRIPT=3]="SCRIPT",Rt[Rt.URL=4]="URL",Rt[Rt.RESOURCE_URL=5]="RESOURCE_URL",Rt))();function tr(t){const e=function(){const t=je();return t&&t[12]}();return e?e.sanitize(Rt.URL,t)||"":ji(t,"URL")?$n(t):function(t){return(t=String(t)).match(Dw)||t.match(Pw)?t:"unsafe:"+t}(it(t))}const fp="__ngContext__";function Sn(t,e){t[fp]=e}function Nu(t){const e=function(t){return t[fp]||null}(t);return e?Array.isArray(e)?e:e.lView:null}function vl(t){return t.ngOriginalError}function Kw(t,...e){t.error(...e)}class Hr{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e),i=this._findContext(e),r=function(t){return t&&t.ngErrorLogger||Kw}(e);r(this._console,"ERROR",e),n&&r(this._console,"ORIGINAL ERROR",n),i&&r(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?function(t){return t.ngDebugContext}(e)||this._findContext(vl(e)):null}_findOriginalError(e){let n=e&&vl(e);for(;n&&vl(n);)n=vl(n);return n||null}}const Sp=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Pt))();function Ui(t){return t instanceof Function?t():t}var Yn=(()=>((Yn=Yn||{})[Yn.Important=1]="Important",Yn[Yn.DashCase=2]="DashCase",Yn))();function Vu(t,e){return undefined(t,e)}function Vo(t){const e=t[3];return mi(e)?e[3]:e}function Uu(t){return Tp(t[13])}function Hu(t){return Tp(t[4])}function Tp(t){for(;null!==t&&!mi(t);)t=t[4];return t}function Ts(t,e,n,i,r){if(null!=i){let s,d=!1;mi(i)?s=i:Fi(i)&&(d=!0,i=i[0]);const y=Zt(i);0===t&&null!==n?null==r?kp(e,n,y):Wr(e,n,y,r||null,!0):1===t&&null!==n?Wr(e,n,y,r||null,!0):2===t?function(t,e,n){const i=bl(t,e);i&&function(t,e,n,i){Yt(t)?t.removeChild(e,n,i):e.removeChild(n)}(t,i,e,n)}(e,y,d):3===t&&e.destroyNode(y),null!=s&&function(t,e,n,i,r){const s=n[7];s!==Zt(n)&&Ts(e,t,i,s,r);for(let y=10;y<n.length;y++){const w=n[y];Uo(w[1],w,t,e,i,s)}}(e,t,s,n,r)}}function zu(t,e,n){return Yt(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Pp(t,e){const n=t[9],i=n.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,uu(r,-1)),n.splice(i,1)}function Gu(t,e){if(t.length<=10)return;const n=10+e,i=t[n];if(i){const r=i[17];null!==r&&r!==t&&Pp(r,i),e>0&&(t[n-1][4]=i[4]);const s=jr(t,10+e);!function(t,e){Uo(t,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const d=s[19];null!==d&&d.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function Mp(t,e){if(!(256&e[2])){const n=e[11];Yt(n)&&n.destroyNode&&Uo(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return $u(t[1],t);for(;e;){let n=null;if(Fi(e))n=e[13];else{const i=e[10];i&&(n=i)}if(!n){for(;e&&!e[4]&&e!==t;)Fi(e)&&$u(e[1],e),e=e[3];null===e&&(e=t),Fi(e)&&$u(e[1],e),n=e&&e[4]}e=n}}(e)}}function $u(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let i=0;i<n.length;i+=2){const r=e[n[i]];if(!(r instanceof xo)){const s=n[i+1];if(Array.isArray(s))for(let d=0;d<s.length;d+=2){const y=r[s[d]],w=s[d+1];try{w.call(y)}finally{}}else try{s.call(r)}finally{}}}}(t,e),function(t,e){const n=t.cleanup,i=e[7];let r=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const d=n[s+1],y="function"==typeof d?d(e):Zt(e[d]),w=i[r=n[s+2]],O=n[s+3];"boolean"==typeof O?y.removeEventListener(n[s],w,O):O>=0?i[r=O]():i[r=-O].unsubscribe(),s+=2}else{const d=i[r=n[s+1]];n[s].call(d)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(t,e),1===e[1].type&&Yt(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&mi(e[3])){n!==e[3]&&Pp(n,e);const i=e[19];null!==i&&i.detachView(t)}}}function Op(t,e,n){return function(t,e,n){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return n[0];if(2&i.flags){const r=t.data[i.directiveStart].encapsulation;if(r===rn.None||r===rn.Emulated)return null}return ii(i,n)}(t,e.parent,n)}function Wr(t,e,n,i,r){Yt(t)?t.insertBefore(e,n,i,r):e.insertBefore(n,i,r)}function kp(t,e,n){Yt(t)?t.appendChild(e,n):e.appendChild(n)}function Rp(t,e,n,i,r){null!==i?Wr(t,e,n,i,r):kp(t,e,n)}function bl(t,e){return Yt(t)?t.parentNode(e):e.parentNode}let Np=function(t,e,n){return 40&t.type?ii(t,n):null};function Cl(t,e,n,i){const r=Op(t,i,e),s=e[11],y=function(t,e,n){return Np(t,e,n)}(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(n))for(let w=0;w<n.length;w++)Rp(s,r,n[w],y,!1);else Rp(s,r,n,y,!1)}function Sl(t,e){if(null!==e){const n=e.type;if(3&n)return ii(e,t);if(4&n)return Xu(-1,t[e.index]);if(8&n){const i=e.child;if(null!==i)return Sl(t,i);{const r=t[e.index];return mi(r)?Xu(-1,r):Zt(r)}}if(32&n)return Vu(e,t)()||Zt(t[e.index]);{const i=jp(t,e);return null!==i?Array.isArray(i)?i[0]:Sl(Vo(t[16]),i):Sl(t,e.next)}}return null}function jp(t,e){return null!==e?t[16][6].projection[e.projection]:null}function Xu(t,e){const n=10+t+1;if(n<e.length){const i=e[n],r=i[1].firstChild;if(null!==r)return Sl(i,r)}return e[7]}function qu(t,e,n,i,r,s,d){for(;null!=n;){const y=i[n.index],w=n.type;if(d&&0===e&&(y&&Sn(Zt(y),i),n.flags|=4),64!=(64&n.flags))if(8&w)qu(t,e,n.child,i,r,s,!1),Ts(e,t,r,y,s);else if(32&w){const O=Vu(n,i);let F;for(;F=O();)Ts(e,t,r,F,s);Ts(e,t,r,y,s)}else 16&w?Up(t,e,i,n,r,s):Ts(e,t,r,y,s);n=d?n.projectionNext:n.next}}function Uo(t,e,n,i,r,s){qu(n,i,t.firstChild,e,r,s,!1)}function Up(t,e,n,i,r,s){const d=n[16],w=d[6].projection[i.projection];if(Array.isArray(w))for(let O=0;O<w.length;O++)Ts(e,t,r,w[O],s);else qu(t,e,w,d[3],r,s,!0)}function Hp(t,e,n){Yt(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function Qu(t,e,n){Yt(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function Wp(t,e,n){let i=t.length;for(;;){const r=t.indexOf(e,n);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||t.charCodeAt(r+s)<=32)return r}n=r+1}}const zp="ng-template";function wx(t,e,n){let i=0;for(;i<t.length;){let r=t[i++];if(n&&"class"===r){if(r=t[i],-1!==Wp(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Gp(t){return 4===t.type&&t.value!==zp}function xx(t,e,n){return e===(4!==t.type||n?t.value:zp)}function Ex(t,e,n){let i=4;const r=t.attrs||[],s=function(t){for(let e=0;e<t.length;e++)if(Ig(t[e]))return e;return t.length}(r);let d=!1;for(let y=0;y<e.length;y++){const w=e[y];if("number"!=typeof w){if(!d)if(4&i){if(i=2|1&i,""!==w&&!xx(t,w,n)||""===w&&1===e.length){if(vi(i))return!1;d=!0}}else{const O=8&i?w:e[++y];if(8&i&&null!==t.attrs){if(!wx(t.attrs,O,n)){if(vi(i))return!1;d=!0}continue}const V=Ax(8&i?"class":w,r,Gp(t),n);if(-1===V){if(vi(i))return!1;d=!0;continue}if(""!==O){let G;G=V>s?"":r[V+1].toLowerCase();const ie=8&i?G:null;if(ie&&-1!==Wp(ie,O,0)||2&i&&O!==G){if(vi(i))return!1;d=!0}}}}else{if(!d&&!vi(i)&&!vi(w))return!1;if(d&&vi(w))continue;d=!1,i=w|1&i}}return vi(i)||d}function vi(t){return 0==(1&t)}function Ax(t,e,n,i){if(null===e)return-1;let r=0;if(i||!n){let s=!1;for(;r<e.length;){const d=e[r];if(d===t)return r;if(3===d||6===d)s=!0;else{if(1===d||2===d){let y=e[++r];for(;"string"==typeof y;)y=e[++r];continue}if(4===d)break;if(0===d){r+=4;continue}}r+=s?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const i=t[n];if("number"==typeof i)return-1;if(i===e)return n;n++}return-1}(e,t)}function $p(t,e,n=!1){for(let i=0;i<e.length;i++)if(Ex(t,e[i],n))return!0;return!1}function Yp(t,e){return t?":not("+e.trim()+")":e}function Ox(t){let e=t[0],n=1,i=2,r="",s=!1;for(;n<t.length;){let d=t[n];if("string"==typeof d)if(2&i){const y=t[++n];r+="["+d+(y.length>0?'="'+y+'"':"")+"]"}else 8&i?r+="."+d:4&i&&(r+=" "+d);else""!==r&&!vi(d)&&(e+=Yp(s,r),r=""),i=d,s=s||!vi(i);n++}return""!==r&&(e+=Yp(s,r)),e}const lt={};function Ct(t){Xp(Et(),je(),Dn()+t,Qa())}function Xp(t,e,n,i){if(!i)if(3==(3&e[2])){const s=t.preOrderCheckHooks;null!==s&&tl(e,s,n)}else{const s=t.preOrderHooks;null!==s&&nl(e,s,0,n)}_r(n)}function wl(t,e){return t<<17|e<<2}function yi(t){return t>>17&32767}function Ku(t){return 2|t}function nr(t){return(131068&t)>>2}function Ju(t,e){return-131069&t|e<<2}function Zu(t){return 1|t}function rm(t,e){const n=t.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const r=n[i],s=n[i+1];if(-1!==s){const d=t.data[s];pu(r),d.contentQueries(2,e[s],s)}}}function Ho(t,e,n,i,r,s,d,y,w,O){const F=e.blueprint.slice();return F[0]=r,F[2]=140|i,bg(F),F[3]=F[15]=t,F[8]=n,F[10]=d||t&&t[10],F[11]=y||t&&t[11],F[12]=w||t&&t[12]||null,F[9]=O||t&&t[9]||null,F[6]=s,F[16]=2==e.type?t[16]:F,F}function Ds(t,e,n,i,r){let s=t.data[e];if(null===s)s=function(t,e,n,i,r){const s=Sg(),d=hu(),w=t.data[e]=function(t,e,n,i,r,s){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,d?s:s&&s.parent,n,e,i,r);return null===t.firstChild&&(t.firstChild=w),null!==s&&(d?null==s.child&&null!==w.parent&&(s.child=w):null===s.next&&(s.next=w)),w}(t,e,n,i,r),st.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;const d=function(){const t=st.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===d?-1:d.injectorIndex}return Li(s,!0),s}function Ps(t,e,n,i){if(0===n)return-1;const r=e.length;for(let s=0;s<n;s++)e.push(i),t.blueprint.push(i),t.data.push(null);return r}function Wo(t,e,n){Ja(e);try{const i=t.viewQuery;null!==i&&ph(1,i,n);const r=t.template;null!==r&&sm(t,e,r,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&rm(t,e),t.staticViewQueries&&ph(2,t.viewQuery,n);const s=t.components;null!==s&&function(t,e){for(let n=0;n<e.length;n++)uE(t,e[n])}(e,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{e[2]&=-5,Za()}}function Ms(t,e,n,i){const r=e[2];if(256==(256&r))return;Ja(e);const s=Qa();try{bg(e),function(t){st.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&sm(t,e,n,2,i);const d=3==(3&r);if(!s)if(d){const O=t.preOrderCheckHooks;null!==O&&tl(e,O,null)}else{const O=t.preOrderHooks;null!==O&&nl(e,O,0,null),mu(e,0)}if(function(t){for(let e=Uu(t);null!==e;e=Hu(e)){if(!e[2])continue;const n=e[9];for(let i=0;i<n.length;i++){const r=n[i],s=r[3];0==(1024&r[2])&&uu(s,1),r[2]|=1024}}}(e),function(t){for(let e=Uu(t);null!==e;e=Hu(e))for(let n=10;n<e.length;n++){const i=e[n],r=i[1];cu(i)&&Ms(r,i,r.template,i[8])}}(e),null!==t.contentQueries&&rm(t,e),!s)if(d){const O=t.contentCheckHooks;null!==O&&tl(e,O)}else{const O=t.contentHooks;null!==O&&nl(e,O,1),mu(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let i=0;i<n.length;i++){const r=n[i];if(r<0)_r(~r);else{const s=r,d=n[++i],y=n[++i];yS(d,s),y(2,e[s])}}}finally{_r(-1)}}(t,e);const y=t.components;null!==y&&function(t,e){for(let n=0;n<e.length;n++)cE(t,e[n])}(e,y);const w=t.viewQuery;if(null!==w&&ph(2,w,i),!s)if(d){const O=t.viewCheckHooks;null!==O&&tl(e,O)}else{const O=t.viewHooks;null!==O&&nl(e,O,2),mu(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,uu(e[3],-1))}finally{Za()}}function zx(t,e,n,i){const r=e[10],s=!Qa(),d=yg(e);try{s&&!d&&r.begin&&r.begin(),d&&Wo(t,e,i),Ms(t,e,n,i)}finally{s&&!d&&r.end&&r.end()}}function sm(t,e,n,i,r){const s=Dn(),d=2&i;try{_r(-1),d&&e.length>20&&Xp(t,e,20,Qa()),n(i,r)}finally{_r(s)}}function om(t,e,n){if(iu(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const d=t.data[s];d.contentQueries&&d.contentQueries(1,n[s],s)}}}function ah(t,e,n){!Cg()||(function(t,e,n,i){const r=n.directiveStart,s=n.directiveEnd;t.firstCreatePass||Ao(n,e),Sn(i,e);const d=n.initialInputs;for(let y=r;y<s;y++){const w=t.data[y],O=_i(w);O&&rE(e,n,w);const F=To(e,t,y,n);Sn(F,e),null!==d&&sE(0,y-r,F,w,0,d),O&&(zn(n.index,e)[8]=F)}}(t,e,n,ii(n,e)),128==(128&n.flags)&&function(t,e,n){const i=n.directiveStart,r=n.directiveEnd,d=n.index,y=st.lFrame.currentDirectiveIndex;try{_r(d);for(let w=i;w<r;w++){const O=t.data[w],F=e[w];fu(w),(null!==O.hostBindings||0!==O.hostVars||null!==O.hostAttrs)&&gm(O,F)}}finally{_r(-1),fu(y)}}(t,e,n))}function lh(t,e,n=ii){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const d=i[s+1],y=-1===d?n(e,t):t[d];t[r++]=y}}}function am(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Al(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Al(t,e,n,i,r,s,d,y,w,O){const F=20+i,V=F+r,G=function(t,e){const n=[];for(let i=0;i<e;i++)n.push(i<t?null:lt);return n}(F,V),ie="function"==typeof O?O():O;return G[1]={type:t,blueprint:G,template:n,queries:null,viewQuery:y,declTNode:e,data:G.slice().fill(null,F),bindingStartIndex:F,expandoStartIndex:V,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof d?d():d,firstChild:null,schemas:w,consts:ie,incompleteFirstPass:!1}}function um(t,e,n,i){const r=bm(e);null===n?r.push(i):(r.push(n),t.firstCreatePass&&Cm(t).push(i,r.length-1))}function hm(t,e,n){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(e,r):n[i]=[e,r]}return n}function Xn(t,e,n,i,r,s,d,y){const w=ii(e,n);let F,O=e.inputs;!y&&null!=O&&(F=O[i])?(xm(t,n,F,i,r),Ya(e)&&function(t,e){const n=zn(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(i=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=d?d(r,e.value||"",i):r,Yt(s)?s.setProperty(w,i,r):vu(i)||(w.setProperty?w.setProperty(i,r):w[i]=r))}function ch(t,e,n,i){let r=!1;if(Cg()){const s=function(t,e,n){const i=t.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const d=i[s];$p(n,d.selectors,!1)&&(r||(r=[]),al(Ao(n,e),t,d.type),_i(d)?(pm(t,n),r.unshift(d)):r.push(d))}return r}(t,e,n),d=null===i?null:{"":-1};if(null!==s){r=!0,mm(n,t.data.length,s.length);for(let F=0;F<s.length;F++){const V=s[F];V.providersResolver&&V.providersResolver(V)}let y=!1,w=!1,O=Ps(t,e,s.length,null);for(let F=0;F<s.length;F++){const V=s[F];n.mergedAttrs=rl(n.mergedAttrs,V.hostAttrs),_m(t,n,e,O,V),iE(O,V,d),null!==V.contentQueries&&(n.flags|=8),(null!==V.hostBindings||null!==V.hostAttrs||0!==V.hostVars)&&(n.flags|=128);const G=V.type.prototype;!y&&(G.ngOnChanges||G.ngOnInit||G.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),y=!0),!w&&(G.ngOnChanges||G.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),w=!0),O++}!function(t,e){const i=e.directiveEnd,r=t.data,s=e.attrs,d=[];let y=null,w=null;for(let O=e.directiveStart;O<i;O++){const F=r[O],V=F.inputs,G=null===s||Gp(e)?null:oE(V,s);d.push(G),y=hm(V,O,y),w=hm(F.outputs,O,w)}null!==y&&(y.hasOwnProperty("class")&&(e.flags|=16),y.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=d,e.inputs=y,e.outputs=w}(t,n)}d&&function(t,e,n){if(e){const i=t.localNames=[];for(let r=0;r<e.length;r+=2){const s=n[e[r+1]];if(null==s)throw new dn("301",`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(n,i,d)}return n.mergedAttrs=rl(n.mergedAttrs,n.attrs),r}function fm(t,e,n,i,r,s){const d=s.hostBindings;if(d){let y=t.hostBindingOpCodes;null===y&&(y=t.hostBindingOpCodes=[]);const w=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(y)!=w&&y.push(w),y.push(i,r,d)}}function gm(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function pm(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function iE(t,e,n){if(n){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)n[e.exportAs[i]]=t;_i(e)&&(n[""]=t)}}function mm(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function _m(t,e,n,i,r){t.data[i]=r;const s=r.factory||(r.factory=Nr(r.type)),d=new xo(s,_i(r),null);t.blueprint[i]=d,n[i]=d,fm(t,e,0,i,Ps(t,n,r.hostVars,lt),r)}function rE(t,e,n){const i=ii(e,t),r=am(n),s=t[10],d=Tl(t,Ho(t,r,null,n.onPush?64:16,i,e,s,s.createRenderer(i,n),null,null));t[e.index]=d}function sE(t,e,n,i,r,s){const d=s[e];if(null!==d){const y=i.setInput;for(let w=0;w<d.length;){const O=d[w++],F=d[w++],V=d[w++];null!==y?i.setInput(n,V,O,F):n[F]=V}}}function oE(t,e){let n=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,t[r],e[i+1])),i+=2}else i+=2;else i+=4}return n}function vm(t,e,n,i){return new Array(t,!0,!1,e,null,0,i,n,null,null)}function cE(t,e){const n=zn(e,t);if(cu(n)){const i=n[1];80&n[2]?Ms(i,n,i.template,n[8]):n[5]>0&&hh(n)}}function hh(t){for(let i=Uu(t);null!==i;i=Hu(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const d=s[1];Ms(d,s,d.template,s[8])}else s[5]>0&&hh(s)}const n=t[1].components;if(null!==n)for(let i=0;i<n.length;i++){const r=zn(n[i],t);cu(r)&&r[5]>0&&hh(r)}}function uE(t,e){const n=zn(e,t),i=n[1];(function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])})(i,n),Wo(i,n,n[8])}function Tl(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function dh(t){for(;t;){t[2]|=64;const e=Vo(t);if(eS(t)&&!e)return t;t=e}return null}function gh(t,e,n){const i=e[10];i.begin&&i.begin();try{Ms(t,e,t.template,n)}catch(r){throw wm(e,r),r}finally{i.end&&i.end()}}function ym(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],i=Nu(n),r=i[1];zx(r,i,r.template,n)}}(t[8])}function ph(t,e,n){pu(0),e(t,n)}const pE=(()=>Promise.resolve(null))();function bm(t){return t[7]||(t[7]=[])}function Cm(t){return t.cleanup||(t.cleanup=[])}function wm(t,e){const n=t[9],i=n?n.get(Hr,null):null;i&&i.handleError(e)}function xm(t,e,n,i,r){for(let s=0;s<n.length;){const d=n[s++],y=n[s++],w=e[d],O=t.data[d];null!==O.setInput?O.setInput(w,r,i,y):w[y]=r}}function Dl(t,e,n){let i=n?t.styles:null,r=n?t.classes:null,s=0;if(null!==e)for(let d=0;d<e.length;d++){const y=e[d];"number"==typeof y?s=y:1==s?r=Ft(r,y):2==s&&(i=Ft(i,y+": "+e[++d]+";"))}n?t.styles=i:t.stylesWithoutHost=i,n?t.classes=r:t.classesWithoutHost=r}const Os=new At("INJECTOR",-1);class Em{get(e,n=Io){if(n===Io){const i=new Error(`NullInjectorError: No provider for ${Ke(e)}!`);throw i.name="NullInjectorError",i}return n}}const zo=new At("Set Injector scope."),Go={},vE={};let mh;function Am(){return void 0===mh&&(mh=new Em),mh}function Tm(t,e=null,n=null,i){return new bE(t,n,e||Am(),i)}class bE{constructor(e,n,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];n&&Bi(n,y=>this.processProvider(y,e,n)),Bi([e],y=>this.processInjectorType(y,[],s)),this.records.set(Os,Is(void 0,this));const d=this.records.get(zo);this.scope=null!=d?d.value:null,this.source=r||("object"==typeof e?null:Ke(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,n=Io,i=tt.Default){this.assertNotDestroyed();const r=Ss(this),s=dr(void 0);try{if(!(i&tt.SkipSelf)){let y=this.records.get(e);if(void 0===y){const w=function(t){return"function"==typeof t||"object"==typeof t&&t instanceof At}(e)&&Ki(e);y=w&&this.injectableDefInScope(w)?Is(_h(e),Go):null,this.records.set(e,y)}if(null!=y)return this.hydrate(e,y)}return(i&tt.Self?Am():this.parent).get(e,n=i&tt.Optional&&n===Io?null:n)}catch(d){if("NullInjectorError"===d.name){if((d[Cs]=d[Cs]||[]).unshift(Ke(e)),r)throw d;return Xg(d,e,"R3InjectorError",this.source)}throw d}finally{dr(s),Ss(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(Ke(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,n,i){if(!(e=We(e)))return!1;let r=ig(e);const s=null==r&&e.ngModule||void 0,d=void 0===s?e:s,y=-1!==i.indexOf(d);if(void 0!==s&&(r=ig(s)),null==r)return!1;if(null!=r.imports&&!y){let F;i.push(d);try{Bi(r.imports,V=>{this.processInjectorType(V,n,i)&&(void 0===F&&(F=[]),F.push(V))})}finally{}if(void 0!==F)for(let V=0;V<F.length;V++){const{ngModule:G,providers:ie}=F[V];Bi(ie,pe=>this.processProvider(pe,G,ie||Ot))}}this.injectorDefTypes.add(d);const w=Nr(d)||(()=>new d);this.records.set(d,Is(w,Go));const O=r.providers;if(null!=O&&!y){const F=e;Bi(O,V=>this.processProvider(V,F,O))}return void 0!==s&&void 0!==e.providers}processProvider(e,n,i){let r=ks(e=We(e))?e:We(e&&e.provide);const s=function(t,e,n){return Pm(t)?Is(void 0,t.useValue):Is(function(t,e,n){let i;if(ks(t)){const r=We(t);return Nr(r)||_h(r)}if(Pm(t))i=()=>We(t.useValue);else if(function(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...Vr(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))i=()=>Ge(We(t.useExisting));else{const r=We(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return Nr(r)||_h(r);i=()=>new r(...Vr(t.deps))}return i}(t),Go)}(e);if(ks(e)||!0!==e.multi)this.records.get(r);else{let d=this.records.get(r);d||(d=Is(void 0,Go,!0),d.factory=()=>Vr(d.multi),this.records.set(r,d)),r=e,d.multi.push(e)}this.records.set(r,s)}hydrate(e,n){return n.value===Go&&(n.value=vE,n.value=n.factory()),"object"==typeof n.value&&n.value&&function(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this.onDestroy.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=We(e.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function _h(t){const e=Ki(t),n=null!==e?e.factory:Nr(t);if(null!==n)return n;if(t instanceof At)throw new Error(`Token ${Ke(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const i=function(t,e){const n=[];for(let i=0;i<t;i++)n.push(e);return n}(e,"?");throw new Error(`Can't resolve all parameters for ${Ke(t)}: (${i.join(", ")}).`)}const n=function(t){const e=t&&(t[Ha]||t[rg]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function Is(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Pm(t){return null!==t&&"object"==typeof t&&Du in t}function ks(t){return"function"==typeof t}const Mm=function(t,e,n){return function(t,e=null,n=null,i){const r=Tm(t,e,n,i);return r._resolveInjectorDefTypes(),r}({name:n},e,t,n)};let It=(()=>{class t{static create(n,i){return Array.isArray(n)?Mm(n,i,""):Mm(n.providers,n.parent,n.name||"")}}return t.THROW_IF_NOT_FOUND=Io,t.NULL=new Em,t.\u0275prov=gt({token:t,providedIn:"any",factory:()=>Ge(Os)}),t.__NG_ELEMENT_ID__=-1,t})();function UE(t,e){el(Nu(t)[1],sn())}let Pl=null;function Rs(){if(!Pl){const t=Pt.Symbol;if(t&&t.iterator)Pl=t.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<e.length;++n){const i=e[n];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Pl=i)}}}return Pl}function Yo(t){return!!xh(t)&&(Array.isArray(t)||!(t instanceof Map)&&Rs()in t)}function xh(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function wn(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function an(t,e,n,i,r,s,d,y){const w=je(),O=Et(),F=t+20,V=O.firstCreatePass?function(t,e,n,i,r,s,d,y,w){const O=e.consts,F=Ds(e,t,4,d||null,mr(O,y));ch(e,n,F,mr(O,w)),el(e,F);const V=F.tViews=Al(2,F,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,O);return null!==e.queries&&(e.queries.template(e,F),V.queries=e.queries.embeddedTView(F)),F}(F,O,w,e,n,i,r,s,d):O.data[F];Li(V,!1);const G=w[11].createComment("");Cl(O,w,G,V),Sn(G,w),Tl(w,w[F]=vm(G,w,G,V)),Xa(V)&&ah(O,w,V),null!=d&&lh(w,V,y)}function Qe(t,e=tt.Default){const n=je();return null===n?Ge(t,e):jg(sn(),n,We(t),e)}function Tt(t,e,n){const i=je();return wn(i,fs(),e)&&Xn(Et(),Xt(),i,t,e,i[11],n,!1),Tt}function Mh(t,e,n,i,r){const d=r?"class":"style";xm(t,n,e.inputs[d],d,i)}function Fe(t,e,n,i){const r=je(),s=Et(),d=20+t,y=r[11],w=r[d]=zu(y,e,st.lFrame.currentNamespace),O=s.firstCreatePass?function(t,e,n,i,r,s,d){const y=e.consts,O=Ds(e,t,2,r,mr(y,s));return ch(e,n,O,mr(y,d)),null!==O.attrs&&Dl(O,O.attrs,!1),null!==O.mergedAttrs&&Dl(O,O.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,O),O}(d,s,r,0,e,n,i):s.data[d];Li(O,!0);const F=O.mergedAttrs;null!==F&&il(y,w,F);const V=O.classes;null!==V&&Qu(y,w,V);const G=O.styles;null!==G&&Hp(y,w,G),64!=(64&O.flags)&&Cl(s,r,w,O),0===st.lFrame.elementDepthCount&&Sn(w,r),st.lFrame.elementDepthCount++,Xa(O)&&(ah(s,r,O),om(s,O,r)),null!==i&&lh(r,O)}function Le(){let t=sn();hu()?du():(t=t.parent,Li(t,!1));const e=t;st.lFrame.elementDepthCount--;const n=Et();n.firstCreatePass&&(el(n,t),iu(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&Mh(n,e,je(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&Mh(n,e,je(),e.stylesWithoutHost,!1)}function Nt(t,e,n,i){Fe(t,e,n,i),Le()}function Il(t,e,n){const i=je(),r=Et(),s=t+20,d=r.firstCreatePass?function(t,e,n,i,r){const s=e.consts,d=mr(s,i),y=Ds(e,t,8,"ng-container",d);return null!==d&&Dl(y,d,!0),ch(e,n,y,mr(s,r)),null!==e.queries&&e.queries.elementStart(e,y),y}(s,r,i,e,n):r.data[s];Li(d,!0);const y=i[s]=i[11].createComment("");Cl(r,i,y,d),Sn(y,i),Xa(d)&&(ah(r,i,d),om(r,d,i)),null!=n&&lh(i,d)}function kl(){let t=sn();const e=Et();hu()?du():(t=t.parent,Li(t,!1)),e.firstCreatePass&&(el(e,t),iu(t)&&e.queries.elementEnd(t))}function Si(){return je()}function Rl(t){return!!t&&"function"==typeof t.then}const Oh=function(t){return!!t&&"function"==typeof t.subscribe};function Dt(t,e,n,i){const r=je(),s=Et(),d=sn();return function(t,e,n,i,r,s,d,y){const w=Xa(i),F=t.firstCreatePass&&Cm(t),V=e[8],G=bm(e);let ie=!0;if(3&i.type||y){const ve=ii(i,e),Ne=y?y(ve):ve,Pe=G.length,ze=y?Je=>y(Zt(Je[i.index])):i.index;if(Yt(n)){let Je=null;if(!y&&w&&(Je=function(t,e,n,i){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const d=r[s];if(d===n&&r[s+1]===i){const y=e[7],w=r[s+2];return y.length>w?y[w]:null}"string"==typeof d&&(s+=2)}return null}(t,e,r,i.index)),null!==Je)(Je.__ngLastListenerFn__||Je).__ngNextListenerFn__=s,Je.__ngLastListenerFn__=s,ie=!1;else{s=Ih(i,e,V,s,!1);const pt=n.listen(Ne,r,s);G.push(s,pt),F&&F.push(r,ze,Pe,Pe+1)}}else s=Ih(i,e,V,s,!0),Ne.addEventListener(r,s,d),G.push(s),F&&F.push(r,ze,Pe,d)}else s=Ih(i,e,V,s,!1);const pe=i.outputs;let Ee;if(ie&&null!==pe&&(Ee=pe[r])){const ve=Ee.length;if(ve)for(let Ne=0;Ne<ve;Ne+=2){const hn=e[Ee[Ne]][Ee[Ne+1]].subscribe(s),di=G.length;G.push(s,hn),F&&F.push(r,i.index,di,-(di+1))}}}(s,r,r[11],d,t,e,!!n,i),Dt}function y_(t,e,n,i){try{return!1!==n(i)}catch(r){return wm(t,r),!1}}function Ih(t,e,n,i,r){return function s(d){if(d===Function)return i;const y=2&t.flags?zn(t.index,e):e;0==(32&e[2])&&dh(y);let w=y_(e,0,i,d),O=s.__ngNextListenerFn__;for(;O;)w=y_(e,0,O,d)&&w,O=O.__ngNextListenerFn__;return r&&!1===w&&(d.preventDefault(),d.returnValue=!1),w}}function Wt(t=1){return function(t){return(st.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,st.lFrame.contextLView))[8]}(t)}function Gs(t,e,n){return kh(t,"",e,"",n),Gs}function kh(t,e,n,i,r){const s=je(),d=function(t,e,n,i){return wn(t,fs(),n)?e+it(n)+i:lt}(s,e,n,i);return d!==lt&&Xn(Et(),Xt(),s,t,d,s[11],r,!1),kh}function D_(t,e,n,i,r){const s=t[n+1],d=null===e;let y=i?yi(s):nr(s),w=!1;for(;0!==y&&(!1===w||d);){const F=t[y+1];OA(t[y],e)&&(w=!0,t[y+1]=i?Zu(F):Ku(F)),y=i?yi(F):nr(F)}w&&(t[n+1]=i?Ku(s):Zu(s))}function OA(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&bs(t,e)>=0}function wr(t,e){return function(t,e,n,i){const r=je(),s=Et(),d=function(t){const e=st.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}(2);s.firstUpdatePass&&function(t,e,n,i){const r=t.data;if(null===r[n+1]){const s=r[Dn()],d=function(t,e){return e>=t.expandoStartIndex}(t,n);(function(t,e){return 0!=(t.flags&(e?16:32))})(s,i)&&null===e&&!d&&(e=!1),e=function(t,e,n,i){const r=function(t){const e=st.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(n=qo(n=Rh(null,t,e,n,i),e.attrs,i),s=null);else{const d=e.directiveStylingLast;if(-1===d||t[d]!==r)if(n=Rh(r,t,e,n,i),null===s){let w=function(t,e,n){const i=n?e.classBindings:e.styleBindings;if(0!==nr(i))return t[yi(i)]}(t,e,i);void 0!==w&&Array.isArray(w)&&(w=Rh(null,t,e,w[1],i),w=qo(w,e.attrs,i),function(t,e,n,i){t[yi(n?e.classBindings:e.styleBindings)]=i}(t,e,i,w))}else s=function(t,e,n){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=qo(i,t[s].hostAttrs,n);return qo(i,e.attrs,n)}(t,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),n}(r,s,e,i),function(t,e,n,i,r,s){let d=s?e.classBindings:e.styleBindings,y=yi(d),w=nr(d);t[i]=n;let F,O=!1;if(Array.isArray(n)){const V=n;F=V[1],(null===F||bs(V,F)>0)&&(O=!0)}else F=n;if(r)if(0!==w){const G=yi(t[y+1]);t[i+1]=wl(G,y),0!==G&&(t[G+1]=Ju(t[G+1],i)),t[y+1]=function(t,e){return 131071&t|e<<17}(t[y+1],i)}else t[i+1]=wl(y,0),0!==y&&(t[y+1]=Ju(t[y+1],i)),y=i;else t[i+1]=wl(w,0),0===y?y=i:t[w+1]=Ju(t[w+1],i),w=i;O&&(t[i+1]=Ku(t[i+1])),D_(t,F,i,!0),D_(t,F,i,!1),function(t,e,n,i,r){const s=r?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&bs(s,e)>=0&&(n[i+1]=Zu(n[i+1]))}(e,F,t,i,s),d=wl(y,w),s?e.classBindings=d:e.styleBindings=d}(r,s,e,n,d,i)}}(s,t,d,i),e!==lt&&wn(r,d,e)&&function(t,e,n,i,r,s,d,y){if(!(3&e.type))return;const w=t.data,O=w[y+1];Fl(function(t){return 1==(1&t)}(O)?V_(w,e,n,r,nr(O),d):void 0)||(Fl(s)||function(t){return 2==(2&t)}(O)&&(s=V_(w,null,n,r,y,d)),function(t,e,n,i,r){const s=Yt(t);if(e)r?s?t.addClass(n,i):n.classList.add(i):s?t.removeClass(n,i):n.classList.remove(i);else{let d=-1===i.indexOf("-")?void 0:Yn.DashCase;if(null==r)s?t.removeStyle(n,i,d):n.style.removeProperty(i);else{const y="string"==typeof r&&r.endsWith("!important");y&&(r=r.slice(0,-10),d|=Yn.Important),s?t.setStyle(n,i,r,d):n.style.setProperty(i,r,y?"important":"")}}}(i,d,function(t,e){return Zt(e[t])}(Dn(),n),r,s))}(s,s.data[Dn()],r,r[11],t,r[d+1]=function(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=Ke($n(t)))),t}(e,n),i,d)}(t,e,null,!0),wr}function Rh(t,e,n,i,r){let s=null;const d=n.directiveEnd;let y=n.directiveStylingLast;for(-1===y?y=n.directiveStart:y++;y<d&&(s=e[y],i=qo(i,s.hostAttrs,r),s!==t);)y++;return null!==t&&(n.directiveStylingLast=y),i}function qo(t,e,n){const i=n?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const d=e[s];"number"==typeof d?r=d:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Gn(t,d,!!n||e[++s]))}return void 0===t?null:t}function V_(t,e,n,i,r,s){const d=null===e;let y;for(;r>0;){const w=t[r],O=Array.isArray(w),F=O?w[1]:w,V=null===F;let G=n[r+1];G===lt&&(G=V?Ot:void 0);let ie=V?xu(G,i):F===i?G:void 0;if(O&&!Fl(ie)&&(ie=xu(w,i)),Fl(ie)&&(y=ie,d))return y;const pe=t[r+1];r=d?yi(pe):nr(pe)}if(null!==e){let w=s?e.residualClasses:e.residualStyles;null!=w&&(y=xu(w,i))}return y}function Fl(t){return void 0!==t}function ot(t,e=""){const n=je(),i=Et(),r=t+20,s=i.firstCreatePass?Ds(i,r,1,e,null):i.data[r],d=n[r]=function(t,e){return Yt(t)?t.createText(e):t.createTextNode(e)}(n[11],e);Cl(i,n,d,s),Li(s,!1)}const Gr=void 0;var dT=["en",[["a","p"],["AM","PM"],Gr],[["AM","PM"],Gr,Gr],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Gr,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Gr,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Gr,"{1} 'at' {0}",Gr],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){const e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let Ys={};function lv(t){return t in Ys||(Ys[t]=Pt.ng&&Pt.ng.common&&Pt.ng.common.locales&&Pt.ng.common.locales[t]),Ys[t]}var He=(()=>((He=He||{})[He.LocaleId=0]="LocaleId",He[He.DayPeriodsFormat=1]="DayPeriodsFormat",He[He.DayPeriodsStandalone=2]="DayPeriodsStandalone",He[He.DaysFormat=3]="DaysFormat",He[He.DaysStandalone=4]="DaysStandalone",He[He.MonthsFormat=5]="MonthsFormat",He[He.MonthsStandalone=6]="MonthsStandalone",He[He.Eras=7]="Eras",He[He.FirstDayOfWeek=8]="FirstDayOfWeek",He[He.WeekendRange=9]="WeekendRange",He[He.DateFormat=10]="DateFormat",He[He.TimeFormat=11]="TimeFormat",He[He.DateTimeFormat=12]="DateTimeFormat",He[He.NumberSymbols=13]="NumberSymbols",He[He.NumberFormats=14]="NumberFormats",He[He.CurrencyCode=15]="CurrencyCode",He[He.CurrencySymbol=16]="CurrencySymbol",He[He.CurrencyName=17]="CurrencyName",He[He.Currencies=18]="Currencies",He[He.Directionality=19]="Directionality",He[He.PluralCase=20]="PluralCase",He[He.ExtraData=21]="ExtraData",He))();const Ll="en-US";let cv=Ll;function Nh(t){Hn(t,"Expected localeId to be defined"),"string"==typeof t&&(cv=t.toLowerCase().replace(/_/g,"-"))}class Rv{}const Lv="ngComponent";class fD{resolveComponentFactory(e){throw function(t){const e=Error(`No component factory found for ${Ke(t)}. Did you add it to @NgModule.entryComponents?`);return e[Lv]=t,e}(e)}}let $r=(()=>{class t{}return t.NULL=new fD,t})();function Ul(...t){}function qs(t,e){return new On(ii(t,e))}const mD=function(){return qs(sn(),je())};let On=(()=>{class t{constructor(n){this.nativeElement=n}}return t.__NG_ELEMENT_ID__=mD,t})();function Nv(t){return t instanceof On?t.nativeElement:t}class Hl{}let Wl=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>vD(),t})();const vD=function(){const t=je(),n=zn(sn().index,t);return function(t){return t[11]}(Fi(n)?n:t)};let Gh=(()=>{class t{}return t.\u0275prov=gt({token:t,providedIn:"root",factory:()=>null}),t})();class zl{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Bv=new zl("12.2.16");class jv{constructor(){}supports(e){return Yo(e)}create(e){return new SD(e)}}const CD=(t,e)=>e;class SD{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||CD}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,i=this._removalsHead,r=0,s=null;for(;n||i;){const d=!i||n&&n.currentIndex<Uv(i,r,s)?n:i,y=Uv(d,r,s),w=d.currentIndex;if(d===i)r--,i=i._nextRemoved;else if(n=n._next,null==d.previousIndex)r++;else{s||(s=[]);const O=y-r,F=w-r;if(O!=F){for(let G=0;G<O;G++){const ie=G<s.length?s[G]:s[G]=0,pe=ie+G;F<=pe&&pe<O&&(s[G]=ie+1)}s[d.previousIndex]=F-O}}y!==w&&e(d,y,w)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!Yo(e))throw new Error(`Error trying to diff '${Ke(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,d,n=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let y=0;y<this.length;y++)s=e[y],d=this._trackByFn(y,s),null!==n&&Object.is(n.trackById,d)?(i&&(n=this._verifyReinsertion(n,s,d,y)),Object.is(n.item,s)||this._addIdentityChange(n,s)):(n=this._mismatch(n,s,d,y),i=!0),n=n._next}else r=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Rs()]();let i;for(;!(i=n.next()).done;)e(i.value)}}(e,y=>{d=this._trackByFn(r,y),null!==n&&Object.is(n.trackById,d)?(i&&(n=this._verifyReinsertion(n,y,d,r)),Object.is(n.item,y)||this._addIdentityChange(n,y)):(n=this._mismatch(n,y,d,r),i=!0),n=n._next,r++}),this.length=r;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,r)):e=this._addAfter(new wD(n,i),s,r),e}_verifyReinsertion(e,n,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,n,i),this._addToMoves(e,i),e}_moveAfter(e,n,i){return this._unlink(e),this._insertAfter(e,n,i),this._addToMoves(e,i),e}_addAfter(e,n,i){return this._insertAfter(e,n,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,i){const r=null===n?this._itHead:n._next;return e._next=r,e._prev=n,null===r?this._itTail=e:r._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new Vv),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,i=e._next;return null===n?this._itHead=i:n._next=i,null===i?this._itTail=n:i._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Vv),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class wD{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class xD{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===n||n<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const n=e._prevDup,i=e._nextDup;return null===n?this._head=i:n._nextDup=i,null===i?this._tail=n:i._prevDup=n,null===this._head}}class Vv{constructor(){this.map=new Map}put(e){const n=e.trackById;let i=this.map.get(n);i||(i=new xD,this.map.set(n,i)),i.add(e)}get(e,n){const r=this.map.get(e);return r?r.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Uv(t,e,n){const i=t.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+e+r}class Hv{constructor(){}supports(e){return e instanceof Map||xh(e)}create(){return new ED}}class ED{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let n;for(n=this._mapHead;null!==n;n=n._next)e(n)}forEachPreviousItem(e){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)e(n)}forEachChangedItem(e){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}diff(e){if(e){if(!(e instanceof Map||xh(e)))throw new Error(`Error trying to diff '${Ke(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(n&&n.key===r)this._maybeAddToChanges(n,i),this._appendAfter=n,n=n._next;else{const s=this._getOrCreateRecordForKey(r,i);n=this._insertBeforeOrAppend(n,s)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let i=n;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,n){if(e){const i=e._prev;return n._next=e,n._prev=i,e._prev=n,i&&(i._next=n),e===this._mapHead&&(this._mapHead=n),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(e,n){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,n);const s=r._prev,d=r._next;return s&&(s._next=d),d&&(d._prev=s),r._next=null,r._prev=null,r}const i=new AD(e);return this._records.set(e,i),i.currentValue=n,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,n){Object.is(n,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=n,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,n){e instanceof Map?e.forEach(n):Object.keys(e).forEach(i=>n(e[i],i))}}class AD{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Wv(){return new ea([new jv])}let ea=(()=>{class t{constructor(n){this.factories=n}static create(n,i){if(null!=i){const r=i.factories.slice();n=n.concat(r)}return new t(n)}static extend(n){return{provide:t,useFactory:i=>t.create(n,i||Wv()),deps:[[t,new br,new Ln]]}}find(n){const i=this.factories.find(r=>r.supports(n));if(null!=i)return i;throw new Error(`Cannot find a differ supporting object '${n}' of type '${function(t){return t.name||typeof t}(n)}'`)}}return t.\u0275prov=gt({token:t,providedIn:"root",factory:Wv}),t})();function zv(){return new Qs([new Hv])}let Qs=(()=>{class t{constructor(n){this.factories=n}static create(n,i){if(i){const r=i.factories.slice();n=n.concat(r)}return new t(n)}static extend(n){return{provide:t,useFactory:i=>t.create(n,i||zv()),deps:[[t,new br,new Ln]]}}find(n){const i=this.factories.find(r=>r.supports(n));if(i)return i;throw new Error(`Cannot find a differ supporting object '${n}'`)}}return t.\u0275prov=gt({token:t,providedIn:"root",factory:zv}),t})();function Gl(t,e,n,i,r=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&i.push(Zt(s)),mi(s))for(let y=10;y<s.length;y++){const w=s[y],O=w[1].firstChild;null!==O&&Gl(w[1],w,O,i)}const d=n.type;if(8&d)Gl(t,e,n.child,i);else if(32&d){const y=Vu(n,e);let w;for(;w=y();)i.push(w)}else if(16&d){const y=jp(e,n);if(Array.isArray(y))i.push(...y);else{const w=Vo(e[16]);Gl(w[1],w,y,i,!0)}}n=r?n.projectionNext:n.next}return i}class ta{constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,n=e[1];return Gl(n,e,n.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(mi(e)){const n=e[8],i=n?n.indexOf(this):-1;i>-1&&(Gu(e,i),jr(n,i))}this._attachedToViewContainer=!1}Mp(this._lView[1],this._lView)}onDestroy(e){um(this._lView[1],this._lView,null,e)}markForCheck(){dh(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){gh(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){Ka(!0);try{gh(t,e,n)}finally{Ka(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(t,e){Uo(t,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class DD extends ta{constructor(e){super(e),this._view=e}detectChanges(){ym(this._view)}checkNoChanges(){!function(t){Ka(!0);try{ym(t)}finally{Ka(!1)}}(this._view)}get context(){return null}}const MD=function(t){return function(t,e,n){if(Ya(t)&&!n){const i=zn(t.index,e);return new ta(i,i)}return 47&t.type?new ta(e[16],e):null}(sn(),je(),16==(16&t))};let $h=(()=>{class t{}return t.__NG_ELEMENT_ID__=MD,t})();const kD=[new Hv],FD=new ea([new jv]),LD=new Qs(kD),BD=function(){return $l(sn(),je())};let or=(()=>{class t{}return t.__NG_ELEMENT_ID__=BD,t})();const jD=or,VD=class extends jD{constructor(e,n,i){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=i}createEmbeddedView(e){const n=this._declarationTContainer.tViews,i=Ho(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(n)),Wo(n,i,e),new ta(i)}};function $l(t,e){return 4&t.type?new VD(e,t,qs(t,e)):null}class $i{}class Gv{}const WD=function(){return Xv(sn(),je())};let Ei=(()=>{class t{}return t.__NG_ELEMENT_ID__=WD,t})();const GD=Ei,$v=class extends GD{constructor(e,n,i){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=i}get element(){return qs(this._hostTNode,this._hostLView)}get injector(){return new ms(this._hostTNode,this._hostLView)}get parentInjector(){const e=ol(this._hostTNode,this._hostLView);if(Rg(e)){const n=ps(e,this._hostLView),i=gs(e);return new ms(n[1].data[i+8],n)}return new ms(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=Yv(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,n,i){const r=e.createEmbeddedView(n||{});return this.insert(r,i),r}createComponent(e,n,i,r,s){const d=i||this.parentInjector;if(!s&&null==e.ngModule&&d){const w=d.get($i,null);w&&(s=w)}const y=e.create(d,r,void 0,s);return this.insert(y.hostView,n),y}insert(e,n){const i=e._lView,r=i[1];if(function(t){return mi(t[3])}(i)){const F=this.indexOf(e);if(-1!==F)this.detach(F);else{const V=i[3],G=new $v(V,V[6],V[3]);G.detach(G.indexOf(e))}}const s=this._adjustIndex(n),d=this._lContainer;!function(t,e,n,i){const r=10+i,s=n.length;i>0&&(n[r-1][4]=e),i<s-10?(e[4]=n[r],hl(n,10+i,e)):(n.push(e),e[4]=null),e[3]=n;const d=e[17];null!==d&&n!==d&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(d,e);const y=e[19];null!==y&&y.insertView(t),e[2]|=128}(r,i,d,s);const y=Xu(s,d),w=i[11],O=bl(w,d[7]);return null!==O&&function(t,e,n,i,r,s){i[0]=r,i[6]=e,Uo(t,i,n,1,r,s)}(r,d[6],w,i,O,y),e.attachToViewContainerRef(),hl(Yh(d),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=Yv(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),i=Gu(this._lContainer,n);i&&(jr(Yh(this._lContainer),n),Mp(i[1],i))}detach(e){const n=this._adjustIndex(e,-1),i=Gu(this._lContainer,n);return i&&null!=jr(Yh(this._lContainer),n)?new ta(i):null}_adjustIndex(e,n=0){return null==e?this.length+n:e}};function Yv(t){return t[8]}function Yh(t){return t[8]||(t[8]=[])}function Xv(t,e){let n;const i=e[t.index];if(mi(i))n=i;else{let r;if(8&t.type)r=Zt(i);else{const s=e[11];r=s.createComment("");const d=ii(t,e);Wr(s,bl(s,d),r,function(t,e){return Yt(t)?t.nextSibling(e):e.nextSibling}(s,d),!1)}e[t.index]=n=vm(i,e,r,t),Tl(e,n)}return new $v(n,t,e)}const eo={};class gy extends $r{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=An(e);return new my(n,this.ngModule)}}function py(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const UP=new At("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Sp});class my extends Rv{constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function(t){return t.map(Ox).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return py(this.componentDef.inputs)}get outputs(){return py(this.componentDef.outputs)}create(e,n,i,r){const s=(r=r||this.ngModule)?function(t,e){return{get:(n,i,r)=>{const s=t.get(n,eo,r);return s!==eo||i===eo?s:e.get(n,i,r)}}}(e,r.injector):e,d=s.get(Hl,vg),y=s.get(Gh,null),w=d.createRenderer(null,this.componentDef),O=this.componentDef.selectors[0][0]||"div",F=i?function(t,e,n){if(Yt(t))return t.selectRootElement(e,n===rn.ShadowDom);let i="string"==typeof e?t.querySelector(e):e;return i.textContent="",i}(w,i,this.componentDef.encapsulation):zu(d.createRenderer(null,this.componentDef),O,function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(O)),V=this.componentDef.onPush?576:528,G=function(t,e){return{components:[],scheduler:t||Sp,clean:pE,playerHandler:e||null,flags:0}}(),ie=Al(0,null,null,1,0,null,null,null,null,null),pe=Ho(null,ie,G,V,null,null,d,w,y,s);let Ee,ve;Ja(pe);try{const Ne=function(t,e,n,i,r,s){const d=n[1];n[20]=t;const w=Ds(d,20,2,"#host",null),O=w.mergedAttrs=e.hostAttrs;null!==O&&(Dl(w,O,!0),null!==t&&(il(r,t,O),null!==w.classes&&Qu(r,t,w.classes),null!==w.styles&&Hp(r,t,w.styles)));const F=i.createRenderer(t,e),V=Ho(n,am(e),null,e.onPush?64:16,n[20],w,i,F,s||null,null);return d.firstCreatePass&&(al(Ao(w,n),d,e.type),pm(d,w),mm(w,n.length,1)),Tl(n,V),n[20]=V}(F,this.componentDef,pe,d,w);if(F)if(i)il(w,F,["ng-version",Bv.full]);else{const{attrs:Pe,classes:ze}=function(t){const e=[],n=[];let i=1,r=2;for(;i<t.length;){let s=t[i];if("string"==typeof s)2===r?""!==s&&e.push(s,t[++i]):8===r&&n.push(s);else{if(!vi(r))break;r=s}i++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);Pe&&il(w,F,Pe),ze&&ze.length>0&&Qu(w,F,ze.join(" "))}if(ve=lu(ie,20),void 0!==n){const Pe=ve.projection=[];for(let ze=0;ze<this.ngContentSelectors.length;ze++){const Je=n[ze];Pe.push(null!=Je?Array.from(Je):null)}}Ee=function(t,e,n,i,r){const s=n[1],d=function(t,e,n){const i=sn();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),_m(t,i,e,Ps(t,e,1,null),n));const r=To(e,t,i.directiveStart,i);Sn(r,e);const s=ii(i,e);return s&&Sn(s,e),r}(s,n,e);if(i.components.push(d),t[8]=d,r&&r.forEach(w=>w(d,e)),e.contentQueries){const w=sn();e.contentQueries(1,d,w.directiveStart)}const y=sn();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(_r(y.index),fm(n[1],y,0,y.directiveStart,y.directiveEnd,e),gm(e,d)),d}(Ne,this.componentDef,pe,G,[UE]),Wo(ie,pe,null)}finally{Za()}return new zP(this.componentType,Ee,qs(ve,pe),pe,ve)}}class zP extends class{}{constructor(e,n,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=n,this.hostView=this.changeDetectorRef=new DD(r),this.componentType=e}get injector(){return new ms(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const to=new Map;class YP extends $i{constructor(e,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new gy(this);const i=ei(e),r=function(t){return t[$C]||null}(e);r&&Nh(r),this._bootstrapComponents=Ui(i.bootstrap),this._r3Injector=Tm(e,n,[{provide:$i,useValue:this},{provide:$r,useValue:this.componentFactoryResolver}],Ke(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,n=It.THROW_IF_NOT_FOUND,i=tt.Default){return e===It||e===$i||e===Os?this:this._r3Injector.get(e,n,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class od extends Gv{constructor(e){super(),this.moduleType=e,null!==ei(e)&&function(t){const e=new Set;!function n(i){const r=ei(i,!0),s=r.id;null!==s&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${Ke(e)} vs ${Ke(e.name)}`)}(s,to.get(s),i),to.set(s,i));const d=Ui(r.imports);for(const y of d)e.has(y)||(e.add(y),n(y))}(t)}(e)}create(e){return new YP(this.moduleType,e)}}function ca(t,e,n){const i=function(){const t=st.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}()+t,r=je();return r[i]===lt?function(t,e,n){return t[e]=n}(r,i,n?e.call(n):e()):function(t,e){return t[e]}(r,i)}function ad(t){return e=>{setTimeout(t,void 0,e)}}const cn=class extends ne{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,i){var r,s,d;let y=e,w=n||(()=>null),O=i;if(e&&"object"==typeof e){const V=e;y=null===(r=V.next)||void 0===r?void 0:r.bind(V),w=null===(s=V.error)||void 0===s?void 0:s.bind(V),O=null===(d=V.complete)||void 0===d?void 0:d.bind(V)}this.__isAsync&&(w=ad(w),y&&(y=ad(y)),O&&(O=ad(O)));const F=super.subscribe({next:y,error:w,complete:O});return e instanceof g&&e.add(F),F}};function h1(){return this._results[Rs()]()}class Kl{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=Rs(),i=Kl.prototype;i[n]||(i[n]=h1)}get changes(){return this._changes||(this._changes=new cn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){const i=this;i.dirty=!1;const r=ri(e);(this._changesDetected=!function(t,e,n){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],s=e[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}(i._results,r,n))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class ld{constructor(e){this.queryList=e,this.matches=null}clone(){return new ld(this.queryList)}setDirty(){this.queryList.setDirty()}}class cd{constructor(e=[]){this.queries=e}createEmbeddedView(e){const n=e.queries;if(null!==n){const i=null!==e.contentQueries?e.contentQueries[0]:n.length,r=[];for(let s=0;s<i;s++){const d=n.getByIndex(s);r.push(this.queries[d.indexInDeclarationView].clone())}return new cd(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)null!==Dy(e,n).matches&&this.queries[n].setDirty()}}class xy{constructor(e,n,i=null){this.predicate=e,this.flags=n,this.read=i}}class ud{constructor(e=[]){this.queries=e}elementStart(e,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let i=0;i<this.length;i++){const r=null!==n?n.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==n?n.push(s):n=[s])}return null!==n?new ud(n):null}template(e,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class hd{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new hd(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==n;)i=i.parent;return n===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,n){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,n,g1(n,s)),this.matchTNodeWithReadOption(e,n,ll(n,e,s,!1,!1))}else i===or?4&n.type&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,ll(n,e,i,!1,!1))}matchTNodeWithReadOption(e,n,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===On||r===Ei||r===or&&4&n.type)this.addMatch(n.index,-2);else{const s=ll(n,e,r,!1,!1);null!==s&&this.addMatch(n.index,s)}else this.addMatch(n.index,i)}}addMatch(e,n){null===this.matches?this.matches=[e,n]:this.matches.push(e,n)}}function g1(t,e){const n=t.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===e)return n[i+1];return null}function m1(t,e,n,i){return-1===n?function(t,e){return 11&t.type?qs(t,e):4&t.type?$l(t,e):null}(e,t):-2===n?function(t,e,n){return n===On?qs(e,t):n===or?$l(e,t):n===Ei?Xv(e,t):void 0}(t,e,i):To(t,t[1],n,e)}function Ey(t,e,n,i){const r=e[19].queries[i];if(null===r.matches){const s=t.data,d=n.matches,y=[];for(let w=0;w<d.length;w+=2){const O=d[w];y.push(O<0?null:m1(e,s[O],d[w+1],n.metadata.read))}r.matches=y}return r.matches}function dd(t,e,n,i){const r=t.queries.getByIndex(n),s=r.matches;if(null!==s){const d=Ey(t,e,r,n);for(let y=0;y<s.length;y+=2){const w=s[y];if(w>0)i.push(d[y/2]);else{const O=s[y+1],F=e[-w];for(let V=10;V<F.length;V++){const G=F[V];G[17]===G[3]&&dd(G[1],G,O,i)}if(null!==F[9]){const V=F[9];for(let G=0;G<V.length;G++){const ie=V[G];dd(ie[1],ie,O,i)}}}}}return i}function qn(t){const e=je(),n=Et(),i=Eg();pu(i+1);const r=Dy(n,i);if(t.dirty&&yg(e)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const s=r.crossesNgTemplate?dd(n,e,i,[]):Ey(n,e,r,i);t.reset(s,Nv),t.notifyOnChanges()}return!0}return!1}function Di(t,e,n){const i=Et();i.firstCreatePass&&(function(t,e,n){null===t.queries&&(t.queries=new ud),t.queries.track(new hd(e,n))}(i,new xy(t,e,n),-1),2==(2&e)&&(i.staticViewQueries=!0)),function(t,e,n){const i=new Kl(4==(4&n));um(t,e,i,i.destroy),null===e[19]&&(e[19]=new cd),e[19].queries.push(new ld(i))}(i,je(),e)}function Qn(){return function(t,e){return t[19].queries[e].queryList}(je(),Eg())}function Dy(t,e){return t.queries.getByIndex(e)}function Py(t,e){return $l(t,e)}const ga=new At("Application Initializer");let io=(()=>{class t{constructor(n){this.appInits=n,this.resolve=Ul,this.reject=Ul,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const n=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Rl(s))n.push(s);else if(Oh(s)){const d=new Promise((y,w)=>{s.subscribe({complete:y,error:w})});n.push(d)}}Promise.all(n).then(()=>{i()}).catch(r=>{this.reject(r)}),0===n.length&&i(),this.initialized=!0}}return t.\u0275fac=function(n){return new(n||t)(Ge(ga,8))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const pa=new At("AppId"),$1={provide:pa,useFactory:function(){return`${yd()}${yd()}${yd()}`},deps:[]};function yd(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Yy=new At("Platform Initializer"),bd=new At("Platform ID"),Xy=new At("appBootstrapListener");let ec=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const Er=new At("LocaleId"),qy=new At("DefaultCurrencyCode");class X1{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}const Cd=function(t){return new od(t)},q1=Cd,Q1=function(t){return Promise.resolve(Cd(t))},Qy=function(t){const e=Cd(t),i=Ui(ei(t).declarations).reduce((r,s)=>{const d=An(s);return d&&r.push(new my(d)),r},[]);return new X1(e,i)},K1=Qy,J1=function(t){return Promise.resolve(Qy(t))};let qr=(()=>{class t{constructor(){this.compileModuleSync=q1,this.compileModuleAsync=Q1,this.compileModuleAndAllComponentsSync=K1,this.compileModuleAndAllComponentsAsync=J1}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const tM=(()=>Promise.resolve(0))();function Sd(t){"undefined"==typeof Zone?tM.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Kt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new cn(!1),this.onMicrotaskEmpty=new cn(!1),this.onStable=new cn(!1),this.onError=new cn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&n,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function(){let t=Pt.requestAnimationFrame,e=Pt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Pt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,xd(t),t.isCheckStableRunning=!0,wd(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),xd(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,d,y)=>{try{return Ky(t),n.invokeTask(r,s,d,y)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),Jy(t)}},onInvoke:(n,i,r,s,d,y,w)=>{try{return Ky(t),n.invoke(r,s,d,y,w)}finally{t.shouldCoalesceRunChangeDetection&&e(),Jy(t)}},onHasTask:(n,i,r,s)=>{n.hasTask(r,s),i===r&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,xd(t),wd(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,i,r,s)=>(n.handleError(r,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Kt.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Kt.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,n,i){return this._inner.run(e,n,i)}runTask(e,n,i,r){const s=this._inner,d=s.scheduleEventTask("NgZoneEvent: "+r,e,iM,Ul,Ul);try{return s.runTask(d,n,i)}finally{s.cancelTask(d)}}runGuarded(e,n,i){return this._inner.runGuarded(e,n,i)}runOutsideAngular(e){return this._outer.run(e)}}const iM={};function wd(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function xd(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function Ky(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Jy(t){t._nesting--,wd(t)}class oM{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new cn,this.onMicrotaskEmpty=new cn,this.onStable=new cn,this.onError=new cn}run(e,n,i){return e.apply(n,i)}runGuarded(e,n,i){return e.apply(n,i)}runOutsideAngular(e){return e()}runTask(e,n,i,r){return e.apply(n,i)}}let Ed=(()=>{class t{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Kt.assertNotInAngularZone(),Sd(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Sd(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(d=>d.timeoutId!==s),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:r})}whenStable(n,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,i,r){return[]}}return t.\u0275fac=function(n){return new(n||t)(Ge(Kt))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),Zy=(()=>{class t{constructor(){this._applications=new Map,Ad.addToWindow(this)}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return Ad.findTestabilityInTree(this,n,i)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class aM{addToWindow(e){}findTestabilityInTree(e,n,i){return null}}let Ad=new aM,e0=!0,t0=!1;let Pi;const i0=new At("AllowMultipleToken");class Td{constructor(e,n){this.name=e,this.token=n}}function r0(t,e,n=[]){const i=`Platform: ${e}`,r=new At(i);return(s=[])=>{let d=s0();if(!d||d.injector.get(i0,!1))if(t)t(n.concat(s).concat({provide:r,useValue:!0}));else{const y=n.concat(s).concat({provide:r,useValue:!0},{provide:zo,useValue:"platform"});!function(t){if(Pi&&!Pi.destroyed&&!Pi.injector.get(i0,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Pi=t.get(o0);const e=t.get(Yy,null);e&&e.forEach(n=>n())}(It.create({providers:y,name:i}))}return function(t){const e=s0();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function s0(){return Pi&&!Pi.destroyed?Pi:null}let o0=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const y=function(t,e){let n;return n="noop"===t?new oM:("zone.js"===t?void 0:t)||new Kt({enableLongStackTrace:(t0=!0,e0),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),w=[{provide:Kt,useValue:y}];return y.run(()=>{const O=It.create({providers:w,parent:this.injector,name:n.moduleType.name}),F=n.create(O),V=F.injector.get(Hr,null);if(!V)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return y.runOutsideAngular(()=>{const G=y.onError.subscribe({next:ie=>{V.handleError(ie)}});F.onDestroy(()=>{Dd(this._modules,F),G.unsubscribe()})}),function(t,e,n){try{const i=n();return Rl(i)?i.catch(r=>{throw e.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>t.handleError(i)),i}}(V,y,()=>{const G=F.injector.get(io);return G.runInitializers(),G.donePromise.then(()=>(Nh(F.injector.get(Er,Ll)||Ll),this._moduleDoBootstrap(F),F))})})}bootstrapModule(n,i=[]){const r=a0({},i);return function(t,e,n){const i=new od(n);return Promise.resolve(i)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(n){const i=n.injector.get(ro);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!n.instance.ngDoBootstrap)throw new Error(`The module ${Ke(n.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(n){return new(n||t)(Ge(It))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();function a0(t,e){return Array.isArray(e)?e.reduce(a0,t):Object.assign(Object.assign({},t),e)}let ro=(()=>{class t{constructor(n,i,r,s,d){this._zone=n,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=d,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const y=new T(O=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{O.next(this._stable),O.complete()})}),w=new T(O=>{let F;this._zone.runOutsideAngular(()=>{F=this._zone.onStable.subscribe(()=>{Kt.assertNotInAngularZone(),Sd(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,O.next(!0))})})});const V=this._zone.onUnstable.subscribe(()=>{Kt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{O.next(!1)}))});return()=>{F.unsubscribe(),V.unsubscribe()}});this.isStable=Oe(y,w.pipe(t=>Ye()(function(t,e){return function(i){let r;r="function"==typeof t?t:function(){return t};const s=Object.create(i,re);return s.source=i,s.subjectFactory=r,s}}(ut)(t))))}bootstrap(n,i){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let r;r=n instanceof Rv?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(r.componentType);const s=function(t){return t.isBoundToModule}(r)?void 0:this._injector.get($i),y=r.create(It.NULL,[],i||r.selector,s),w=y.location.nativeElement,O=y.injector.get(Ed,null),F=O&&y.injector.get(Zy);return O&&F&&F.registerApplication(w,O),y.onDestroy(()=>{this.detachView(y.hostView),Dd(this.components,y),F&&F.unregisterApplication(w)}),this._loadComponent(y),y}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;Dd(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(Xy,[]).concat(this._bootstrapListeners).forEach(r=>r(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(n){return new(n||t)(Ge(Kt),Ge(It),Ge(Hr),Ge($r),Ge(io))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();function Dd(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class nc{}class SM{}const wM={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let xM=(()=>{class t{constructor(n,i){this._compiler=n,this._config=i||wM}load(n){return this.loadAndCompile(n)}loadAndCompile(n){let[i,r]=n.split("#");return void 0===r&&(r="default"),Ae(255)(i).then(s=>s[r]).then(s=>h0(s,i,r)).then(s=>this._compiler.compileModuleAsync(s))}loadFactory(n){let[i,r]=n.split("#"),s="NgFactory";return void 0===r&&(r="default",s=""),Ae(255)(this._config.factoryPathPrefix+i+this._config.factoryPathSuffix).then(d=>d[r+s]).then(d=>h0(d,i,r))}}return t.\u0275fac=function(n){return new(n||t)(Ge(qr),Ge(SM,8))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();function h0(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const RM=r0(null,"core",[{provide:bd,useValue:"unknown"},{provide:o0,deps:[It]},{provide:Zy,deps:[]},{provide:ec,deps:[]}]),jM=[{provide:ro,useClass:ro,deps:[Kt,It,Hr,$r,io]},{provide:UP,deps:[Kt],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(n){e.push(n)}}},{provide:io,useClass:io,deps:[[new Ln,ga]]},{provide:qr,useClass:qr,deps:[]},$1,{provide:ea,useFactory:function(){return FD},deps:[]},{provide:Qs,useFactory:function(){return LD},deps:[]},{provide:Er,useFactory:function(t){return Nh(t=t||"undefined"!=typeof $localize&&$localize.locale||Ll),t},deps:[[new ws(Er),new Ln,new br]]},{provide:qy,useValue:"USD"}];let UM=(()=>{class t{constructor(n){}}return t.\u0275fac=function(n){return new(n||t)(Ge(ro))},t.\u0275mod=Zi({type:t}),t.\u0275inj=fi({providers:jM}),t})(),dc=null;function Tr(){return dc}const mn=new At("DocumentToken");let Jr=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=gt({factory:VO,token:t,providedIn:"platform"}),t})();function VO(){return Ge(F0)}const UO=new At("Location Initialized");let F0=(()=>{class t extends Jr{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Tr().getBaseHref(this._doc)}onPopState(n){const i=Tr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=Tr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,i,r){L0()?this._history.pushState(n,i,r):this.location.hash=r}replaceState(n,i,r){L0()?this._history.replaceState(n,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return t.\u0275fac=function(n){return new(n||t)(Ge(mn))},t.\u0275prov=gt({factory:HO,token:t,providedIn:"platform"}),t})();function L0(){return!!window.history.pushState}function HO(){return new F0(Ge(mn))}function Wd(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function N0(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function lr(t){return t&&"?"!==t[0]?"?"+t:t}let ao=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=gt({factory:WO,token:t,providedIn:"root"}),t})();function WO(t){const e=Ge(mn).location;return new B0(Ge(Jr),e&&e.origin||"")}const zd=new At("appBaseHref");let B0=(()=>{class t extends ao{constructor(n,i){if(super(),this._platformLocation=n,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return Wd(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+lr(this._platformLocation.search),r=this._platformLocation.hash;return r&&n?`${i}${r}`:i}pushState(n,i,r,s){const d=this.prepareExternalUrl(r+lr(s));this._platformLocation.pushState(n,i,d)}replaceState(n,i,r,s){const d=this.prepareExternalUrl(r+lr(s));this._platformLocation.replaceState(n,i,d)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,n)}}return t.\u0275fac=function(n){return new(n||t)(Ge(Jr),Ge(zd,8))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),zO=(()=>{class t extends ao{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=Wd(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,r,s){let d=this.prepareExternalUrl(r+lr(s));0==d.length&&(d=this._platformLocation.pathname),this._platformLocation.pushState(n,i,d)}replaceState(n,i,r,s){let d=this.prepareExternalUrl(r+lr(s));0==d.length&&(d=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,d)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,n)}}return t.\u0275fac=function(n){return new(n||t)(Ge(Jr),Ge(zd,8))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),fc=(()=>{class t{constructor(n,i){this._subject=new cn,this._urlChangeListeners=[],this._platformStrategy=n;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=N0(j0(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(n=!1){return this.normalize(this._platformStrategy.path(n))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+lr(i))}normalize(n){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,j0(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._platformStrategy.prepareExternalUrl(n)}go(n,i="",r=null){this._platformStrategy.pushState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+lr(i)),r)}replaceState(n,i="",r=null){this._platformStrategy.replaceState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+lr(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,n)}onUrlChange(n){this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(r=>r(n,i))}subscribe(n,i,r){return this._subject.subscribe({next:n,error:i,complete:r})}}return t.\u0275fac=function(n){return new(n||t)(Ge(ao),Ge(Jr))},t.normalizeQueryParams=lr,t.joinWithSlash=Wd,t.stripTrailingSlash=N0,t.\u0275prov=gt({factory:GO,token:t,providedIn:"root"}),t})();function GO(){return new fc(Ge(ao),Ge(Jr))}function j0(t){return t.replace(/\/index.html$/,"")}var en=(()=>((en=en||{})[en.Zero=0]="Zero",en[en.One=1]="One",en[en.Two=2]="Two",en[en.Few=3]="Few",en[en.Many=4]="Many",en[en.Other=5]="Other",en))();const ZO=function(t){return function(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=lv(e);if(n)return n;const i=e.split("-")[0];if(n=lv(i),n)return n;if("en"===i)return dT;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[He.PluralCase]};class wc{}let DI=(()=>{class t extends wc{constructor(n){super(),this.locale=n}getPluralCategory(n,i){switch(ZO(i||this.locale)(n)){case en.Zero:return"zero";case en.One:return"one";case en.Two:return"two";case en.Few:return"few";case en.Many:return"many";default:return"other"}}}return t.\u0275fac=function(n){return new(n||t)(Ge(Er))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),lo=(()=>{class t{constructor(n,i){this._viewContainer=n,this._context=new FI,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){q0("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){q0("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return t.\u0275fac=function(n){return new(n||t)(Qe(Ei),Qe(or))},t.\u0275dir=yn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class FI{constructor(){this.$implicit=null,this.ngIf=null}}function q0(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Ke(e)}'.`)}let J0=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Zi({type:t}),t.\u0275inj=fi({providers:[{provide:wc,useClass:DI}]}),t})();let eb=(()=>{class t{}return t.\u0275prov=gt({token:t,providedIn:"root",factory:()=>new uk(Ge(mn),window)}),t})();class uk{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const n=function(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const i=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const d=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(d)return d}r=i.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),this.attemptFocus(n))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=e)}}scrollToElement(e){const n=e.getBoundingClientRect(),i=n.left+this.window.pageXOffset,r=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=tb(this.window.history)||tb(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function tb(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class rf extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(t){dc||(dc=t)}(new rf)}onAndCancel(e,n,i){return e.addEventListener(n,i,!1),()=>{e.removeEventListener(n,i,!1)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=(Sa=Sa||document.querySelector("base"),Sa?Sa.getAttribute("href"):null);return null==n?null:function(t){xc=xc||document.createElement("a"),xc.setAttribute("href",t);const e=xc.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){Sa=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const i=n.indexOf("="),[r,s]=-1==i?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let xc,Sa=null;const nb=new At("TRANSITION_ID"),_k=[{provide:ga,useFactory:function(t,e,n){return()=>{n.get(io).donePromise.then(()=>{const i=Tr(),r=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[nb,mn,It],multi:!0}];class sf{static init(){!function(t){Ad=t}(new sf)}addToWindow(e){Pt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Pt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Pt.getAllAngularRootElements=()=>e.getAllRootElements(),Pt.frameworkStabilizers||(Pt.frameworkStabilizers=[]),Pt.frameworkStabilizers.push(i=>{const r=Pt.getAllAngularTestabilities();let s=r.length,d=!1;const y=function(w){d=d||w,s--,0==s&&i(d)};r.forEach(function(w){w.whenStable(y)})})}findTestabilityInTree(e,n,i){if(null==n)return null;const r=e.getTestability(n);return null!=r?r:i?Tr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null}}let vk=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const wa=new At("EventManagerPlugins");let Ac=(()=>{class t{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(r=>r.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,i,r){return this._findPluginFor(i).addEventListener(n,i,r)}addGlobalEventListener(n,i,r){return this._findPluginFor(i).addGlobalEventListener(n,i,r)}getZone(){return this._zone}_findPluginFor(n){const i=this._eventNameToPlugin.get(n);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const d=r[s];if(d.supports(n))return this._eventNameToPlugin.set(n,d),d}throw new Error(`No event manager plugin found for event ${n}`)}}return t.\u0275fac=function(n){return new(n||t)(Ge(wa),Ge(Kt))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class of{constructor(e){this._doc=e}addGlobalEventListener(e,n,i){const r=Tr().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${n}`);return this.addEventListener(r,n,i)}}let rb=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(n){const i=new Set;n.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),xa=(()=>{class t extends rb{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,i,r){n.forEach(s=>{const d=this._doc.createElement("style");d.textContent=s,r.push(i.appendChild(d))})}addHost(n){const i=[];this._addStylesToHost(this._stylesSet,n,i),this._hostNodes.set(n,i)}removeHost(n){const i=this._hostNodes.get(n);i&&i.forEach(sb),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(n,r,i)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(sb))}}return t.\u0275fac=function(n){return new(n||t)(Ge(mn))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();function sb(t){Tr().remove(t)}const af={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},lf=/%COMP%/g;function Tc(t,e,n){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?Tc(t,r,n):(r=r.replace(lf,t),n.push(r))}return n}function lb(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let cf=(()=>{class t{constructor(n,i,r){this.eventManager=n,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new uf(n)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;switch(i.encapsulation){case rn.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new kk(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(n),r}case 1:case rn.ShadowDom:return new Rk(this.eventManager,this.sharedStylesHost,n,i);default:if(!this.rendererByCompId.has(i.id)){const r=Tc(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(n){return new(n||t)(Ge(Ac),Ge(xa),Ge(pa))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();class uf{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,n){return n?document.createElementNS(af[n]||n,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,n){e.appendChild(n)}insertBefore(e,n,i){e&&e.insertBefore(n,i)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return n||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,i,r){if(r){n=r+":"+n;const s=af[r];s?e.setAttributeNS(s,n,i):e.setAttribute(n,i)}else e.setAttribute(n,i)}removeAttribute(e,n,i){if(i){const r=af[i];r?e.removeAttributeNS(r,n):e.removeAttribute(`${i}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,i,r){r&(Yn.DashCase|Yn.Important)?e.style.setProperty(n,i,r&Yn.Important?"important":""):e.style[n]=i}removeStyle(e,n,i){i&Yn.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,i){e[n]=i}setValue(e,n){e.nodeValue=n}listen(e,n,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,n,lb(i)):this.eventManager.addEventListener(e,n,lb(i))}}class kk extends uf{constructor(e,n,i,r){super(e),this.component=i;const s=Tc(r+"-"+i.id,i.styles,[]);n.addStyles(s),this.contentAttr=function(t){return"_ngcontent-%COMP%".replace(lf,t)}(r+"-"+i.id),this.hostAttr=function(t){return"_nghost-%COMP%".replace(lf,t)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,n){const i=super.createElement(e,n);return super.setAttribute(i,this.contentAttr,""),i}}class Rk extends uf{constructor(e,n,i,r){super(e),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Tc(r.id,r.styles,[]);for(let d=0;d<s.length;d++){const y=document.createElement("style");y.textContent=s[d],this.shadowRoot.appendChild(y)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,i){return super.insertBefore(this.nodeOrShadowRoot(e),n,i)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Fk=(()=>{class t extends of{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,r){return n.addEventListener(i,r,!1),()=>this.removeEventListener(n,i,r)}removeEventListener(n,i,r){return n.removeEventListener(i,r)}}return t.\u0275fac=function(n){return new(n||t)(Ge(mn))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const hb=["alt","control","meta","shift"],Hk={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},db={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Wk={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let zk=(()=>{class t extends of{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,i,r){const s=t.parseEventName(i),d=t.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Tr().onAndCancel(n,s.domEventName,d))}static parseEventName(n){const i=n.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=t._normalizeKey(i.pop());let d="";if(hb.forEach(w=>{const O=i.indexOf(w);O>-1&&(i.splice(O,1),d+=w+".")}),d+=s,0!=i.length||0===s.length)return null;const y={};return y.domEventName=r,y.fullKey=d,y}static getEventFullKey(n){let i="",r=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&db.hasOwnProperty(e)&&(e=db[e]))}return Hk[e]||e}(n);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),hb.forEach(s=>{s!=r&&Wk[s](n)&&(i+=s+".")}),i+=r,i}static eventCallback(n,i,r){return s=>{t.getEventFullKey(s)===n&&r.runGuarded(()=>i(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return t.\u0275fac=function(n){return new(n||t)(Ge(mn))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const Qk=[{provide:bd,useValue:"browser"},{provide:Yy,useValue:function(){rf.makeCurrent(),sf.init()},multi:!0},{provide:mn,useFactory:function(){return function(t){ou=t}(document),document},deps:[]}],Jk=r0(RM,"browser",Qk),Zk=[[],{provide:zo,useValue:"root"},{provide:Hr,useFactory:function(){return new Hr},deps:[]},{provide:wa,useClass:Fk,multi:!0,deps:[mn,Kt,bd]},{provide:wa,useClass:zk,multi:!0,deps:[mn]},[],{provide:cf,useClass:cf,deps:[Ac,xa,pa]},{provide:Hl,useExisting:cf},{provide:rb,useExisting:xa},{provide:xa,useClass:xa,deps:[mn]},{provide:Ed,useClass:Ed,deps:[Kt]},{provide:Ac,useClass:Ac,deps:[wa,Kt]},{provide:class{},useClass:vk,deps:[]},[]];let eR=(()=>{class t{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:t,providers:[{provide:pa,useValue:n.appId},{provide:nb,useExisting:pa},_k]}}}return t.\u0275fac=function(n){return new(n||t)(Ge(t,12))},t.\u0275mod=Zi({type:t}),t.\u0275inj=fi({providers:Zk,imports:[J0,UM]}),t})();function ht(...t){let e=t[t.length-1];return ce(e)?(t.pop(),Q(t,e)):Re(t)}"undefined"!=typeof window&&window;class Ri extends ne{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return n&&!n.closed&&e.next(this._value),n}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new H;return this._value}next(e){super.next(this._value=e)}}class lR extends a{notifyNext(e,n,i,r,s){this.destination.next(n)}notifyError(e,n){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class cR extends a{constructor(e,n,i){super(),this.parent=e,this.outerValue=n,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function uR(t,e,n,i,r=new cR(t,n,i)){if(!r.closed)return e instanceof T?e.subscribe(r):R(e)(r)}const gb={};class dR{constructor(e){this.resultSelector=e}call(e,n){return n.subscribe(new fR(e,this.resultSelector))}}class fR extends lR{constructor(e,n){super(e),this.resultSelector=n,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(gb),this.observables.push(e)}_complete(){const e=this.observables,n=e.length;if(0===n)this.destination.complete();else{this.active=n,this.toRespond=n;for(let i=0;i<n;i++)this.add(uR(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,n,i){const r=this.values,d=this.toRespond?r[i]===gb?--this.toRespond:this.toRespond:0;r[i]=n,0===d&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))}_tryResultSelector(e){let n;try{n=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(n)}}const Dc=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})();function Pc(){return Te(1)}function pf(...t){return Pc()(ht(...t))}const co=new T(t=>t.complete());function mf(t){return t?function(t){return new T(e=>t.schedule(()=>e.complete()))}(t):co}function pb(t){return new T(e=>{let n;try{n=t()}catch(r){return void e.error(r)}return(n?he(n):mf()).subscribe(e)})}function Pr(t,e){return"function"==typeof e?n=>n.pipe(Pr((i,r)=>he(t(i,r)).pipe(Y((s,d)=>e(i,s,r,d))))):n=>n.lift(new pR(t))}class pR{constructor(e){this.project=e}call(e,n){return n.subscribe(new mR(e,this.project))}}class mR extends ue{constructor(e,n){super(e),this.project=n,this.index=0}_next(e){let n;const i=this.index++;try{n=this.project(e,i)}catch(r){return void this.destination.error(r)}this._innerSub(n)}_innerSub(e){const n=this.innerSubscription;n&&n.unsubscribe();const i=new _e(this),r=this.destination;r.add(i),this.innerSubscription=U(e,i),this.innerSubscription!==i&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;(!e||e.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const mb=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function _f(t){return e=>0===t?mf():e.lift(new _R(t))}class _R{constructor(e){if(this.total=e,this.total<0)throw new mb}call(e,n){return n.subscribe(new vR(e,this.total))}}class vR extends a{constructor(e,n){super(e),this.total=n,this.count=0}_next(e){const n=this.total,i=++this.count;i<=n&&(this.destination.next(e),i===n&&(this.destination.complete(),this.unsubscribe()))}}function _b(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new bR(t,e,n))}}class bR{constructor(e,n,i=!1){this.accumulator=e,this.seed=n,this.hasSeed=i}call(e,n){return n.subscribe(new CR(e,this.accumulator,this.seed,this.hasSeed))}}class CR extends a{constructor(e,n,i,r){super(e),this.accumulator=n,this._seed=i,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const n=this.index++;let i;try{i=this.accumulator(this.seed,e,n)}catch(r){this.destination.error(r)}this.seed=i,this.destination.next(i)}}function Zr(t,e){return function(i){return i.lift(new SR(t,e))}}class SR{constructor(e,n){this.predicate=e,this.thisArg=n}call(e,n){return n.subscribe(new wR(e,this.predicate,this.thisArg))}}class wR extends a{constructor(e,n,i){super(e),this.predicate=n,this.thisArg=i,this.count=0}_next(e){let n;try{n=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}n&&this.destination.next(e)}}function es(t){return function(n){const i=new xR(t),r=n.lift(i);return i.caught=r}}class xR{constructor(e){this.selector=e}call(e,n){return n.subscribe(new ER(e,this.selector,this.caught))}}class ER extends ue{constructor(e,n,i){super(e),this.selector=n,this.caught=i}error(e){if(!this.isStopped){let n;try{n=this.selector(e,this.caught)}catch(s){return void super.error(s)}this._unsubscribeAndRecycle();const i=new _e(this);this.add(i);const r=U(n,i);r!==i&&this.add(r)}}}function Ea(t,e){return q(t,e,1)}function vf(t){return function(n){return 0===t?mf():n.lift(new AR(t))}}class AR{constructor(e){if(this.total=e,this.total<0)throw new mb}call(e,n){return n.subscribe(new TR(e,this.total))}}class TR extends a{constructor(e,n){super(e),this.total=n,this.ring=new Array,this.count=0}_next(e){const n=this.ring,i=this.total,r=this.count++;n.length<i?n.push(e):n[r%i]=e}_complete(){const e=this.destination;let n=this.count;if(n>0){const i=this.count>=this.total?this.total:this.count,r=this.ring;for(let s=0;s<i;s++){const d=n++%i;e.next(r[d])}}e.complete()}}function vb(t=MR){return e=>e.lift(new DR(t))}class DR{constructor(e){this.errorFactory=e}call(e,n){return n.subscribe(new PR(e,this.errorFactory))}}class PR extends a{constructor(e,n){super(e),this.errorFactory=n,this.hasValue=!1}_next(e){this.hasValue=!0,this.destination.next(e)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(n){e=n}this.destination.error(e)}}}function MR(){return new Dc}function yb(t=null){return e=>e.lift(new OR(t))}class OR{constructor(e){this.defaultValue=e}call(e,n){return n.subscribe(new IR(e,this.defaultValue))}}class IR extends a{constructor(e,n){super(e),this.defaultValue=n,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function uo(t,e){const n=arguments.length>=2;return i=>i.pipe(t?Zr((r,s)=>t(r,s,i)):v,_f(1),n?yb(e):vb(()=>new Dc))}function Mr(){}function Kn(t,e,n){return function(r){return r.lift(new RR(t,e,n))}}class RR{constructor(e,n,i){this.nextOrObserver=e,this.error=n,this.complete=i}call(e,n){return n.subscribe(new FR(e,this.nextOrObserver,this.error,this.complete))}}class FR extends a{constructor(e,n,i,r){super(e),this._tapNext=Mr,this._tapError=Mr,this._tapComplete=Mr,this._tapError=i||Mr,this._tapComplete=r||Mr,S(n)?(this._context=this,this._tapNext=n):n&&(this._context=n,this._tapNext=n.next||Mr,this._tapError=n.error||Mr,this._tapComplete=n.complete||Mr)}_next(e){try{this._tapNext.call(this._context,e)}catch(n){return void this.destination.error(n)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(n){return void this.destination.error(n)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}class NR{constructor(e){this.callback=e}call(e,n){return n.subscribe(new BR(e,this.callback))}}class BR extends a{constructor(e,n){super(e),this.add(new g(n))}}class ur{constructor(e,n){this.id=e,this.url=n}}class yf extends ur{constructor(e,n,i="imperative",r=null){super(e,n),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Aa extends ur{constructor(e,n,i){super(e,n),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class bb extends ur{constructor(e,n,i){super(e,n),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class jR extends ur{constructor(e,n,i){super(e,n),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class VR extends ur{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class UR extends ur{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class HR extends ur{constructor(e,n,i,r,s){super(e,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class WR extends ur{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zR extends ur{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Cb{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Sb{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class GR{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $R{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class YR{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class XR{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wb{constructor(e,n,i){this.routerEvent=e,this.position=n,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const vt="primary";class qR{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function ho(t){return new qR(t)}const xb="ngNavigationCancelingError";function bf(t){const e=Error("NavigationCancelingError: "+t);return e[xb]=!0,e}function KR(t,e,n){const i=n.path.split("/");if(i.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||i.length<t.length))return null;const r={};for(let s=0;s<i.length;s++){const d=i[s],y=t[s];if(d.startsWith(":"))r[d.substring(1)]=y;else if(d!==y.path)return null}return{consumed:t.slice(0,i.length),posParams:r}}function Yi(t,e){const n=t?Object.keys(t):void 0,i=e?Object.keys(e):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!Eb(t[r],e[r]))return!1;return!0}function Eb(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),i=[...e].sort();return n.every((r,s)=>i[s]===r)}return t===e}function Ab(t){return Array.prototype.concat.apply([],t)}function Tb(t){return t.length>0?t[t.length-1]:null}function _n(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function Xi(t){return Oh(t)?t:Rl(t)?he(Promise.resolve(t)):ht(t)}const eF={exact:function Mb(t,e,n){if(!ns(t.segments,e.segments)||!Mc(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!t.children[i]||!Mb(t.children[i],e.children[i],n))return!1;return!0},subset:Ob},Db={exact:function(t,e){return Yi(t,e)},subset:function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>Eb(t[n],e[n]))},ignored:()=>!0};function Pb(t,e,n){return eF[n.paths](t.root,e.root,n.matrixParams)&&Db[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function Ob(t,e,n){return Ib(t,e,e.segments,n)}function Ib(t,e,n,i){if(t.segments.length>n.length){const r=t.segments.slice(0,n.length);return!(!ns(r,n)||e.hasChildren()||!Mc(r,n,i))}if(t.segments.length===n.length){if(!ns(t.segments,n)||!Mc(t.segments,n,i))return!1;for(const r in e.children)if(!t.children[r]||!Ob(t.children[r],e.children[r],i))return!1;return!0}{const r=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!(ns(t.segments,r)&&Mc(t.segments,r,i)&&t.children[vt])&&Ib(t.children[vt],e,s,i)}}function Mc(t,e,n){return e.every((i,r)=>Db[n](t[r].parameters,i.parameters))}class ts{constructor(e,n,i){this.root=e,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ho(this.queryParams)),this._queryParamMap}toString(){return sF.serialize(this)}}class wt{constructor(e,n){this.segments=e,this.children=n,this.parent=null,_n(n,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Oc(this)}}class Ta{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=ho(this.parameters)),this._parameterMap}toString(){return Lb(this)}}function ns(t,e){return t.length===e.length&&t.every((n,i)=>n.path===e[i].path)}class Cf{}class kb{parse(e){const n=new gF(e);return new ts(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){const n=`/${Da(e.root,!0)}`,i=function(t){const e=Object.keys(t).map(n=>{const i=t[n];return Array.isArray(i)?i.map(r=>`${Ic(n)}=${Ic(r)}`).join("&"):`${Ic(n)}=${Ic(i)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}(e.queryParams),r="string"==typeof e.fragment?`#${function(t){return encodeURI(t)}(e.fragment)}`:"";return`${n}${i}${r}`}}const sF=new kb;function Oc(t){return t.segments.map(e=>Lb(e)).join("/")}function Da(t,e){if(!t.hasChildren())return Oc(t);if(e){const n=t.children[vt]?Da(t.children[vt],!1):"",i=[];return _n(t.children,(r,s)=>{s!==vt&&i.push(`${s}:${Da(r,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}{const n=function(t,e){let n=[];return _n(t.children,(i,r)=>{r===vt&&(n=n.concat(e(i,r)))}),_n(t.children,(i,r)=>{r!==vt&&(n=n.concat(e(i,r)))}),n}(t,(i,r)=>r===vt?[Da(t.children[vt],!1)]:[`${r}:${Da(i,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[vt]?`${Oc(t)}/${n[0]}`:`${Oc(t)}/(${n.join("//")})`}}function Rb(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ic(t){return Rb(t).replace(/%3B/gi,";")}function Sf(t){return Rb(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function kc(t){return decodeURIComponent(t)}function Fb(t){return kc(t.replace(/\+/g,"%20"))}function Lb(t){return`${Sf(t.path)}${function(t){return Object.keys(t).map(e=>`;${Sf(e)}=${Sf(t[e])}`).join("")}(t.parameters)}`}const cF=/^[^\/()?;=#]+/;function Rc(t){const e=t.match(cF);return e?e[0]:""}const uF=/^[^=?&#]+/,dF=/^[^?&#]+/;class gF{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new wt([],{}):new wt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(i[vt]=new wt(e,n)),i}parseSegment(){const e=Rc(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new Ta(kc(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=Rc(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const r=Rc(this.remaining);r&&(i=r,this.capture(i))}e[kc(n)]=kc(i)}parseQueryParam(e){const n=function(t){const e=t.match(uF);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const d=function(t){const e=t.match(dF);return e?e[0]:""}(this.remaining);d&&(i=d,this.capture(i))}const r=Fb(n),s=Fb(i);if(e.hasOwnProperty(r)){let d=e[r];Array.isArray(d)||(d=[d],e[r]=d),d.push(s)}else e[r]=s}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Rc(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=vt);const d=this.parseChildren();n[s]=1===Object.keys(d).length?d[vt]:new wt([],d),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class Nb{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=wf(e,this._root);return n?n.children.map(i=>i.value):[]}firstChild(e){const n=wf(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=xf(e,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return xf(e,this._root).map(n=>n.value)}}function wf(t,e){if(t===e.value)return e;for(const n of e.children){const i=wf(t,n);if(i)return i}return null}function xf(t,e){if(t===e.value)return[e];for(const n of e.children){const i=xf(t,n);if(i.length)return i.unshift(e),i}return[]}class hr{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function Pa(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class Bb extends Nb{constructor(e,n){super(e),this.snapshot=n,Ef(this,e)}toString(){return this.snapshot.toString()}}function jb(t,e){const n=function(t,e){const d=new Fc([],{},{},"",{},vt,e,null,t.root,-1,{});return new Ub("",new hr(d,[]))}(t,e),i=new Ri([new Ta("",{})]),r=new Ri({}),s=new Ri({}),d=new Ri({}),y=new Ri(""),w=new is(i,r,d,y,s,vt,e,n.root);return w.snapshot=n.root,new Bb(new hr(w,[]),n)}class is{constructor(e,n,i,r,s,d,y,w){this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=d,this.component=y,this._futureSnapshot=w}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Y(e=>ho(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Y(e=>ho(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Vb(t,e="emptyOnly"){const n=t.pathFromRoot;let i=0;if("always"!==e)for(i=n.length-1;i>=1;){const r=n[i],s=n[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function(t){return t.reduce((e,n)=>({params:Object.assign(Object.assign({},e.params),n.params),data:Object.assign(Object.assign({},e.data),n.data),resolve:Object.assign(Object.assign({},e.resolve),n._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(i))}class Fc{constructor(e,n,i,r,s,d,y,w,O,F,V){this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=d,this.component=y,this.routeConfig=w,this._urlSegment=O,this._lastPathIndex=F,this._resolve=V}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ho(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ho(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ub extends Nb{constructor(e,n){super(n),this.url=e,Ef(this,n)}toString(){return Hb(this._root)}}function Ef(t,e){e.value._routerState=t,e.children.forEach(n=>Ef(t,n))}function Hb(t){const e=t.children.length>0?` { ${t.children.map(Hb).join(", ")} } `:"";return`${t.value}${e}`}function Af(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Yi(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),Yi(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Yi(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),Yi(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function Tf(t,e){const n=Yi(t.params,e.params)&&function(t,e){return ns(t,e)&&t.every((n,i)=>Yi(n.parameters,e[i].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||Tf(t.parent,e.parent))}function Lc(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=e.value;const r=function(t,e,n){return e.children.map(i=>{for(const r of n.children)if(t.shouldReuseRoute(i.value,r.value.snapshot))return Lc(t,i,r);return Lc(t,i)})}(t,e,n);return new hr(i,r)}{if(t.shouldAttach(e.value)){const s=t.retrieve(e.value);if(null!==s){const d=s.route;return Wb(e,d),d}}const i=function(t){return new is(new Ri(t.url),new Ri(t.params),new Ri(t.queryParams),new Ri(t.fragment),new Ri(t.data),t.outlet,t.component,t)}(e.value),r=e.children.map(s=>Lc(t,s));return new hr(i,r)}}function Wb(t,e){if(t.value.routeConfig!==e.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==e.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");e.value._futureSnapshot=t.value;for(let n=0;n<t.children.length;++n)Wb(t.children[n],e.children[n])}function Nc(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Ma(t){return"object"==typeof t&&null!=t&&t.outlets}function Df(t,e,n,i,r){let s={};return i&&_n(i,(d,y)=>{s[y]=Array.isArray(d)?d.map(w=>`${w}`):`${d}`}),new ts(n.root===t?e:zb(n.root,t,e),s,r)}function zb(t,e,n){const i={};return _n(t.children,(r,s)=>{i[s]=r===e?n:zb(r,e,n)}),new wt(t.segments,i)}class Gb{constructor(e,n,i){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=i,e&&i.length>0&&Nc(i[0]))throw new Error("Root segment cannot have matrix parameters");const r=i.find(Ma);if(r&&r!==Tb(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Pf{constructor(e,n,i){this.segmentGroup=e,this.processChildren=n,this.index=i}}function $b(t,e,n){if(t||(t=new wt([],{})),0===t.segments.length&&t.hasChildren())return Bc(t,e,n);const i=function(t,e,n){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(i>=n.length)return s;const d=t.segments[r],y=n[i];if(Ma(y))break;const w=`${y}`,O=i<n.length-1?n[i+1]:null;if(r>0&&void 0===w)break;if(w&&O&&"object"==typeof O&&void 0===O.outlets){if(!Xb(w,O,d))return s;i+=2}else{if(!Xb(w,{},d))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(t,e,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){const s=new wt(t.segments.slice(0,i.pathIndex),{});return s.children[vt]=new wt(t.segments.slice(i.pathIndex),t.children),Bc(s,0,r)}return i.match&&0===r.length?new wt(t.segments,{}):i.match&&!t.hasChildren()?Mf(t,e,n):i.match?Bc(t,0,r):Mf(t,e,n)}function Bc(t,e,n){if(0===n.length)return new wt(t.segments,{});{const i=function(t){return Ma(t[0])?t[0].outlets:{[vt]:t}}(n),r={};return _n(i,(s,d)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[d]=$b(t.children[d],e,s))}),_n(t.children,(s,d)=>{void 0===i[d]&&(r[d]=s)}),new wt(t.segments,r)}}function Mf(t,e,n){const i=t.segments.slice(0,e);let r=0;for(;r<n.length;){const s=n[r];if(Ma(s)){const w=AF(s.outlets);return new wt(i,w)}if(0===r&&Nc(n[0])){i.push(new Ta(t.segments[e].path,Yb(n[0]))),r++;continue}const d=Ma(s)?s.outlets[vt]:`${s}`,y=r<n.length-1?n[r+1]:null;d&&y&&Nc(y)?(i.push(new Ta(d,Yb(y))),r+=2):(i.push(new Ta(d,{})),r++)}return new wt(i,{})}function AF(t){const e={};return _n(t,(n,i)=>{"string"==typeof n&&(n=[n]),null!==n&&(e[i]=Mf(new wt([],{}),0,n))}),e}function Yb(t){const e={};return _n(t,(n,i)=>e[i]=`${n}`),e}function Xb(t,e,n){return t==n.path&&Yi(e,n.parameters)}class DF{constructor(e,n,i,r){this.routeReuseStrategy=e,this.futureState=n,this.currState=i,this.forwardEvent=r}activate(e){const n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,e),Af(this.futureState.root),this.activateChildRoutes(n,i,e)}deactivateChildRoutes(e,n,i){const r=Pa(n);e.children.forEach(s=>{const d=s.value.outlet;this.deactivateRoutes(s,r[d],i),delete r[d]}),_n(r,(s,d)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,n,i){const r=e.value,s=n?n.value:null;if(r===s)if(r.component){const d=i.getContext(r.outlet);d&&this.deactivateChildRoutes(e,n,d.children)}else this.deactivateChildRoutes(e,n,i);else s&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(e,n){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const i=n.getContext(e.value.outlet);if(i&&i.outlet){const r=i.outlet.detach(),s=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:s})}}deactivateRouteAndOutlet(e,n){const i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=Pa(e);for(const d of Object.keys(s))this.deactivateRouteAndItsChildren(s[d],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,n,i){const r=Pa(n);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new XR(s.value.snapshot))}),e.children.length&&this.forwardEvent(new $R(e.value.snapshot))}activateRoutes(e,n,i){const r=e.value,s=n?n.value:null;if(Af(r),r===s)if(r.component){const d=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,n,d.children)}else this.activateChildRoutes(e,n,i);else if(r.component){const d=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const y=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),d.children.onOutletReAttached(y.contexts),d.attachRef=y.componentRef,d.route=y.route.value,d.outlet&&d.outlet.attach(y.componentRef,y.route.value),qb(y.route)}else{const y=function(t){for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),w=y?y.module.componentFactoryResolver:null;d.attachRef=null,d.route=r,d.resolver=w,d.outlet&&d.outlet.activateWith(r,w),this.activateChildRoutes(e,null,d.children)}}else this.activateChildRoutes(e,null,i)}}function qb(t){Af(t.value),t.children.forEach(qb)}class Of{constructor(e,n){this.routes=e,this.module=n}}function Or(t){return"function"==typeof t}function rs(t){return t instanceof ts}const Oa=Symbol("INITIAL_VALUE");function Ia(){return Pr(t=>function(...t){let e,n;return ce(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&le(t[0])&&(t=t[0]),Re(t,n).lift(new dR(e))}(t.map(e=>e.pipe(_f(1),function(...t){const e=t[t.length-1];return ce(e)?(t.pop(),n=>pf(t,n,e)):n=>pf(t,n)}(Oa)))).pipe(_b((e,n)=>{let i=!1;return n.reduce((r,s,d)=>r!==Oa?r:(s===Oa&&(i=!0),i||!1!==s&&d!==n.length-1&&!rs(s)?r:s),e)},Oa),Zr(e=>e!==Oa),Y(e=>rs(e)?e:!0===e),_f(1)))}let Qb=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=gi({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(n,i){1&n&&Nt(0,"router-outlet")},directives:function(){return[Nf]},encapsulation:2}),t})();function Kb(t,e=""){for(let n=0;n<t.length;n++){const i=t[n];FF(i,LF(e,i))}}function FF(t,e){t.children&&Kb(t.children,e)}function LF(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function If(t){const e=t.children&&t.children.map(If),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==vt&&(n.component=Qb),n}function hi(t){return t.outlet||vt}function Jb(t,e){const n=t.filter(i=>hi(i)===e);return n.push(...t.filter(i=>hi(i)!==e)),n}const Zb={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function jc(t,e,n){var i;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?Object.assign({},Zb):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const s=(e.matcher||KR)(n,t,e);if(!s)return Object.assign({},Zb);const d={};_n(s.posParams,(w,O)=>{d[O]=w.path});const y=s.consumed.length>0?Object.assign(Object.assign({},d),s.consumed[s.consumed.length-1].parameters):d;return{matched:!0,consumedSegments:s.consumed,lastChild:s.consumed.length,parameters:y,positionalParamSegments:null!==(i=s.posParams)&&void 0!==i?i:{}}}function Vc(t,e,n,i,r="corrected"){if(n.length>0&&function(t,e,n){return n.some(i=>Uc(t,e,i)&&hi(i)!==vt)}(t,n,i)){const d=new wt(e,function(t,e,n,i){const r={};r[vt]=i,i._sourceSegment=t,i._segmentIndexShift=e.length;for(const s of n)if(""===s.path&&hi(s)!==vt){const d=new wt([],{});d._sourceSegment=t,d._segmentIndexShift=e.length,r[hi(s)]=d}return r}(t,e,i,new wt(n,t.children)));return d._sourceSegment=t,d._segmentIndexShift=e.length,{segmentGroup:d,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(i=>Uc(t,e,i))}(t,n,i)){const d=new wt(t.segments,function(t,e,n,i,r,s){const d={};for(const y of i)if(Uc(t,n,y)&&!r[hi(y)]){const w=new wt([],{});w._sourceSegment=t,w._segmentIndexShift="legacy"===s?t.segments.length:e.length,d[hi(y)]=w}return Object.assign(Object.assign({},r),d)}(t,e,n,i,t.children,r));return d._sourceSegment=t,d._segmentIndexShift=e.length,{segmentGroup:d,slicedSegments:n}}const s=new wt(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}function Uc(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function eC(t,e,n,i){return!!(hi(t)===i||i!==vt&&Uc(e,n,t))&&("**"===t.path||jc(e,t,n).matched)}function tC(t,e,n){return 0===e.length&&!t.children[n]}class ka{constructor(e){this.segmentGroup=e||null}}class nC{constructor(e){this.urlTree=e}}function Hc(t){return new T(e=>e.error(new ka(t)))}function iC(t){return new T(e=>e.error(new nC(t)))}function UF(t){return new T(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class zF{constructor(e,n,i,r,s){this.configLoader=n,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=e.get($i)}apply(){const e=Vc(this.urlTree.root,[],[],this.config).segmentGroup,n=new wt(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,n,vt).pipe(Y(s=>this.createUrlTree(kf(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(es(s=>{if(s instanceof nC)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof ka?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,vt).pipe(Y(r=>this.createUrlTree(kf(r),e.queryParams,e.fragment))).pipe(es(r=>{throw r instanceof ka?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,n,i){const r=e.segments.length>0?new wt([],{[vt]:e}):e;return new ts(r,n,i)}expandSegmentGroup(e,n,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,n,i).pipe(Y(s=>new wt([],s))):this.expandSegment(e,i,n,i.segments,r,!0)}expandChildren(e,n,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return he(r).pipe(Ea(s=>{const d=i.children[s],y=Jb(n,s);return this.expandSegmentGroup(e,y,d,s).pipe(Y(w=>({segment:w,outlet:s})))}),_b((s,d)=>(s[d.outlet]=d.segment,s),{}),function(t,e){const n=arguments.length>=2;return i=>i.pipe(t?Zr((r,s)=>t(r,s,i)):v,vf(1),n?yb(e):vb(()=>new Dc))}())}expandSegment(e,n,i,r,s,d){return he(i).pipe(Ea(y=>this.expandSegmentAgainstRoute(e,n,i,y,r,s,d).pipe(es(O=>{if(O instanceof ka)return ht(null);throw O}))),uo(y=>!!y),es((y,w)=>{if(y instanceof Dc||"EmptyError"===y.name){if(tC(n,r,s))return ht(new wt([],{}));throw new ka(n)}throw y}))}expandSegmentAgainstRoute(e,n,i,r,s,d,y){return eC(r,n,s,d)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,n,r,s,d):y&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,n,i,r,s,d):Hc(n):Hc(n)}expandSegmentAgainstRouteUsingRedirect(e,n,i,r,s,d){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,d):this.expandRegularSegmentAgainstRouteUsingRedirect(e,n,i,r,s,d)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?iC(s):this.lineralizeSegments(i,s).pipe(q(d=>{const y=new wt(d,{});return this.expandSegment(e,y,n,d,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,n,i,r,s,d){const{matched:y,consumedSegments:w,lastChild:O,positionalParamSegments:F}=jc(n,r,s);if(!y)return Hc(n);const V=this.applyRedirectCommands(w,r.redirectTo,F);return r.redirectTo.startsWith("/")?iC(V):this.lineralizeSegments(r,V).pipe(q(G=>this.expandSegment(e,n,i,G.concat(s.slice(O)),d,!1)))}matchSegmentAgainstRoute(e,n,i,r,s){if("**"===i.path)return i.loadChildren?(i._loadedConfig?ht(i._loadedConfig):this.configLoader.load(e.injector,i)).pipe(Y(G=>(i._loadedConfig=G,new wt(r,{})))):ht(new wt(r,{}));const{matched:d,consumedSegments:y,lastChild:w}=jc(n,i,r);if(!d)return Hc(n);const O=r.slice(w);return this.getChildConfig(e,i,r).pipe(q(V=>{const G=V.module,ie=V.routes,{segmentGroup:pe,slicedSegments:Ee}=Vc(n,y,O,ie),ve=new wt(pe.segments,pe.children);if(0===Ee.length&&ve.hasChildren())return this.expandChildren(G,ie,ve).pipe(Y(Je=>new wt(y,Je)));if(0===ie.length&&0===Ee.length)return ht(new wt(y,{}));const Ne=hi(i)===s;return this.expandSegment(G,ve,ie,Ee,Ne?vt:s,!0).pipe(Y(ze=>new wt(y.concat(ze.segments),ze.children)))}))}getChildConfig(e,n,i){return n.children?ht(new Of(n.children,e)):n.loadChildren?void 0!==n._loadedConfig?ht(n._loadedConfig):this.runCanLoadGuards(e.injector,n,i).pipe(q(r=>r?this.configLoader.load(e.injector,n).pipe(Y(s=>(n._loadedConfig=s,s))):function(t){return new T(e=>e.error(bf(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(n))):ht(new Of([],e))}runCanLoadGuards(e,n,i){const r=n.canLoad;if(!r||0===r.length)return ht(!0);const s=r.map(d=>{const y=e.get(d);let w;if(function(t){return t&&Or(t.canLoad)}(y))w=y.canLoad(n,i);else{if(!Or(y))throw new Error("Invalid CanLoad guard");w=y(n,i)}return Xi(w)});return ht(s).pipe(Ia(),Kn(d=>{if(!rs(d))return;const y=bf(`Redirecting to "${this.urlSerializer.serialize(d)}"`);throw y.url=d,y}),Y(d=>!0===d))}lineralizeSegments(e,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return ht(i);if(r.numberOfChildren>1||!r.children[vt])return UF(e.redirectTo);r=r.children[vt]}}applyRedirectCommands(e,n,i){return this.applyRedirectCreatreUrlTree(n,this.urlSerializer.parse(n),e,i)}applyRedirectCreatreUrlTree(e,n,i,r){const s=this.createSegmentGroup(e,n.root,i,r);return new ts(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const i={};return _n(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const y=r.substring(1);i[s]=n[y]}else i[s]=r}),i}createSegmentGroup(e,n,i,r){const s=this.createSegments(e,n.segments,i,r);let d={};return _n(n.children,(y,w)=>{d[w]=this.createSegmentGroup(e,y,i,r)}),new wt(s,d)}createSegments(e,n,i,r){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,n,i){const r=i[n.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${n.path}'.`);return r}findOrReturn(e,n){let i=0;for(const r of n){if(r.path===e.path)return n.splice(i),r;i++}return e}}function kf(t){const e={};for(const i of Object.keys(t.children)){const s=kf(t.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function(t){if(1===t.numberOfChildren&&t.children[vt]){const e=t.children[vt];return new wt(t.segments.concat(e.segments),e.children)}return t}(new wt(t.segments,e))}class rC{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Wc{constructor(e,n){this.component=e,this.route=n}}function YF(t,e,n){const i=t._root;return Ra(i,e?e._root:null,n,[i.value])}function zc(t,e,n){const i=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(e);return(i?i.module.injector:n).get(t)}function Ra(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=Pa(e);return t.children.forEach(d=>{(function(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,d=e?e.value:null,y=n?n.getContext(t.value.outlet):null;if(d&&s.routeConfig===d.routeConfig){const w=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!ns(t.url,e.url);case"pathParamsOrQueryParamsChange":return!ns(t.url,e.url)||!Yi(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Tf(t,e)||!Yi(t.queryParams,e.queryParams);default:return!Tf(t,e)}}(d,s,s.routeConfig.runGuardsAndResolvers);w?r.canActivateChecks.push(new rC(i)):(s.data=d.data,s._resolvedData=d._resolvedData),Ra(t,e,s.component?y?y.children:null:n,i,r),w&&y&&y.outlet&&y.outlet.isActivated&&r.canDeactivateChecks.push(new Wc(y.outlet.component,d))}else d&&Fa(e,y,r),r.canActivateChecks.push(new rC(i)),Ra(t,null,s.component?y?y.children:null:n,i,r)})(d,s[d.value.outlet],n,i.concat([d.value]),r),delete s[d.value.outlet]}),_n(s,(d,y)=>Fa(d,n.getContext(y),r)),r}function Fa(t,e,n){const i=Pa(t),r=t.value;_n(i,(s,d)=>{Fa(s,r.component?e?e.children.getContext(d):null:e,n)}),n.canDeactivateChecks.push(new Wc(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class oL{}function sC(t){return new T(e=>e.error(t))}class lL{constructor(e,n,i,r,s,d){this.rootComponentType=e,this.config=n,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=d}recognize(){const e=Vc(this.urlTree.root,[],[],this.config.filter(d=>void 0===d.redirectTo),this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,e,vt);if(null===n)return null;const i=new Fc([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},vt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new hr(i,n),s=new Ub(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const n=e.value,i=Vb(n,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,n):this.processSegment(e,n,n.segments,i)}processChildren(e,n){const i=[];for(const s of Object.keys(n.children)){const d=n.children[s],y=Jb(e,s),w=this.processSegmentGroup(y,d,s);if(null===w)return null;i.push(...w)}const r=oC(i);return function(t){t.sort((e,n)=>e.value.outlet===vt?-1:n.value.outlet===vt?1:e.value.outlet.localeCompare(n.value.outlet))}(r),r}processSegment(e,n,i,r){for(const s of e){const d=this.processSegmentAgainstRoute(s,n,i,r);if(null!==d)return d}return tC(n,i,r)?[]:null}processSegmentAgainstRoute(e,n,i,r){if(e.redirectTo||!eC(e,n,i,r))return null;let s,d=[],y=[];if("**"===e.path){const ie=i.length>0?Tb(i).parameters:{};s=new Fc(i,ie,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,cC(e),hi(e),e.component,e,aC(n),lC(n)+i.length,uC(e))}else{const ie=jc(n,e,i);if(!ie.matched)return null;d=ie.consumedSegments,y=i.slice(ie.lastChild),s=new Fc(d,ie.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,cC(e),hi(e),e.component,e,aC(n),lC(n)+d.length,uC(e))}const w=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(e),{segmentGroup:O,slicedSegments:F}=Vc(n,d,y,w.filter(ie=>void 0===ie.redirectTo),this.relativeLinkResolution);if(0===F.length&&O.hasChildren()){const ie=this.processChildren(w,O);return null===ie?null:[new hr(s,ie)]}if(0===w.length&&0===F.length)return[new hr(s,[])];const V=hi(e)===r,G=this.processSegment(w,O,F,V?vt:r);return null===G?null:[new hr(s,G)]}}function hL(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function oC(t){const e=[],n=new Set;for(const i of t){if(!hL(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),n.add(r)):e.push(i)}for(const i of n){const r=oC(i.children);e.push(new hr(i.value,r))}return e.filter(i=>!n.has(i))}function aC(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function lC(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function cC(t){return t.data||{}}function uC(t){return t.resolve||{}}function Rf(t){return Pr(e=>{const n=t(e);return n?he(n).pipe(Y(()=>e)):ht(e)})}class yL extends class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}{}const Ff=new At("ROUTES");class hC{constructor(e,n,i,r){this.loader=e,this.compiler=n,this.onLoadStartListener=i,this.onLoadEndListener=r}load(e,n){if(n._loader$)return n._loader$;this.onLoadStartListener&&this.onLoadStartListener(n);const r=this.loadModuleFactory(n.loadChildren).pipe(Y(s=>{this.onLoadEndListener&&this.onLoadEndListener(n);const d=s.create(e);return new Of(Ab(d.injector.get(Ff,void 0,tt.Self|tt.Optional)).map(If),d)}),es(s=>{throw n._loader$=void 0,s}));return n._loader$=new Ce(r,()=>new ne).pipe(Ye()),n._loader$}loadModuleFactory(e){return"string"==typeof e?he(this.loader.load(e)):Xi(e()).pipe(q(n=>n instanceof Gv?ht(n):he(this.compiler.compileModuleAsync(n))))}}class bL{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new fo,this.attachRef=null}}class fo{constructor(){this.contexts=new Map}onChildOutletCreated(e,n){const i=this.getOrCreateContext(e);i.outlet=n,this.contexts.set(e,i)}onChildOutletDestroyed(e){const n=this.getContext(e);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let n=this.getContext(e);return n||(n=new bL,this.contexts.set(e,n)),n}getContext(e){return this.contexts.get(e)||null}}class SL{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,n){return e}}function wL(t){throw t}function xL(t,e,n){return e.parse("/")}function dC(t,e){return ht(null)}const EL={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},AL={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Bn=(()=>{class t{constructor(n,i,r,s,d,y,w,O){this.rootComponentType=n,this.urlSerializer=i,this.rootContexts=r,this.location=s,this.config=O,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ne,this.errorHandler=wL,this.malformedUriErrorHandler=xL,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:dC,afterPreactivation:dC},this.urlHandlingStrategy=new SL,this.routeReuseStrategy=new yL,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=d.get($i),this.console=d.get(ec);const G=d.get(Kt);this.isNgZoneEnabled=G instanceof Kt&&Kt.isInAngularZone(),this.resetConfig(O),this.currentUrlTree=new ts(new wt([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new hC(y,w,ie=>this.triggerEvent(new Cb(ie)),ie=>this.triggerEvent(new Sb(ie))),this.routerState=jb(this.currentUrlTree,this.rootComponentType),this.transitions=new Ri({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var n;return null===(n=this.location.getState())||void 0===n?void 0:n.\u0275routerPageId}setupNavigations(n){const i=this.events;return n.pipe(Zr(r=>0!==r.id),Y(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Pr(r=>{let s=!1,d=!1;return ht(r).pipe(Kn(y=>{this.currentNavigation={id:y.id,initialUrl:y.currentRawUrl,extractedUrl:y.extractedUrl,trigger:y.source,extras:y.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Pr(y=>{const w=this.browserUrlTree.toString(),O=!this.navigated||y.extractedUrl.toString()!==w||w!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||O)&&this.urlHandlingStrategy.shouldProcessUrl(y.rawUrl))return Gc(y.source)&&(this.browserUrlTree=y.extractedUrl),ht(y).pipe(Pr(V=>{const G=this.transitions.getValue();return i.next(new yf(V.id,this.serializeUrl(V.extractedUrl),V.source,V.restoredState)),G!==this.transitions.getValue()?co:Promise.resolve(V)}),function(t,e,n,i){return Pr(r=>function(t,e,n,i,r){return new zF(t,e,n,i,r).apply()}(t,e,n,r.extractedUrl,i).pipe(Y(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Kn(V=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:V.urlAfterRedirects})}),function(t,e,n,i,r){return q(s=>function(t,e,n,i,r="emptyOnly",s="legacy"){try{const d=new lL(t,e,n,i,r,s).recognize();return null===d?sC(new oL):ht(d)}catch(d){return sC(d)}}(t,e,s.urlAfterRedirects,n(s.urlAfterRedirects),i,r).pipe(Y(d=>Object.assign(Object.assign({},s),{targetSnapshot:d}))))}(this.rootComponentType,this.config,V=>this.serializeUrl(V),this.paramsInheritanceStrategy,this.relativeLinkResolution),Kn(V=>{"eager"===this.urlUpdateStrategy&&(V.extras.skipLocationChange||this.setBrowserUrl(V.urlAfterRedirects,V),this.browserUrlTree=V.urlAfterRedirects);const G=new VR(V.id,this.serializeUrl(V.extractedUrl),this.serializeUrl(V.urlAfterRedirects),V.targetSnapshot);i.next(G)}));if(O&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:G,extractedUrl:ie,source:pe,restoredState:Ee,extras:ve}=y,Ne=new yf(G,this.serializeUrl(ie),pe,Ee);i.next(Ne);const Pe=jb(ie,this.rootComponentType).snapshot;return ht(Object.assign(Object.assign({},y),{targetSnapshot:Pe,urlAfterRedirects:ie,extras:Object.assign(Object.assign({},ve),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=y.rawUrl,this.browserUrlTree=y.urlAfterRedirects,y.resolve(null),co}),Rf(y=>{const{targetSnapshot:w,id:O,extractedUrl:F,rawUrl:V,extras:{skipLocationChange:G,replaceUrl:ie}}=y;return this.hooks.beforePreactivation(w,{navigationId:O,appliedUrlTree:F,rawUrlTree:V,skipLocationChange:!!G,replaceUrl:!!ie})}),Kn(y=>{const w=new UR(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(y.urlAfterRedirects),y.targetSnapshot);this.triggerEvent(w)}),Y(y=>Object.assign(Object.assign({},y),{guards:YF(y.targetSnapshot,y.currentSnapshot,this.rootContexts)})),function(t,e){return q(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:d}}=n;return 0===d.length&&0===s.length?ht(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,i){return he(t).pipe(q(r=>function(t,e,n,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?ht(s.map(y=>{const w=zc(y,e,r);let O;if(function(t){return t&&Or(t.canDeactivate)}(w))O=Xi(w.canDeactivate(t,e,n,i));else{if(!Or(w))throw new Error("Invalid CanDeactivate guard");O=Xi(w(t,e,n,i))}return O.pipe(uo())})).pipe(Ia()):ht(!0)}(r.component,r.route,n,e,i)),uo(r=>!0!==r,!0))}(d,i,r,t).pipe(q(y=>y&&function(t){return"boolean"==typeof t}(y)?function(t,e,n,i){return he(e).pipe(Ea(r=>pf(function(t,e){return null!==t&&e&&e(new GR(t)),ht(!0)}(r.route.parent,i),function(t,e){return null!==t&&e&&e(new YR(t)),ht(!0)}(r.route,i),function(t,e,n){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(d=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(d)).filter(d=>null!==d).map(d=>pb(()=>ht(d.guards.map(w=>{const O=zc(w,d.node,n);let F;if(function(t){return t&&Or(t.canActivateChild)}(O))F=Xi(O.canActivateChild(i,t));else{if(!Or(O))throw new Error("Invalid CanActivateChild guard");F=Xi(O(i,t))}return F.pipe(uo())})).pipe(Ia())));return ht(s).pipe(Ia())}(t,r.path,n),function(t,e,n){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return ht(!0);const r=i.map(s=>pb(()=>{const d=zc(s,e,n);let y;if(function(t){return t&&Or(t.canActivate)}(d))y=Xi(d.canActivate(e,t));else{if(!Or(d))throw new Error("Invalid CanActivate guard");y=Xi(d(e,t))}return y.pipe(uo())}));return ht(r).pipe(Ia())}(t,r.route,n))),uo(r=>!0!==r,!0))}(i,s,t,e):ht(y)),Y(y=>Object.assign(Object.assign({},n),{guardsResult:y})))})}(this.ngModule.injector,y=>this.triggerEvent(y)),Kn(y=>{if(rs(y.guardsResult)){const O=bf(`Redirecting to "${this.serializeUrl(y.guardsResult)}"`);throw O.url=y.guardsResult,O}const w=new HR(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(y.urlAfterRedirects),y.targetSnapshot,!!y.guardsResult);this.triggerEvent(w)}),Zr(y=>!!y.guardsResult||(this.restoreHistory(y),this.cancelNavigationTransition(y,""),!1)),Rf(y=>{if(y.guards.canActivateChecks.length)return ht(y).pipe(Kn(w=>{const O=new WR(w.id,this.serializeUrl(w.extractedUrl),this.serializeUrl(w.urlAfterRedirects),w.targetSnapshot);this.triggerEvent(O)}),Pr(w=>{let O=!1;return ht(w).pipe(function(t,e){return q(n=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return ht(n);let s=0;return he(r).pipe(Ea(d=>function(t,e,n,i){return function(t,e,n,i){const r=Object.keys(t);if(0===r.length)return ht({});const s={};return he(r).pipe(q(d=>function(t,e,n,i){const r=zc(t,e,i);return Xi(r.resolve?r.resolve(e,n):r(e,n))}(t[d],e,n,i).pipe(Kn(y=>{s[d]=y}))),vf(1),q(()=>Object.keys(s).length===r.length?ht(s):co))}(t._resolve,t,e,i).pipe(Y(s=>(t._resolvedData=s,t.data=Object.assign(Object.assign({},t.data),Vb(t,n).resolve),null)))}(d.route,i,t,e)),Kn(()=>s++),vf(1),q(d=>s===r.length?ht(n):co))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Kn({next:()=>O=!0,complete:()=>{O||(this.restoreHistory(w),this.cancelNavigationTransition(w,"At least one route resolver didn't emit any value."))}}))}),Kn(w=>{const O=new zR(w.id,this.serializeUrl(w.extractedUrl),this.serializeUrl(w.urlAfterRedirects),w.targetSnapshot);this.triggerEvent(O)}))}),Rf(y=>{const{targetSnapshot:w,id:O,extractedUrl:F,rawUrl:V,extras:{skipLocationChange:G,replaceUrl:ie}}=y;return this.hooks.afterPreactivation(w,{navigationId:O,appliedUrlTree:F,rawUrlTree:V,skipLocationChange:!!G,replaceUrl:!!ie})}),Y(y=>{const w=function(t,e,n){const i=Lc(t,e._root,n?n._root:void 0);return new Bb(i,e)}(this.routeReuseStrategy,y.targetSnapshot,y.currentRouterState);return Object.assign(Object.assign({},y),{targetRouterState:w})}),Kn(y=>{this.currentUrlTree=y.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(y.urlAfterRedirects,y.rawUrl),this.routerState=y.targetRouterState,"deferred"===this.urlUpdateStrategy&&(y.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,y),this.browserUrlTree=y.urlAfterRedirects)}),((t,e,n)=>Y(i=>(new DF(e,i.targetRouterState,i.currentRouterState,n).activate(t),i)))(this.rootContexts,this.routeReuseStrategy,y=>this.triggerEvent(y)),Kn({next(){s=!0},complete(){s=!0}}),function(t){return e=>e.lift(new NR(t))}(()=>{var y;if(!s&&!d){const w=`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`;"replace"===this.canceledNavigationResolution?(this.restoreHistory(r),this.cancelNavigationTransition(r,w)):this.cancelNavigationTransition(r,w)}(null===(y=this.currentNavigation)||void 0===y?void 0:y.id)===r.id&&(this.currentNavigation=null)}),es(y=>{if(d=!0,function(t){return t&&t[xb]}(y)){const w=rs(y.url);w||(this.navigated=!0,this.restoreHistory(r,!0));const O=new bb(r.id,this.serializeUrl(r.extractedUrl),y.message);i.next(O),w?setTimeout(()=>{const F=this.urlHandlingStrategy.merge(y.url,this.rawUrlTree),V={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Gc(r.source)};this.scheduleNavigation(F,"imperative",null,V,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const w=new jR(r.id,this.serializeUrl(r.extractedUrl),y);i.next(w);try{r.resolve(this.errorHandler(y))}catch(O){r.reject(O)}}return co}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}getTransition(){const n=this.transitions.value;return n.urlAfterRedirects=this.browserUrlTree,n}setTransition(n){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),n))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i=this.extractLocationChangeInfoFromEvent(n);this.shouldScheduleNavigation(this.lastLocationChangeInfo,i)&&setTimeout(()=>{const{source:r,state:s,urlTree:d}=i,y={replaceUrl:!0};if(s){const w=Object.assign({},s);delete w.navigationId,delete w.\u0275routerPageId,0!==Object.keys(w).length&&(y.state=w)}this.scheduleNavigation(d,r,s,y)},0),this.lastLocationChangeInfo=i}))}extractLocationChangeInfoFromEvent(n){var i;return{source:"popstate"===n.type?"popstate":"hashchange",urlTree:this.parseUrl(n.url),state:(null===(i=n.state)||void 0===i?void 0:i.navigationId)?n.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(n,i){if(!n)return!0;const r=i.urlTree.toString()===n.urlTree.toString();return i.transitionId!==n.transitionId||!r||!("hashchange"===i.source&&"popstate"===n.source||"popstate"===i.source&&"hashchange"===n.source)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){Kb(n),this.config=n.map(If),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:r,queryParams:s,fragment:d,queryParamsHandling:y,preserveFragment:w}=i,O=r||this.routerState.root,F=w?this.currentUrlTree.fragment:d;let V=null;switch(y){case"merge":V=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":V=this.currentUrlTree.queryParams;break;default:V=s||null}return null!==V&&(V=this.removeEmptyProps(V)),function(t,e,n,i,r){if(0===n.length)return Df(e.root,e.root,e,i,r);const s=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new Gb(!0,0,t);let e=0,n=!1;const i=t.reduce((r,s,d)=>{if("object"==typeof s&&null!=s){if(s.outlets){const y={};return _n(s.outlets,(w,O)=>{y[O]="string"==typeof w?w.split("/"):w}),[...r,{outlets:y}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===d?(s.split("/").forEach((y,w)=>{0==w&&"."===y||(0==w&&""===y?n=!0:".."===y?e++:""!=y&&r.push(y))}),r):[...r,s]},[]);return new Gb(n,e,i)}(n);if(s.toRoot())return Df(e.root,new wt([],{}),e,i,r);const d=function(t,e,n){if(t.isAbsolute)return new Pf(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const s=n.snapshot._urlSegment;return new Pf(s,s===e.root,0)}const i=Nc(t.commands[0])?0:1;return function(t,e,n){let i=t,r=e,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new Pf(i,!1,r-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,t.numberOfDoubleDots)}(s,e,t),y=d.processChildren?Bc(d.segmentGroup,d.index,s.commands):$b(d.segmentGroup,d.index,s.commands);return Df(d.segmentGroup,y,e,i,r)}(O,this.currentUrlTree,n,V,null!=F?F:null)}navigateByUrl(n,i={skipLocationChange:!1}){const r=rs(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(n,i={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,n)}return i}isActive(n,i){let r;if(r=!0===i?Object.assign({},EL):!1===i?Object.assign({},AL):i,rs(n))return Pb(this.currentUrlTree,n,r);const s=this.parseUrl(n);return Pb(this.currentUrlTree,s,r)}removeEmptyProps(n){return Object.keys(n).reduce((i,r)=>{const s=n[r];return null!=s&&(i[r]=s),i},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new Aa(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,i,r,s,d){var y,w;if(this.disposed)return Promise.resolve(!1);const O=this.getTransition(),F=Gc(i)&&O&&!Gc(O.source),ie=(this.lastSuccessfulId===O.id||this.currentNavigation?O.rawUrl:O.urlAfterRedirects).toString()===n.toString();if(F&&ie)return Promise.resolve(!0);let pe,Ee,ve;d?(pe=d.resolve,Ee=d.reject,ve=d.promise):ve=new Promise((ze,Je)=>{pe=ze,Ee=Je});const Ne=++this.navigationId;let Pe;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),Pe=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(y=this.browserPageId)&&void 0!==y?y:0:(null!==(w=this.browserPageId)&&void 0!==w?w:0)+1):Pe=0,this.setTransition({id:Ne,targetPageId:Pe,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:s,resolve:pe,reject:Ee,promise:ve,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),ve.catch(ze=>Promise.reject(ze))}setBrowserUrl(n,i){const r=this.urlSerializer.serialize(n),s=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(n,i=!1){var r,s;if("computed"===this.canceledNavigationResolution){const d=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===d?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===d&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(d)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,i){const r=new bb(n.id,this.serializeUrl(n.extractedUrl),i);this.triggerEvent(r),n.resolve(!1)}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return t.\u0275fac=function(n){return new(n||t)(Ge(cl),Ge(Cf),Ge(fo),Ge(fc),Ge(It),Ge(nc),Ge(qr),Ge(void 0))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();function Gc(t){return"imperative"!==t}let La=(()=>{class t{constructor(n,i,r,s,d){this.router=n,this.route=i,this.commands=[],this.onChanges=new ne,null==r&&s.setAttribute(d.nativeElement,"tabindex","0")}ngOnChanges(n){this.onChanges.next(this)}set routerLink(n){this.commands=null!=n?Array.isArray(n)?n:[n]:[]}onClick(){const n={skipLocationChange:go(this.skipLocationChange),replaceUrl:go(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,n),!0}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:go(this.preserveFragment)})}}return t.\u0275fac=function(n){return new(n||t)(Qe(Bn),Qe(is),Do("tabindex"),Qe(Wl),Qe(On))},t.\u0275dir=yn({type:t,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(n,i){1&n&&Dt("click",function(){return i.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[pr]}),t})();function go(t){return""===t||!!t}let Nf=(()=>{class t{constructor(n,i,r,s,d){this.parentContexts=n,this.location=i,this.resolver=r,this.changeDetector=d,this.activated=null,this._activatedRoute=null,this.activateEvents=new cn,this.deactivateEvents=new cn,this.name=s||vt,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=n;const d=(i=i||this.resolver).resolveComponentFactory(n._futureSnapshot.routeConfig.component),y=this.parentContexts.getOrCreateContext(this.name).children,w=new ML(n,y,this.location.injector);this.activated=this.location.createComponent(d,this.location.length,w),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(n){return new(n||t)(Qe(fo),Qe(Ei),Qe($r),Do("name"),Qe($h))},t.\u0275dir=yn({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class ML{constructor(e,n,i){this.route=e,this.childContexts=n,this.parent=i}get(e,n){return e===is?this.route:e===fo?this.childContexts:this.parent.get(e,n)}}class fC{}class gC{preload(e,n){return ht(null)}}let pC=(()=>{class t{constructor(n,i,r,s,d){this.router=n,this.injector=s,this.preloadingStrategy=d,this.loader=new hC(i,r,O=>n.triggerEvent(new Cb(O)),O=>n.triggerEvent(new Sb(O)))}setUpPreloading(){this.subscription=this.router.events.pipe(Zr(n=>n instanceof Aa),Ea(()=>this.preload())).subscribe(()=>{})}preload(){const n=this.injector.get($i);return this.processRoutes(n,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const r=[];for(const s of i)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const d=s._loadedConfig;r.push(this.processRoutes(d.module,d.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(n,s)):s.children&&r.push(this.processRoutes(n,s.children));return he(r).pipe(Te(),Y(s=>{}))}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?ht(i._loadedConfig):this.loader.load(n.injector,i)).pipe(q(s=>(i._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return t.\u0275fac=function(n){return new(n||t)(Ge(Bn),Ge(nc),Ge(qr),Ge(It),Ge(fC))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})(),Bf=(()=>{class t{constructor(n,i,r={}){this.router=n,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof yf?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Aa&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof wb&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.router.triggerEvent(new wb(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(Ge(Bn),Ge(eb),Ge(void 0))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();const ss=new At("ROUTER_CONFIGURATION"),mC=new At("ROUTER_FORROOT_GUARD"),IL=[fc,{provide:Cf,useClass:kb},{provide:Bn,useFactory:function(t,e,n,i,r,s,d,y={},w,O){const F=new Bn(null,t,e,n,i,r,s,Ab(d));return w&&(F.urlHandlingStrategy=w),O&&(F.routeReuseStrategy=O),function(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy)}(y,F),y.enableTracing&&F.events.subscribe(V=>{var G,ie;null===(G=console.group)||void 0===G||G.call(console,`Router Event: ${V.constructor.name}`),console.log(V.toString()),console.log(V),null===(ie=console.groupEnd)||void 0===ie||ie.call(console)}),F},deps:[Cf,fo,fc,It,nc,qr,Ff,ss,[class{},new Ln],[class{},new Ln]]},fo,{provide:is,useFactory:function(t){return t.routerState.root},deps:[Bn]},{provide:nc,useClass:xM},pC,gC,class{preload(e,n){return n().pipe(es(()=>ht(null)))}},{provide:ss,useValue:{enableTracing:!1}}];function kL(){return new Td("Router",Bn)}let jf=(()=>{class t{constructor(n,i){}static forRoot(n,i){return{ngModule:t,providers:[IL,_C(n),{provide:mC,useFactory:LL,deps:[[Bn,new Ln,new br]]},{provide:ss,useValue:i||{}},{provide:ao,useFactory:FL,deps:[Jr,[new ws(zd),new Ln],ss]},{provide:Bf,useFactory:RL,deps:[Bn,eb,ss]},{provide:fC,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:gC},{provide:Td,multi:!0,useFactory:kL},[Vf,{provide:ga,multi:!0,useFactory:VL,deps:[Vf]},{provide:vC,useFactory:UL,deps:[Vf]},{provide:Xy,multi:!0,useExisting:vC}]]}}static forChild(n){return{ngModule:t,providers:[_C(n)]}}}return t.\u0275fac=function(n){return new(n||t)(Ge(mC,8),Ge(Bn,8))},t.\u0275mod=Zi({type:t}),t.\u0275inj=fi({}),t})();function RL(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new Bf(t,e,n)}function FL(t,e,n={}){return n.useHash?new zO(t,e):new B0(t,e)}function LL(t){return"guarded"}function _C(t){return[{provide:GS,multi:!0,useValue:t},{provide:Ff,multi:!0,useValue:t}]}let Vf=(()=>{class t{constructor(n){this.injector=n,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new ne}appInitializer(){return this.injector.get(UO,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const r=new Promise(y=>i=y),s=this.injector.get(Bn),d=this.injector.get(ss);return"disabled"===d.initialNavigation?(s.setUpLocationChangeListener(),i(!0)):"enabled"===d.initialNavigation||"enabledBlocking"===d.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?ht(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),s.initialNavigation()):i(!0),r})}bootstrapListener(n){const i=this.injector.get(ss),r=this.injector.get(pC),s=this.injector.get(Bf),d=this.injector.get(Bn),y=this.injector.get(ro);n===y.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&d.initialNavigation(),r.setUpPreloading(),s.init(),d.resetRootComponentType(y.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return t.\u0275fac=function(n){return new(n||t)(Ge(It))},t.\u0275prov=gt({token:t,factory:t.\u0275fac}),t})();function VL(t){return t.appInitializer.bind(t)}function UL(t){return t.bootstrapListener.bind(t)}const vC=new At("Router Initializer");let Na=(()=>{class t{constructor(){this.isSign1Isset=!0,this.signatureUrl1="https://siezlh4405.github.io/the-f2e-2022-w2/assets/file/sign1.png",this.isSign2Isset=!1,this.signatureUrl2="",this.saveUrl="https://siezlh4405.github.io/the-f2e-2022-w2/assets/file/pdf4.png",this.saveUrl1="https://siezlh4405.github.io/the-f2e-2022-w2/assets/file/pdf1.png",this.saveUrl2="https://siezlh4405.github.io/the-f2e-2022-w2/assets/file/pdf2.png",this.saveUrl3="https://siezlh4405.github.io/the-f2e-2022-w2/assets/file/pdf3.png",this.work="sign"}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=gt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function WL(t,e){if(1&t){const n=Si();Fe(0,"div",2),Fe(1,"p",3),ot(2,"PDF 1"),Le(),Fe(3,"div",4),Nt(4,"img",5),Le(),Fe(5,"div",6),Fe(6,"button",7),Dt("click",function(){return Cn(n),Wt().signautreService.saveUrl1=""}),ot(7,"\u522a\u9664"),Le(),Fe(8,"button",8),Dt("click",function(){Cn(n);const r=Wt();return r.download(r.signautreService.saveUrl1)}),ot(9,"\u4e0b\u8f09"),Le(),Le(),Le()}if(2&t){const n=Wt();Ct(4),Gs("src",n.signautreService.saveUrl1,tr)}}function zL(t,e){if(1&t){const n=Si();Fe(0,"div",2),Fe(1,"p",3),ot(2,"PDF 2"),Le(),Fe(3,"div",4),Nt(4,"img",5),Le(),Fe(5,"div",6),Fe(6,"button",7),Dt("click",function(){return Cn(n),Wt().signautreService.saveUrl2=""}),ot(7,"\u522a\u9664"),Le(),Fe(8,"button",8),Dt("click",function(){Cn(n);const r=Wt();return r.download(r.signautreService.saveUrl2)}),ot(9,"\u4e0b\u8f09"),Le(),Le(),Le()}if(2&t){const n=Wt();Ct(4),Gs("src",n.signautreService.saveUrl2,tr)}}function GL(t,e){if(1&t){const n=Si();Fe(0,"div",2),Fe(1,"p",3),ot(2,"PDF 3"),Le(),Fe(3,"div",4),Nt(4,"img",5),Le(),Fe(5,"div",6),Fe(6,"button",7),Dt("click",function(){return Cn(n),Wt().signautreService.saveUrl3=""}),ot(7,"\u522a\u9664"),Le(),Fe(8,"button",8),Dt("click",function(){Cn(n);const r=Wt();return r.download(r.signautreService.saveUrl3)}),ot(9,"\u4e0b\u8f09"),Le(),Le(),Le()}if(2&t){const n=Wt();Ct(4),Gs("src",n.signautreService.saveUrl3,tr)}}function $L(t,e){if(1&t){const n=Si();Fe(0,"div",2),Fe(1,"p",3),ot(2,"PDF 4"),Le(),Fe(3,"div",4),Nt(4,"img",5),Le(),Fe(5,"div",6),Fe(6,"button",7),Dt("click",function(){return Cn(n),Wt().signautreService.saveUrl=""}),ot(7,"\u522a\u9664"),Le(),Fe(8,"button",8),Dt("click",function(){Cn(n);const r=Wt();return r.download(r.signautreService.saveUrl)}),ot(9,"\u4e0b\u8f09"),Le(),Le(),Le()}if(2&t){const n=Wt();Ct(4),Gs("src",n.signautreService.saveUrl,tr)}}let YL=(()=>{class t{constructor(n){this.signautreService=n}ngOnInit(){}download(n){var i=document.createElement("a");i.download="sign.png",i.href=n,i.click()}}return t.\u0275fac=function(n){return new(n||t)(Qe(Na))},t.\u0275cmp=gi({type:t,selectors:[["app-history"]],decls:5,vars:4,consts:[[1,"history"],["class","file-item",4,"ngIf"],[1,"file-item"],[1,"file-item__title"],[1,"file-item__pdf"],["alt","",1,"file-item__pdf-file",3,"src"],[1,"file-item__footer"],[1,"file-item__btn","btn","btn_transparent",3,"click"],[1,"file-item__btn","btn","btn_dark",3,"click"]],template:function(n,i){1&n&&(Fe(0,"div",0),an(1,WL,10,1,"div",1),an(2,zL,10,1,"div",1),an(3,GL,10,1,"div",1),an(4,$L,10,1,"div",1),Le()),2&n&&(Ct(1),Tt("ngIf",""!==i.signautreService.saveUrl1),Ct(1),Tt("ngIf",""!==i.signautreService.saveUrl2),Ct(1),Tt("ngIf",""!==i.signautreService.saveUrl3),Ct(1),Tt("ngIf",""!==i.signautreService.saveUrl))},directives:[lo],styles:[".btn[_ngcontent-%COMP%]{width:15.4rem;height:4.7rem;border-radius:4px;background-color:#f8eaa3;letter-spacing:.2em;outline:none;border:1px solid transparent;box-shadow:0 0 4px #ffec8a;font-weight:400;font-family:inherit;color:#00212d;cursor:pointer;transition:all .3s;font-size:2rem}.btn_label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.btn_step[_ngcontent-%COMP%]{width:30rem;height:5rem}.btn_step[_ngcontent-%COMP%]:not(:last-child){margin-right:2.5rem}.btn_step-transparent[_ngcontent-%COMP%]{border:1px solid #F8EAA3;box-shadow:none;color:#f8eaa3;background-color:transparent}.btn_dark[_ngcontent-%COMP%]{box-shadow:none;background-color:#cb9b0c;color:#fff}.btn_transparent[_ngcontent-%COMP%]{border:1px solid #CB9B0C;box-shadow:none;color:#cb9b0c;background-color:transparent}.btn_dark-disabled[_ngcontent-%COMP%]{background-color:#b4b4b4;pointer-events:none;color:#515151;border:1px solid #515151}.btn[_ngcontent-%COMP%]:hover{background-color:#f5e076}.btn_dark[_ngcontent-%COMP%]:hover{background-color:#cb9b0cb3}.btn_transparent[_ngcontent-%COMP%]:hover{background-color:#cb9b0c4d;color:#fff}.btn_step-transparent[_ngcontent-%COMP%]:hover{background-color:#f8eaa34d;color:#fff}@media only screen and (max-width: 48em){.btn[_ngcontent-%COMP%]{font-size:2rem}}@media only screen and (max-width: 36em){.btn[_ngcontent-%COMP%]{width:8rem;height:3.3rem;font-size:1.4rem}}.history[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:flex-start;flex-wrap:wrap;width:100%;min-height:calc(100vh - 11rem);height:-moz-fit-content;height:fit-content;padding:4rem 7.2rem 0}@media only screen and (max-width: 66.25em){.history[_ngcontent-%COMP%]{justify-content:space-around}}@media only screen and (max-width: 66.25em){.history[_ngcontent-%COMP%]{padding:0}}.file-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;width:30rem;min-height:50rem;padding:0 .5rem;margin:0 6rem 5rem}.file-item__title[_ngcontent-%COMP%]{width:100%;font-weight:400;letter-spacing:.2em;color:#fff;font-size:1.6rem}.file-item__pdf[_ngcontent-%COMP%]{width:100%;height:40rem;border:1px solid #000;background-color:#fff}.file-item__pdf-file[_ngcontent-%COMP%]{width:100%}.file-item__footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.file-item__btn[_ngcontent-%COMP%]{width:14.1rem}"]}),t})();const yC=function(){return["/sign"]};let XL=(()=>{class t{constructor(n){this.signautreService=n}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(Qe(Na))},t.\u0275cmp=gi({type:t,selectors:[["app-service-select"]],decls:11,vars:4,consts:[[1,"service-select"],[1,"service-select__card",3,"routerLink","click"],[1,"service-select__logo-box"],["src","https://siezlh4405.github.io/the-f2e-2022-w2/assets/images/sign.png","alt","\u7c3d\u5c6c\u6587\u4ef6",1,"service-select__logo"],[1,"service-select__text"],["src","https://siezlh4405.github.io/the-f2e-2022-w2/assets/images/add-sign.png","alt","\u5efa\u7acb\u7c3d\u540d\u6a94",1,"service-select__logo"]],template:function(n,i){1&n&&(Fe(0,"div",0),Fe(1,"div",1),Dt("click",function(){return i.signautreService.work="sign"}),Fe(2,"div",2),Nt(3,"img",3),Le(),Fe(4,"p",4),ot(5,"\u7c3d\u5c6c\u6587\u4ef6"),Le(),Le(),Fe(6,"div",1),Dt("click",function(){return i.signautreService.work="add"}),Fe(7,"div",2),Nt(8,"img",5),Le(),Fe(9,"p",4),ot(10,"\u5efa\u7acb\u7c3d\u540d\u6a94"),Le(),Le(),Le()),2&n&&(Ct(1),Tt("routerLink",ca(2,yC)),Ct(5),Tt("routerLink",ca(3,yC)))},directives:[La],styles:[".service-select[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;width:100%;height:calc(100vh - 11rem);padding:0 calc((100% - (32.8rem * 2)) / 4)}@media only screen and (max-width: 48em){.service-select[_ngcontent-%COMP%]{padding:0}}.service-select__card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:space-around;width:32.8rem;height:32.8rem;padding:2rem;border:3px solid #F8EAA3;border-radius:8px;background-color:transparent;cursor:pointer;transition:all .5s}@media only screen and (max-width: 48em){.service-select__card[_ngcontent-%COMP%]{width:40vw;height:40vw}}@media only screen and (max-width: 36em){.service-select__card[_ngcontent-%COMP%]{width:40vw;height:60vw}}.service-select__logo-box[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:20.4rem;height:20.4rem;border-radius:50%;background-color:#f8eaa3;transition:all .5s}@media only screen and (max-width: 48em){.service-select__logo-box[_ngcontent-%COMP%]{width:70%;height:70%}}@media only screen and (max-width: 36em){.service-select__logo-box[_ngcontent-%COMP%]{width:28vw;height:28vw}}@media only screen and (max-width: 48em){.service-select__logo[_ngcontent-%COMP%]{width:50%}}.service-select__text[_ngcontent-%COMP%]{font-weight:500;letter-spacing:.2em;color:#f8eaa3;transition:all .5s;font-size:2.4rem}@media only screen and (max-width: 48em){.service-select__text[_ngcontent-%COMP%]{font-size:2rem}}@media only screen and (max-width: 36em){.service-select__text[_ngcontent-%COMP%]{font-size:2rem}}.service-select__card[_ngcontent-%COMP%]:hover{background-color:#f8eaa3}.service-select__card[_ngcontent-%COMP%]:hover   .service-select__logo-box[_ngcontent-%COMP%]{background-color:#fff}.service-select__card[_ngcontent-%COMP%]:hover   .service-select__text[_ngcontent-%COMP%]{color:#043951}"]}),t})();function xt(t,e,n,i){return S(n)&&(i=n,n=void 0),i?xt(t,e,n).pipe(Y(r=>le(r)?i(...r):i(r))):new T(r=>{bC(t,e,function(d){r.next(arguments.length>1?Array.prototype.slice.call(arguments):d)},r,n)})}function bC(t,e,n,i,r){let s;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){const d=t;t.addEventListener(e,n,r),s=()=>d.removeEventListener(e,n,r)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){const d=t;t.on(e,n),s=()=>d.off(e,n)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){const d=t;t.addListener(e,n),s=()=>d.removeListener(e,n)}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(let d=0,y=t.length;d<y;d++)bC(t[d],e,n,i,r)}i.add(s)}function Vt(t){return e=>e.lift(new JL(t))}class JL{constructor(e){this.notifier=e}call(e,n){const i=new ZL(e),r=U(this.notifier,new _e(i));return r&&!i.seenValue?(i.add(r),n.subscribe(i)):i}}class ZL extends ue{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}function Uf(...t){return e=>e.lift.call(Oe(e,...t))}var Hf=Ae(371);class e2 extends g{constructor(e,n){super()}schedule(e,n=0){return this}}let CC=(()=>{class t{constructor(n,i=t.now){this.SchedulerAction=n,this.now=i}schedule(n,i=0,r){return new this.SchedulerAction(this,n).schedule(r,i)}}return t.now=()=>Date.now(),t})();class Ir extends CC{constructor(e,n=CC.now){super(e,()=>Ir.delegate&&Ir.delegate!==this?Ir.delegate.now():n()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,n=0,i){return Ir.delegate&&Ir.delegate!==this?Ir.delegate.schedule(e,n,i):super.schedule(e,n,i)}flush(e){const{actions:n}=this;if(this.active)return void n.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=n.shift());if(this.active=!1,i){for(;e=n.shift();)e.unsubscribe();throw i}}}const n2=new Ir(class extends e2{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(r,this.id,n),this}requestAsyncId(e,n,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,n,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return n;clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,n);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),r}_unsubscribe(){const e=this.id,n=this.scheduler,i=n.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null}});class r2{constructor(e,n){this.dueTime=e,this.scheduler=n}call(e,n){return n.subscribe(new s2(e,this.dueTime,this.scheduler))}}class s2 extends a{constructor(e,n,i){super(e),this.dueTime=n,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(o2,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:e}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}}clearDebounce(){const e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)}}function o2(t){t.debouncedNext()}var os=Ae(552),$c=Ae.t(os,2),qi=Ae(837),a2=Ae.t(qi,2);const l2=["pdfViewerContainer"];function Wf(t,e,n){t[e]=n}function Ba(){return"undefined"==typeof window}Ba()||Wf($c,"verbosity",os.VerbosityLevel.INFOS);var po=(()=>(function(t){t[t.DISABLED=0]="DISABLED",t[t.ENABLED=1]="ENABLED",t[t.ENHANCED=2]="ENHANCED"}(po||(po={})),po))();let h2=(()=>{class t{constructor(n,i){if(this.element=n,this.ngZone=i,this.isVisible=!1,this._cMapsUrl=void 0!==$c?`https://unpkg.com/pdfjs-dist@${os.version}/cmaps/`:null,this._imageResourcesPath=void 0!==$c?`https://unpkg.com/pdfjs-dist@${os.version}/web/images/`:null,this._renderText=!0,this._renderTextMode=po.ENABLED,this._stickToPage=!1,this._originalSize=!0,this._page=1,this._zoom=1,this._zoomScale="page-width",this._rotation=0,this._showAll=!0,this._canAutoResize=!0,this._fitToPage=!1,this._externalLinkTarget="blank",this._showBorders=!1,this.resizeTimeout=null,this.pageScrollTimeout=null,this.isInitialized=!1,this.destroy$=new ne,this.afterLoadComplete=new cn,this.pageRendered=new cn,this.pageInitialized=new cn,this.textLayerRendered=new cn,this.onError=new cn,this.onProgress=new cn,this.pageChange=new cn(!0),Ba())return;let r;r=window.hasOwnProperty("pdfWorkerSrc")&&"string"==typeof window.pdfWorkerSrc&&window.pdfWorkerSrc?window.pdfWorkerSrc:`https://cdn.jsdelivr.net/npm/pdfjs-dist@${os.version}/legacy/build/pdf.worker.min.js`,Wf(os.GlobalWorkerOptions,"workerSrc",r)}set cMapsUrl(n){this._cMapsUrl=n}set page(n){const i=n=parseInt(n,10)||1;this._pdf&&(n=this.getValidPageNumber(n)),this._page=n,i!==n&&this.pageChange.emit(n)}set renderText(n){this._renderText=n}set renderTextMode(n){this._renderTextMode=n}set originalSize(n){this._originalSize=n}set showAll(n){this._showAll=n}set stickToPage(n){this._stickToPage=n}set zoom(n){n<=0||(this._zoom=n)}get zoom(){return this._zoom}set zoomScale(n){this._zoomScale=n}get zoomScale(){return this._zoomScale}set rotation(n){"number"==typeof n&&n%90==0?this._rotation=n:console.warn("Invalid pages rotation angle.")}set externalLinkTarget(n){this._externalLinkTarget=n}set autoresize(n){this._canAutoResize=Boolean(n)}set fitToPage(n){this._fitToPage=Boolean(n)}set showBorders(n){this._showBorders=Boolean(n)}static getLinkTarget(n){switch(n){case"blank":return qi.LinkTarget.BLANK;case"none":return qi.LinkTarget.NONE;case"self":return qi.LinkTarget.SELF;case"parent":return qi.LinkTarget.PARENT;case"top":return qi.LinkTarget.TOP}return null}ngAfterViewChecked(){if(this.isInitialized)return;const n=this.pdfViewerContainer.nativeElement.offsetParent;!0!==this.isVisible||null!=n?!1===this.isVisible&&null!=n&&(this.isVisible=!0,setTimeout(()=>{this.initialize(),this.ngOnChanges({src:this.src})})):this.isVisible=!1}ngOnInit(){this.initialize(),this.setupResizeListener()}ngOnDestroy(){this.clear(),this.destroy$.next(),this.loadingTask=null}ngOnChanges(n){if(!Ba()&&this.isVisible)if("src"in n)this.loadPDF();else if(this._pdf){if("renderText"in n?(this.pdfViewer.textLayerMode=this._renderText?this._renderTextMode:po.DISABLED,this.resetPdfDocument()):"showAll"in n&&(this.setupViewer(),this.resetPdfDocument()),"page"in n){const{page:i}=n;if(i.currentValue===this._latestScrolledPage)return;this.pdfViewer.scrollPageIntoView({pageNumber:this._page})}this.update()}}updateSize(){he(this._pdf.getPage(this.pdfViewer.currentPageNumber)).pipe(Vt(this.destroy$)).subscribe({next:n=>{const i=this._rotation||n.rotate,r=n.getViewport({scale:this._zoom,rotation:i}).width*t.CSS_UNITS;let s=this._zoom,d=!0;if(!this._originalSize||this._fitToPage&&r>this.pdfViewerContainer.nativeElement.clientWidth){const y=n.getViewport({scale:1,rotation:i});s=this.getScale(y.width,y.height),d=!this._stickToPage}this.pdfViewer._setScale(s,d)}})}clear(){this.loadingTask&&!this.loadingTask.destroyed&&this.loadingTask.destroy(),this._pdf&&(this._pdf.destroy(),this._pdf=null,this.pdfViewer.setDocument(null),this.pdfLinkService.setDocument(null,null),this.pdfFindController.setDocument(null))}getPDFLinkServiceConfig(){const n=t.getLinkTarget(this._externalLinkTarget);return n?{externalLinkTarget:n}:{}}initEventBus(){this.eventBus=function(t,e){const n=new t.EventBus;return function(t,e){xt(t,"documentload").pipe(Vt(e)).subscribe(()=>{const n=document.createEvent("CustomEvent");n.initCustomEvent("documentload",!0,!0,{}),window.dispatchEvent(n)}),xt(t,"pagerendered").pipe(Vt(e)).subscribe(({pageNumber:n,cssTransform:i,source:r})=>{const s=document.createEvent("CustomEvent");s.initCustomEvent("pagerendered",!0,!0,{pageNumber:n,cssTransform:i}),r.div.dispatchEvent(s)}),xt(t,"textlayerrendered").pipe(Vt(e)).subscribe(({pageNumber:n,source:i})=>{const r=document.createEvent("CustomEvent");r.initCustomEvent("textlayerrendered",!0,!0,{pageNumber:n}),i.textLayerDiv.dispatchEvent(r)}),xt(t,"pagechanging").pipe(Vt(e)).subscribe(({pageNumber:n,source:i})=>{const r=document.createEvent("UIEvents");r.initEvent("pagechanging",!0,!0),r.pageNumber=n,i.container.dispatchEvent(r)}),xt(t,"pagesinit").pipe(Vt(e)).subscribe(({source:n})=>{const i=document.createEvent("CustomEvent");i.initCustomEvent("pagesinit",!0,!0,null),n.container.dispatchEvent(i)}),xt(t,"pagesloaded").pipe(Vt(e)).subscribe(({pagesCount:n,source:i})=>{const r=document.createEvent("CustomEvent");r.initCustomEvent("pagesloaded",!0,!0,{pagesCount:n}),i.container.dispatchEvent(r)}),xt(t,"scalechange").pipe(Vt(e)).subscribe(({scale:n,presetValue:i,source:r})=>{const s=document.createEvent("UIEvents");s.initEvent("scalechange",!0,!0),s.scale=n,s.presetValue=i,r.container.dispatchEvent(s)}),xt(t,"updateviewarea").pipe(Vt(e)).subscribe(({location:n,source:i})=>{const r=document.createEvent("UIEvents");r.initEvent("updateviewarea",!0,!0),r.location=n,i.container.dispatchEvent(r)}),xt(t,"find").pipe(Vt(e)).subscribe(({source:n,type:i,query:r,phraseSearch:s,caseSensitive:d,highlightAll:y,findPrevious:w})=>{if(n===window)return;const O=document.createEvent("CustomEvent");O.initCustomEvent("find"+i,!0,!0,{query:r,phraseSearch:s,caseSensitive:d,highlightAll:y,findPrevious:w}),window.dispatchEvent(O)}),xt(t,"attachmentsloaded").pipe(Vt(e)).subscribe(({attachmentsCount:n,source:i})=>{const r=document.createEvent("CustomEvent");r.initCustomEvent("attachmentsloaded",!0,!0,{attachmentsCount:n}),i.container.dispatchEvent(r)}),xt(t,"sidebarviewchanged").pipe(Vt(e)).subscribe(({view:n,source:i})=>{const r=document.createEvent("CustomEvent");r.initCustomEvent("sidebarviewchanged",!0,!0,{view:n}),i.outerContainer.dispatchEvent(r)}),xt(t,"pagemode").pipe(Vt(e)).subscribe(({mode:n,source:i})=>{const r=document.createEvent("CustomEvent");r.initCustomEvent("pagemode",!0,!0,{mode:n}),i.pdfViewer.container.dispatchEvent(r)}),xt(t,"namedaction").pipe(Vt(e)).subscribe(({action:n,source:i})=>{const r=document.createEvent("CustomEvent");r.initCustomEvent("namedaction",!0,!0,{action:n}),i.pdfViewer.container.dispatchEvent(r)}),xt(t,"presentationmodechanged").pipe(Vt(e)).subscribe(({active:n,switchInProgress:i})=>{const r=document.createEvent("CustomEvent");r.initCustomEvent("presentationmodechanged",!0,!0,{active:n,switchInProgress:i}),window.dispatchEvent(r)}),xt(t,"outlineloaded").pipe(Vt(e)).subscribe(({outlineCount:n,source:i})=>{const r=document.createEvent("CustomEvent");r.initCustomEvent("outlineloaded",!0,!0,{outlineCount:n}),i.container.dispatchEvent(r)})}(n,e),n}(a2,this.destroy$),xt(this.eventBus,"pagerendered").pipe(Vt(this.destroy$)).subscribe(n=>{this.pageRendered.emit(n)}),xt(this.eventBus,"pagesinit").pipe(Vt(this.destroy$)).subscribe(n=>{this.pageInitialized.emit(n)}),xt(this.eventBus,"pagechanging").pipe(Vt(this.destroy$)).subscribe(({pageNumber:n})=>{this.pageScrollTimeout&&clearTimeout(this.pageScrollTimeout),this.pageScrollTimeout=window.setTimeout(()=>{this._latestScrolledPage=n,this.pageChange.emit(n)},100)}),xt(this.eventBus,"textlayerrendered").pipe(Vt(this.destroy$)).subscribe(n=>{this.textLayerRendered.emit(n)})}initPDFServices(){this.pdfLinkService=new qi.PDFLinkService(Object.assign({eventBus:this.eventBus},this.getPDFLinkServiceConfig())),this.pdfFindController=new qi.PDFFindController({eventBus:this.eventBus,linkService:this.pdfLinkService})}getPDFOptions(){return{eventBus:this.eventBus,container:this.element.nativeElement.querySelector("div"),removePageBorders:!this._showBorders,linkService:this.pdfLinkService,textLayerMode:this._renderText?this._renderTextMode:po.DISABLED,findController:this.pdfFindController,renderer:"canvas",l10n:void 0,imageResourcesPath:this._imageResourcesPath}}setupViewer(){Wf($c,"disableTextLayer",!this._renderText),this.initPDFServices(),this.pdfViewer=this._showAll?new qi.PDFViewer(this.getPDFOptions()):new qi.PDFSinglePageViewer(this.getPDFOptions()),this.pdfLinkService.setViewer(this.pdfViewer),this.pdfViewer._currentPageNumber=this._page}getValidPageNumber(n){return n<1?1:n>this._pdf.numPages?this._pdf.numPages:n}getDocumentParams(){const n=typeof this.src;if(!this._cMapsUrl)return this.src;const i={cMapUrl:this._cMapsUrl,cMapPacked:!0,enableXfa:!0};return"string"===n?i.url=this.src:"object"===n&&(void 0!==this.src.byteLength?i.data=this.src:Object.assign(i,this.src)),i}loadPDF(){if(!this.src)return;if(this.lastLoaded===this.src)return void this.update();this.clear(),this.setupViewer(),this.loadingTask=os.getDocument(this.getDocumentParams()),this.loadingTask.onProgress=i=>{this.onProgress.emit(i)};const n=this.src;he(this.loadingTask.promise).pipe(Vt(this.destroy$)).subscribe({next:i=>{this._pdf=i,this.lastLoaded=n,this.afterLoadComplete.emit(i),this.resetPdfDocument(),this.update()},error:i=>{this.lastLoaded=null,this.onError.emit(i)}})}update(){this.page=this._page,this.render()}render(){this._page=this.getValidPageNumber(this._page),(0!==this._rotation||this.pdfViewer.pagesRotation!==this._rotation)&&setTimeout(()=>{this.pdfViewer.pagesRotation=this._rotation}),this._stickToPage&&setTimeout(()=>{this.pdfViewer.currentPageNumber=this._page}),this.updateSize()}getScale(n,i){const r=this._showBorders?2*t.BORDER_WIDTH:0,s=this.pdfViewerContainer.nativeElement.clientWidth-r,d=this.pdfViewerContainer.nativeElement.clientHeight-r;if(0===d||0===i||0===s||0===n)return 1;let y=1;switch(this._zoomScale){case"page-fit":y=Math.min(d/i,s/n);break;case"page-height":y=d/i;break;default:y=s/n}return this._zoom*y/t.CSS_UNITS}resetPdfDocument(){this.pdfLinkService.setDocument(this._pdf,null),this.pdfFindController.setDocument(this._pdf),this.pdfViewer.setDocument(this._pdf)}initialize(){Ba()||!this.isVisible||(this.isInitialized=!0,this.initEventBus(),this.setupViewer())}setupResizeListener(){Ba()||this.ngZone.runOutsideAngular(()=>{xt(window,"resize").pipe(function(t,e=n2){return n=>n.lift(new r2(t,e))}(100),Zr(()=>this._canAutoResize&&!!this._pdf),Vt(this.destroy$)).subscribe(()=>{this.updateSize()})})}}return t.CSS_UNITS=96/72,t.BORDER_WIDTH=9,t.\u0275fac=function(n){return new(n||t)(Qe(On),Qe(Kt))},t.\u0275cmp=gi({type:t,selectors:[["pdf-viewer"]],viewQuery:function(n,i){if(1&n&&Di(l2,5),2&n){let r;qn(r=Qn())&&(i.pdfViewerContainer=r.first)}},inputs:{src:"src",cMapsUrl:["c-maps-url","cMapsUrl"],page:"page",renderText:["render-text","renderText"],renderTextMode:["render-text-mode","renderTextMode"],originalSize:["original-size","originalSize"],showAll:["show-all","showAll"],stickToPage:["stick-to-page","stickToPage"],zoom:"zoom",zoomScale:["zoom-scale","zoomScale"],rotation:"rotation",externalLinkTarget:["external-link-target","externalLinkTarget"],autoresize:"autoresize",fitToPage:["fit-to-page","fitToPage"],showBorders:["show-borders","showBorders"]},outputs:{afterLoadComplete:"after-load-complete",pageRendered:"page-rendered",pageInitialized:"pages-initialized",textLayerRendered:"text-layer-rendered",onError:"error",onProgress:"on-progress",pageChange:"pageChange"},features:[pr],decls:3,vars:0,consts:[[1,"ng2-pdf-viewer-container"],["pdfViewerContainer",""],[1,"pdfViewer"]],template:function(n,i){1&n&&(Fe(0,"div",0,1),Nt(2,"div",2),Le())},styles:[".ng2-pdf-viewer-container[_ngcontent-%COMP%]{overflow-x:auto;position:absolute;height:100%;width:100%;-webkit-overflow-scrolling:touch}[_nghost-%COMP%]{display:block;position:relative}[_nghost-%COMP%]    {--pdfViewer-padding-bottom: 0;--page-margin: 1px auto -8px;--page-border: 9px solid transparent;--spreadHorizontalWrapped-margin-LR: -3.5px;--zoom-factor: 1;--viewport-scale-factor: 1;--shadow: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAA1ElEQVQ4jbWUWw6EIAxFy2NFs/8NzR4UJhpqLsdi5mOmSSMUOfYWqv3S0gMr4XlYH/64gZa/gN3ANYA7KAXALt4ktoQ5MI9YxqaG8bWmsIysMuT6piSQCa4whZThCu8CM4zP9YJaKci9jicPq3NcBWYoPMGUlhG7ivtkB+gVyFY75wXghOvh8t5mto1Mdim6e+MBqH6XsY+YAwjpq3vGF7weTWQptLEDVCZvPTMl5JZZsdh47FHW6qFMyvLYqjcnmdFfY9Xk/KDOlzCusX2mi/ofM7MPkzBcSp4Q1/wAAAAASUVORK5CYII=);--viewer-container-height: 0;--annotation-unfocused-field-background: url(\"data:image/svg+xml;charset=UTF-8,<svg width='1px' height='1px' xmlns='http://www.w3.org/2000/svg'><rect width='100%' height='100%' style='fill:rgba(0, 54, 255, 0.13);'/></svg>\");--xfa-unfocused-field-background: url(\"data:image/svg+xml;charset=UTF-8,<svg width='1px' height='1px' xmlns='http://www.w3.org/2000/svg'><rect width='100%' height='100%' style='fill:rgba(0, 54, 255, 0.13);'/></svg>\")}@media screen and (forced-colors: active){[_nghost-%COMP%]    {--pdfViewer-padding-bottom: 9px;--page-margin: 9px auto 0;--page-border: none;--spreadHorizontalWrapped-margin-LR: 4.5px}}[_nghost-%COMP%]     .textLayer{position:absolute;text-align:initial;left:0;top:0;right:0;bottom:0;overflow:hidden;opacity:.2;line-height:1;-webkit-text-size-adjust:none;text-size-adjust:none;forced-color-adjust:none}[_nghost-%COMP%]     .textLayer span, [_nghost-%COMP%]     .textLayer br{color:transparent;position:absolute;white-space:pre;cursor:text;transform-origin:0% 0%}[_nghost-%COMP%]     .textLayer span.markedContent{top:0;height:0}[_nghost-%COMP%]     .textLayer .highlight{margin:-1px;padding:1px;background-color:#b400aa;border-radius:4px}[_nghost-%COMP%]     .textLayer .highlight.appended{position:initial}[_nghost-%COMP%]     .textLayer .highlight.begin{border-radius:4px 0 0 4px}[_nghost-%COMP%]     .textLayer .highlight.end{border-radius:0 4px 4px 0}[_nghost-%COMP%]     .textLayer .highlight.middle{border-radius:0}[_nghost-%COMP%]     .textLayer .highlight.selected{background-color:#006400}[_nghost-%COMP%]     .textLayer ::selection{background:blue}[_nghost-%COMP%]     .textLayer br::selection{background:transparent}[_nghost-%COMP%]     .textLayer .endOfContent{display:block;position:absolute;left:0;top:100%;right:0;bottom:0;z-index:-1;cursor:default;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]     .textLayer .endOfContent.active{top:0}[_nghost-%COMP%]     .annotationLayer section{position:absolute;text-align:initial}[_nghost-%COMP%]     .annotationLayer .linkAnnotation>a, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>a{position:absolute;font-size:1em;top:0;left:0;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>canvas{position:relative;top:0;left:0;z-index:-1}[_nghost-%COMP%]     .annotationLayer .linkAnnotation>a:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>a:hover{opacity:.2;background:yellow;box-shadow:0 2px 10px #ff0}[_nghost-%COMP%]     .annotationLayer .textAnnotation img{position:absolute;cursor:pointer}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{background-image:var(--annotation-unfocused-field-background);border:1px solid transparent;box-sizing:border-box;font-size:9px;height:100%;margin:0;padding:0 3px;vertical-align:top;width:100%}[_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select option{padding:0}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{border-radius:50%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea{font:message-box;font-size:9px;resize:none}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input[disabled], [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea[disabled], [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select[disabled], [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input[disabled], [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input[disabled]{background:none;border:1px solid transparent;cursor:not-allowed}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:hover, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:hover, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:hover{border:1px solid black}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:focus, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:focus, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:focus{background:none;border:1px solid transparent}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input :focus, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea :focus, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select :focus, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox :focus, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton :focus{background-image:none;background-color:transparent;outline:auto}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:checked:before{background-color:#000;content:\"\";display:block;position:absolute}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after{height:80%;left:45%;width:1px}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before{transform:rotate(45deg)}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after{transform:rotate(-45deg)}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:checked:before{border-radius:50%;height:50%;left:30%;top:20%;width:50%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input.comb{font-family:monospace;padding-left:2px;padding-right:0}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input.comb:focus{width:103%}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0}[_nghost-%COMP%]     .annotationLayer .popupWrapper{position:absolute;width:20em}[_nghost-%COMP%]     .annotationLayer .popup{position:absolute;z-index:200;max-width:20em;background-color:#ff9;box-shadow:0 2px 5px #888;border-radius:2px;padding:6px;margin-left:5px;cursor:pointer;font:message-box;font-size:9px;white-space:normal;word-wrap:break-word}[_nghost-%COMP%]     .annotationLayer .popup>*{font-size:9px}[_nghost-%COMP%]     .annotationLayer .popup h1{display:inline-block}[_nghost-%COMP%]     .annotationLayer .popupDate{display:inline-block;margin-left:5px}[_nghost-%COMP%]     .annotationLayer .popupContent{border-top:1px solid #333333;margin-top:2px;padding-top:2px}[_nghost-%COMP%]     .annotationLayer .richText>*{white-space:pre-wrap}[_nghost-%COMP%]     .annotationLayer .highlightAnnotation, [_nghost-%COMP%]     .annotationLayer .underlineAnnotation, [_nghost-%COMP%]     .annotationLayer .squigglyAnnotation, [_nghost-%COMP%]     .annotationLayer .strikeoutAnnotation, [_nghost-%COMP%]     .annotationLayer .freeTextAnnotation, [_nghost-%COMP%]     .annotationLayer .lineAnnotation svg line, [_nghost-%COMP%]     .annotationLayer .squareAnnotation svg rect, [_nghost-%COMP%]     .annotationLayer .circleAnnotation svg ellipse, [_nghost-%COMP%]     .annotationLayer .polylineAnnotation svg polyline, [_nghost-%COMP%]     .annotationLayer .polygonAnnotation svg polygon, [_nghost-%COMP%]     .annotationLayer .caretAnnotation, [_nghost-%COMP%]     .annotationLayer .inkAnnotation svg polyline, [_nghost-%COMP%]     .annotationLayer .stampAnnotation, [_nghost-%COMP%]     .annotationLayer .fileAttachmentAnnotation{cursor:pointer}[_nghost-%COMP%]     .xfaLayer .highlight{margin:-1px;padding:1px;background-color:#efcbed;border-radius:4px}[_nghost-%COMP%]     .xfaLayer .highlight.appended{position:initial}[_nghost-%COMP%]     .xfaLayer .highlight.begin{border-radius:4px 0 0 4px}[_nghost-%COMP%]     .xfaLayer .highlight.end{border-radius:0 4px 4px 0}[_nghost-%COMP%]     .xfaLayer .highlight.middle{border-radius:0}[_nghost-%COMP%]     .xfaLayer .highlight.selected{background-color:#cbdfcb}[_nghost-%COMP%]     .xfaLayer ::selection{background:blue}[_nghost-%COMP%]     .xfaPage{overflow:hidden;position:relative}[_nghost-%COMP%]     .xfaContentarea{position:absolute}[_nghost-%COMP%]     .xfaPrintOnly{display:none}[_nghost-%COMP%]     .xfaLayer{position:absolute;text-align:initial;top:0;left:0;transform-origin:0 0;line-height:1.2}[_nghost-%COMP%]     .xfaLayer *{color:inherit;font:inherit;font-style:inherit;font-weight:inherit;font-feature-settings:inherit;font-kerning:inherit;letter-spacing:-.01px;text-align:inherit;text-decoration:inherit;box-sizing:border-box;background-color:transparent;padding:0;margin:0;pointer-events:auto;line-height:inherit}[_nghost-%COMP%]     .xfaLayer div{pointer-events:none}[_nghost-%COMP%]     .xfaLayer svg{pointer-events:none}[_nghost-%COMP%]     .xfaLayer svg *{pointer-events:none}[_nghost-%COMP%]     .xfaLayer a{color:#00f}[_nghost-%COMP%]     .xfaRich li{margin-left:3em}[_nghost-%COMP%]     .xfaFont{color:#000;font-weight:400;font-feature-settings:\"kern\" off;font-kerning:none;font-size:10px;font-style:normal;letter-spacing:0;text-decoration:none;vertical-align:0}[_nghost-%COMP%]     .xfaCaption{overflow:hidden;flex:0 0 auto}[_nghost-%COMP%]     .xfaCaptionForCheckButton{overflow:hidden;flex:1 1 auto}[_nghost-%COMP%]     .xfaLabel{height:100%;width:100%}[_nghost-%COMP%]     .xfaLeft{display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]     .xfaRight{display:flex;flex-direction:row-reverse;align-items:center}[_nghost-%COMP%]     .xfaLeft>.xfaCaption, [_nghost-%COMP%]     .xfaLeft>.xfaCaptionForCheckButton, [_nghost-%COMP%]     .xfaRight>.xfaCaption, [_nghost-%COMP%]     .xfaRight>.xfaCaptionForCheckButton{max-height:100%}[_nghost-%COMP%]     .xfaTop{display:flex;flex-direction:column;align-items:flex-start}[_nghost-%COMP%]     .xfaBottom{display:flex;flex-direction:column-reverse;align-items:flex-start}[_nghost-%COMP%]     .xfaTop>.xfaCaption, [_nghost-%COMP%]     .xfaTop>.xfaCaptionForCheckButton, [_nghost-%COMP%]     .xfaBottom>.xfaCaption, [_nghost-%COMP%]     .xfaBottom>.xfaCaptionForCheckButton{width:100%}[_nghost-%COMP%]     .xfaBorder{background-color:transparent;position:absolute;pointer-events:none}[_nghost-%COMP%]     .xfaWrapped{width:100%;height:100%}[_nghost-%COMP%]     .xfaTextfield:focus, [_nghost-%COMP%]     .xfaSelect:focus{background-image:none;background-color:transparent;outline:auto;outline-offset:-1px}[_nghost-%COMP%]     .xfaCheckbox:focus, [_nghost-%COMP%]     .xfaRadio:focus{outline:auto}[_nghost-%COMP%]     .xfaTextfield, [_nghost-%COMP%]     .xfaSelect{height:100%;width:100%;flex:1 1 auto;border:none;resize:none;background-image:var(--xfa-unfocused-field-background)}[_nghost-%COMP%]     .xfaTop>.xfaTextfield, [_nghost-%COMP%]     .xfaTop>.xfaSelect, [_nghost-%COMP%]     .xfaBottom>.xfaTextfield, [_nghost-%COMP%]     .xfaBottom>.xfaSelect{flex:0 1 auto}[_nghost-%COMP%]     .xfaButton{cursor:pointer;width:100%;height:100%;border:none;text-align:center}[_nghost-%COMP%]     .xfaLink{width:100%;height:100%;position:absolute;top:0;left:0}[_nghost-%COMP%]     .xfaCheckbox, [_nghost-%COMP%]     .xfaRadio{width:100%;height:100%;flex:0 0 auto;border:none}[_nghost-%COMP%]     .xfaRich{white-space:pre-wrap;width:100%;height:100%}[_nghost-%COMP%]     .xfaImage{object-position:left top;object-fit:contain;width:100%;height:100%}[_nghost-%COMP%]     .xfaLrTb, [_nghost-%COMP%]     .xfaRlTb, [_nghost-%COMP%]     .xfaTb{display:flex;flex-direction:column;align-items:stretch}[_nghost-%COMP%]     .xfaLr{display:flex;flex-direction:row;align-items:stretch}[_nghost-%COMP%]     .xfaRl{display:flex;flex-direction:row-reverse;align-items:stretch}[_nghost-%COMP%]     .xfaTb>div{justify-content:left}[_nghost-%COMP%]     .xfaPosition{position:relative}[_nghost-%COMP%]     .xfaArea{position:relative}[_nghost-%COMP%]     .xfaValignMiddle{display:flex;align-items:center}[_nghost-%COMP%]     .xfaTable{display:flex;flex-direction:column;align-items:stretch}[_nghost-%COMP%]     .xfaTable .xfaRow{display:flex;flex-direction:row;align-items:stretch}[_nghost-%COMP%]     .xfaTable .xfaRlRow{display:flex;flex-direction:row-reverse;align-items:stretch;flex:1}[_nghost-%COMP%]     .xfaTable .xfaRlRow>div{flex:1}[_nghost-%COMP%]     .xfaNonInteractive input, [_nghost-%COMP%]     .xfaNonInteractive textarea, [_nghost-%COMP%]     .xfaDisabled input, [_nghost-%COMP%]     .xfaDisabled textarea, [_nghost-%COMP%]     .xfaReadOnly input, [_nghost-%COMP%]     .xfaReadOnly textarea{background:initial}@media print{[_nghost-%COMP%]     .xfaTextfield, [_nghost-%COMP%]     .xfaSelect{background:transparent}[_nghost-%COMP%]     .xfaSelect{-webkit-appearance:none;-moz-appearance:none;appearance:none;text-indent:1px;text-overflow:\"\"}}[_nghost-%COMP%]     .pdfViewer{padding-bottom:var(--pdfViewer-padding-bottom)}[_nghost-%COMP%]     .pdfViewer .canvasWrapper{overflow:hidden}[_nghost-%COMP%]     .pdfViewer .page{direction:ltr;width:816px;height:1056px;margin:var(--page-margin);position:relative;overflow:visible;border:var(--page-border);background-clip:content-box;border-image:var(--shadow) 9 9 repeat;background-color:#fff}[_nghost-%COMP%]     .pdfViewer .dummyPage{position:relative;width:0;height:var(--viewer-container-height)}[_nghost-%COMP%]     .pdfViewer.removePageBorders .page{margin:0 auto 10px;border:none}[_nghost-%COMP%]     .pdfViewer.singlePageView{display:inline-block}[_nghost-%COMP%]     .pdfViewer.singlePageView .page{margin:0;border:none}[_nghost-%COMP%]     .pdfViewer.scrollHorizontal, [_nghost-%COMP%]     .pdfViewer.scrollWrapped, [_nghost-%COMP%]     .spread{margin-left:3.5px;margin-right:3.5px;text-align:center}[_nghost-%COMP%]     .pdfViewer.scrollHorizontal, [_nghost-%COMP%]     .spread{white-space:nowrap}[_nghost-%COMP%]     .pdfViewer.removePageBorders, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .spread, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .spread{margin-left:0;margin-right:0}[_nghost-%COMP%]     .spread .page, [_nghost-%COMP%]     .spread .dummyPage, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .page, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .spread, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .spread{display:inline-block;vertical-align:middle}[_nghost-%COMP%]     .spread .page, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .page{margin-left:var(--spreadHorizontalWrapped-margin-LR);margin-right:var(--spreadHorizontalWrapped-margin-LR)}[_nghost-%COMP%]     .pdfViewer.removePageBorders .spread .page, [_nghost-%COMP%]     .pdfViewer.removePageBorders.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.removePageBorders.scrollWrapped .page{margin-left:5px;margin-right:5px}[_nghost-%COMP%]     .pdfViewer .page canvas{margin:0;display:block}[_nghost-%COMP%]     .pdfViewer .page canvas[hidden]{display:none}[_nghost-%COMP%]     .pdfViewer .page .loadingIcon{position:absolute;display:block;left:0;top:0;right:0;bottom:0;background:url(data:image/gif;base64,R0lGODlhGAAYAPQQAM7Ozvr6+uDg4LCwsOjo6I6OjsjIyJycnNjY2KioqMDAwPLy8nZ2doaGhri4uGhoaP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/ilPcHRpbWl6ZWQgd2l0aCBodHRwczovL2V6Z2lmLmNvbS9vcHRpbWl6ZQAh+QQJBwAQACwAAAAAGAAYAAAFmiAkjiTkOGVaBgjZNGSgkgKjjM8zLoI8iy+BKCdiCX8iBeMAhEEIPRXLxViYUE9CbCQoFAzFhHY3zkaT3oPvBz1zE4UBsr1eWZH4vAowOBwGAHk8AoQLfH6Agm0Ed3qOAXWOIgQKiWyFJQgDgJEpdG+WEACNEFNFmKVlVzJQk6qdkwqBoi1mebJ3ALNGeIZHtGSwNDS1RZKueCEAIfkECQcAEAAsAAAAABgAGAAABZcgJI4kpChlWgYCWRQkEKgjURgjw4zOg9CjVwuiEyEeO6CxkBC9nA+HiuUqLEyoBZI0Mx4SAFFgQCDZuguBoGv6Dtg0gvpqdhxQQDkBzuUr/4A1JwMKP39pc2mDhYCIc4GQYn6QCwCMeY91l0p6dBAEJ0OfcFRimZ91Mwt0alxxAIZyRmuAsKxDLKKvZbM1tJxmvGKRpn8hACH5BAkHABAALAAAAAAYABgAAAWhICSOJGQYZVoGAnkcJBKoI3EAY1GMCtPSosSBINKJBIwGkHdwBGGQA0OhYpEGQxNqkYzNIITBACEKKBaxxNfBeOCO4vMy0Hg8nDHFeCktkKtfNAtoS4UqAicKBj9zBAKPC4iKi4aRkISGmWWBmjUIAIyHkCUEAKCVo2WmREecVqoCgZhgP4NHrGWCj7e3szSpuxAsoVWxnp6cVV4kyZW+KSEAIfkECQcAEAAsAAAAABgAGAAABZkgJI4kBABlWgYEOQykEKgjMSDjcYxG0dKi108nEhQKQN4rCIMkCgbawjWYnSCLY2yGVSgEooBhWqsGGwxc0RtNBgoMhmJ1QgETjANYFeBKyUmBKQQIdT9JDmgPDQ6EhoKJD4sOgpWWgiwChyqEBH5hmptSoSOZgJ4kLKWkYTF7C2SaqaM/hEWygay4mYG8t6uffFuzl1iANCEAIfkECQcAEAAsAAAAABgAGAAABZ0gJI4khCBlmhKkopBCoI6LIozDMAIHO4uuBVBnOiR+I4FrCDwAZsKdQnaCLIwwmRUA8JmioprWUCjcwlwUMnAoG0qL03k2KCS8cC0UjOzDCQKBfHQFDAwFU4CCfgqFhy9+kZJWgzSKSAcPZn+BfQENDw8OljGWJAFeDoZPYTBnC1GdSXqnsoBolSulX2GyP6hgvnG0KrS3NJNhuSQhACH5BAkHABAALAAAAAAYABgAAAWaICSOJCQIZZoupGGQRKCOC0CMijIiwz2LABtQZxoMfjQhxAXszWQ7gOwECRhh0MCJJRJARTUoIHFAgbfI6uBwAJS01J/i4PClVYHvfV8lbLlIBmwFbQt+aGmChG18jXeGT4dICQxlb4g/AQUMDER9XjR6BAdiDQwINDBmkAsPDVh4cX4imw53iLKuaVqAcUsPqEiidkt6j4AzIQAh+QQJBwAQACwAAAAAGAAYAAAFmSAkjiREEGWaBiSCtCoZCMsIAKOg1LEo0KKbaKFQ9EYLoOkFuQlirNxzCQkUW9GZ0hQd4nyDAWr4G/esYSbyZFYZwu3jqiuvr8u8I2BwOAwASXh1e31/doeHC3klWnElfAlTd46MfQUGk2stCVEGBQWSdCciDg5VDAVYKoEiDQ0iBwxGcj9RDw8+qHIzebc2DJJQJK6qiKVyIQAh+QQJBwAQACwAAAAAGAAYAAAFmSAkjiS0LGWaBiRBtCoZCKgoCCMB1DF0sz6cCQDo5W62l28XAyZFpyECBv3lnCbhUqHMIo0Qg4Jbmn1jRCa4iV27TzfXGjEecOFWMN1OdvvfPGUuXSoKBw6EXokrAwcHRVU0UAeEBANAAAmUI1gNDyhjJgUHLW0iDg8FIqOnBQZrDA9TELE2rEYIDw4jta2LMpCrqld/YQpgIQAh+QQJBwAQACwAAAAAGAAYAAAFmyAkjiS0LGWaBiRBkKw6BgIqCsJcyyMe4yJajhcEml5H26o1PN2QQd3uFiv2AADlAgflIbDdZLgkABOJgep5LfWty4p4zeU+w+XsvJWXliEKDwdEBgMKYQ4PDw1qK3EDCCMAiQ5BCV0LCj+FSDQkgCgGBiYHAy2MIgoMghAHqw4HAGsNDEMFBTekdgwKI7aRB2MwkL2rVHoQoWchACH5BAkHABAALAAAAAAYABgAAAWWICSOJLQsZZoGJEGQrDoGAioKwlzLIx7jIlqOFwSaXkfbqjU83ZBB3e4WK0qrCxyU55peid0qcUwuixyNx6PhILsAcAJazXYj4lvz2MkLiFsHDAlEcABKZwwMBX8pBgoKQxAIigpBA1sLBj+PSDQkB4uSACYDlTMyBgWDEKVnl2QFBUigN61gBQYjtLV5JZ4jtlR6omMhACH5BAkHABAALAAAAAAYABgAAAWaICSOJLQsZZoGJEGQrDoGAioKwlzLIx7jIlqOFwSaXkdbidYanm7I4AjwYDh6saJuJ3JUG1mZi9srPA7EcRimJLrfJYWZUVC8TziXnEG3u/E+cIJaPAFrPQl1aQAIbRAGBZGHJQiMUQKRBkEKbQsAPZaEXQcslSYKmjMyAAdXj34ACkNEiUgDA5t+PAQHn6Ogjkuzry2DNwhuIQAh+QQFBwAQACwAAAAAGAAYAAAFnCAkjiS0LGVaBgBJEGSguo8zCsK4CPIsMg+ECCcKEH0ix6MwhJl4KiOp8UCdmrEbo6EoHpxF8A6aBBZ6vhf5dmAkkGr0CoWs21WGQ2FvsI9xC3l7B311fy93iWGKJQQOhHCAJQB6A3IqcWwJLU90i2FkUiMKlhBELEI6MwgDXRAGhQgAYD6tTqRFAJxpA6mvrqazSKJJhUWMpjlIIQA7) center no-repeat}[_nghost-%COMP%]     .pdfViewer .page .loadingIcon.notVisible{background:none}[_nghost-%COMP%]     .pdfViewer.enablePermissions .textLayer span{-webkit-user-select:none!important;user-select:none!important;cursor:not-allowed}[_nghost-%COMP%]     .pdfPresentationMode .pdfViewer{padding-bottom:0}[_nghost-%COMP%]     .pdfPresentationMode .spread{margin:0}[_nghost-%COMP%]     .pdfPresentationMode .pdfViewer .page{margin:0 auto;border:2px solid transparent}"]}),t})(),d2=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Zi({type:t}),t.\u0275inj=fi({}),t})();const f2=["imgCanvas"],g2=["imgCanvasContainer"],p2=["signCanvas"],m2=["signCanvasContainer"],_2=["mergeContainer"];function v2(t,e){if(1&t){const n=Si();Fe(0,"pdf-viewer",39),Dt("after-load-complete",function(r){return Cn(n),Wt().afterLoadComplete(r)})("page-rendered",function(r){return Cn(n),Wt().pageRendered(r)}),Le()}if(2&t){const n=Wt();Tt("src",n.pdfSrc)("render-text",!1)("page",n.currentpage)("show-all",!1)("original-size",!0)("fit-to-page",!1)}}function y2(t,e){1&t&&(Fe(0,"p",40),ot(1,"\u6587\u4ef6\u986f\u793a\u5340"),Le())}function b2(t,e){1&t&&(Il(0),Fe(1,"div",41),Nt(2,"div",42),Nt(3,"div",42),Le(),Fe(4,"p",43),ot(5,"\u60a8\u7684\u6a94\u6848\u8d85\u904e 10 MB \u6216 \u683c\u5f0f\u4e0d\u652f\u63f4"),Le(),kl())}function C2(t,e){1&t&&(Fe(0,"div",44,45),Nt(2,"canvas",46),Le())}function S2(t,e){1&t&&(Il(0),ot(1,"\u4e0b\u4e00\u6b65"),kl())}function w2(t,e){1&t&&ot(0,"\u4e0b\u8f09")}function x2(t,e){if(1&t){const n=Si();Fe(0,"div",53),Fe(1,"div",54),Nt(2,"img",55),Le(),Fe(3,"button",56),Dt("click",function(){return Cn(n),Wt(2).selectSignature(1)}),ot(4,"\u9078\u64c7"),Le(),Le()}if(2&t){const n=Wt(2);Ct(2),Tt("src",n.signautreService.signatureUrl1,tr)}}function E2(t,e){if(1&t){const n=Si();Fe(0,"div",53),Fe(1,"div",54),Nt(2,"img",55),Le(),Fe(3,"button",56),Dt("click",function(){return Cn(n),Wt(2).selectSignature(2)}),ot(4,"\u9078\u64c7"),Le(),Le()}if(2&t){const n=Wt(2);Ct(2),Tt("src",n.signautreService.signatureUrl2,tr)}}function A2(t,e){if(1&t){const n=Si();Fe(0,"div",47),Fe(1,"div",48),Fe(2,"p",49),ot(3,"\u6211\u7684\u7c3d\u540d\u6a94"),Le(),an(4,x2,5,1,"div",50),an(5,E2,5,1,"div",50),Fe(6,"div",51),Dt("click",function(){return Cn(n),Wt().setIsPopupShow(!1)}),Nt(7,"i",52),Nt(8,"i",52),Le(),Le(),Le()}if(2&t){const n=Wt();Ct(4),Tt("ngIf",n.signautreService.isSign1Isset),Ct(1),Tt("ngIf",n.signautreService.isSign2Isset)}}let T2=(()=>{class t{constructor(n,i){this.elem=n,this.signautreService=i,this.resize$=xt(window,"resize"),this.pdfSrc="",this.imgSrc="",this.isFileUploaded=!1,this.isPDF=!1,this.isIMG=!1,this.currentpage=0,this.totalPages=1,this.pdfUrl="",this.imgUrl="",this.step=1,this.signImgUrl="",this.isDrawSignCanvas=!1,this.isPopupShow=!1,this.uploadError=!1}ngOnInit(){}ngOnDestroy(){this.resizeSubscript&&this.resizeSubscript.unsubscribe(),this.mouse1Subscript&&this.mouse1Subscript.unsubscribe()}ngAfterViewInit(){if(this.resizeSubscript=this.resize$.subscribe(()=>{if(2===this.step){let n=this.ctxSign.getImageData(0,0,this.signCanvas.nativeElement.width,this.signCanvas.nativeElement.height);this.ctxSign.canvas.width=this.signCanvasContainer.nativeElement.offsetWidth,this.ctxSign.canvas.height=this.signCanvasContainer.nativeElement.offsetHeight,this.ctxSign.putImageData(n,0,0)}}),void 0!==this.imgCanvas.nativeElement&&(this.ctxImg=this.imgCanvas.nativeElement.getContext("2d")),void 0!==this.signCanvas){const n=xt(this.signCanvas.nativeElement,"mousedown"),i=xt(this.signCanvas.nativeElement,"mousemove"),r=xt(this.signCanvas.nativeElement,"mouseup"),s=xt(this.signCanvas.nativeElement,"mouseout");this.signCanvas.nativeElement.width=this.signCanvasContainer.nativeElement.offsetWidth,this.signCanvas.nativeElement.height=this.signCanvasContainer.nativeElement.offsetHeight,void 0!==this.signCanvas.nativeElement&&(this.ctxSign=this.signCanvas.nativeElement.getContext("2d")),this.mouse1Subscript=n.pipe(Y(d=>{const w=this.getMousePos(this.signCanvas.nativeElement,d);return this.ctxSign.beginPath(),this.ctxSign.moveTo(w.x,w.y),d.preventDefault(),i.pipe(Vt(r.pipe(Uf(s))))})).pipe(Pc()).subscribe(d=>{const w=this.getMousePos(this.signCanvas.nativeElement,d);this.ctxSign.lineCap="round",this.ctxSign.lineWidth=2,this.ctxSign.lineJoin="round",this.ctxSign.shadowBlur=1,this.ctxSign.shadowColor="black",this.ctxSign.lineTo(w.x,w.y),this.ctxSign.stroke(),this.isDrawSignCanvas=!0,this.signImgUrl=""})}}resetUploadFile(n){n.target.value=""}uploadFile(n){const i=n.target;if(this.isFileUploaded=!1,this.isPDF=!1,this.isIMG=!1,this.imgSrc="",this.pdfSrc="",this.imgUrl="",this.pdfUrl="",this.uploadError=!1,null!==i.files&&console.log(i.files[0].size),null!==i.files&&"application/pdf"==i.files[0].type&&i.files[0].size<=10966423){if("undefined"!=typeof FileReader){this.isPDF=!0,this.isFileUploaded=!0;let r=new FileReader;r.onload=s=>{this.pdfSrc=s.target.result},r.readAsArrayBuffer(i.files[0])}}else if(null!==i.files&&"image/png"==i.files[0].type&&i.files[0].size<=10966423){this.isIMG=!0,this.isFileUploaded=!0;let r=new FileReader;r.onload=s=>{this.imgSrc=s.target.result;const d=new Image;d.onload=()=>{this.ctxImg.canvas.width=d.width,this.ctxImg.canvas.height=d.height,setTimeout(()=>{this.ctxImg.drawImage(d,0,0),this.imgUrl=this.imgCanvas.nativeElement.toDataURL()},0)},d.src=this.imgSrc},r.readAsDataURL(i.files[0])}else this.uploadError=!0}afterLoadComplete(n){this.totalPages=n.numPages}pageChange(n){console.log(n)}pageRendered(n){const i=this.elem.nativeElement.querySelectorAll(".canvasWrapper canvas")[0];this.pdfUrl=i.toDataURL()}getMousePos(n,i){var r=n.getBoundingClientRect();return{x:i.clientX-r.left,y:i.clientY-r.top}}resetSignCanvas(){this.ctxSign.canvas.width=this.signCanvasContainer.nativeElement.offsetWidth,this.ctxSign.canvas.height=this.signCanvasContainer.nativeElement.offsetHeight,this.signImgUrl="",this.isDrawSignCanvas=!1}saveSignCanvas(){this.isDrawSignCanvas?(this.signImgUrl=this.ctxSign.canvas.toDataURL(),alert("\u5132\u5b58\u6210\u529f!")):alert("\u8acb\u5148\u7c3d\u5c6c\u7c3d\u540d\u5728\u5132\u5b58")}next(){if(1!==this.step||""!==this.pdfUrl||""!==this.imgSrc)if(2!==this.step||""!==this.signImgUrl){if(3===this.step){this.signautreService.saveUrl=this.margeCanvas.toDataURL();var n=document.createElement("a");return n.download="sign.png",n.href=this.margeCanvas.toDataURL(),void n.click()}this.step+=1,2===this.step&&(setTimeout(()=>{this.ctxSign.canvas.width=this.signCanvasContainer.nativeElement.offsetWidth,this.ctxSign.canvas.height=this.signCanvasContainer.nativeElement.offsetHeight},0),this.isStep2HasSign()),3===this.step&&setTimeout(()=>{this.margeCanvas=new Hf.fabric.Canvas("margeCanvas"),Hf.fabric.Image.fromURL(""!==this.pdfUrl?this.pdfUrl:this.imgSrc,r=>{setTimeout(()=>{this.margeCanvas.setWidth(r.width),this.margeCanvas.setHeight(r.height),this.margeCanvas.renderAll(),this.margeCanvas.setBackgroundImage(r,this.margeCanvas.renderAll.bind(this.margeCanvas)),Hf.fabric.Image.fromURL(this.signImgUrl,s=>{s.scaleToWidth(50),s.scaleToHeight(50),this.margeCanvas.add(s).renderAll()})},0)})},0)}else alert("\u8acb\u5148\u5132\u5b58\u7c3d\u540d\u6216\u662f\u9078\u64c7\u7c3d\u540d\u6a94");else alert("\u8acb\u5148\u4e0a\u50b3\u6a94\u6848")}back(){1!==this.step&&(this.step-=1,2===this.step&&setTimeout(()=>{this.ctxSign.canvas.width=this.signCanvasContainer.nativeElement.offsetWidth,this.ctxSign.canvas.height=this.signCanvasContainer.nativeElement.offsetHeight,this.isStep2HasSign()},0))}setIsPopupShow(n){this.isPopupShow=n}selectSignature(n){this.resetSignCanvas();const i=new Image;i.onload=()=>{this.ctxSign.drawImage(i,0,0),this.setIsPopupShow(!1),this.signImgUrl=this.ctxSign.canvas.toDataURL(),this.isDrawSignCanvas=!0},i.src=1===n?this.signautreService.signatureUrl1:this.signautreService.signatureUrl2}isStep2HasSign(){if(""!==this.signImgUrl){const n=new Image;n.onload=()=>{this.ctxSign.drawImage(n,0,0),this.setIsPopupShow(!1),this.signImgUrl=this.ctxSign.canvas.toDataURL(),this.isDrawSignCanvas=!0},n.src=this.signImgUrl}}test(){var n=document.createElement("a");if(n.setAttribute("href",this.pdfUrl),n.setAttribute("target","_blank"),n.setAttribute("download","test.png"),document.createEvent){var i=document.createEvent("MouseEvents");i.initEvent("click",!0,!0),n.dispatchEvent(i)}else n.click&&n.click()}}return t.\u0275fac=function(n){return new(n||t)(Qe(On),Qe(Na))},t.\u0275cmp=gi({type:t,selectors:[["app-service-sign"]],viewQuery:function(n,i){if(1&n&&(Di(f2,5),Di(g2,5),Di(p2,5),Di(m2,5),Di(_2,5)),2&n){let r;qn(r=Qn())&&(i.imgCanvas=r.first),qn(r=Qn())&&(i.imgCanvasContainer=r.first),qn(r=Qn())&&(i.signCanvas=r.first),qn(r=Qn())&&(i.signCanvasContainer=r.first),qn(r=Qn())&&(i.mergeContainer=r.first)}},decls:65,vars:16,consts:[[1,"sign-text-content"],[1,"sign-text-content__process-box"],[1,"process"],[1,"process__item","process__item_active"],[1,"process__text"],[1,"process__step"],[1,"process__item"],[1,"process__line"],[1,"sign-text-content__file-box"],[1,"sign-text-content__upload",3,"hidden"],[1,"sign-text-content__upload-header"],[1,"sign-text-content__notice"],["for","upload-doc",1,"btn","btn_dark","btn_label"],["type","file","id","upload-doc","accept",".pdf, .png",1,"upload-input",3,"click","change"],[1,"sign-text-content__pdf"],["imgCanvasContainer",""],["class","pdf-viewer",3,"src","render-text","page","show-all","original-size","fit-to-page","after-load-complete","page-rendered",4,"ngIf"],[1,"canvas-viewer",3,"hidden"],["imgCanvas",""],["class","sign-text-content__notice-text",4,"ngIf"],[4,"ngIf"],[1,"signature",3,"hidden"],[1,"signature__header"],[1,"signature__title"],[1,"signature__title","signature__title_href",3,"click"],[1,"signature__canvas-container"],["signCanvasContainer",""],[1,"signature__canvas"],["signCanvas",""],[1,"signature__footer"],[1,"btn","btn_transparent","signature__btn-margin",3,"click"],[1,"btn","btn_dark",3,"click"],["class","marge",4,"ngIf"],[1,"sign-text-content__footer"],[1,"btn","btn_step","btn_step-transparent",3,"click"],[1,"btn","btn_step",3,"click"],[4,"ngIf","ngIfElse"],["downloadTmp",""],["class","signature-pop-box",4,"ngIf"],[1,"pdf-viewer",3,"src","render-text","page","show-all","original-size","fit-to-page","after-load-complete","page-rendered"],[1,"sign-text-content__notice-text"],[1,"sign-text-content__error"],[1,"sign-text-content__error-line"],[1,"sign-text-content__notice-text","sign-text-content__notice-text_red"],[1,"marge"],["mergeContainer",""],["id","margeCanvas",1,"marge__canvas"],[1,"signature-pop-box"],[1,"signature-pop"],[1,"signature-pop__title"],["class","signature-pop__item",4,"ngIf"],[1,"signature-pop__close-box",3,"click"],[1,"signature-pop__close"],[1,"signature-pop__item"],[1,"signature-pop__img-box"],[1,"signature-pop__img",3,"src"],[1,"btn","btn_transparent",3,"click"]],template:function(n,i){if(1&n&&(Fe(0,"div",0),Fe(1,"div",1),Fe(2,"div",2),Fe(3,"div",3),Fe(4,"p",4),ot(5,"\u4e0a\u50b3\u6587\u4ef6"),Le(),Fe(6,"p",5),ot(7,"1"),Le(),Le(),Fe(8,"div",6),Fe(9,"p",4),ot(10,"\u9078\u64c7\u7c3d\u540d\u6a94"),Le(),Fe(11,"p",5),ot(12,"2"),Le(),Le(),Fe(13,"div",6),Fe(14,"p",4),ot(15,"\u4f4d\u79fb\u8207\u5c3a\u5bf8"),Le(),Fe(16,"p",5),ot(17,"3"),Le(),Le(),Nt(18,"i",7),Le(),Le(),Fe(19,"div",8),Fe(20,"div",9),Fe(21,"div",10),Fe(22,"div",11),Fe(23,"ul"),Fe(24,"li"),ot(25,"\u6a94\u6848\u683c\u5f0f\u9700\u70ba PDF \u6216 IMG"),Le(),Fe(26,"li"),ot(27," \u6a94\u6848\u5927\u5c0f\u4e0a\u9650\u70ba 10MB"),Le(),Le(),Le(),Fe(28,"label",12),Fe(29,"p"),ot(30,"\u4e0a\u50b3\u6587\u4ef6"),Le(),Le(),Fe(31,"input",13),Dt("click",function(s){return i.resetUploadFile(s)})("change",function(s){return i.uploadFile(s)}),Le(),Le(),Fe(32,"div",14,15),an(34,v2,1,6,"pdf-viewer",16),Nt(35,"canvas",17,18),an(37,y2,2,0,"p",19),an(38,b2,6,0,"ng-container",20),Le(),Le(),Fe(39,"div",21),Fe(40,"div",22),Fe(41,"p",23),ot(42,"\u8acb\u5728\u6b64\u5beb\u4e0b\u60a8\u7684\u7c3d\u540d"),Le(),Fe(43,"p",23),ot(44,"\u6216"),Le(),Fe(45,"a",24),Dt("click",function(){return i.setIsPopupShow(!0)}),ot(46,"\u5f9e\u7c3d\u540d\u6a94\u4e2d\u9078\u53d6\u7c3d\u540d"),Le(),Le(),Fe(47,"div",25,26),Nt(49,"canvas",27,28),Le(),Fe(51,"div",29),Fe(52,"button",30),Dt("click",function(){return i.resetSignCanvas()}),ot(53,"\u6e05\u9664"),Le(),Fe(54,"button",31),Dt("click",function(){return i.saveSignCanvas()}),ot(55,"\u5132\u5b58"),Le(),Le(),Le(),an(56,C2,3,0,"div",32),Fe(57,"div",33),Fe(58,"button",34),Dt("click",function(){return i.back()}),ot(59,"\u4e0a\u4e00\u6b65"),Le(),Fe(60,"button",35),Dt("click",function(){return i.next()}),an(61,S2,2,0,"ng-container",36),an(62,w2,1,0,"ng-template",null,37,Py),Le(),Le(),Le(),Le(),an(64,A2,9,2,"div",38)),2&n){const r=function(t){return function(t,e){return t[e]}(st.lFrame.contextLView,20+t)}(63);Ct(8),wr("process__item_active",i.step>1),Ct(5),wr("process__item_active",i.step>2),Ct(7),Tt("hidden",1!==i.step),Ct(14),Tt("ngIf",i.isFileUploaded&&i.isPDF),Ct(1),Tt("hidden",!(i.isFileUploaded&&i.isIMG)),Ct(2),Tt("ngIf",!i.isFileUploaded&&!i.uploadError),Ct(1),Tt("ngIf",i.uploadError),Ct(1),Tt("hidden",2!==i.step),Ct(17),Tt("ngIf",3===i.step),Ct(2),wr("btn_dark-disabled",!1),Ct(3),Tt("ngIf",3!==i.step)("ngIfElse",r),Ct(3),Tt("ngIf",i.isPopupShow)}},directives:[lo,h2],styles:[".btn[_ngcontent-%COMP%]{width:15.4rem;height:4.7rem;border-radius:4px;background-color:#f8eaa3;letter-spacing:.2em;outline:none;border:1px solid transparent;box-shadow:0 0 4px #ffec8a;font-weight:400;font-family:inherit;color:#00212d;cursor:pointer;transition:all .3s;font-size:2rem}.btn_label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.btn_step[_ngcontent-%COMP%]{width:30rem;height:5rem}.btn_step[_ngcontent-%COMP%]:not(:last-child){margin-right:2.5rem}.btn_step-transparent[_ngcontent-%COMP%]{border:1px solid #F8EAA3;box-shadow:none;color:#f8eaa3;background-color:transparent}.btn_dark[_ngcontent-%COMP%]{box-shadow:none;background-color:#cb9b0c;color:#fff}.btn_transparent[_ngcontent-%COMP%]{border:1px solid #CB9B0C;box-shadow:none;color:#cb9b0c;background-color:transparent}.btn_dark-disabled[_ngcontent-%COMP%]{background-color:#b4b4b4;pointer-events:none;color:#515151;border:1px solid #515151}.btn[_ngcontent-%COMP%]:hover{background-color:#f5e076}.btn_dark[_ngcontent-%COMP%]:hover{background-color:#cb9b0cb3}.btn_transparent[_ngcontent-%COMP%]:hover{background-color:#cb9b0c4d;color:#fff}.btn_step-transparent[_ngcontent-%COMP%]:hover{background-color:#f8eaa34d;color:#fff}@media only screen and (max-width: 48em){.btn[_ngcontent-%COMP%]{font-size:2rem}}@media only screen and (max-width: 36em){.btn[_ngcontent-%COMP%]{width:8rem;height:3.3rem;font-size:1.4rem}}.sign-text-content[_ngcontent-%COMP%]{position:relative;display:flex;width:100%;height:calc(100% - 5rem);padding-top:6.8rem;padding-bottom:4rem}.sign-text-content__process-box[_ngcontent-%COMP%]{flex:0 1 45rem}.sign-text-content__file-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;flex:1 0 70rem;height:100%}@media only screen and (max-width: 56.875em){.sign-text-content__file-box[_ngcontent-%COMP%]{flex:none;width:90%}}.sign-text-content__upload[_ngcontent-%COMP%]{width:100%;height:calc(100% - 7rem);border:1px solid #F8EAA3;background-color:#fffffff2}.sign-text-content__footer[_ngcontent-%COMP%]{display:flex;align-items:flex-end;justify-content:flex-end;width:100%}.sign-text-content__upload-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;height:7rem;padding:1rem 0;margin:0 1rem;border-bottom:1px solid #000}.sign-text-content__pdf[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:calc(100% - 7rem);overflow:auto}.sign-text-content__notice[_ngcontent-%COMP%]{margin-right:1.5rem;color:#424242;letter-spacing:.065em;font-size:1.4rem}.sign-text-content__notice-text[_ngcontent-%COMP%]{font-weight:400;letter-spacing:.1em;color:#6f6f6f;font-size:1.4rem}.sign-text-content__notice-text_red[_ngcontent-%COMP%]{color:#d00000}.sign-text-content__error[_ngcontent-%COMP%]{position:relative;width:3.4rem;height:3.4rem;margin-right:.8rem;border:1px solid #D00000;background-color:transparent;border-radius:50%}.sign-text-content__error-line[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;width:2rem;height:.1rem;background-color:#d00000}.sign-text-content__error-line[_ngcontent-%COMP%]:nth-child(1){transform:translate(-50%,-50%) rotate(45deg)}.sign-text-content__error-line[_ngcontent-%COMP%]:nth-child(2){transform:translate(-50%,-50%) rotate(-45deg)}.process[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:space-between;align-items:center;width:100%;height:100%;padding:0 25%}@media only screen and (max-width: 75em){.process[_ngcontent-%COMP%]{padding-left:0}}.process__line[_ngcontent-%COMP%]{position:absolute;right:calc(25% + 2.1rem);width:1px;height:100%;background-color:#ffec8a;z-index:100}.process__item[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-end;font-weight:500;font-size:2rem}.process__item_active[_ngcontent-%COMP%]   .process__text[_ngcontent-%COMP%]{background-color:transparent}.process__item_active[_ngcontent-%COMP%]   .process__step[_ngcontent-%COMP%]{color:#043951;background-color:#ffec8a}.process__text[_ngcontent-%COMP%]{margin-right:1.6rem;color:#fff;letter-spacing:.2em}@media only screen and (max-width: 36em){.process__text[_ngcontent-%COMP%]{display:none}}.process__step[_ngcontent-%COMP%]{position:relative;min-width:4.2rem;min-height:4.2rem;width:4.2rem;height:4.2rem;border:1px solid #FFEC8A;border-radius:50%;text-align:center;line-height:4.2rem;color:#ffec8a;background-color:#464646;z-index:150;transition:all .4s}.upload-input[_ngcontent-%COMP%]{display:none}.pdf-viewer[_ngcontent-%COMP%], .canvas-viewer[_ngcontent-%COMP%]{width:100%;height:100%}.signature[_ngcontent-%COMP%]{width:100%;height:calc(100% - 7rem);border:1px solid #F8EAA3;background-color:#fffffff2}.signature__header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:10rem}.signature__title[_ngcontent-%COMP%]{font-weight:400;font-size:14px;letter-spacing:.1em;color:#6f6f6f;font-size:1.4rem}.signature__title_href[_ngcontent-%COMP%]{color:#043951;text-decoration:underline;cursor:pointer}.signature__canvas-container[_ngcontent-%COMP%]{width:80%;height:calc(100% - 25rem);margin:0 auto}.signature__canvas[_ngcontent-%COMP%]{width:100%;height:100%;border:1px solid #BFBFBF}.signature__footer[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:15rem}.signature__btn-margin[_ngcontent-%COMP%]{margin-right:5rem}.marge[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;height:calc(100% - 7rem);border:1px solid #F8EAA3;background-color:#fffffff2;overflow:auto}.marge__canvas[_ngcontent-%COMP%]{width:100%;height:100%}.signature-pop-box[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#0009;z-index:500}.signature-pop[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:75%;height:58.7rem;padding:8.4rem 11.1rem;border:5px solid #F8EAA3;background-color:#fff;border-radius:5px;z-index:480}@media only screen and (max-width: 36em){.signature-pop[_ngcontent-%COMP%]{padding:8.4rem 2rem}}@media only screen and (max-width: 62.5em){.signature-pop[_ngcontent-%COMP%]{padding:8.4rem 2rem}}.signature-pop__title[_ngcontent-%COMP%]{margin-bottom:6rem;font-weight:400;font-size:4rem;letter-spacing:.065em;color:#043951;text-align:center}@media only screen and (max-width: 48em){.signature-pop__title[_ngcontent-%COMP%]{font-size:2.4rem}}@media only screen and (max-width: 36em){.signature-pop__title[_ngcontent-%COMP%]{font-size:1.8rem}}.signature-pop__item[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.signature-pop__item[_ngcontent-%COMP%]:not(:last-child){margin-bottom:6.5rem}.signature-pop__img-box[_ngcontent-%COMP%]{width:60%;height:10.3rem;border:3px solid #F8EAA3;border-radius:5px;margin-right:4rem}@media only screen and (max-width: 62.5em){.signature-pop__img-box[_ngcontent-%COMP%]{height:7rem}}@media only screen and (max-width: 36em){.signature-pop__img-box[_ngcontent-%COMP%]{height:4rem}}.signature-pop__img[_ngcontent-%COMP%]{width:100%}.signature-pop__close-box[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem;width:5rem;height:5rem;cursor:pointer}.signature-pop__close-box[_ngcontent-%COMP%]:hover   .signature-pop__close[_ngcontent-%COMP%]{opacity:.7}.signature-pop__close[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;display:inline-block;width:3rem;height:2px;background-color:#bfbfbf}.signature-pop__close[_ngcontent-%COMP%]:nth-child(1){transform:translate(-50%,-50%) rotate(45deg)}.signature-pop__close[_ngcontent-%COMP%]:nth-child(2){transform:translate(-50%,-50%) rotate(-45deg)}"]}),t})();const D2=["signCanvas1"],P2=["signCanvasContainer1"],M2=["signCanvas2"],O2=["signCanvasContainer2"];function I2(t,e){1&t&&(Fe(0,"p",15),ot(1,"\u60a8\u7684\u7c3d\u540d\u6a94\u5df2\u9054\u5169\u5247\u4e0a\u9650"),Le())}let k2=(()=>{class t{constructor(n){this.signautreService=n,this.resize$=xt(window,"resize")}ngOnInit(){}ngOnDestroy(){this.signautreService.isSign1Isset&&""===this.signautreService.signatureUrl1&&(this.signautreService.isSign1Isset=!1),this.signautreService.isSign2Isset&&""===this.signautreService.signatureUrl2&&(this.signautreService.isSign2Isset=!1),this.signautreService.isSign2Isset&&!this.signautreService.isSign1Isset&&(this.signautreService.isSign1Isset=!0,this.signautreService.signatureUrl1=this.signautreService.signatureUrl2,this.signautreService.isSign2Isset=!1,this.signautreService.signatureUrl2=""),this.resizeSubscript&&this.resizeSubscript.unsubscribe(),this.mouse1Subscript&&this.mouse1Subscript.unsubscribe(),this.mouse2Subscript&&this.mouse2Subscript.unsubscribe()}ngAfterViewInit(){if(this.resizeSubscript=this.resize$.subscribe(()=>{if(this.signautreService.isSign1Isset){let n=this.ctxSign1.getImageData(0,0,this.signCanvas1.nativeElement.width,this.signCanvas1.nativeElement.height);this.ctxSign1.canvas.width=this.signCanvasContainer1.nativeElement.offsetWidth,this.ctxSign1.canvas.height=this.signCanvasContainer1.nativeElement.offsetHeight,this.ctxSign1.putImageData(n,0,0)}if(this.signautreService.isSign2Isset){let n=this.ctxSign2.getImageData(0,0,this.signCanvas2.nativeElement.width,this.signCanvas2.nativeElement.height);this.ctxSign2.canvas.width=this.signCanvasContainer2.nativeElement.offsetWidth,this.ctxSign2.canvas.height=this.signCanvasContainer2.nativeElement.offsetHeight,this.ctxSign2.putImageData(n,0,0)}}),void 0!==this.signCanvas1){const n=xt(this.signCanvas1.nativeElement,"mousedown"),i=xt(this.signCanvas1.nativeElement,"mousemove"),r=xt(this.signCanvas1.nativeElement,"mouseup"),s=xt(this.signCanvas1.nativeElement,"mouseout");this.signCanvas1.nativeElement.width=this.signCanvasContainer1.nativeElement.offsetWidth,this.signCanvas1.nativeElement.height=this.signCanvasContainer1.nativeElement.offsetHeight,void 0!==this.signCanvas1.nativeElement&&(this.ctxSign1=this.signCanvas1.nativeElement.getContext("2d")),this.mouse1Subscript=n.pipe(Y(d=>{const w=this.getMousePos(this.signCanvas1.nativeElement,d);return this.ctxSign1.beginPath(),this.ctxSign1.moveTo(w.x,w.y),d.preventDefault(),i.pipe(Vt(r.pipe(Uf(s))))})).pipe(Pc()).subscribe(d=>{const w=this.getMousePos(this.signCanvas1.nativeElement,d);this.ctxSign1.lineCap="round",this.ctxSign1.lineWidth=2,this.ctxSign1.lineJoin="round",this.ctxSign1.shadowBlur=1,this.ctxSign1.shadowColor="black",this.ctxSign1.lineTo(w.x,w.y),this.ctxSign1.stroke(),this.saveSignCanvas(1)})}if(void 0!==this.signCanvas2){const n=xt(this.signCanvas2.nativeElement,"mousedown"),i=xt(this.signCanvas2.nativeElement,"mousemove"),r=xt(this.signCanvas2.nativeElement,"mouseup"),s=xt(this.signCanvas2.nativeElement,"mouseout");this.signCanvas2.nativeElement.width=this.signCanvasContainer2.nativeElement.offsetWidth,this.signCanvas2.nativeElement.height=this.signCanvasContainer2.nativeElement.offsetHeight,void 0!==this.signCanvas2.nativeElement&&(this.ctxSign2=this.signCanvas2.nativeElement.getContext("2d")),this.mouse2Subscript=n.pipe(Y(d=>{const w=this.getMousePos(this.signCanvas2.nativeElement,d);return this.ctxSign2.beginPath(),this.ctxSign2.moveTo(w.x,w.y),d.preventDefault(),i.pipe(Vt(r.pipe(Uf(s))))})).pipe(Pc()).subscribe(d=>{const w=this.getMousePos(this.signCanvas2.nativeElement,d);this.ctxSign2.lineCap="round",this.ctxSign2.lineWidth=2,this.ctxSign2.lineJoin="round",this.ctxSign2.shadowBlur=1,this.ctxSign2.shadowColor="black",this.ctxSign2.lineTo(w.x,w.y),this.ctxSign2.stroke(),this.saveSignCanvas(2)})}if(this.signautreService.isSign1Isset){const n=new Image;n.onload=()=>{this.ctxSign1.drawImage(n,0,0)},n.src=this.signautreService.signatureUrl1}if(this.signautreService.isSign2Isset){const n=new Image;n.onload=()=>{this.ctxSign2.drawImage(n,0,0)},n.src=this.signautreService.signatureUrl2}}addSignature(){let n=!1;!this.signautreService.isSign1Isset&&!n&&(n=!0,this.signautreService.isSign1Isset=!0,setTimeout(()=>{this.ctxSign1.canvas.width=this.signCanvasContainer1.nativeElement.offsetWidth,this.ctxSign1.canvas.height=this.signCanvasContainer1.nativeElement.offsetHeight},0)),!this.signautreService.isSign2Isset&&!n&&(n=!0,this.signautreService.isSign2Isset=!0,setTimeout(()=>{this.ctxSign2.canvas.width=this.signCanvasContainer2.nativeElement.offsetWidth,this.ctxSign2.canvas.height=this.signCanvasContainer2.nativeElement.offsetHeight},0))}deleteSign(n){1===n&&(this.signautreService.isSign1Isset=!1,this.signautreService.signatureUrl1="",this.ctxSign1.canvas.width=this.signCanvasContainer1.nativeElement.offsetWidth,this.ctxSign1.canvas.height=this.signCanvasContainer1.nativeElement.offsetHeight),2===n&&(this.signautreService.isSign2Isset=!1,this.signautreService.signatureUrl2="",this.ctxSign2.canvas.width=this.signCanvasContainer2.nativeElement.offsetWidth,this.ctxSign2.canvas.height=this.signCanvasContainer2.nativeElement.offsetHeight)}getMousePos(n,i){var r=n.getBoundingClientRect();return{x:i.clientX-r.left,y:i.clientY-r.top}}saveSignCanvas(n){1===n&&(this.signautreService.signatureUrl1=this.ctxSign1.canvas.toDataURL()),2===n&&(this.signautreService.signatureUrl2=this.ctxSign2.canvas.toDataURL())}}return t.\u0275fac=function(n){return new(n||t)(Qe(Na))},t.\u0275cmp=gi({type:t,selectors:[["app-add-sign"]],viewQuery:function(n,i){if(1&n&&(Di(D2,5),Di(P2,5),Di(M2,5),Di(O2,5)),2&n){let r;qn(r=Qn())&&(i.signCanvas1=r.first),qn(r=Qn())&&(i.signCanvasContainer1=r.first),qn(r=Qn())&&(i.signCanvas2=r.first),qn(r=Qn())&&(i.signCanvasContainer2=r.first)}},decls:23,vars:5,consts:[[1,"add-sign-content"],[1,"add-sign-content__header"],[1,"add-sign-content__title"],[1,"btn","btn_dark","add-sign-content__title-btn",3,"click"],["id","1",1,"add-sign-content__container",3,"hidden"],[1,"add-sign-content__box"],[1,"add-sign-content__sign"],["signCanvasContainer1",""],[1,"add-sign-content__canvas"],["signCanvas1",""],[1,"btn","btn_transparent",3,"click"],["id","2",1,"add-sign-content__container",3,"hidden"],["signCanvasContainer2",""],["signCanvas2",""],["class","add-sign-content__notice-text",4,"ngIf"],[1,"add-sign-content__notice-text"]],template:function(n,i){1&n&&(Fe(0,"div",0),Fe(1,"div",1),Fe(2,"p",2),ot(3,"\u6211\u7684\u7c3d\u540d\u6a94"),Le(),Fe(4,"button",3),Dt("click",function(){return i.addSignature()}),ot(5,"\u65b0\u589e"),Le(),Le(),Fe(6,"div",4),Fe(7,"div",5),Fe(8,"div",6,7),Nt(10,"canvas",8,9),Le(),Fe(12,"button",10),Dt("click",function(){return i.deleteSign(1)}),ot(13,"\u522a\u9664"),Le(),Le(),Le(),Fe(14,"div",11),Fe(15,"div",5),Fe(16,"div",6,12),Nt(18,"canvas",8,13),Le(),Fe(20,"button",10),Dt("click",function(){return i.deleteSign(2)}),ot(21,"\u522a\u9664"),Le(),Le(),Le(),an(22,I2,2,0,"p",14),Le()),2&n&&(Ct(4),wr("btn_dark-disabled",i.signautreService.isSign1Isset&&i.signautreService.isSign2Isset),Ct(2),Tt("hidden",!i.signautreService.isSign1Isset),Ct(8),Tt("hidden",!i.signautreService.isSign2Isset),Ct(8),Tt("ngIf",i.signautreService.isSign1Isset&&i.signautreService.isSign2Isset))},directives:[lo],styles:[".btn[_ngcontent-%COMP%]{width:15.4rem;height:4.7rem;border-radius:4px;background-color:#f8eaa3;letter-spacing:.2em;outline:none;border:1px solid transparent;box-shadow:0 0 4px #ffec8a;font-weight:400;font-family:inherit;color:#00212d;cursor:pointer;transition:all .3s;font-size:2rem}.btn_label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.btn_step[_ngcontent-%COMP%]{width:30rem;height:5rem}.btn_step[_ngcontent-%COMP%]:not(:last-child){margin-right:2.5rem}.btn_step-transparent[_ngcontent-%COMP%]{border:1px solid #F8EAA3;box-shadow:none;color:#f8eaa3;background-color:transparent}.btn_dark[_ngcontent-%COMP%]{box-shadow:none;background-color:#cb9b0c;color:#fff}.btn_transparent[_ngcontent-%COMP%]{border:1px solid #CB9B0C;box-shadow:none;color:#cb9b0c;background-color:transparent}.btn_dark-disabled[_ngcontent-%COMP%]{background-color:#b4b4b4;pointer-events:none;color:#515151;border:1px solid #515151}.btn[_ngcontent-%COMP%]:hover{background-color:#f5e076}.btn_dark[_ngcontent-%COMP%]:hover{background-color:#cb9b0cb3}.btn_transparent[_ngcontent-%COMP%]:hover{background-color:#cb9b0c4d;color:#fff}.btn_step-transparent[_ngcontent-%COMP%]:hover{background-color:#f8eaa34d;color:#fff}@media only screen and (max-width: 48em){.btn[_ngcontent-%COMP%]{font-size:2rem}}@media only screen and (max-width: 36em){.btn[_ngcontent-%COMP%]{width:8rem;height:3.3rem;font-size:1.4rem}}.add-sign-content[_ngcontent-%COMP%]{width:100%;height:calc(100% - 5rem);padding:9.5rem calc(20.27% - 7.2rem);padding-bottom:0}@media only screen and (max-width: 62.5em){.add-sign-content[_ngcontent-%COMP%]{padding:9.5rem 0}}.add-sign-content__header[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;height:6rem;margin-bottom:5rem}.add-sign-content__title[_ngcontent-%COMP%]{font-weight:400;font-size:4rem;letter-spacing:.065em;color:#f8eaa3}@media only screen and (max-width: 48em){.add-sign-content__title[_ngcontent-%COMP%]{font-size:3.2rem}}@media only screen and (max-width: 36em){.add-sign-content__title[_ngcontent-%COMP%]{font-size:1.4rem}}.add-sign-content__title-btn[_ngcontent-%COMP%]{position:absolute;right:0;top:50%;transform:translateY(-50%)}@media only screen and (max-width: 48em){.add-sign-content__title-btn[_ngcontent-%COMP%]{width:11.4rem}}.add-sign-content__container[_ngcontent-%COMP%]:not(:last-child){margin-bottom:6.5rem}.add-sign-content__box[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.add-sign-content__sign[_ngcontent-%COMP%]{flex:1;height:10.3rem;margin-right:4rem;border:3px solid #FCD20D;border-radius:4px;background-color:#fff}.add-sign-content__notice-text[_ngcontent-%COMP%]{width:100%;font-size:1.6rem;letter-spacing:.2em;text-align:center;color:#fff}@media only screen and (max-width: 36em){.add-sign-content__notice-text[_ngcontent-%COMP%]{font-size:1.2rem}}.add-sign-content__canvas[_ngcontent-%COMP%]{width:100%;height:100%}"]}),t})();function R2(t,e){1&t&&Nt(0,"app-service-sign")}function F2(t,e){1&t&&Nt(0,"app-add-sign")}const L2=[{path:"",component:XL},{path:"sign",component:(()=>{class t{constructor(n){this.signautreService=n,this.tab="sign",this.tab=n.work}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(Qe(Na))},t.\u0275cmp=gi({type:t,selectors:[["app-service"]],decls:10,vars:6,consts:[[1,"container"],[1,"tab"],[1,"tab__item",3,"click"],[1,"tab__text"],[4,"ngIf"]],template:function(n,i){1&n&&(Fe(0,"div",0),Fe(1,"div",1),Fe(2,"div",2),Dt("click",function(){return i.tab="sign"}),Fe(3,"p",3),ot(4,"\u7c3d\u5c6c\u6587\u4ef6"),Le(),Le(),Fe(5,"div",2),Dt("click",function(){return i.tab="add"}),Fe(6,"p",3),ot(7,"\u5efa\u7acb\u7c3d\u540d\u6a94"),Le(),Le(),Le(),an(8,R2,1,0,"app-service-sign",4),an(9,F2,1,0,"app-add-sign",4),Le()),2&n&&(Ct(2),wr("tab__item_active","sign"===i.tab),Ct(3),wr("tab__item_active","add"===i.tab),Ct(3),Tt("ngIf","sign"===i.tab),Ct(1),Tt("ngIf","add"===i.tab))},directives:[lo,T2,k2],styles:[".btn[_ngcontent-%COMP%]{width:15.4rem;height:4.7rem;border-radius:4px;background-color:#f8eaa3;letter-spacing:.2em;outline:none;border:1px solid transparent;box-shadow:0 0 4px #ffec8a;font-weight:400;font-family:inherit;color:#00212d;cursor:pointer;transition:all .3s;font-size:2rem}.btn_label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.btn_step[_ngcontent-%COMP%]{width:30rem;height:5rem}.btn_step[_ngcontent-%COMP%]:not(:last-child){margin-right:2.5rem}.btn_step-transparent[_ngcontent-%COMP%]{border:1px solid #F8EAA3;box-shadow:none;color:#f8eaa3;background-color:transparent}.btn_dark[_ngcontent-%COMP%]{box-shadow:none;background-color:#cb9b0c;color:#fff}.btn_transparent[_ngcontent-%COMP%]{border:1px solid #CB9B0C;box-shadow:none;color:#cb9b0c;background-color:transparent}.btn_dark-disabled[_ngcontent-%COMP%]{background-color:#b4b4b4;pointer-events:none;color:#515151;border:1px solid #515151}.btn[_ngcontent-%COMP%]:hover{background-color:#f5e076}.btn_dark[_ngcontent-%COMP%]:hover{background-color:#cb9b0cb3}.btn_transparent[_ngcontent-%COMP%]:hover{background-color:#cb9b0c4d;color:#fff}.btn_step-transparent[_ngcontent-%COMP%]:hover{background-color:#f8eaa34d;color:#fff}@media only screen and (max-width: 48em){.btn[_ngcontent-%COMP%]{font-size:2rem}}@media only screen and (max-width: 36em){.btn[_ngcontent-%COMP%]{width:8rem;height:3.3rem;font-size:1.4rem}}.container[_ngcontent-%COMP%]{width:100%;height:calc(100vh - 11rem);padding:4rem 7.2rem 0}.tab[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:5rem}.tab__item[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex:1;height:100%;border-bottom:1px solid #8E8E8E;color:#bfbfbf;cursor:pointer;transition:all .3s}.tab__item_active[_ngcontent-%COMP%]{border-bottom:1px solid #F8EAA3;border-radius:4px;background-color:#ffffff26}.tab__text[_ngcontent-%COMP%]{font-weight:500;letter-spacing:.2em;font-size:2.4rem}@media only screen and (max-width: 48em){.tab__text[_ngcontent-%COMP%]{font-size:2rem}}@media only screen and (max-width: 36em){.tab__text[_ngcontent-%COMP%]{font-size:2rem}}.tab__item[_ngcontent-%COMP%]:hover   .tab__text[_ngcontent-%COMP%]{opacity:.7}.tab__item_active[_ngcontent-%COMP%]   .tab__text[_ngcontent-%COMP%]{color:#fff}"]}),t})()},{path:"history",component:YL}];let N2=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Zi({type:t}),t.\u0275inj=fi({imports:[[jf.forRoot(L2)],jf]}),t})();const B2=function(){return["/history"]};function j2(t,e){if(1&t){const n=Si();Fe(0,"button",3),Dt("click",function(){return Cn(n),Wt().isHistory=!0}),ot(1,"\u6b77\u53f2\u6587\u4ef6"),Le()}2&t&&Tt("routerLink",ca(1,B2))}const V2=function(){return["/"]};function U2(t,e){if(1&t){const n=Si();Fe(0,"button",3),Dt("click",function(){return Cn(n),Wt().isHistory=!1}),ot(1,"\u56de\u5230\u9996\u9801"),Le()}2&t&&Tt("routerLink",ca(1,V2))}let H2=(()=>{class t{constructor(n){this.route=n,this.isHistory=!1}ngOnInit(){const n=window.location.href.split("/");"history"==n[n.length-1]&&(this.isHistory=!0)}}return t.\u0275fac=function(n){return new(n||t)(Qe(is))},t.\u0275cmp=gi({type:t,selectors:[["app-header"]],decls:4,vars:2,consts:[[1,"header"],["src","https://siezlh4405.github.io/the-f2e-2022-w2/assets/images/logo.png","alt","LOGO",1,"header__logo"],["class","header__btn btn",3,"routerLink","click",4,"ngIf"],[1,"header__btn","btn",3,"routerLink","click"]],template:function(n,i){1&n&&(Fe(0,"header",0),Nt(1,"img",1),an(2,j2,2,2,"button",2),an(3,U2,2,2,"button",2),Le()),2&n&&(Ct(2),Tt("ngIf",!i.isHistory),Ct(1),Tt("ngIf",i.isHistory))},directives:[lo,La],styles:[".header[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;height:11rem}.header__logo[_ngcontent-%COMP%]{width:26.4rem}@media only screen and (max-width: 36em){.header__logo[_ngcontent-%COMP%]{width:21.4rem}}.header__btn[_ngcontent-%COMP%]{position:absolute;top:50%;right:7.2rem;transform:translateY(-50%)}@media only screen and (max-width: 48em){.header__btn[_ngcontent-%COMP%]{right:5.2rem}}@media only screen and (max-width: 36em){.header__btn[_ngcontent-%COMP%]{right:2.7rem}}",".btn[_ngcontent-%COMP%]{width:15.4rem;height:4.7rem;border-radius:4px;background-color:#f8eaa3;letter-spacing:.2em;outline:none;border:1px solid transparent;box-shadow:0 0 4px #ffec8a;font-weight:400;font-family:inherit;color:#00212d;cursor:pointer;transition:all .3s;font-size:2rem}.btn_label[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.btn_step[_ngcontent-%COMP%]{width:30rem;height:5rem}.btn_step[_ngcontent-%COMP%]:not(:last-child){margin-right:2.5rem}.btn_step-transparent[_ngcontent-%COMP%]{border:1px solid #F8EAA3;box-shadow:none;color:#f8eaa3;background-color:transparent}.btn_dark[_ngcontent-%COMP%]{box-shadow:none;background-color:#cb9b0c;color:#fff}.btn_transparent[_ngcontent-%COMP%]{border:1px solid #CB9B0C;box-shadow:none;color:#cb9b0c;background-color:transparent}.btn_dark-disabled[_ngcontent-%COMP%]{background-color:#b4b4b4;pointer-events:none;color:#515151;border:1px solid #515151}.btn[_ngcontent-%COMP%]:hover{background-color:#f5e076}.btn_dark[_ngcontent-%COMP%]:hover{background-color:#cb9b0cb3}.btn_transparent[_ngcontent-%COMP%]:hover{background-color:#cb9b0c4d;color:#fff}.btn_step-transparent[_ngcontent-%COMP%]:hover{background-color:#f8eaa34d;color:#fff}@media only screen and (max-width: 48em){.btn[_ngcontent-%COMP%]{font-size:2rem}}@media only screen and (max-width: 36em){.btn[_ngcontent-%COMP%]{width:8rem;height:3.3rem;font-size:1.4rem}}"]}),t})(),W2=(()=>{class t{constructor(){this.title="thef2e2022week2"}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=gi({type:t,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"body"]],template:function(n,i){1&n&&(Fe(0,"div",0),Nt(1,"app-header"),Nt(2,"router-outlet"),Le())},directives:[H2,Nf],styles:[".body[_ngcontent-%COMP%]{width:100%;min-height:100vh;background-image:url(bg-desktop.d72a5359e29d54c2dccd.png);background-repeat:no-repeat;background-size:cover}@media only screen and (max-width: 48em){.body[_ngcontent-%COMP%]{background-image:url(bg-tablet.a030ebc19af924e07973.png)}}@media only screen and (max-width: 36em){.body[_ngcontent-%COMP%]{background-image:url(bg-phone.5811675c0ddb01814fbb.png)}}"]}),t})(),z2=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Zi({type:t}),t.\u0275inj=fi({imports:[[J0,jf,d2]]}),t})(),G2=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Zi({type:t,bootstrap:[W2]}),t.\u0275inj=fi({providers:[],imports:[[eR,N2,z2]]}),t})();(function(){if(t0)throw new Error("Cannot enable prod mode after platform setup.");e0=!1})(),Jk().bootstrapModule(G2).catch(t=>console.error(t))},52:Ie=>{function $(S,ke,we,ye,be,le,_){try{var h=S[le](_),p=h.value}catch(g){return void we(g)}h.done?ke(p):Promise.resolve(p).then(ye,be)}Ie.exports=function(S){return function(){var ke=this,we=arguments;return new Promise(function(ye,be){var le=S.apply(ke,we);function _(p){$(le,ye,be,_,h,"next",p)}function h(p){$(le,ye,be,_,h,"throw",p)}_(void 0)})}},Ie.exports.default=Ie.exports,Ie.exports.__esModule=!0},960:()=>{},759:()=>{},272:()=>{},414:()=>{},172:()=>{},1:()=>{},779:()=>{},558:()=>{},258:()=>{}},Ie=>{Ie(Ie.s=859)}]);